

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TwoPtCorrelators &mdash; LQCD Analysis Codebase TF Fits documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LQCD Analysis Codebase
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LQCD Analysis Codebase</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>TwoPtCorrelators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for TwoPtCorrelators</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>


<span class="c1">#IMPORT THIS FIRST, put in base import file</span>
<span class="c1"># import matplotlib</span>
<span class="c1"># matplotlib.use(&#39;Agg&#39;) # Must be before importing matplotlib.pyplot or pylab!</span>
<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="c1">##</span>


<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">nboot</span><span class="p">,</span><span class="n">defxlimAlpha</span><span class="p">,</span><span class="n">defxlimOp</span><span class="p">,</span><span class="n">datadir</span><span class="p">,</span><span class="n">cfgfmtdir</span><span class="p">,</span><span class="n">Debug_Mode</span><span class="p">,</span><span class="n">this_dir</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">ReadFuns</span><span class="p">,</span><span class="n">WriteFuns</span><span class="p">,</span><span class="n">Construct_File_Object</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">cfundir</span><span class="p">,</span><span class="n">defxlim</span><span class="p">,</span><span class="n">outputdir</span><span class="p">,</span><span class="n">TflowToPhys</span><span class="p">,</span><span class="n">Qeps</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">defSparam</span><span class="p">,</span><span class="n">Wipe_All_Fits</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">ODNested</span><span class="p">,</span><span class="n">mkdir_p</span><span class="p">,</span><span class="n">CheckClass</span><span class="p">,</span><span class="n">GetInfoList</span><span class="p">,</span><span class="n">RemoveAllBoots</span><span class="p">,</span><span class="n">fmt_file_type</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">Series_fix_key</span><span class="p">,</span><span class="n">CombineCfgs</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">CreateNameAndLL</span><span class="p">,</span><span class="n">GenSinkFun</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">,</span><span class="n">Series_TO_ODict</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">tstr</span><span class="p">,</span><span class="n">unxmlfitr</span><span class="p">,</span><span class="n">untstr</span><span class="p">,</span><span class="n">AvgStdToFormat</span><span class="p">,</span><span class="n">epsstr</span><span class="p">,</span><span class="n">unxmlfitr_int</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">tflowTOLeg</span><span class="p">,</span><span class="n">tflowstr</span><span class="p">,</span><span class="n">tsinkTOLeg</span><span class="p">,</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tsumstr</span><span class="p">,</span><span class="n">KeyForamtting</span>
<span class="c1"># from XmlFormatting import MakeValAndErr</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">C2OneStateFitFunNoExp</span><span class="p">,</span><span class="n">C2OneStateFitFun</span><span class="p">,</span><span class="n">C2TwoStateFitFun</span><span class="p">,</span><span class="n">C2TwoStateFitFunNoExp</span><span class="p">,</span><span class="n">C2OSFAntiper</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">ConstantFitFun</span><span class="p">,</span><span class="n">Alpha_Prop_Fit_plin</span><span class="p">,</span><span class="n">C2OSFAntiperDer</span>
<span class="kn">from</span> <span class="nn">Autocorr</span> <span class="k">import</span> <span class="n">AutoCorrelate</span>
<span class="kn">from</span> <span class="nn">NullPlotData</span> <span class="k">import</span> <span class="n">null_series</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">SetsOfFits</span> <span class="k">as</span> <span class="nn">sff</span>
<span class="c1"># import traceback</span>


<span class="kn">import</span> <span class="nn">MomParams</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">ReadBinaryCfuns</span> <span class="k">import</span> <span class="n">R2CChromaXMLFileList</span><span class="p">,</span><span class="n">RC2Full</span>
<span class="kn">from</span> <span class="nn">BootStrapping</span> <span class="k">import</span> <span class="n">BootStrap</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">WriteXml</span><span class="p">,</span><span class="n">WritePickle</span><span class="p">,</span><span class="n">ReadPickleWrap</span><span class="p">,</span><span class="n">WriteExcel</span><span class="p">,</span><span class="n">ReadWithMeta</span><span class="p">,</span><span class="n">WriteWithMeta</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="c1"># import cPickle as pickle</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">re</span><span class="o">,</span><span class="nn">glob</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">import</span> <span class="nn">FitFunctions</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>

<span class="kn">from</span> <span class="nn">FlowOpps</span> <span class="k">import</span> <span class="n">FlowOp</span><span class="p">,</span><span class="n">FlowOpFullSquared</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">How to use:</span>

<span class="sd">TwoPointCorr(cfglist=[], Info={})</span>
<span class="sd">creates class using:</span>
<span class="sd"> configuration list cfglist</span>
<span class="sd"> Information Dictionary Info (See below for what can be in Info)</span>


<span class="sd">.LoadPickle()</span>
<span class="sd">Does everything basically.</span>
<span class="sd">Will ReadAndWrite() if pickle file is not found</span>
<span class="sd">i.e. will run analysis if not already done before.</span>


<span class="sd">NNQCorr class is below, (search for string! this is big file)</span>

<span class="sd">WARNING: only 1 stream is implemented now. only pass in config lists or have directories</span>
<span class="sd">         with 1 steam (-a- for example)</span>

<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="GetInterpFlag"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.GetInterpFlag">[docs]</a><span class="k">def</span> <span class="nf">GetInterpFlag</span><span class="p">(</span><span class="n">thisInterp</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;P4&#39;</span> <span class="ow">or</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;CPEven&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;9&#39;</span>
    <span class="k">elif</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;g5P4&#39;</span> <span class="ow">or</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;CPOdd&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;17&#39;</span>
    <span class="k">elif</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;g5&#39;</span> <span class="ow">or</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;g5div2&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;1&#39;</span>
    <span class="k">elif</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;P4g5&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0&#39;</span>
    <span class="k">elif</span> <span class="n">thisInterp</span> <span class="o">==</span> <span class="s1">&#39;Pion&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;15&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">thisInterp</span></div>



<div class="viewcode-block" id="TwoPointCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr">[docs]</a><span class="k">class</span> <span class="nc">TwoPointCorr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; C2(p,t) uses bootstrap class</span>
<span class="sd">        p =  momentum</span>
<span class="sd">        t = time</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="TwoPointCorr.Construct_2pt_File"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Construct_2pt_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_2pt_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">)</span></div>


    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SetOfCorrs.SetOfTwoPt&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQCorr&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQFullCorr&#39;</span><span class="p">,</span><span class="s1">&#39;VarMethod.VariationalTwoPt&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span><span class="n">Info</span><span class="o">=</span><span class="p">{},</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;nt&#39;</span><span class="p">,</span><span class="s1">&#39;ProjStr&#39;</span><span class="p">,</span><span class="s1">&#39;ism&#39;</span><span class="p">,</span><span class="s1">&#39;jsm&#39;</span><span class="p">,</span><span class="s1">&#39;tsrc&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>
        <span class="c1"># self.checkmomlist = self.latparams.momstrlistAvg</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## Initialising plotting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>
        <span class="c1">## the actual shift ammount needs to be scaled by the x axis size</span>
        <span class="c1">## see GetShift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>

        <span class="c1">#self.C2 = [ ip , it , ,istream , iconf ]</span>
        <span class="c1"># self.C2     = np.array([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_cfgs DataFrame:</span>

<span class="sd">        columns =   config_numbers , Op[ip, it]</span>

<span class="sd">        rows =      stream , configuration</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_Stats DataFrame:</span>

<span class="sd">        columns =   boot,   Avg,        Std</span>
<span class="sd">                    EffM,   EffMAvg,    EffMStd</span>

<span class="sd">        rows =      momenta, time separation</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># # C2boot [ ip , it ] bs</span>
        <span class="c1"># self.C2boot = ODNested()</span>
        <span class="c1"># self.C2Avg  = ODNested()</span>
        <span class="c1"># self.C2Std  = ODNested()</span>
        <span class="c1">#</span>
        <span class="c1"># # EffM [ ip , it ] bs</span>
        <span class="c1"># self.EffM    = ODNested()</span>
        <span class="c1"># self.EffMAvg = ODNested()</span>
        <span class="c1"># self.EffMStd = ODNested()</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_Fit_Stats DataFrame:</span>

<span class="sd">        columns =   boot</span>

<span class="sd">        rows =      states fitted to, momenta</span>


<span class="sd">        boot is SetOfFits object</span>
<span class="sd">        Avg/Std elements are pa.Series instances with:</span>
<span class="sd">            index = fit parameters</span>
<span class="sd">            values = Avg/Std values</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="c1"># # FitDict = [ States_Fitted_To, ip, Fit_range ] fitting class</span>
        <span class="c1"># self.FitDict    = ODNested()</span>
        <span class="c1"># # FitDictAvg/Std [ States_Fitted_To , ip ,  Fit_range , Fit_Parameter ] bs</span>
        <span class="c1"># self.FitDictAvg = ODNested()</span>
        <span class="c1"># self.FitDictStd = ODNested()</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>


        <span class="c1">## toggle to show exact configurations and sources used in xml outputfiles</span>
        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## used to pick out different configuraiton/source lists.</span>
        <span class="c1">## for example, if there are less flowed operators than 2 point correlators, passing &#39;TopCharge&#39; will read that result</span>
        <span class="k">if</span> <span class="s1">&#39;fo_for_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;fo_for_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="kc">False</span>



        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;Fits&#39;] = [ (&#39;state#&#39; , &#39;fit#-#&#39; ) , ...]</span>
        <span class="k">if</span> <span class="s1">&#39;Fits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="c1">## Info can contain projector used (or type of meson in psibar Gamma psi)</span>
        <span class="k">if</span> <span class="s1">&#39;Interp&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Interp</span> <span class="o">=</span> <span class="n">GetInterpFlag</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="s1">&#39;CPEven&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Interp</span> <span class="o">=</span> <span class="n">GetInterpFlag</span><span class="p">(</span><span class="s1">&#39;CPEven&#39;</span><span class="p">)</span> <span class="c1">## default to regular CP Even projector</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">==</span> <span class="s1">&#39;g5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="s1">&#39;g5div2&#39;</span>
        <span class="c1">## Info can contain projector used (or type of meson in psibar Gamma psi)</span>

        <span class="k">if</span> <span class="s1">&#39;MesOrBar&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;MesOrBar&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">=</span> <span class="s1">&#39;Baryon&#39;</span> <span class="c1">## Default to baryon</span>

        <span class="k">if</span> <span class="s1">&#39;cfg_file_type&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">cfg_file_type</span>

        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;iGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>

        <span class="c1">## Source Smearing ism value ( in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;ism&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ism</span> <span class="o">=</span> <span class="s1">&#39;ism&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ism&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ism</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## Sink Smearing jsm value ( in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;jsm&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="s1">&#39;jsm&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;jsm&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## t_source location ( in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;tsrc&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span> <span class="o">=</span> <span class="s1">&#39;tsrc&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsrc&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">defSparam</span>


        <span class="c1">## will attempt to find all replica streams in directory.</span>
        <span class="c1">## set self.nstream to number of streams you want to find.</span>
        <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">iinfo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">iinfo</span> <span class="ow">in</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>


        <span class="c1"># ## x_source list has been pushed to cfglist, this is depriciated</span>
        <span class="c1"># if &#39;xsrc&#39; in Info.keys(): self.xsrc = [&#39;xsrc&#39;+str(isrc) for isrc in Info[&#39;xsrc&#39;]]</span>
        <span class="c1"># else: self.xsrc = [&#39;xsrc1&#39;]</span>

        <span class="c1">## momentum ( in form of [px py pz] )</span>
        <span class="k">if</span> <span class="s1">&#39;pmom&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;pmom&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetMomList</span><span class="p">(</span><span class="n">list_type</span><span class="o">=</span><span class="s1">&#39;str_Avg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1">## aparenlty ReadBinary likes lists, not numpy arrays</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetAvgmomstr</span><span class="p">,</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;pmom&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetMomList</span><span class="p">(</span><span class="n">list_type</span><span class="o">=</span><span class="s1">&#39;str_Avg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">RemoveDup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkmomlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pform</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="o">+</span><span class="n">ip</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">]</span>


        <span class="c1">## kappa up down (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;Csw&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Csw</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Csw&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Csw</span> <span class="o">=</span> <span class="s1">&#39;C1715&#39;</span>
        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;Beta&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Beta</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Beta&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Beta</span> <span class="o">=</span> <span class="s1">&#39;B1900&#39;</span>

        <span class="n">fileism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ism&#39;</span><span class="p">,</span><span class="s1">&#39;sm&#39;</span><span class="p">)</span>
        <span class="n">filejsm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;jsm&#39;</span><span class="p">,</span><span class="s1">&#39;si&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder2</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^</span><span class="si">{3}</span><span class="s1">\times &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readfilename</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Beta</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Csw</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;_k&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;_nucleon.2cf.xml&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readfilename2</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Beta</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder2</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Csw</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;_k1382500_k1370000_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;_nucleon.2cf.xml&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readfilename3</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Beta</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder2</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Csw</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;_k1370000_k1364000_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;_nucleon.2cf.xml&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">cfundir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;_AY&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filedir</span> <span class="o">=</span> <span class="n">cfundir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;_AY/twoptRandT/twopt&#39;</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">cfundir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filedir</span> <span class="o">=</span> <span class="n">cfundir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/twoptRandT/twopt&#39;</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filedir</span> <span class="o">=</span> <span class="n">cfundir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/twoptRandT/twopt&#39;</span><span class="o">+</span><span class="n">fileism</span><span class="o">+</span><span class="n">filejsm</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>

        <span class="c1">## cfglist { configuration : [ x-source numbers ] }</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="n">Info</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">man_load_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="TwoPointCorr.LoadCfgs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.LoadCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">LoadCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="TwoPointCorr.GetFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="TwoPointCorr.RemoveFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span></div>

    <span class="c1"># ## thisInfo must contain correct information for combining the correlators (the smearings, the eigenvectors, etc...)</span>
    <span class="c1"># def GetCombCorr(self,thisInfo):</span>
    <span class="c1">#     from SetsOfTwoPtCorrs import SetOfTwoPt</span>
    <span class="c1">#     sinklab,jsmcoeffs,sm2ptList,InfoList = GetInfoList(thisInfo)</span>

    <span class="c1">#     C2Set = SetOfTwoPt(cfglist=self.NNQ_cfgs[[&#39;configs&#39;,&#39;xsrc_list&#39;]],InfoDict = InfoList)</span>
    <span class="c1">#     C2Set.LoadPickle(CheckCfgs=CheckCfgs)</span>
    <span class="c1">#     thisname,thisleglab,jsmlab = CreateNameAndLL(C2Set.SetC2,sinklab)</span>
    <span class="c1">#     thisfun = GenSinkFun(jsmcoeffs)</span>
    <span class="c1">#     thisfile = self.filename.replace(self.jsm,sinklab)</span>
    <span class="c1">#     thisLL = self.LegLab.replace(self.jsm,sinklab)</span>
    <span class="c1">#     # self.SetCustomName(thisfile,thisLL)</span>
    <span class="c1">#     # self.jsm = jsmlab</span>
    <span class="c1">#     return C2Set.CombineCorrs(thisfun,filename=thisfile,LegLab=thisLL,jsmlab=jsmlab)</span>



<div class="viewcode-block" id="TwoPointCorr.GetCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.GetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">SplitCfgSrc</span><span class="p">(</span><span class="n">ifile</span><span class="p">):</span>
            <span class="n">isrc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;_xsrc.*_k&#39;</span><span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.-00.*_xsrc&#39;</span><span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="n">istream</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.-&#39;</span><span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">isrc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">icfg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: file does not have xsrc or -.-####### (source or cfg number)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
            <span class="n">isrc</span> <span class="o">=</span> <span class="n">isrc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">icfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_xsrc&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)[</span><span class="mi">5</span><span class="p">:]</span>
            <span class="n">istream</span> <span class="o">=</span> <span class="n">istream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># return istream,isrc,icfg,int(icfg),int(isrc.replace(&#39;xsrc&#39;,&#39;&#39;))</span>
            <span class="k">return</span> <span class="n">istream</span><span class="p">,</span><span class="n">isrc</span><span class="p">,</span><span class="n">icfg</span>

        <span class="n">cfg_dict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="n">this_check</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span>
        <span class="k">for</span> <span class="n">ifile</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filedir</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">):</span>
            <span class="n">istream</span><span class="p">,</span><span class="n">ixsrc</span><span class="p">,</span><span class="n">icfg</span> <span class="o">=</span> <span class="n">SplitCfgSrc</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_check</span> <span class="ow">or</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">istream</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">cfg_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">icfg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">cfg_dict</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">cfg_dict</span><span class="p">[</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ixsrc</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cfg_dict</span><span class="p">[</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ixsrc</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cfg_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no configs found in &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filedir</span><span class="p">)</span>


        <span class="n">cfglist</span><span class="p">,</span><span class="n">xsrclist</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">this_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ix</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">ix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;xsrc&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">stream_dict</span> <span class="ow">in</span> <span class="n">cfg_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">icfg</span><span class="p">,(</span><span class="n">the_cfg</span><span class="p">,</span><span class="n">ixsrc_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span>
                <span class="n">cfglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">the_cfg</span><span class="p">)</span>
                <span class="c1">## sorting xsrc list with respect to its INTEGER value (not string sort!)</span>
                <span class="n">ixsrc_int_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">this_lambda</span><span class="p">,</span><span class="n">ixsrc_list</span><span class="p">))</span>
                <span class="n">xsrclist</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ix</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">ix</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ixsrc_int_list</span><span class="p">,</span><span class="n">ixsrc_list</span><span class="p">))])</span>
        <span class="c1">## finds cfgs and xsrcs conbinations that are in all streams.</span>
        <span class="c1">##MAKE SURE TO ORDER CFG AND SRC</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># raise EnvironmentError(&#39;No configs found for \n&#39;+name)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, No configs found for </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">xsrclist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">cfglist</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">cfg_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;int_configs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cfg_df</span><span class="p">[</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfg_df</span><span class="p">)</span></div>


    <span class="c1"># def MakeOutputFile(self):</span>
    <span class="c1">#     self.name = &#39;_&#39;.join([self.tsrc,self.ism,self.jsm])</span>
    <span class="c1">#     self.HumanFile = &#39;/&#39;+self.kappafolder+&#39;/G2/&#39;+self.name+&#39;.xml&#39;</span>
    <span class="c1">#     self.PickleFile = &#39;/&#39;+self.kappafolder+&#39;/G2/Pickle/&#39;+self.name+&#39;.py3p&#39;</span>


    <span class="c1">## Routines for Plotting ###############################################</span>

<div class="viewcode-block" id="TwoPointCorr.ImportPlotParams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.ImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">ImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>

<div class="viewcode-block" id="TwoPointCorr.CheckCol"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.CheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">CheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thiscol</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in color to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="TwoPointCorr.CheckSym"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.CheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">CheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thissym</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in symbol to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>


<div class="viewcode-block" id="TwoPointCorr.GetShift"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.GetShift">[docs]</a>    <span class="k">def</span> <span class="nf">GetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># if self.thisshiftscale == &#39;Not Set&#39;:</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span></div>
        <span class="c1"># else:</span>
        <span class="c1">#     return self.thisshiftscale</span>




    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="TwoPointCorr.LogPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.LogPlot">[docs]</a>    <span class="k">def</span> <span class="nf">LogPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">momlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
            <span class="n">tlist</span><span class="p">,</span><span class="n">databoot</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                <span class="n">scale</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">Avg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="n">logdata</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                <span class="n">logdata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logdata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">tlist</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span><span class="o">=</span><span class="n">scale</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>

    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="TwoPointCorr.Plot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Plot">[docs]</a>    <span class="k">def</span> <span class="nf">Plot</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1">## resets thisshiftscale so that you can plot EffMass and Log plot next to eachother,</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="c1"># thisshift = self.GetShift(xlims,thisshift)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span>
        <span class="c1"># m_getattr = lambda x, y: getattr(y,x)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="c1"># pdata = self.C2_Stats[&#39;EffM&#39;].xs(ip, level=&#39;momentum&#39;)</span>
        <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Log</span><span class="p">())</span>
            <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># tlist = pdata.index[xlims[0]:xlims[1]]</span>
        <span class="c1"># dataavg = dataavg.iloc[xlims[0]:xlims[1]]</span>
        <span class="c1"># dataerr = dataerr.iloc[xlims[0]:xlims[1]]</span>
        <span class="c1">## np.abs makes negative effective masses coming from G2^-1 be positive.</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(map(untstr,tlist))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>


    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="TwoPointCorr.EffMassPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.EffMassPlot">[docs]</a>    <span class="k">def</span> <span class="nf">EffMassPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="n">defxlim</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                    <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoPhys</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">thisval</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">hbarcdivlat</span>
            <span class="n">thisval</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">thisval</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1">## resets thisshiftscale so that you can plot EffMass and Log plot next to eachother,</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span>
        <span class="c1"># m_getattr = lambda x, y: getattr(y,x)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="c1"># pdata = self.C2_Stats[&#39;EffM&#39;].xs(ip, level=&#39;momentum&#39;)</span>
        <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Phys</span><span class="p">:</span> <span class="n">pdata</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoPhys</span><span class="p">)</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># tlist = pdata.index[xlims[0]:xlims[1]]</span>
        <span class="c1"># dataavg = dataavg.iloc[xlims[0]:xlims[1]]</span>
        <span class="c1"># dataerr = dataerr.iloc[xlims[0]:xlims[1]]</span>
        <span class="c1">## np.abs makes negative effective masses coming from G2^-1 be positive.</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(map(untstr,tlist))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phys</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>

    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after LogPlot or the xlims wont work properly</span>
<div class="viewcode-block" id="TwoPointCorr.LogFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.LogFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">LogFitPlot</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span>
                    <span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">EffMassFitPlot</span><span class="p">(</span> <span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span>
                        <span class="n">xlims</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="n">momlist</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span>
                        <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;logplot&#39;</span><span class="p">)</span></div>
    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after EffMassPlot or the xlims wont work properly</span>
<div class="viewcode-block" id="TwoPointCorr.EffMassFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.EffMassFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">EffMassFitPlot</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span>
                        <span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;effmass&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">momlist</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;momlist is not needed anymore, picking p000&#39;</span><span class="p">)</span>
            <span class="n">momlist</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no fits done, starting&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),</span><span class="n">fitr</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="c1"># fit_data = Series_fix_key(fit_data,4,&#39;fittwor&#39;,&#39;tsumfitr&#39;)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">momlist</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">,</span> <span class="s1">&#39; not found in FitDict, performing fit now&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),</span><span class="n">fitr</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="k">if</span> <span class="s1">&#39;effmass&#39;</span> <span class="ow">in</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;effm_fit_vary&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;log&#39;</span> <span class="ow">in</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;log_fit_vary&#39;</span>

        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Exp Fit&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phys</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
    <span class="c1">## ##################### ###############################################</span>

    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after EffMassPlot or the xlims wont work properly</span>
    <span class="c1">## TODO, fix this</span>
<div class="viewcode-block" id="TwoPointCorr.RecRelPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.RecRelPlot">[docs]</a>    <span class="k">def</span> <span class="nf">RecRelPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RecRelPlot Not implemeted for ImpSOF, ON THE TODO LIST&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># def DoPhys(value):</span>
        <span class="c1">#     thisval = value*self.latparams.hbarcdivlat</span>
        <span class="c1">#     thisval.Stats()</span>
        <span class="c1">#     return thisval</span>
        <span class="c1">#</span>
        <span class="c1"># self.CheckCol(thiscol)</span>
        <span class="c1"># self.CheckSym(thissym)</span>
        <span class="c1"># if isinstance(state,int): state = &#39;state&#39;+str(state)</span>
        <span class="c1"># # fitr_params = self.FitDict[state][fitr]</span>
        <span class="c1"># for imom in self.pform:</span>
        <span class="c1">#     if (state,imom,fitr) not in self.C2_Fit_Stats.index:</span>
        <span class="c1">#         print state,imom,fitr , &#39; has not been done, performing fit now&#39;</span>
        <span class="c1">#         self.Fit(int(state.replace(&#39;state&#39;,&#39;&#39;)),[fitr])</span>
        <span class="c1"># this_fit = self.C2_Fit_Stats[&#39;boot&#39;]</span>
        <span class="c1"># varl,errl,indexl,bootl = [],[],[],[]</span>
        <span class="c1"># for (istate,imom,ifitr),ifit in this_fit.iteritems():</span>
        <span class="c1">#     for ipar,parval in ifit.fit_data[&#39;Params&#39;].iteritems():</span>
        <span class="c1">#         indexl.append((istate,imom,ifitr,ipar))</span>
        <span class="c1">#         if ipar == &#39;Energy&#39; and Phys:</span>
        <span class="c1">#             parval = parval*self.latparams.hbarcdivlat</span>
        <span class="c1">#             parval.Stats()</span>
        <span class="c1">#         bootl.append(parval)</span>
        <span class="c1">#         varl.append(parval.Avg)</span>
        <span class="c1">#         errl.append(parval.Std)</span>
        <span class="c1"># if len(indexl) &gt; 0:</span>
        <span class="c1">#     indicies = pa.MultiIndex.from_tuples(indexl,names=list(self.C2_Fit_Stats.index.names) + [&#39;Parameter&#39;])</span>
        <span class="c1">#     fit_boot = pa.Series(bootl,index=indicies)</span>
        <span class="c1">#     fit_data = pa.Series(varl,index=indicies)</span>
        <span class="c1">#     fiterr_data = pa.Series(errl,index=indicies)</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="c1"># xboot = [self.latparams.EnergyFromRecRel(imom,zboot) for imom,zboot in fit_boot.loc[(istate,slice(None),ifitr,ipar)].iteritems()]</span>
        <span class="c1"># ploty = fit_data.loc[(istate,slice(None),ifitr,ipar)].values</span>
        <span class="c1"># plotx = map(lambda x : x.Avg,xboot)</span>
        <span class="c1"># plotxerr = map(lambda x : x.Std,xboot)</span>
        <span class="c1"># thisshift = self.GetShift((min(plotx),max(plotx)),thisshift)</span>
        <span class="c1"># hold_series = pa.Series()</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="c1"># hold_series[&#39;y_data&#39;] = fit_data</span>
        <span class="c1"># hold_series[&#39;xerr_data&#39;] = plotxerr</span>
        <span class="c1"># hold_series[&#39;yerr_data&#39;] = fiterr_data</span>
        <span class="c1"># hold_series[&#39;type&#39;] = &#39;error_bar_vary&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (istate,slice(None),ifitr,ipar)</span>
        <span class="c1"># hold_series[&#39;fit_class&#39;] = None</span>
        <span class="c1"># hold_series[&#39;label&#39;] = self.LegLab</span>
        <span class="c1"># hold_series[&#39;symbol&#39;] = self.thissym</span>
        <span class="c1"># hold_series[&#39;color&#39;] = self.thiscol</span>
        <span class="c1"># hold_series[&#39;shift&#39;] = thisshift</span>
        <span class="c1"># plot_class.AppendData(hold_series)</span>
        <span class="c1"># return plot_class,max([max(ploty),max(plotx)]),min([min(ploty),min(plotx)])</span>



<div class="viewcode-block" id="TwoPointCorr.SetCustomName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.SetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">SetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-def-&#39;</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">])</span>
            <span class="c1"># self.filename = self.name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">string</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span> <span class="c1">## customise this how you like</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="n">stringLL</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fo_for_cfgs</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span> <span class="o">=</span>        <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span><span class="o">+</span><span class="n">fo_for_cfgs</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2Cfgsdir</span> <span class="o">=</span>    <span class="n">cfgfmtdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span><span class="o">+</span><span class="n">fo_for_cfgs</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2Cfgsdir</span> <span class="o">=</span> <span class="n">cfgfmtdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2Cfgsdir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2Cfgsdir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.cfgs&#39;</span></div>

<div class="viewcode-block" id="TwoPointCorr.ImportCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.ImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfgsrclist</span><span class="p">,</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfgsrclist</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="n">stream_list</span>
            <span class="c1">## cfgsrclist is [cfglist , xsrclist]</span>
            <span class="c1">## cfglist must be 2-d array, first dimension is stream, second dimension is configuraiton number</span>
            <span class="c1">## xsrclist is 3-d array, first dimension is stream, second dimension is cfg number, third is xsrc number</span>
            <span class="c1">## xsrclist must have values &#39;xsrc##&#39; with no zero pre buffering</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">xsrc_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">istream</span><span class="p">,(</span><span class="n">is_cfg</span><span class="p">,</span><span class="n">is_xsrc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cfgsrclist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cfgsrclist</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
                <span class="k">for</span> <span class="n">icf</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">is_cfg</span><span class="p">):</span>
                    <span class="n">xsrc_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_xsrc</span><span class="p">)</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cfgsrclist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">xsrc_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="o">=</span> <span class="n">cfg_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="o">=</span> <span class="n">cfgsrclist</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;00&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># print</span>
            <span class="c1"># print &#39;DEBUG importing cfgs&#39;</span>
            <span class="c1"># print self.C2_cfgs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsrcAvg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsrcAvg</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span></div>
        <span class="c1">## filecfglist [ istream , icfg , isrc ]</span>

<div class="viewcode-block" id="TwoPointCorr.Update_Stream_List"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
                <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;filename&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;LegLab&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span></div>


<div class="viewcode-block" id="TwoPointCorr.Stats"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Stats">[docs]</a>    <span class="k">def</span> <span class="nf">Stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">lAvg</span><span class="p">,</span><span class="n">lStd</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">iC2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">iC2</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">lAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iC2</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iC2</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span></div>


<div class="viewcode-block" id="TwoPointCorr.RemoveVals"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.RemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span></div>


    <span class="c1">#self.C3 = [ igamma , ip , it , iconf ]</span>
<div class="viewcode-block" id="TwoPointCorr.WriteCfgsToFile"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.WriteCfgsToFile">[docs]</a>    <span class="k">def</span> <span class="nf">WriteCfgsToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisdir</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisoutdir</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="c1"># for igamma,gammadata in zip(self.gammalist,self.C3_cfgs[&#39;C3&#39;]):</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisoutdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing 2-ptCorrs &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">cfgdata</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;C2&#39;</span><span class="o">+</span><span class="n">istream</span><span class="o">+</span><span class="s1">&#39;cfg&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">icfg</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisoutdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">cfgstr</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
            <span class="n">dictout</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ip</span><span class="p">,</span><span class="n">qdata</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">,</span><span class="n">cfgdata</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qdata</span><span class="p">):</span>
                    <span class="n">itstr</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">dictout</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="n">itstr</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdata</span>
            <span class="n">WriteXml</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">dictout</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span></div>

    <span class="c1">#self.C3 = [ igamma , ip , it , iconf ]</span>
<div class="viewcode-block" id="TwoPointCorr.WriteBootToFile"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.WriteBootToFile">[docs]</a>    <span class="k">def</span> <span class="nf">WriteBootToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisdir</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisoutdir</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="c1"># for igamma,gammadata in zip(self.gammalist,self.C3_cfgs[&#39;C3&#39;]):</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisoutdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing booted 2-ptCorrs &#39;</span><span class="p">)</span>
        <span class="n">this_nboot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bootvals</span><span class="o">.</span><span class="n">index</span>
        <span class="k">for</span> <span class="n">iboot</span> <span class="ow">in</span> <span class="n">this_nboot</span><span class="p">:</span>
            <span class="n">boot_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ival</span> <span class="p">:</span> <span class="n">ival</span><span class="o">.</span><span class="n">bootvals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iboot</span><span class="p">])</span>
            <span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;C2_iboot&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iboot</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisoutdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">cfgstr</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
            <span class="n">dictout</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">boot_val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">dictout</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span>
            <span class="n">WriteXml</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">dictout</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span></div>


    <span class="c1">## self.C2 = [ ip, it , iconf ]</span>
<div class="viewcode-block" id="TwoPointCorr.Read"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="c1">## making interpolator number more human readable</span>
        <span class="k">if</span> <span class="n">Full</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;_Full.cfgs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prop_src</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># if len(self.filename.split(&#39;_&#39;)) &gt; 5:</span>
        <span class="c1">#     raise IOError(&#39;Do not read after combining correlators, please recreate the correlator&#39;)</span>
        <span class="n">thistfix</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if self.nt == 40 and self.nxyz == 20: thistfix = True</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_stream_cfg</span><span class="p">,</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">thisxsrclist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filedir</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">readfilename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i_stream_cfg</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ixsrc</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">ixsrc</span> <span class="ow">in</span> <span class="n">ixsrc_list</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisxsrclist</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">thisxsrclist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filedir</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">readfilename2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i_stream_cfg</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ixsrc</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">ixsrc</span> <span class="ow">in</span> <span class="n">ixsrc_list</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisxsrclist</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">thisxsrclist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filedir</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">readfilename3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i_stream_cfg</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ixsrc</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">readfilename3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">ixsrc</span> <span class="ow">in</span> <span class="n">ixsrc_list</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">Full</span><span class="p">:</span>
                <span class="n">idata</span> <span class="o">=</span> <span class="n">RC2Full</span><span class="p">(</span><span class="n">thisxsrclist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">,</span><span class="n">InterpNumb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Interp</span><span class="p">,</span><span class="n">MesOrBar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idata</span> <span class="o">=</span> <span class="n">R2CChromaXMLFileList</span><span class="p">(</span><span class="n">thisxsrclist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">,</span><span class="n">InterpNumb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Interp</span><span class="p">,</span><span class="n">MesOrBar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="n">tfix</span><span class="o">=</span><span class="n">thistfix</span><span class="p">)</span>

            <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">prop_src</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">tshiftlist</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Full</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">prop_src</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Interp</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write_Cfgs</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span></div>

        <span class="c1"># self.C2_cfgs.to_csv(&#39;./Debug2pt_cfgs.csv&#39;)</span>
        <span class="c1"># pa.Series(self.Info).to_csv(&#39;./Debug2pt_Info.csv&#39;)</span>

        <span class="c1"># print &#39;DEBUG mean&#39;</span>
        <span class="c1"># for ival in range(self.nt):</span>
        <span class="c1">#     print &#39;t&#39;+str(ival),self.C2_cfgs.loc[:,&#39;C2&#39;].apply(lambda x : x[0][ival]).mean()</span>
        <span class="c1">#     # print self.C2_cfgs.loc[:,&#39;C2&#39;].apply(lambda x : x[0][ival]).to_csv(&#39;./Debug2pt_C2.csv&#39;)</span>
        <span class="c1"># print</span>
        <span class="c1">#</span>
        <span class="c1"># print &#39;DEBUG t1 in stream -2-&#39;</span>
        <span class="c1"># for ikey,ival in self.C2_cfgs.loc[:,&#39;C2&#39;].iteritems():</span>
        <span class="c1">#     print ikey,ival[0][0]</span>
        <span class="c1">#     # self.C2_cfgs.loc[:,&#39;stream_cfgs&#39;].to_csv(&#39;./Debug2pt_cfgs.csv&#39;)</span>
        <span class="c1">#     # print self.C2_cfgs.loc[:,&#39;C2&#39;].apply(lambda x : x[0][ival]).to_csv(&#39;./Debug2pt_C2.csv&#39;)</span>
        <span class="c1"># print</span>

<div class="viewcode-block" id="TwoPointCorr.Bootstrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Bootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">Bootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="n">lC2</span><span class="p">,</span><span class="n">lC2Avg</span><span class="p">,</span><span class="n">lC2Std</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lCA2</span><span class="p">,</span><span class="n">lCA2Avg</span><span class="p">,</span><span class="n">lCA2Std</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># print &#39;DEBUG&#39;,self.name</span>
        <span class="k">for</span> <span class="n">icp</span><span class="p">,</span><span class="n">ip</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">):</span>
                <span class="n">strit</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">))</span>
                <span class="n">this_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">]</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_lambda</span><span class="p">)</span>

                <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;G_</span><span class="si">{2}</span><span class="s1">(&#39;</span><span class="o">+</span><span class="n">ip</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">strit</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span><span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">)</span>
                <span class="n">rlist</span> <span class="o">=</span> <span class="n">thisboot</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
                <span class="c1"># print ip,it,&#39;bootval=&#39;,thisboot.Avg,&#39;bootstd&#39;,thisboot.Std,&#39;diff=&#39;, np.abs(thisboot.Avg-np.mean(tdata))/np.mean(tdata)</span>
                <span class="n">lC2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                <span class="n">lC2Avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lC2Std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">eye_fun</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">def</span> <span class="nf">one_fun</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="p">(</span><span class="n">eye_fun</span><span class="p">,</span><span class="n">one_fun</span><span class="p">),</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tdata</span><span class="p">)</span>
                <span class="n">lCA2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lCA2Avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lCA2Std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2Avg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2Std</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lCA2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lCA2Avg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lCA2Std</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span></div>


    <span class="c1"># def ReadAndBoot(self):</span>
    <span class="c1">#     self.Read()</span>
    <span class="c1">#     self.Bootstrap()</span>

<div class="viewcode-block" id="TwoPointCorr.ImportFitRanges"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.ImportFitRanges">[docs]</a>    <span class="k">def</span> <span class="nf">ImportFitRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fit_range</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SetsOfFits implementation only takes 1 fit range to vary over, choosing first&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


    <span class="c1">## Fitting the correlator</span>
    <span class="c1">## fit_range is either list of fit ranges to fit the correlator to, or a single fit range</span>
    <span class="c1">## formatted as fitr#-# where # are the min and max fit values.</span>
    <span class="c1">## states correspond to how many states to fit to (currenlty only working for states = 1 or 2)</span>
    <span class="c1">## NB, iGuess here is not implemented yet, needs to be passed into the function</span>
<div class="viewcode-block" id="TwoPointCorr.Fit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Fit">[docs]</a>    <span class="k">def</span> <span class="nf">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">iGuess</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="n">iGuess</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ImportFitRanges</span><span class="p">(</span><span class="n">fit_range</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;state&#39;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Baryon&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">C2OneStateFitFunNoExp</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">this_fun</span> <span class="o">=</span><span class="p">[</span><span class="n">C2TwoStateFitFunNoExp</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;fitting state for Bayrons is only implemented up to 2 state so far. Cannot do &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
            <span class="n">this_fit_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Funs&#39;</span><span class="p">:</span><span class="n">this_fun</span><span class="p">}</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Meson&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">C2atT</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">C2OSFAntiper</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">C2atT</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;C2atT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">C2atT</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">def</span> <span class="nf">C2DeratT</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">C2OSFAntiperDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">C2DeratT</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;C2DeratT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;fitting state for Mesons is only implemented up to 1 state so far. Cannot do &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
            <span class="n">this_fit_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Funs&#39;</span><span class="p">:</span><span class="n">this_fun</span><span class="p">,</span><span class="s1">&#39;FunDer&#39;</span><span class="p">:</span><span class="n">C2DeratT</span><span class="p">}</span>

        <span class="n">ststr</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">lFit</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">ip</span><span class="p">,</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;momentum&#39;</span><span class="p">):</span>
            <span class="c1"># print &#39;Fitting state&#39;,str(state) , &#39; &#39; , ifit</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ststr</span><span class="p">,</span><span class="n">ip</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="ow">and</span> <span class="n">this_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
                <span class="n">this_sof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">this_key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_sof</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">this_sof</span> <span class="o">=</span> <span class="n">this_sof</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">this_sof</span><span class="o">.</span><span class="n">CheckRange_fitr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">this_fit_info</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">WipeFit</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="n">ststr</span><span class="p">,</span><span class="n">ip</span><span class="p">)],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>
            <span class="c1"># print &#39;     Fitting &#39;, ip</span>
            <span class="n">thisff</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pdata</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_key</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Baryon&#39;</span><span class="p">:</span>
                <span class="n">thisff</span><span class="o">.</span><span class="n">ScanRange_fitr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">this_fit_info</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Meson&#39;</span><span class="p">:</span>
                <span class="n">thisff</span><span class="o">.</span><span class="n">ScanRange_fitr_Sym</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">this_fit_info</span><span class="p">)</span>
            <span class="n">lFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisff</span><span class="p">)</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="c1"># if Debug_Mode:</span>
            <span class="c1">#     print &#39;DEBUG&#39;</span>
            <span class="c1">#     print self.C2_Fit_Col_Names</span>
            <span class="c1">#     print ilist</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Col_Names</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="c1"># def DoFits(val):</span>
            <span class="c1">#     val.DoFits()</span>
            <span class="c1">#     # if state == 1:</span>
            <span class="c1">#     #     val.UnExpParams(paramkeys=(&#39;Energy&#39;,))</span>
            <span class="c1">#     #     val.ImportFunction( C2OneStateFitFunNoExp,2)</span>
            <span class="c1">#     # elif state == 2:</span>
            <span class="c1">#     #     val.UnExpParams(paramkeys=(&#39;Energy&#39;,&#39;DE&#39;))</span>
            <span class="c1">#     #     val.ImportFunction( C2TwoStateFitFunNoExp,4)</span>
            <span class="c1">#     return val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">DoFits</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>



    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="TwoPointCorr.items"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="TwoPointCorr.iteritems"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.iteritems">[docs]</a>    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="TwoPointCorr.itemsAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="TwoPointCorr.values"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="TwoPointCorr.valuesAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="TwoPointCorr.keys"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_stats</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## TODO this is incorrect, fix if required</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span>


<div class="viewcode-block" id="TwoPointCorr.EffMass"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.EffMass">[docs]</a>    <span class="k">def</span> <span class="nf">EffMass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;MessEffMass&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MessEffMass</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">overwrite_effm</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Meson&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">pynverse</span> <span class="k">import</span> <span class="n">inversefunc</span>
                <span class="n">overwrite_effm</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">MessEffMass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MesEffMass</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;pynverse needs to be install to analytically solve the effective mass </span><span class="se">\</span>
<span class="s1">                     function for Mesons, using incorrect effective mass funciton. Run pip install </span><span class="se">\</span>
<span class="s1">                     pynverse to get it&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MesEffMass</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MesEffMass</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s1">&#39;EffM&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="ow">or</span> <span class="n">overwrite_effm</span><span class="p">:</span>
            <span class="n">lEM</span><span class="p">,</span><span class="n">lEMA</span><span class="p">,</span><span class="n">lEMS</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesEffMass</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">nextt</span> <span class="o">=</span> <span class="p">(</span><span class="n">untstr</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">idata_nextt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">,</span><span class="n">tstr</span><span class="p">(</span><span class="n">nextt</span><span class="p">)]</span>
                    <span class="n">Tshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">untstr</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">def</span> <span class="nf">ThisEffMFun</span><span class="p">(</span><span class="n">mass</span><span class="p">):</span>
                            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="o">-</span><span class="n">mass</span><span class="o">*</span><span class="n">Tshift</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="o">-</span><span class="n">mass</span><span class="o">*</span><span class="p">(</span><span class="n">Tshift</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">thisEmass</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="n">bootvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">inversefunc</span><span class="p">(</span><span class="n">ThisEffMFun</span><span class="p">,</span>
                                                               <span class="n">y_values</span><span class="o">=</span><span class="p">(</span><span class="n">idata</span><span class="o">/</span><span class="n">idata_nextt</span><span class="p">)</span><span class="o">.</span><span class="n">bootvals</span><span class="p">)))</span>
                    <span class="n">thisEmass</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                    <span class="n">lEM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="p">)</span>
                    <span class="n">lEMA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="n">lEMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">nextt</span> <span class="o">=</span> <span class="p">(</span><span class="n">untstr</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
                        <span class="n">thisEmass</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">,</span><span class="n">tstr</span><span class="p">(</span><span class="n">nextt</span><span class="p">)])</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                        <span class="n">thisEmass</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                        <span class="n">lEM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="p">)</span>
                        <span class="n">lEMA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                        <span class="n">lEMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEM</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEMA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEMS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

    <span class="c1"># def ReadAndBootAndEffM(self,DefWipe=False):</span>
    <span class="c1">#     if os.path.isfile(self.PickleFile) and not DefWipe:</span>
    <span class="c1">#         self.LoadPickle()</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self.ReadAndBoot()</span>
    <span class="c1">#         self.EffMass()</span>

<div class="viewcode-block" id="TwoPointCorr.Write"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span>

        <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">incfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">):</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ncfg_&#39;</span><span class="o">+</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">incfg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nstream&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxsrc_avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsrcAvg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nMeas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nMeas</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;tsrc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span>
        <span class="c1"># outDict[&#39;xsrc&#39;] = FixDictArray(self.xsrc,&#39;xsrc&#39;)</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ism</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;jsm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">==</span> <span class="s1">&#39;Meson&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesEffMass</span><span class="p">:</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;EffMassFun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Cosh_ratio_inverse&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;EffMassFun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;log_of_ratio&#39;</span>

        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="c1"># print &#39;debug&#39;</span>
            <span class="c1"># print self.C2_Fit_Stats[&#39;boot&#39;]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">istate</span><span class="p">,</span><span class="n">imom</span><span class="p">),</span><span class="n">fitdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Fit&#39;</span> <span class="ow">in</span> <span class="n">fitdict</span><span class="o">.</span><span class="n">Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="n">istate</span><span class="p">][</span><span class="n">imom</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitdict</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>


        <span class="c1"># for ststr,statedict in self.FitDict.iteritems():</span>
        <span class="c1">#     if len(statedict.keys()) == 0: continue</span>
        <span class="c1">#     for ip,pdict in statedict.iteritems():</span>
        <span class="c1">#         for ifit,fitdict in pdict.iteritems():</span>
        <span class="c1">#             for ipar,pardict in fitdict.Params.iteritems():</span>
        <span class="c1">#                 thisfmtflag = &#39;f&#39;</span>
        <span class="c1">#                 if ipar == &#39;A_Ep&#39;: thisfmtflag = &#39;e&#39;</span>
        <span class="c1">#                 outDict[&#39;Fits&#39;][ststr][ip][ifit][ipar] = AvgStdToFormat(pardict.Avg,pardict.Std,frmtflag=thisfmtflag)</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;Chi^2_pdf&#39;] = AvgStdToFormat(fitdict.Chi2DoF.Avg,fitdict.Chi2DoF.Std)</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;MaxIter&#39;] = fitdict.MaxIter</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;Prec&#39;] = fitdict.Prec</span>

        <span class="c1"># print &#39;DEBUG&#39;,self.name</span>
        <span class="c1"># print self.C2_Stats</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;C2boot&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">pdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;C2Auto&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">pdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;EffM&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">pdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="s1">&#39;tsrc_list&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">itsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">ictsrc</span><span class="p">,</span><span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itsrc_list</span><span class="p">):</span>
                        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">][</span><span class="s1">&#39;itsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ictsrc</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">itsrc</span><span class="p">)</span>



        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>

        <span class="c1">## TODO, include fitting in the excell file</span>
        <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,{</span><span class="s1">&#39;C2_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">)},</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="s1">&#39;tsrc_list&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">itsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">ictsrc</span><span class="p">,</span><span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itsrc_list</span><span class="p">):</span>
                        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">][</span><span class="s1">&#39;itsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ictsrc</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">itsrc</span><span class="p">)</span>

        <span class="c1">## pickles rest of data for reading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>
    <span class="c1">##################################</span>

<div class="viewcode-block" id="TwoPointCorr.ReadAndWrite"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.ReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">NoFit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>


<div class="viewcode-block" id="TwoPointCorr.FixRead"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;PickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;ExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;HumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;CfgFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;C2_Fit_Col_Names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Col_Names</span>
        <span class="k">if</span> <span class="s1">&#39;cfg_file_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">return</span> <span class="n">readdict</span></div>

<div class="viewcode-block" id="TwoPointCorr.Write_Cfgs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Write_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Write_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;read_cfgs_from_file&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;to_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;to_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;to_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
        <span class="c1"># this_df,dump = self.Get_Flattened_Cfgs()</span>
        <span class="n">this_meta</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">]</span>
        <span class="n">WriteWithMeta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span><span class="n">this_meta</span><span class="p">,</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="TwoPointCorr.ChopDepVarList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.ChopDepVarList">[docs]</a>    <span class="k">def</span> <span class="nf">ChopDepVarList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_df</span><span class="p">,</span><span class="n">read_meta</span><span class="p">,</span><span class="n">show_err</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">isin</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum_list&#39;</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">!=</span> <span class="n">read_meta</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">show_err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> missmatch in euclidian time, read_nt=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">read_meta</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, setup_nt=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">this_df</span><span class="p">,</span><span class="kc">False</span>
        <span class="n">mom_list</span> <span class="o">=</span> <span class="n">read_meta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">ithis_list</span><span class="p">,</span><span class="n">icheck_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmom</span><span class="p">,</span><span class="n">mom_list</span><span class="p">)]):</span>
            <span class="n">isin</span> <span class="o">=</span> <span class="n">isin</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isin</span><span class="p">:</span>
                <span class="n">same_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">same_list</span><span class="p">:</span>
                    <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">it</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">ithis_list</span><span class="p">]</span>
                    <span class="n">index</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_list</span>
            <span class="k">elif</span> <span class="n">show_err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> missmatch in &#39;</span><span class="p">,</span><span class="n">name_list</span><span class="p">[</span><span class="n">ic</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">isin</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">Chop_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">)[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Chop_fun</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">,</span><span class="n">isin</span></div>




<div class="viewcode-block" id="TwoPointCorr.Read_Cfgs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Read_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Read_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_meta</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cfg_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span> <span class="ow">and</span> <span class="s1">&#39;stream_cfgs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
                <span class="n">second_class</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">cfg_data</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C2_cfgs&#39;</span><span class="p">])</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">second_class</span><span class="p">,[</span><span class="s1">&#39;C2_cfgs&#39;</span><span class="p">])</span>
                <span class="c1"># if show_timer and not this_bool:</span>
                <span class="c1">#     print &#39;\n&#39;+GetCfgMissmatch( np.array(self.C2_cfgs[&#39;stream_cfgs&#39;].values),</span>
                <span class="c1">#                                 np.array(cfg_data[&#39;stream_cfgs&#39;].values))</span>
                <span class="c1">#</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">cfg_bool</span><span class="p">:</span>
                <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ChopDepVarList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_meta</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>

        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;read_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;read_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;read_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;-def-&#39;</span> <span class="ow">in</span> <span class="n">this_file</span><span class="p">:</span>
                <span class="n">this_file</span> <span class="o">=</span> <span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-def-&#39;</span><span class="p">,</span><span class="s1">&#39;-*-&#39;</span><span class="p">)</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cfg FNF: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">this_file</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">this_file</span> <span class="o">=</span> <span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cfg FNF: &#39;</span> <span class="o">+</span> <span class="n">this_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Reading Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="n">meta_data</span><span class="p">,</span><span class="n">cfg_data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="n">cfg_data</span><span class="p">,</span><span class="n">check_bool</span> <span class="o">=</span> <span class="n">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">meta_data</span><span class="p">)</span>
        <span class="c1"># check_bool = check_bool and CheckMeta(meta_data)</span>
        <span class="c1"># cfg_data = self.Format_Flattened_Cfgs(cfg_data)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="n">check_bool</span>
        <span class="k">if</span> <span class="n">check_bool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> file incorrect,&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CfgFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; found backup file&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; reading unformatted&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="TwoPointCorr.LoadPickle"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># print &#39;filename &#39; , self.PickleFile</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="c1"># print &#39;Loading Pickle for &#39; , self.name</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;C2_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckMom</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span>

            <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">pformTOpstr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">nopref</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;C2_Stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Wipe_All_Fits</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file, fits need to be recomputed&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span>
                <span class="c1"># self.Write()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span></div>
    <span class="c1">## Operator overloading</span>

    <span class="c1">#Too Much work, only works for one operator. Please use SetCustomName after doing all algebraic manipulation</span>


<div class="viewcode-block" id="TwoPointCorr.UpdateName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.UpdateName">[docs]</a>    <span class="k">def</span> <span class="nf">UpdateName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">C2</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;pow2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>
        <span class="k">def</span> <span class="nf">GetLegSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;^</span><span class="si">{2}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>

        <span class="k">def</span> <span class="nf">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">opp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\times &#39;</span><span class="p">)</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">oppout</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;pow&#39;</span><span class="p">,</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">oppout</span>

        <span class="n">outname</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">oppLL</span> <span class="o">=</span> <span class="n">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span> <span class="c1">## \times looks better :)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">C22</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">C22</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="s1">&#39; Comb &#39;</span><span class="p">,</span><span class="n">GetLegSelf</span><span class="p">(</span><span class="n">oppLL</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iname</span><span class="p">,</span><span class="n">iname2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iname</span> <span class="ow">in</span> <span class="n">iname2</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iname2</span> <span class="ow">in</span> <span class="n">iname</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="o">+</span><span class="n">opp</span><span class="o">+</span><span class="n">iname2</span><span class="p">)</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iLegLab</span><span class="p">,</span><span class="n">iLegLab2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">op1LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\ &#39;</span><span class="p">),</span><span class="n">op2LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\ &#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iLegLab</span> <span class="ow">in</span> <span class="n">iLegLab2</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iLegLab2</span> <span class="ow">in</span> <span class="n">iLegLab</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab</span><span class="o">+</span><span class="n">oppLL</span><span class="o">+</span><span class="n">iLegLab2</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">C22</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">outname</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                    <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">C22</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span> <span class="p">,</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">C2</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span><span class="p">,</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
        <span class="c1"># print r&#39;$&#39;+r&#39;\ &#39;.join(outLL)+&#39;$&#39;</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iLL</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outLL</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">iLL</span><span class="p">:</span>
                <span class="n">outLL</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">iLL</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;^{&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">),</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TwoPointCorr.Overload_wrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TwoPointCorr.Overload_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">Overload_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">,</span><span class="n">this_fun</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,self,C22)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span> <span class="n">C22</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">),</span> <span class="n">C22</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="n">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">)</span>


    <span class="c1">## Right multiplication functions</span>


    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">))</span>

    <span class="c1">## Numerical operatoions</span>

    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>

<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>


<div class="viewcode-block" id="NNQCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr">[docs]</a><span class="k">class</span> <span class="nc">NNQCorr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; NNQ(p,t,tf) uses bootstrap class</span>
<span class="sd">        p  = momentum</span>
<span class="sd">        t  = time</span>
<span class="sd">        tf = tflow</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NNQCorr.Construct_NNQ_File"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Construct_NNQ_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_NNQ_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">)</span></div>

    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>
    <span class="c1">## All conflicts between TwoPointCorr and FlowOp were resolved by adding flow to variable names, and Flow to function names.</span>
    <span class="c1">## All new functions and variables where I do not want to overwrite TwoPointCorr have the keyword NNQ and nnq respectivly.</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SetOfCorrs.SetOfNNQ&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQFullCorr&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span>
                 <span class="n">Info</span><span class="o">=</span><span class="p">{},</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1">## initialises all the data dictionaries</span>


        <span class="c1">## Setting to g5P+NNQ (or g5P+NNW) by forceing Info to read correct projector and BarOrMes</span>

        <span class="c1"># if &#39;Interp&#39; not in Info.keys() or &#39;g5&#39; not in Info[&#39;Interp&#39;]:</span>
        <span class="c1">#     Info[&#39;Interp&#39;] = &#39;CPOdd&#39;</span>
        <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;MesOrBar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Baryon&#39;</span>
        <span class="c1">## Instance of FlowOp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># ## Instance of TwoPointCorr</span>
        <span class="c1"># Info[&#39;fo_for_cfgs&#39;] = self.FO.Observ</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;nt&#39;</span><span class="p">,</span><span class="s1">&#39;ProjStr&#39;</span><span class="p">,</span><span class="s1">&#39;ism&#39;</span><span class="p">,</span><span class="s1">&#39;jsm&#39;</span><span class="p">,</span><span class="s1">&#39;tsrc&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;NNfile&#39;</span><span class="p">,</span><span class="s1">&#39;FOfile&#39;</span><span class="p">,</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checkmomlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">checkmomlist</span>

        <span class="c1">## pull stuff from the NN and FO instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsSubComb</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">## if it is a combination of correlators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">tflowlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ProjStr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kud</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ks</span>

        <span class="c1">## Grab some stuff (from .NN and .FO)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="n">Info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">jsm</span>

        <span class="c1">## used to pick out different configuraiton/source lists.</span>
        <span class="c1">## for example, if there are less flowed operators than 2 point correlators, passing &#39;TopCharge&#39; will read that result</span>
        <span class="k">if</span> <span class="s1">&#39;fo_for_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;fo_for_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">defSparam</span>


        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;AlphaiGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;AlphaiGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>

        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;NNQiGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQiGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;NNQiGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQiGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>


        <span class="c1">## Info can contain fit ranges for alpha to be calculated</span>
        <span class="k">if</span> <span class="s1">&#39;FitsAlpha&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FitsAlpha&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">## Info can contain default tflow picked, used for plotting</span>
        <span class="k">if</span> <span class="s1">&#39;tflowfit&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTflowFit</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowfit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTflowFit</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span>


        <span class="c1">## Info can contain default t sink picked, used for plotting</span>
        <span class="k">if</span> <span class="s1">&#39;tsinkfit&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTFit</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsinkfit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTFit</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span>

        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;FitFunAlpha&#39;] = (Function Object , number of parameters )</span>
        <span class="k">if</span> <span class="s1">&#39;FitFunAlpha&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">thisFun</span><span class="p">,</span><span class="n">thisnpar</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FitFunAlpha&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFunction</span><span class="p">(</span><span class="n">thisFun</span><span class="p">,</span><span class="n">thisnpar</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFunction</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">## selects the improved overlap, where the noise is subtracted from Q in NNQ</span>
        <span class="k">if</span> <span class="s1">&#39;IExpect&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;IExpect&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1"># self.NNQOp = ODNested()</span>
        <span class="c1">## Series [ momentum , source_sink_sep , flow_time , configurations]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQ_cfgs DataFrame:</span>

<span class="sd">        columns =   xsrc_list , configs , C2, Op, NNQ</span>

<span class="sd">        rows =      istream, iccfg</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQ_Stats DataFrame:</span>

<span class="sd">        columns =   NNQboot,    NNQAvg,         NNQStd</span>
<span class="sd">                    EffM,       EffMAvg,        EffMStd</span>
<span class="sd">                    Alphaboot,  AlphaAvg,       AlphaStd</span>
<span class="sd">                    AlphaAuto,  AlphaAutoAvg,   AlphaAutoStd</span>
<span class="sd">        rows =      momentum,   source_sink_sep,    flow_time</span>
<span class="sd">        &#39;&#39;&#39;</span>




        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQ_Stats DataFrame:</span>

<span class="sd">        columns =   NNQboot,    NNQAvg,         NNQStd</span>
<span class="sd">                    boot</span>

<span class="sd">        rows =      momentum,   flow_time,  fit_range</span>
<span class="sd">        boot elements are SetsOfFitFuns</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># self.LoadPickle(DefWipe=DefWipe)</span>
        <span class="c1"># self.Read()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">man_load_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="NNQCorr.LoadCfgs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.LoadCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">LoadCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

    <span class="c1">## to be consistant with TwoPtCorr;</span>
<div class="viewcode-block" id="NNQCorr.GetCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.GetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CombineCfgLists</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQCorr.ImportPlotParams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.ImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">ImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>


<div class="viewcode-block" id="NNQCorr.CombineCfgLists"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.CombineCfgLists">[docs]</a>    <span class="k">def</span> <span class="nf">CombineCfgLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">CombineCfgs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">))</span></div>
        <span class="c1"># FO_cfgs = self.FO.Op_cfgs[&#39;configs&#39;]</span>
        <span class="c1"># CombineCfgs</span>
        <span class="c1"># comb_cfgs,comb_xsrc = [],[]</span>
        <span class="c1"># ilist = []</span>
        <span class="c1"># for (istream,iccfg),NN_cfg_data in self.NN.C2_cfgs.iterrows():</span>
        <span class="c1">#     if NN_cfg_data[&#39;configs&#39;] in FO_cfgs[istream].values:</span>
        <span class="c1">#         comb_cfgs.append(NN_cfg_data[&#39;configs&#39;])</span>
        <span class="c1">#         comb_xsrc.append(NN_cfg_data[&#39;xsrc_list&#39;])</span>
        <span class="c1">#         ilist.append((istream,iccfg))</span>
        <span class="c1"># indicies = pa.MultiIndex.from_tuples(ilist,names=[&#39;stream&#39;,&#39;config_number&#39;])</span>
        <span class="c1"># cfglist = pa.Series(comb_cfgs,index=indicies).to_frame(name=&#39;configs&#39;)</span>
        <span class="c1"># cfglist.loc[:,&#39;xsrc_list&#39;] = pa.Series(comb_xsrc,index=indicies)</span>

<div class="viewcode-block" id="NNQCorr.Stats"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Stats">[docs]</a>    <span class="k">def</span> <span class="nf">Stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoStats</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span> <span class="n">val</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">def</span> <span class="nf">DoAvg</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">Avg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">def</span> <span class="nf">DoStd</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">Std</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="c1">## maybe effmass and alpha not here???</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoAvg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStd</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoAvg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IsSubComb&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IsSubComb</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsSubComb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AlphaRatio</span><span class="p">(</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="n">DoAuto</span><span class="p">)</span></div>

    <span class="c1">## not needed, taken care of when bootstrapping</span>
    <span class="c1"># def NNQCombPreBS(self):</span>
    <span class="c1">#     self.NNQ = np.array([np.multiply.outer(iC2,Op) for iC2,iOp in zip(self.C2,self.Op)])</span>

    <span class="c1">## DefWipe can be &#39;C2&#39; or &#39;Flow&#39; to only delete that specific data</span>
    <span class="c1">## You can even call self.FlowCombinePreBS(OtherOpp) if you wanted to look at other flowed operators too!</span>
<div class="viewcode-block" id="NNQCorr.Bootstrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Bootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">Bootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># self.C2 = [ ip , it , iconf ]</span>
        <span class="c1"># self.Op = [ itflow , iconf ]</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="n">WipeData</span> <span class="o">=</span> <span class="n">WipeData</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">tflowlist</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="c1">## Do not wipe the data, we need it for combining on the configuration level!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">Bootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># ReadAll = (len(self.tflowlist) == 0)</span>
        <span class="n">NNQlcfg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">NNQl</span><span class="p">,</span><span class="n">NNQlAvg</span><span class="p">,</span><span class="n">NNQlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>

        <span class="n">indexl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Booting &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">icp</span><span class="p">,</span><span class="n">ip</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">):</span>
            <span class="n">NNQlcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">):</span>
                <span class="n">NNQlcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">])</span>
                <span class="n">strit</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">):</span>
                    <span class="n">tflowdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span>
                    <span class="n">strtflows</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span>
                    <span class="c1"># print self.tflowlist , strtflows</span>
                    <span class="c1"># print &#39;test&#39;,ip,strit,strtflows</span>
                    <span class="n">thisdata</span> <span class="o">=</span> <span class="n">tdata</span> <span class="o">*</span> <span class="n">tflowdata</span>
                    <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">))</span>
                    <span class="c1"># for icfg,icfg_data in zip(self.FO.flowcfglist,thisdata):</span>
                    <span class="n">NNQlcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisdata</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;IExpect not implemented after pandas rework. on the TODO list!&#39;</span><span class="p">)</span>
                        <span class="c1"># if isinstance(self.IExpect,float):</span>
                        <span class="c1">#     self.NNQboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=tdata,</span>
                        <span class="c1">#                                                    thiseps=self.IExpect,QforImprov=tflowdata)</span>
                        <span class="c1">#     # thisfile = &#39;./temp/&#39;+&#39;_&#39;([ip,strit,strtflows,epsstr(self.IExpect)])+&#39;.py3p&#39;</span>
                        <span class="c1">#     # if os.path.isfile(thisfile):</span>
                        <span class="c1">#     #     with open(thisfile,&#39;rb&#39;) as f:</span>
                        <span class="c1">#     #         self.NNQboot[ip][strit][strtflows] = pickle.load(f)</span>
                        <span class="c1">#     # else:</span>
                        <span class="c1">#     #     for ieps in np.arange(0.1,self.IExpect,0.1):</span>
                        <span class="c1">#     #         mkdir_p(&#39;./temp&#39;)</span>
                        <span class="c1">#     #         with open(thisfile.replace(epsstr(self.IExpect),epsstr(ieps)),&#39;wb&#39;) as f:</span>
                        <span class="c1">#     #             pickle.dump(BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,data=tdata,</span>
                        <span class="c1">#     #                                                thiseps=ieps,QforImprov=tflowdata),f)</span>
                        <span class="c1"># elif self.IExpect == True:</span>
                        <span class="c1">#     self.NNQboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=tdata,QforImprov=tflowdata)</span>
                        <span class="c1"># elif self.IExpect == False:</span>
                        <span class="c1">#     self.NNQboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=thisdata)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;G_</span><span class="si">{2}</span><span class="s1">(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">thisdata</span><span class="p">)</span>
                        <span class="n">NNQl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                    <span class="n">NNQlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="n">NNQlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                    <span class="c1"># thistimer.Lap()</span>
                    <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">))</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_col_names</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;NNQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">NNQlcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> missmatch in configuration sizes:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;    number of configs in NNQ:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;    number of configs passed into NNQ:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">NNQlcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">+</span> <span class="n">out_str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="n">WipeData</span> <span class="o">=</span> <span class="n">WipeData</span><span class="p">)</span></div>

<div class="viewcode-block" id="NNQCorr.ObsToName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.ObsToName">[docs]</a>    <span class="k">def</span> <span class="nf">ObsToName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisop</span><span class="p">):</span>
        <span class="n">thisobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="n">thisop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">thisobs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\alpha_{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;}&#39;</span><span class="p">)</span></div>

    <span class="c1"># ## thisInfo must contain correct information for combining the correlators (the smearings, the eigenvectors, etc...)</span>
    <span class="c1"># def GetCombCorr(self,thisInfo):</span>
    <span class="c1">#     from SetsOfTwoPtCorrs import SetOfNNQ</span>
    <span class="c1">#     sinklab,jsmcoeffs,sm2ptList,InfoList = GetInfoList(thisInfo)</span>

    <span class="c1">#     C2Set = SetOfNNQ(cfglist=self.NNQ_cfgs[[&#39;configs&#39;,&#39;xsrc_list&#39;]],InfoDict = InfoList)</span>
    <span class="c1">#     C2Set.LoadPickle(CheckCfgs=CheckCfgs)</span>
    <span class="c1">#     thisname,thisleglab,jsmlab = CreateNameAndLL(C2Set.SetC2,sinklab)</span>
    <span class="c1">#     thisfun = GenSinkFun(jsmcoeffs)</span>
    <span class="c1">#     thisfile = self.filename.replace(self.jsm,sinklab)</span>
    <span class="c1">#     thisLL = self.LegLab.replace(self.jsm,sinklab)</span>
    <span class="c1">#     # self.SetCustomName(thisfile,thisLL)</span>
    <span class="c1">#     # self.jsm = jsmlab</span>
    <span class="c1">#     return C2Set.CombineCorrs(thisfun,filename=thisfile,LegLab=thisLL,jsmlab=jsmlab)</span>


<div class="viewcode-block" id="NNQCorr.SetCustomName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.SetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">SetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Observ</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Observ</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="n">Qeps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">string</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Observ</span><span class="p">)])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span> <span class="c1">## customise this how you like</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+=</span> <span class="s1">&#39; Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+=</span> <span class="s1">&#39; Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="n">Qeps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="n">stringLL</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fo_for_cfgs</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/alpha/&#39;</span><span class="o">+</span><span class="n">fo_for_cfgs</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/alpha/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQdir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span></div>


<div class="viewcode-block" id="NNQCorr.ImportCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.ImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span>
        <span class="c1"># self.NNQ_cfgs[&#39;Op&#39;] = pa.Series(self.FO.Op_cfgs.loc[:,&#39;Op&#39;].values,index=self.NNQ_cfgs.index)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQCorr.Update_Stream_List"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ncfg_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsrcAvg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">xsrcAvg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nMeas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;filename&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;LegLab&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span></div>



<div class="viewcode-block" id="NNQCorr.RemoveVals"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.RemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="o">==</span> <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span>
        <span class="k">elif</span> <span class="s1">&#39;Flow&#39;</span> <span class="o">==</span>  <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowRemoveVals</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="s1">&#39;Flow&#39;</span><span class="p">)</span></div>

    <span class="c1">## self.C2 = [ ip, it , iconf ]</span>
<div class="viewcode-block" id="NNQCorr.Read"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

    <span class="c1"># def ReadAndBoot(self):</span>
    <span class="c1">#     self.Read()</span>
    <span class="c1">#     self.Bootstrap()</span>

<div class="viewcode-block" id="NNQCorr.ImportFitRanges"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.ImportFitRanges">[docs]</a>    <span class="k">def</span> <span class="nf">ImportFitRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SetsOfFits implementation only takes 1 fit range to vary over, choosing first&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="NNQCorr.CheckCol"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.CheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">CheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thiscol</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in color to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="NNQCorr.CheckSym"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.CheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">CheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thissym</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in symbol to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>

<div class="viewcode-block" id="NNQCorr.GetShift"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.GetShift">[docs]</a>    <span class="k">def</span> <span class="nf">GetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># if self.thisshiftscale == &#39;Not Set&#39;:</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span></div>
        <span class="c1"># else:</span>
        <span class="c1">#     return self.thisshiftscale</span>

<div class="viewcode-block" id="NNQCorr.SetTflowFit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.SetTflowFit">[docs]</a>    <span class="k">def</span> <span class="nf">SetTflowFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tflow</span><span class="p">):</span>
        <span class="c1"># if tflow not in self.tflowlist and tflow != &#39;Not Set&#39;:</span>
        <span class="c1">#     print &#39;Warning: &#39;, tflow, &#39; not in flow list, tflowfit not added&#39;</span>
        <span class="c1"># else:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="n">tflow</span></div>

<div class="viewcode-block" id="NNQCorr.SetTFit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.SetTFit">[docs]</a>    <span class="k">def</span> <span class="nf">SetTFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tsink</span><span class="p">):</span>
        <span class="c1"># if tsink not in [&#39;t&#39;+str(it) for it in xrange(1,self.nt+1)] and tsink != &#39;Not Set&#39;:</span>
        <span class="c1">#     print &#39;Warning: &#39;, tsink, &#39; not in  list, tsinkfit not added&#39;</span>
        <span class="c1"># else:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span> <span class="o">=</span> <span class="n">tsink</span></div>

<div class="viewcode-block" id="NNQCorr.SetFunction"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.SetFunction">[docs]</a>    <span class="k">def</span> <span class="nf">SetFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Fun</span><span class="p">,</span><span class="n">npar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">=</span> <span class="n">Fun</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npar</span> <span class="o">=</span> <span class="n">npar</span></div>

<div class="viewcode-block" id="NNQCorr.GetFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.NN.GetFuns()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">=</span> <span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;NNCPEven&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQCorr.RemoveFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.NN.RemoveFuns()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;NNCPEven&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQCorr.FitNNQ"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.FitNNQ">[docs]</a>    <span class="k">def</span> <span class="nf">FitNNQ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNfit</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NNQ fit not implemented for setsoffits, skipping&#39;</span><span class="p">)</span></div>
        <span class="c1"># if self.Fun == &#39;None&#39;: raise IOError(&#39;Please define funciton using .SetFunction(Fun,npar) for fitting before calling .FitNNQ()&#39;)</span>
        <span class="c1"># if &#39;PreDef&#39; == fit_range:</span>
        <span class="c1">#     self.fit_range = self.PredefFits</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self.fit_range = fit_range</span>
        <span class="c1"># if iGuess != &#39;PreDef&#39;: self.NNQiGuess = iGuess</span>
        <span class="c1"># if thistflowlist == &#39;PreDef&#39;:</span>
        <span class="c1">#     if self.tflowfit == &#39;Not Set&#39;: raise IOError(&#39;tflowfit not set, please set by using .SetTflowFit()&#39;)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     if thistflowlist == &#39;All&#39;:</span>
        <span class="c1">#         self.tflowfit = self.tflowlist</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         self.tflowfit = thistflowlist</span>
        <span class="c1">#</span>
        <span class="c1"># lFit,lFitA,lFitS = [],[],[]</span>
        <span class="c1"># ilist = []</span>
        <span class="c1"># for ip,pdata in self.NNQ_Stats[&#39;boot&#39;].groupby(level=&#39;momentum&#39;):</span>
        <span class="c1">#     if isinstance(NNfit,(list,tuple,np.ndarray)):</span>
        <span class="c1">#         NNfit = NNfit[0]</span>
        <span class="c1">#     indexlist = self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;].index.levels</span>
        <span class="c1">#     if NNfit == &#39;First&#39;:</span>
        <span class="c1">#         if &#39;state1&#39; in indexlist[0] and ip in indexlist[1] and len(self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;].loc[&#39;state1&#39;,ip,:]) == 0:</span>
        <span class="c1">#             self.NNCPEven.Fit(state=&#39;state1&#39;)</span>
        <span class="c1">#             if &#39;state1&#39; in indexlist[0] and ip in indexlist[1] and len(self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;].loc[&#39;state1&#39;,ip,:]) == 0:</span>
        <span class="c1">#                 raise EnvironmentError(&#39;NN fit dictonary has not fits, please run self.NN.Fit()&#39;)</span>
        <span class="c1">#         thisindex = self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;].loc[&#39;state1&#39;,ip,:].index[0]</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         thisindex = (&#39;state1&#39;,ip,NNfit)</span>
        <span class="c1">#         if thisindex not in self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;]:</span>
        <span class="c1">#             self.NNCPEven.Fit(state=&#39;state1&#39;,fit_range=NNfit)</span>
        <span class="c1">#     NNfit = self.NNCPEven.C2_Fit_Stats[&#39;boot&#39;][thisindex]</span>
        <span class="c1">#     if isinstance(NNfit,pa.Series):</span>
        <span class="c1">#         NNfit = NNfit.iloc[0]</span>
        <span class="c1">#     NNparams = NNfit.fit_data[&#39;Params&#39;]</span>
        <span class="c1">#     NNmass = NNparams[&#39;Energy&#39;]</span>
        <span class="c1">#     NNCoeff = NNparams[&#39;A_Ep&#39;]</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="c1">#     # print &#39;debug&#39;, NNmass.Avg,NNCoeff.Avg</span>
        <span class="c1">#     for itflow in self.tflowfit:</span>
        <span class="c1">#         if (ip,itflow) not in pdata.swaplevel(1,2): continue</span>
        <span class="c1">#         for ifit in self.fit_range:</span>
        <span class="c1">#             if (ip,itflow,ifit) in self.NNQ_Fit_Stats.index:</span>
        <span class="c1">#                 if WipeFit:</span>
        <span class="c1">#                     self.NNQ_Fit_Stats.drop([(ip,itflow,ifit)],inplace=True)</span>
        <span class="c1">#                 else:</span>
        <span class="c1">#                     continue</span>
        <span class="c1">#             ilist.append((ip,itflow,ifit))</span>
        <span class="c1">#             ifitmin,ifitmax = np.array(unxmlfitr(ifit),dtype=np.float64)</span>
        <span class="c1">#             tdatarange,ydata = [[]],[]</span>
        <span class="c1">#             for it,idata in pdata.swaplevel(1,2)[ip,itflow].iteritems():</span>
        <span class="c1">#                 tint = untstr(it)</span>
        <span class="c1">#                 if ifitmin &lt;= tint &lt;= ifitmax:</span>
        <span class="c1">#                     tdatarange[0].append(tint)</span>
        <span class="c1">#                     # print</span>
        <span class="c1">#                     # print &#39;t, flowdata&#39;,tint,tflowdata.Avg</span>
        <span class="c1">#                     # print &#39;NNmass&#39;,NNmass.Avg</span>
        <span class="c1">#                     # print &#39;NNCoeff&#39;,NNCoeff.Avg</span>
        <span class="c1">#                     # print &#39;(inverse) exp value Avg&#39;,np.exp(NNmass.Avg*tint)</span>
        <span class="c1">#                     # print &#39;denominator for ratio Avg&#39;,np.exp(NNmass.Avg*tint)/NNCoeff.Avg</span>
        <span class="c1">#                     # print &#39;(inverse) exp value&#39;,np.mean((NNmass*tint).Exp().bootvals)</span>
        <span class="c1">#                     # print &#39;denominator for ratio&#39;,np.mean(((NNmass*tint).Exp()/NNCoeff).bootvals)</span>
        <span class="c1">#                     thisdata = idata*(NNmass*tint).Exp()/NNCoeff</span>
        <span class="c1">#                     thisdata.Stats()</span>
        <span class="c1">#                     ydata.append(thisdata)</span>
        <span class="c1">#                     # print &#39;result value&#39;,np.mean(ydata[-1].bootvals)</span>
        <span class="c1">#                     # print</span>
        <span class="c1">#</span>
        <span class="c1">#             # ##debugging</span>
        <span class="c1">#             # print</span>
        <span class="c1">#             # print &#39;FitData:&#39;</span>
        <span class="c1">#             # for it,iy in zip(tdatarange[0],ydata):</span>
        <span class="c1">#             #     iy.Stats()</span>
        <span class="c1">#             #     print it, iy.Avg</span>
        <span class="c1">#             # print</span>
        <span class="c1">#</span>
        <span class="c1">#             if EstDir:</span>
        <span class="c1">#                 thisff = ff.Fitting(Funs=[self.Fun,self.npar,&#39;Estimate&#39;],data=[np.array(tdatarange),np.array(ydata)],name=&#39;NNQ&#39;+ifit,iGuess=self.NNQiGuess)</span>
        <span class="c1">#             else:</span>
        <span class="c1">#                 thisff = ff.Fitting(Funs=[self.Fun,self.npar],data=[np.array(tdatarange),np.array(ydata)],name=&#39;NNQ&#39;+ifit,iGuess=self.NNQiGuess)</span>
        <span class="c1">#</span>
        <span class="c1">#             thistest = thisff.FitBoots()</span>
        <span class="c1">#             if not np.isnan(thistest):</span>
        <span class="c1">#                 ilist.append((ip,itflow,ifit))</span>
        <span class="c1">#                 lFit.append(thisff)</span>
        <span class="c1">#                 lFitA.append(thisff.fit_data[&#39;ParamsAvg&#39;])</span>
        <span class="c1">#                 lFitS.append(thisff.fit_data[&#39;ParamsStd&#39;])</span>
        <span class="c1">#                 # print &#39;results after fit&#39;</span>
        <span class="c1">#                 # for iparam,paramval in thisff.Params.iteritems():</span>
        <span class="c1">#                 #     print iparam,paramval.Avg</span>
        <span class="c1">#                 # print</span>
        <span class="c1"># if len(lFit) != 0:</span>
        <span class="c1">#     indicies = pa.MultiIndex.from_tuples(ilist,names=self.NNQ_Fit_col_names)</span>
        <span class="c1">#     if &#39;NNQboot&#39; in self.NNQ_Fit_Stats.columns:</span>
        <span class="c1">#         this_df = pa.DataFrame()</span>
        <span class="c1">#         this_df.loc[:,&#39;NNQboot&#39;] = pa.Series(lFit,index=indicies)</span>
        <span class="c1">#         this_df.loc[:,&#39;NNQAvg&#39;] = pa.Series(lFitA,index=indicies)</span>
        <span class="c1">#         this_df.loc[:,&#39;NNQStd&#39;] = pa.Series(lFitS,index=indicies)</span>
        <span class="c1">#         self.NNQ_Fit_Stats = self.NNQ_Fit_Stats.append(this_df)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         self.NNQ_Fit_Stats.loc[:,&#39;NNQboot&#39;] = pa.Series(lFit,index=indicies)</span>
        <span class="c1">#         self.NNQ_Fit_Stats.loc[:,&#39;NNQAvg&#39;] = pa.Series(lFitA,index=indicies)</span>
        <span class="c1">#         self.NNQ_Fit_Stats.loc[:,&#39;NNQStd&#39;] = pa.Series(lFitS,index=indicies)</span>
        <span class="c1">#     self.Write()</span>


<div class="viewcode-block" id="NNQCorr.FitAlpha"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.FitAlpha">[docs]</a>    <span class="k">def</span> <span class="nf">FitAlpha</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                    <span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Please define funciton using .SetFunction(Fun,npar) for fitting before calling .FitAlpha()&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;PreDef&#39;</span> <span class="o">==</span> <span class="n">fit_range</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit ranges for setsoffits implementation now only takes 1 fit range to scan with.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;selecting first: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fitting Alpha scanned in &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">iGuess</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="n">iGuess</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">==</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;tflowfit not set, please set by using .SetTflowFit()&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="n">thistflowlist</span>
        <span class="n">lFit</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">ip_key</span><span class="p">,</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">ip_key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip_key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;not in flow list, skipping&#39;</span><span class="p">)</span>
                <span class="c1"># print(&#39;DEBUG&#39;,self.tflowlist)</span>
                <span class="k">continue</span>
            <span class="c1">## checks and sets for if data is already present.</span>
            <span class="k">if</span> <span class="n">ip_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="n">this_sof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ip_key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_sof</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">this_sof</span> <span class="o">=</span> <span class="n">this_sof</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">EstDir</span><span class="p">:</span>
                    <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">,</span><span class="s1">&#39;Estimate&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">this_sof</span><span class="o">.</span><span class="n">CheckRange_fitr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Funs&#39;</span><span class="p">:</span><span class="n">this_fun</span><span class="p">}):</span>
                    <span class="k">if</span> <span class="n">WipeFit</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">ip_key</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>

            <span class="c1"># ##debugging</span>
            <span class="c1"># print</span>
            <span class="c1"># print &#39;FitData:&#39;</span>
            <span class="c1"># for it,iy in zip(tdatarange[0],ydata):</span>
            <span class="c1">#     print it, iy</span>
            <span class="c1"># print</span>

            <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">EstDir</span><span class="p">:</span>
                <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">,</span><span class="s1">&#39;Estimate&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">)</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; Fits&#39;</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;paramlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span><span class="p">]</span>
            <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ip_key</span><span class="p">[</span><span class="mi">0</span><span class="p">],:,</span><span class="n">ip_key</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">this_test</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanRange_fitr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ip_key</span><span class="p">)</span>
                <span class="n">lFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_fit</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha fit for &#39;</span><span class="p">,</span> <span class="n">ip_key</span><span class="p">,</span><span class="s1">&#39; failed to setup&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_col_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">DoFit</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">val</span><span class="o">.</span><span class="n">DoFits</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoFit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha found nothing to fit!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="NNQCorr.Get_Extrapolation"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Get_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">Get_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">keep_keys</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries_Wpar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">keep_keys</span><span class="o">=</span><span class="n">keep_keys</span><span class="p">,</span><span class="n">fmted</span><span class="o">=</span><span class="n">fmted</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQCorr.AlphaPlotTauIntWopt"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaPlotTauIntWopt">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotTauIntWopt</span><span class="p">(</span>    <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlimAlpha</span><span class="p">,</span>
                                <span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                                <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                                <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span> <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">xlims</span><span class="p">))</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">iflow</span> <span class="o">=</span> <span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># for ip in momlist:</span>
        <span class="c1">#     for iflow in thistflowlist:</span>
        <span class="c1">## cannot figure out a good solution for this test. It will just throw exception</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Autocorrlation result not present (might be combined result?), skipping tauintWopt plot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">iflow</span><span class="p">,</span><span class="s1">&#39; not found in AlphaAuto keys&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="c1"># tlist,values = idata.keys()[xlims[0]:xlims[1]],idata.values[xlims[0]:xlims[1]]</span>
        <span class="c1"># dataavg,dataerr = zip(*[(ival.,ival.) for ival in values])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(map(untstr,tlist))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>





<div class="viewcode-block" id="NNQCorr.AlphaPlotTflowTauIntWopt"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaPlotTflowTauIntWopt">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotTflowTauIntWopt</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">tflowplot</span> <span class="o">=</span> <span class="n">defxlimOp</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                                    <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                                    <span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thistsinklist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="c1"># def WithinBounds(tlist):</span>
        <span class="c1">#     output,indicies = [],[]</span>
        <span class="c1">#     for ic,ilist in enumerate(tlist):</span>
        <span class="c1">#         if untflowstr(ilist) in tflowplot:</span>
        <span class="c1">#             output.append(ilist)</span>
        <span class="c1">#             indicies.append(ic)</span>
        <span class="c1">#     return output,indicies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">tflowplot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tflowplot</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">thistsinklist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistsinklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">itsink</span> <span class="o">=</span> <span class="n">thistsinklist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># for ip in momlist:</span>
        <span class="c1">#     for itsink in thistsinklist:</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Autocorrlation result not present (might be combined result?), skipping tauintwop plot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">itsink</span> <span class="p">,</span><span class="s1">&#39; not found in AlphaAuto keys&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">tflowdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># tflowlist,indicies = WithinBounds(np.array(tflowlist))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">itflow</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">]</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">([</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="c1"># print</span>
        <span class="c1"># print thisshift</span>
        <span class="c1"># print plotshift</span>
        <span class="c1"># print [tflowlist[0],tflowlist[-1]]</span>
        <span class="c1"># print np.array(tflowlist)+plotshift</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">tflowdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">tflowdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>


    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
    <span class="c1">## thistflowlist is array of tflows to plot over (currently supports length 1 arrays).</span>
    <span class="c1">## ToDo: make color and symbol and shift iterate over this. Currently handeled externally (SetsOfCorrs.py) with repeated calls</span>
<div class="viewcode-block" id="NNQCorr.AlphaPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlot</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlimAlpha</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                    <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                    <span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span> <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">xlims</span><span class="p">))</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Autocorrlation result not present (might be combined result?), skipping alphaplot&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">iflow</span> <span class="o">=</span> <span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span> <span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span>  <span class="o">=</span> <span class="n">thisleglab</span> <span class="o">+</span> <span class="s1">&#39; Auto&#39;</span>

        <span class="c1"># xlims[0] = max(xlims[0],self.boot_tsum_list[0])</span>
        <span class="c1"># xlims[1] = min(xlims[1],self.boot_tsum_list[-1])</span>

        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>



<div class="viewcode-block" id="NNQCorr.AlphaPlotTflow"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaPlotTflow">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotTflow</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">tflowplot</span> <span class="o">=</span> <span class="n">defxlimOp</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thistsinklist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># def WithinBounds(tlist):</span>
        <span class="c1">#     output,indicies = [],[]</span>
        <span class="c1">#     for ic,ilist in enumerate(tlist):</span>
        <span class="c1">#         if untflowstr(ilist) in tflowplot:</span>
        <span class="c1">#             output.append(ilist)</span>
        <span class="c1">#             indicies.append(ic)</span>
        <span class="c1">#     return output,indicies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">tflowplot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tflowplot</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">thistsinklist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistsinklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Autocorrlation result not present (might be combined result?), skipping tflowplot&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">itsink</span> <span class="o">=</span> <span class="n">thistsinklist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span> <span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span> <span class="o">=</span> <span class="n">thisleglab</span> <span class="o">+</span> <span class="s1">&#39; Auto&#39;</span>
        <span class="n">tflowdata</span> <span class="o">=</span> <span class="n">thisdata</span><span class="p">[</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">]</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># tflowlist,indicies = WithinBounds(np.array(tflowlist))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">itflow</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">]</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">([</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="c1"># print</span>
        <span class="c1"># print thisshift</span>
        <span class="c1"># print plotshift</span>
        <span class="c1"># print [tflowlist[0],tflowlist[-1]]</span>
        <span class="c1"># print np.array(tflowlist)+plotshift</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>



    <span class="c1">#state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="NNQCorr.AlphaFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaFitPlot</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># autocorrelation has not fits (currenlty)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">fitr</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitr</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="n">imom</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">iflow</span> <span class="o">=</span> <span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">imom</span><span class="p">:</span> <span class="n">imom</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">iflow</span> <span class="p">,</span><span class="s1">&#39; not found in FitDict, fitting now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fitr</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>

        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">,</span> <span class="s1">&#39; not found in FitDict, performing fit now&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fitr</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fit &#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">#state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="NNQCorr.AlphaNNQFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaNNQFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaNNQFitPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NNQFitPlot not implemented with setoffitfuns, skipping&#39;</span><span class="p">)</span></div>
        <span class="c1"># if Auto: return plot_class</span>
        <span class="c1"># if fitr == &#39;None&#39;: return plot_class</span>
        <span class="c1"># self.CheckCol(thiscol)</span>
        <span class="c1"># thisshift = self.GetShift(plot_class.get_xlim(),thisshift)</span>
        <span class="c1"># if len(momlist) == 0: momlist = self.NNQ_Stats.index.get_level_values(&#39;momentum&#39;)</span>
        <span class="c1"># if thistflowlist == &#39;PreDef&#39;: thistflowlist = self.tflowfit</span>
        <span class="c1"># imom = momlist[0]</span>
        <span class="c1"># iflow = thistflowlist[0]</span>
        <span class="c1"># if &#39;All&#39; in imom: imom = &#39;p000&#39;</span>
        <span class="c1"># if &#39;NNQboot&#39; not in self.NNQ_Fit_Stats or (imom,iflow,fitr) not in self.NNQ_Fit_Stats[&#39;NNQboot&#39;]:</span>
        <span class="c1">#     print imom,iflow,fitr, &#39; not found in NNQFitDict, fitting now&#39;</span>
        <span class="c1">#     self.FitNNQ([fitr],thistflowlist = [iflow])</span>
        <span class="c1"># # print &#39;debug&#39;,self.NNQFitDict[imom][iflow][fitr]</span>
        <span class="c1"># # print self.HumanFile</span>
        <span class="c1"># # print &#39;results&#39;</span>
        <span class="c1"># # for iparam,paramval in self.NNQFitDict[imom][iflow][fitr].Params.iteritems():</span>
        <span class="c1"># #     print imom,iflow,fitr,iparam,paramval.Avg</span>
        <span class="c1"># # print</span>
        <span class="c1"># hold_series = pa.Series()</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;y_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;yerr_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;xerr_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;type&#39;] = &#39;fit_vary&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (imom,iflow,fitr)</span>
        <span class="c1"># hold_series[&#39;fit_class&#39;] = self.NNQ_Fit_Stats[&#39;NNQboot&#39;]</span>
        <span class="c1"># hold_series[&#39;label&#39;] = &#39;NNQ Fit&#39;</span>
        <span class="c1"># hold_series[&#39;symbol&#39;] = self.thissym</span>
        <span class="c1"># hold_series[&#39;color&#39;] = self.thiscol</span>
        <span class="c1"># hold_series[&#39;shift&#39;] = thisshift</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = xlims</span>
        <span class="c1"># # hold_series[&#39;ShowPar&#39;] = r&#39;\alpha&#39;</span>
        <span class="c1"># hold_series[&#39;fmt_class&#39;] = KeyForamtting(self.NN.latparams)</span>
        <span class="c1"># plot_class.AppendData(hold_series)</span>
        <span class="c1"># return plot_class</span>

    <span class="c1">#state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="NNQCorr.AlphaPlotVsEnergy"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaPlotVsEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotVsEnergy</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                            <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">PhysEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># autocorrelation has not fits (currenlty)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">fitr</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>

        <span class="n">iflow</span> <span class="o">=</span> <span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Fmt_pmom_index</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">fit_param</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">fit_param</span><span class="p">)</span>
        <span class="n">test_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">fit_param</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="ow">or</span> <span class="n">test_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">test_key</span><span class="p">,</span> <span class="s1">&#39; is not in FitDictionary, fitting now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fitr</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>

        <span class="c1"># this_x = self.NN.latparams.EnergyFromRecRel(momlist,self.NN.latparams.GetNucleonMass(Phys=False))</span>
        <span class="c1"># if PhysEnergy: this_x = this_x*self.NN.latparams.hbarcdivlat</span>
        <span class="c1"># plotx.append(this_x)</span>

        <span class="c1">## into GeV</span>
        <span class="c1"># plotshift = self.GetShift([plotx[0],plotx[-1]],thisshift)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>



    <span class="c1"># ## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
    <span class="c1"># ## thistflowlist is array of tflows to plot over (currently supports length 1 arrays).</span>
    <span class="c1"># ## ToDo: make color and symbol and shift iterate over this. Currently handeled externally (SetsOfCorrs.py) with repeated calls</span>
    <span class="c1"># def AlphaPlotAuto(self,xlims=defxlimAlpha,momlist=[&#39;p000&#39;],thiscol=&#39;PreDefine&#39;,thissym=&#39;PreDefine&#39;,thisshift=&#39;PreDefine&#39;,thistflowlist = &#39;PreDef&#39;):</span>
    <span class="c1">#     self.CheckCol(thiscol)</span>
    <span class="c1">#     self.CheckSym(thissym)</span>
    <span class="c1">#     self.thisshiftscale = &#39;Not Set&#39;</span>
    <span class="c1">#     if thistflowlist == &#39;PreDef&#39;: thistflowlist = self.tflowfit</span>
    <span class="c1">#     if len(momlist) == 0: momlist = self.AlphaAuto.keys()</span>
    <span class="c1">#     if isinstance(xlims[0],basestring): xlims = map(untstr,xlims)</span>
    <span class="c1">#     thisshift = self.GetShift(xlims,thisshift)</span>
    <span class="c1">#     for ip in momlist:</span>
    <span class="c1">#         if ip not in self.AlphaAuto.keys():</span>
    <span class="c1">#             print ip, &#39; not found in AlphaAuto keys&#39;</span>
    <span class="c1">#             continue</span>
    <span class="c1">#         for iflow in thistflowlist:</span>
    <span class="c1">#             thisleglab = self.LegLab +&#39;$\ &#39;+ tflowTOLeg(iflow) + &#39;$&#39;</span>
    <span class="c1">#             if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
    <span class="c1">#             pdata = self.AlphaAuto[ip]</span>
    <span class="c1">#             tlist,dataAuto = zip(*pdata.items())</span>
    <span class="c1">#             if any([iflow not in iAuto.keys() for iAuto in dataAuto]):</span>
    <span class="c1">#                 print iflow, &#39; not found in AlphaAuto&#39;</span>
    <span class="c1">#                 continue</span>
    <span class="c1">#             dataAuto = [idata[iflow] for idata in dataAuto[xlims[0]:xlims[1]]]</span>
    <span class="c1">#             dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in dataAuto])</span>
    <span class="c1">#             tlist = tlist[xlims[0]:xlims[1]]</span>
    <span class="c1">#             pl.errorbar(np.array(map(untstr,tlist))+thisshift,dataavg,dataerr,label=thisleglab,fmt=self.thissym,color=self.thiscol)</span>
    <span class="c1">#     # plot_class.get_xlim(*xlims)</span>



    <span class="c1"># def AlphaPlotTflowAuto(self,tflowplot = defxlimOp,momlist=[&#39;p000&#39;],thiscol=&#39;PreDefine&#39;,thissym=&#39;PreDefine&#39;,thisshift=&#39;PreDefine&#39;,thistsinklist = &#39;PreDef&#39;):</span>
    <span class="c1">#     def WithinBounds(tlist):</span>
    <span class="c1">#         output,indicies = [],[]</span>
    <span class="c1">#         for ic,ilist in enumerate(tlist):</span>
    <span class="c1">#             if untflowstr(ilist) in tflowplot:</span>
    <span class="c1">#                 output.append(ilist)</span>
    <span class="c1">#                 indicies.append(ic)</span>
    <span class="c1">#         return output,indicies</span>
    <span class="c1">#     self.CheckCol(thiscol)</span>
    <span class="c1">#     self.CheckSym(thissym)</span>
    <span class="c1">#     tflowplot = map(untflowstr,tflowplot)</span>
    <span class="c1">#     if thistsinklist == &#39;PreDef&#39;: thistsinklist = self.tsinkfit</span>
    <span class="c1">#     if len(momlist) == 0: momlist = self.AlphaAuto.keys()</span>
    <span class="c1">#     for ip in momlist:</span>
    <span class="c1">#         if ip not in self.AlphaAuto.keys():</span>
    <span class="c1">#             print ip, &#39; not found in AlphaAuto keys&#39;</span>
    <span class="c1">#             continue</span>
    <span class="c1">#         for itsink in thistsinklist:</span>
    <span class="c1">#             if itsink not in self.AlphaAuto[ip].keys():</span>
    <span class="c1">#                 print itsink, &#39; not found in AlphaAuto&#39;</span>
    <span class="c1">#                 continue</span>
    <span class="c1">#             thisleglab = self.LegLab +&#39;$\ &#39;+ tsinkTOLeg(itsink) + &#39;$&#39;</span>
    <span class="c1">#             if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
    <span class="c1">#             tflowdata = self.AlphaAuto[ip][itsink]</span>
    <span class="c1">#             tflowlist,dataAuto = zip(*tflowdata.items())</span>
    <span class="c1">#             tflowlist,indicies = WithinBounds(np.array(tflowlist))</span>
    <span class="c1">#             tflowlist = TflowToPhys(np.array(tflowlist),self.NN.latparams.latspace)</span>
    <span class="c1">#             plotshift = self.GetShift([tflowlist[0],tflowlist[-1]],thisshift)</span>
    <span class="c1">#             # print</span>
    <span class="c1">#             # print thisshift</span>
    <span class="c1">#             # print plotshift</span>
    <span class="c1">#             # print [tflowlist[0],tflowlist[-1]]</span>
    <span class="c1">#             # print np.array(tflowlist)+plotshift</span>
    <span class="c1">#             dataAuto = np.array(dataAuto)[indicies]</span>
    <span class="c1">#             dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in dataAuto])</span>
    <span class="c1">#             pl.errorbar(np.array(tflowlist)+plotshift,dataavg,dataerr,label=thisleglab,fmt=self.thissym,color=self.thiscol)</span>
    <span class="c1">#     # plot_class.get_xlim(*xlims)</span>



    <span class="c1"># TODO: implement FitEffMass function with same layout as TwoPtCorr</span>

    <span class="c1"># ## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
    <span class="c1"># def EffMassPlot(self,xlims = defxlim,momlist=[&#39;p000&#39;],thiscol=&#39;PreDefine&#39;,thissym=&#39;PreDefine&#39;,thisshift=&#39;PreDefine&#39;):</span>
    <span class="c1">#     self.CheckCol(thiscol)</span>
    <span class="c1">#     self.CheckSym(thissym)</span>
    <span class="c1">#     thisshift = self.GetShift(xlims,thisshift)</span>
    <span class="c1">#     if len(momlist) == 0:</span>
    <span class="c1">#         momlist = self.EffMAvg.keys()</span>
    <span class="c1">#     for ip in momlist:</span>
    <span class="c1">#         if ip not in self.EffMAvg.keys():</span>
    <span class="c1">#             print ip, &#39; not found in effective mass list&#39;</span>
    <span class="c1">#             continue</span>
    <span class="c1">#         pdata = self.EffMAvg[ip]</span>
    <span class="c1">#         tlist,dataavg = zip(*pdata.items())</span>
    <span class="c1">#         tlist,dataerr = zip(*self.EffMStd[ip].items())</span>
    <span class="c1">#         tlist = tlist[xlims[0]:xlims[1]]</span>
    <span class="c1">#         dataavg = dataavg[xlims[0]:xlims[1]]</span>
    <span class="c1">#         dataerr = dataerr[xlims[0]:xlims[1]]</span>
    <span class="c1">#         pl.errorbar(np.array(map(untstr,tlist))+thisshift,dataavg,dataerr,label=self.LegLab,fmt=self.thissym,color=self.thiscol)</span>
    <span class="c1">#     plot_class.get_xlim(*xlims)</span>


    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1"># ## fitr is fit range e.g. fitr5-10</span>
    <span class="c1"># ## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1"># def EffMassFitPlot(self,state,fitr,xlims = &#39;Data&#39;,momlist=[&#39;p000&#39;],thiscol=&#39;PreDefine&#39;,thisshift=&#39;PreDefine&#39;):</span>
    <span class="c1">#     self.CheckCol(thiscol)</span>
    <span class="c1">#     thisshift = self.GetShift(plot_class.get_xlim(),thisshift)</span>
    <span class="c1">#     if len(momlist) == 0:</span>
    <span class="c1">#         momlist = self.EffMAvg.keys()</span>
    <span class="c1">#     if isinstance(state,int): state = &#39;state&#39;+str(state)</span>
    <span class="c1">#     if fitr not in self.FitDict[state].keys():</span>
    <span class="c1">#         print fitr , &#39; has not been done, performing fit now&#39;</span>
    <span class="c1">#         self.Fit(int(state.replace(&#39;state&#39;,&#39;&#39;)),[fitr])</span>
    <span class="c1">#     fitr_params = self.FitDict[state][fitr]</span>
    <span class="c1">#     for imom in momlist:</span>
    <span class="c1">#         if imom not in fitr_params.keys():</span>
    <span class="c1">#             print imom, &#39; not found in FitDict&#39;</span>
    <span class="c1">#             continue</span>
    <span class="c1">#         fitr_params[imom].PlotEffMass(xdatarange=xlims,color=self.thiscol,shift=thisshift)</span>



    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="NNQCorr.items"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>


<div class="viewcode-block" id="NNQCorr.itemsAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="NNQCorr.values"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="NNQCorr.valuesAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="NNQCorr.keys"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span>



<div class="viewcode-block" id="NNQCorr.EffMass"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.EffMass">[docs]</a>    <span class="k">def</span> <span class="nf">EffMass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">lEff</span><span class="p">,</span><span class="n">lEffA</span><span class="p">,</span><span class="n">lEffS</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)):</span>
            <span class="n">next_tdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">idata</span><span class="p">),</span><span class="n">idata_shift</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="n">next_tdata</span><span class="p">):</span>
                <span class="n">thisEff</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span><span class="o">/</span><span class="n">idata_shift</span><span class="p">)</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                <span class="n">thisEff</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
                <span class="n">lEff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="p">)</span>
                <span class="n">lEffA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lEffS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEff</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEffA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEffS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>

<div class="viewcode-block" id="NNQCorr.RatFunAndDer"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.RatFunAndDer">[docs]</a>    <span class="k">def</span> <span class="nf">RatFunAndDer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">chit</span><span class="p">,</span><span class="n">chitder</span><span class="p">)</span></div>

<div class="viewcode-block" id="NNQCorr.AlphaRatio"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.AlphaRatio">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsSubComb</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">cpevenInfo</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">)</span>
        <span class="n">cpevenInfo</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CPEven&#39;</span>


        <span class="c1"># print &#39;Debug iscomb , &#39; , self.IsComb</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="c1">## TODO, autocorrelation needs to be done for combining correlators...</span>
            <span class="c1">## NOT FEASABLE, too much memory me thinks...</span>
            <span class="kn">from</span> <span class="nn">SetsOfTwoPtCorrs</span> <span class="k">import</span> <span class="n">SetOfTwoPt</span>
            <span class="n">sinklab</span><span class="p">,</span><span class="n">jsmcoeffs</span><span class="p">,</span><span class="n">sm2ptList</span><span class="p">,</span><span class="n">InfoList</span> <span class="o">=</span> <span class="n">GetInfoList</span><span class="p">(</span><span class="n">cpevenInfo</span><span class="p">)</span>
            <span class="n">C2Set</span> <span class="o">=</span> <span class="n">SetOfTwoPt</span><span class="p">(</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span><span class="n">InfoDict</span> <span class="o">=</span> <span class="n">InfoList</span><span class="p">)</span>
            <span class="n">C2Set</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># for iset in C2Set.SetC2.values():</span>
            <span class="c1">#     if len(iset.C2) == 0 and DoAuto:</span>
            <span class="c1">#         iset.LoadPickle(DefWipe=True,CheckCfgs=True,CheckMom=True,WipeData=not DoAuto)</span>
            <span class="n">thisname</span><span class="p">,</span><span class="n">thisleglab</span><span class="p">,</span><span class="n">jsmlab</span> <span class="o">=</span> <span class="n">CreateNameAndLL</span><span class="p">(</span><span class="n">C2Set</span><span class="o">.</span><span class="n">SetC2</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="n">thisfun</span> <span class="o">=</span> <span class="n">GenSinkFun</span><span class="p">(</span><span class="n">jsmcoeffs</span><span class="p">)</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="n">thisLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,</span><span class="n">thisLL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="n">jsmlab</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span> <span class="o">=</span> <span class="n">C2Set</span><span class="o">.</span><span class="n">CombineCorrs</span><span class="p">(</span><span class="n">thisfun</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">thisfile</span><span class="p">,</span><span class="n">LegLab</span><span class="o">=</span><span class="n">thisLL</span><span class="p">,</span><span class="n">jsmlab</span><span class="o">=</span><span class="n">jsmlab</span><span class="p">)</span>
            <span class="n">thisname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ForAlpha&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">thisname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span><span class="n">cpevenInfo</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="c1"># self.NNCPEven = self.NNCPEven.GetCombCorr(cpevenInfo)</span>
            <span class="n">thisname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ForAlpha&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">thisname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="ow">not</span> <span class="n">DoAuto</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">DoAuto</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="ow">not</span> <span class="n">DoAuto</span><span class="p">)</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="k">if</span> <span class="n">DoAuto</span> <span class="ow">and</span> <span class="s1">&#39;NNQ&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="n">thisfuns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RatFunAndDer</span><span class="p">()</span>
            <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),</span><span class="n">ict</span><span class="p">,(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">ict</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># cant do these checks XO.... dictionaries are better!</span>
                <span class="c1"># if ip not in self.NNCPEven.C2.keys(): continue</span>
                <span class="c1"># if it not in self.NNCPEven.C2[ip].keys(): continue</span>
                <span class="c1"># if (&#39;C2&#39; not in self.NNCPEven.C2_cfgs</span>
                <span class="c1">#     or icp*self.nt+ict &gt;= self.NNCPEven.C2_cfgs[&#39;C2&#39;].size): continue</span>
                <span class="n">auto_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQ&#39;</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">auto_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="c1"># print &#39;debug&#39;,idata[5],twoptdata[5]</span>
                <span class="c1"># if len(idata) != len(twoptdata):</span>
                <span class="c1">#     errorstr = &#39;&#39;&#39;</span>
                <span class="c1">#     NNQ and NN have different configuration lists, \n</span>
                <span class="c1">#     maybe force delete the pickled files for NN, \n</span>
                <span class="c1">#     or select a different -stats from- directory corresponding to operator Q or W</span>
                <span class="c1">#     &#39;&#39;&#39;</span>
                <span class="c1">#     raise EnvironmentError(errorstr)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>

                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="n">thisfuns</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">auto_df</span><span class="p">)</span>
                <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ&#39;</span><span class="p">]</span>

        <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span> <span class="k">continue</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="n">idata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">idata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">]</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print &#39;iscomb&#39;,self.IsComb</span>
            <span class="c1"># print &#39;nncpeven&#39;,self.NNCPEven</span>
            <span class="c1"># print &#39;nncpodd&#39;,self.NN</span>
            <span class="c1"># print &#39;flow&#39;,self.FO</span>
            <span class="c1"># print (ip,it,itflow, idata.Avg,idata.Std,</span>
            <span class="c1">#                     self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Avg,self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Std,</span>
            <span class="c1">#                     thisboot.Avg, thisboot.Std)</span>
            <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>


    <span class="c1"># def ReadAndBootAndEffM(self,DefWipe=False):</span>
    <span class="c1">#     if os.path.isfile(self.PickleFile) and not DefWipe:</span>
    <span class="c1">#         self.LoadPickle()</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self.ReadAndBoot()</span>
    <span class="c1">#         self.EffMass()</span>


<div class="viewcode-block" id="NNQCorr.Write"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="c1"># self.FO.FlowWrite()</span>
        <span class="c1"># if not self.IsComb:</span>
        <span class="c1">#     self.NN.Write()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Not outputted&#39;</span>
        <span class="c1">#     self.NN.HumanFile = self.NN.HumanFile.replace(self.NN.jsm,self.jsm)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;FlowOp_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_CPEven_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span>
        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kud</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ks</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nt</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nxyz</span>

        <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">incfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">):</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ncfg_&#39;</span><span class="o">+</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">incfg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nstream&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nstream</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxsrc_avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">xsrcAvg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nMeas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nMeas</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nboot</span>

        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Default (see FitFunctions.py)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">thispar</span> <span class="o">=</span> <span class="s1">&#39;Par&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iparam</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">fitdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitdict</span><span class="p">,</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span> <span class="k">continue</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitdict</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>


        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;NNQFits&#39;</span><span class="p">][</span><span class="s1">&#39;Function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQiGuess</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;NNQFits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Default (see FitFunctions.py)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">thispar</span> <span class="o">=</span> <span class="s1">&#39;Par&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iparam</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;NNQFits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQiGuess</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
        <span class="c1"># if &#39;NNQboot&#39; in self.NNQ_Fit_Stats:</span>
        <span class="c1">#     for (ip,itflow,ifit),fitdict in self.NNQ_Fit_Stats[&#39;NNQboot&#39;].iteritems():</span>
        <span class="c1">#         if not isinstance(fitdict,ff.Fitting): continue</span>
        <span class="c1">#         outDict[&#39;Fits&#39;][ip][itflow][ifit] = fitdict.GetOutputDict()</span>


        <span class="k">for</span> <span class="n">col_key</span><span class="p">,</span><span class="n">col_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;Avg&#39;</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="ow">or</span> <span class="s1">&#39;Std&#39;</span> <span class="ow">in</span> <span class="n">col_key</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">col_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">col_key</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span>

        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>
        <span class="c1">## pickles rest of data for reading</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>
        <span class="c1">## TODO, include fitting in the excell file</span>
        <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,{</span><span class="s1">&#39;NNQ_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">)},</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>
        <span class="c1">##################################</span>

<div class="viewcode-block" id="NNQCorr.ReadAndWrite"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.ReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">NoFit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="c1"># self.FitNNQ()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>


<div class="viewcode-block" id="NNQCorr.FixRead"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Info</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flowPickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FO</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">PickleFile</span>

        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;PickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;HumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNQ_Fit_col_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_col_names</span>

        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;IsSubComb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsSubComb</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNfile&#39;</span><span class="p">]):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNfile</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOfile&#39;</span><span class="p">]):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOfile</span>
        <span class="c1"># if not os.path.isfile(readdict[&#39;ppparams&#39;].PickleFile):</span>
        <span class="c1">#     readdict[&#39;ppparams&#39;].PickleFile = self.ppparams.PickleFile</span>
        <span class="c1">#     readdict[&#39;ppparams&#39;].HumanFile = self.ppparams.HumanFile</span>
        <span class="c1">#     readdict[&#39;qparams&#39;].PickleFile = self.qparams.PickleFile</span>
        <span class="c1">#     readdict[&#39;qparams&#39;].HumanFile = self.qparams.HumanFile</span>
        <span class="c1">#     readdict[&#39;Info&#39;][&#39;outdir&#39;] = self.Info[&#39;outdir&#39;]</span>
        <span class="k">return</span> <span class="n">readdict</span></div>




    <span class="c1">## TODO: Pickle load and dump self.NN and self.FO from their respective directories.</span>
    <span class="c1">##       At this point, I am just dumping this whole class instead. (doubles up data)</span>
<div class="viewcode-block" id="NNQCorr.LoadPickle"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># print &#39;Loading Pickle&#39;,self.PickleFile</span>
        <span class="n">read_pickle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">legacy</span><span class="p">:</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;NNQ_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckMom</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span>
            <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">pformTOpstr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">nopref</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQ_Stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loading pickle:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Wipe_All_Fits</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file, fits need to be recomputed&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting to read legacy file&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span>
                <span class="c1"># self.ReadAndWrite(WipeData=WipeData)</span>
            <span class="c1"># self.Write()</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;NNQ_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckMom</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span>
            <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">pformTOpstr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">nopref</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQ_Stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file found, reading and writing to proper file&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, legacy file &#39;</span> <span class="p">,</span> <span class="n">read_pickle</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pickle file not found:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;or legacy file&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span></div>
    <span class="c1">## Operator overloading</span>


    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span>

<div class="viewcode-block" id="NNQCorr.sin"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.sin">[docs]</a>    <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                         <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="NNQCorr.cos"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.cos">[docs]</a>    <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                         <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="NNQCorr.Overload_wrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQCorr.Overload_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">Overload_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">this_fun</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,self,NNQ2)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">NNQ2</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span> <span class="ow">and</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">],</span><span class="n">NNQ2</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">iNNQ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">result</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQ</span><span class="p">,</span> <span class="n">NNQ2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">iNNQ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQ</span><span class="p">,</span> <span class="n">NNQ2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">iNNQ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">result</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQ</span><span class="p">,</span> <span class="n">NNQ2</span><span class="p">[</span><span class="n">itflow</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">iNNQ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQ</span><span class="p">,</span> <span class="n">NNQ2</span><span class="p">[</span><span class="n">itflow</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span> <span class="n">NNQ2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">),</span> <span class="n">NNQ2</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with NNQCorr class&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">],</span> <span class="n">NNQ2</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">),</span> <span class="n">NNQ2</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with NNQCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">)</span>


    <span class="c1">## Right multiplication functions</span>


    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQ2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQ2</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQ2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">))</span></div>



<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>
<span class="c1">####################################################################################################################</span>


<div class="viewcode-block" id="NNQFullCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr">[docs]</a><span class="k">class</span> <span class="nc">NNQFullCorr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; NNQFull(p,t,tf) uses bootstrap class</span>
<span class="sd">        p  = momentum</span>
<span class="sd">        t  = time</span>
<span class="sd">        tf = tflow</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NNQFullCorr.Construct_NNQFull_File"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Construct_NNQFull_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_NNQFull_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">)</span></div>

    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>
    <span class="c1">## All conflicts between TwoPointCorr and FlowOp were resolved by adding flow to variable names, and Flow to function names.</span>
    <span class="c1">## All new functions and variables where I do not want to overwrite TwoPointCorr have the keyword NNQFull and NNQFull respectivly.</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SetOfCorrs.SetOfNNQFull&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span>
                 <span class="n">Info</span><span class="o">=</span><span class="p">{},</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1">## initialises all the data dictionaries</span>


        <span class="c1">## Setting to g5P+NNQ (or g5P+NNW) by forceing Info to read correct projector and BarOrMes</span>
        <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Do_Chi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># if &#39;g5&#39; not in Info[&#39;Interp&#39;]: Info[&#39;Interp&#39;] = &#39;CPOdd&#39;</span>
        <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;MesOrBar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Baryon&#39;</span>
        <span class="c1"># c2_info = deepcopy(Info)</span>
        <span class="c1"># c2_info[&#39;pmom&#39;] = &#39;All&#39;</span>
        <span class="c1">## Instance of FlowOp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span> <span class="o">=</span> <span class="n">FlowOpFullSquared</span><span class="p">(</span><span class="n">thisnboot</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># ## Instance of TwoPointCorr</span>
        <span class="c1"># Info[&#39;fo_for_cfgs&#39;] = self.FOFull.Observ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>
        <span class="c1"># self.thischecklist = [  &#39;nboot&#39;,&#39;nt&#39;,&#39;ProjStr&#39;,&#39;ism&#39;,&#39;jsm&#39;,&#39;tsrc&#39;,&#39;kud&#39;,&#39;ks&#39;,</span>
        <span class="c1">#                         &#39;NNfile&#39;,&#39;FOFullfile&#39;,&#39;tflowlist&#39;,&#39;boot_tsum_list&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span>  <span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;boot_nt_list&#39;</span><span class="p">,</span><span class="s1">&#39;ProjStr&#39;</span><span class="p">,</span><span class="s1">&#39;ism&#39;</span><span class="p">,</span><span class="s1">&#39;jsm&#39;</span><span class="p">,</span><span class="s1">&#39;tsrc&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;tflowlist&#39;</span><span class="p">,</span><span class="s1">&#39;boot_tsum_list&#39;</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">]</span>



        <span class="c1">## pull stuff from the NN and FO instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">## if it is a combination of correlators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFullfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ProjStr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsrc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kud</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ks</span>

        <span class="c1">## Grab some stuff (from .NN and .FOfull)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="n">Info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">jsm</span>

        <span class="c1">## used to pick out different configuraiton/source lists.</span>
        <span class="c1">## for example, if there are less flowed operators than 2 point correlators, passing &#39;TopCharge&#39; will read that result</span>
        <span class="k">if</span> <span class="s1">&#39;fo_for_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;fo_for_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">defSparam</span>


        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;AlphaiGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;AlphaiGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>

        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;NNQFulliGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulliGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;NNQFulliGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulliGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>


        <span class="c1">## Info can contain fit ranges for alpha to be calculated</span>
        <span class="k">if</span> <span class="s1">&#39;FitsAlphaFull&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FitsAlphaFull&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">## Info can contain default tflow picked, used for plotting</span>
        <span class="k">if</span> <span class="s1">&#39;tflowfit&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTflowFit</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowfit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTflowFit</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span>


        <span class="c1">## Info can contain default t sink picked, used for plotting</span>
        <span class="k">if</span> <span class="s1">&#39;tsinkfit&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTFit</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsinkfit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetTFit</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span>


        <span class="c1">## Info can contain default t sink picked, used for plotting</span>
        <span class="k">if</span> <span class="s1">&#39;min_fit_len_tsum&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;min_fit_len_tsum&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span> <span class="o">=</span> <span class="s1">&#39;Default&#39;</span>

        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;FitFunAlpha&#39;] = (Function Object , number of parameters )</span>
        <span class="c1"># if &#39;FitFunAlpha&#39; in Info.keys():</span>
        <span class="c1">#     thisFun,thisnpar = Info[&#39;FitFunAlpha&#39;]</span>
        <span class="c1">#     self.SetFunction(thisFun,thisnpar)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self.SetFunction(&#39;None&#39;,0)</span>

        <span class="c1">## momentum ( in form of [px py pz] )</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkmomlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">checkmomlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span>

        <span class="c1">## selects the improved overlap, where the noise is subtracted from Q in NNQFull</span>
        <span class="k">if</span> <span class="s1">&#39;IExpect&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;IExpect&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s1">&#39;tsum_fit_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">tsumstr</span><span class="p">,</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsum_fit_list&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">tsumstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))))</span>



        <span class="k">if</span> <span class="s1">&#39;boot_nt_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;boot_nt_list&#39;</span><span class="p">]))</span>
            <span class="n">hold_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">its</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">its</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">:</span>
                    <span class="n">hold_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">its</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span> <span class="o">=</span> <span class="n">hold_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>





        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        I&#39;m thinking types could be:</span>
<span class="sd">        from_src_sink_sum       is summing from source and sink, outwards</span>
<span class="sd">        from_src_sum            is summing from source</span>
<span class="sd">        from_sink_sum           is summing from sink</span>
<span class="sd">        from_center_sum         is summing from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sym_sum                is summing symmetrically from source</span>
<span class="sd">        from_sink_sym_sum               is summing symmetrically from sink</span>
<span class="sd">        from_center_sym_sum             is summing symmetrically from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sink           is values from source and sink, outwards</span>
<span class="sd">        from_src                is values from source</span>
<span class="sd">        from_sink               is values from sink</span>
<span class="sd">        from_center             is values from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sym                is values symmetrically from source</span>
<span class="sd">        from_sink_sym               is values symmetrically from sink</span>
<span class="sd">        from_center_sym             is values symmetrically from central point (tsink+tsrc)/2</span>

<span class="sd">        mult   multiplys result by t (when doing non summed)</span>
<span class="sd">        etc...</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;op_trange_sum_type&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;op_trange_sum_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="o">=</span> <span class="s1">&#39;from_src_sink&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="s1">&#39;sr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;sink&#39;</span><span class="p">,</span><span class="s1">&#39;si&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;su&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="s1">&#39;ce&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;sym&#39;</span><span class="p">,</span><span class="s1">&#39;sy&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;mult&#39;</span><span class="p">,</span><span class="s1">&#39;mt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;boot_tsum_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;boot_tsum_list&#39;</span><span class="p">]))</span>
            <span class="n">hold_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">its</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="ow">and</span> <span class="s1">&#39;_sum&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">its</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">hold_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">its</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">its</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">:</span>
                        <span class="n">hold_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">its</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span> <span class="o">=</span> <span class="n">hold_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="o">=</span> <span class="s1">&#39;_Qsub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="o">=</span> <span class="s1">&#39;_Q2sub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span> <span class="o">=</span> <span class="s1">&#39;_NNQ2sub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span> <span class="o">=</span> <span class="s1">&#39;_NNQsub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span> <span class="o">=</span> <span class="s1">&#39;_P5NNQsub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span> <span class="o">=</span> <span class="s1">&#39;_NNSingQ2sub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span>



        <span class="k">if</span> <span class="s1">&#39;boot_spec_tsum_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;boot_spec_tsum_list&#39;</span><span class="p">]))</span>
            <span class="n">hold_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">its</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="ow">and</span> <span class="s1">&#39;_sum&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, not sure how spectator Q is dealt with in sym and sum&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">its</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">hold_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">its</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">its</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">:</span>
                        <span class="n">hold_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">its</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span> <span class="o">=</span> <span class="n">hold_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
            <span class="n">this_info</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">Info</span><span class="p">)</span>
            <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CPEven&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN2</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">this_info</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_None&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_None&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>



        <span class="c1"># self.NNQFullOp = ODNested()</span>
        <span class="c1">## Series [ momentum , source_sink_sep , flow_time , configurations]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQFull_cfgs DataFrame:</span>

<span class="sd">        columns =   xsrc_list , configs</span>

<span class="sd">        rows =      istream, iccfg</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_col_names</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;flow_op_trange&#39;</span><span class="p">,</span><span class="s1">&#39;flow_op_2_trange&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            self.NNQ_subNNQ2_Stats DataFrame:</span>

<span class="sd">            columns =   Alphaboot,  AlphaAvg,       AlphaStd</span>
<span class="sd">                        AlphaAuto,  AlphaAutoAvg,   AlphaAutoStd</span>

<span class="sd">            rows =      momentum,   source_sink_sep,    flow_time,  flow_op_trange, flow_op_2_trange</span>
<span class="sd">            &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_col_names</span> <span class="o">=</span> <span class="p">[</span>  <span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;flow_op_trange&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQFull_Stats DataFrame:</span>

<span class="sd">        columns =   NNQFullboot,    NNQFullAvg,         NNQFullStd</span>
<span class="sd">                    Alphaboot,      AlphaAvg,           AlphaStd</span>
<span class="sd">                    AlphaAuto,      AlphaAutoAvg,       AlphaAutoStd</span>

<span class="sd">        rows =      momentum,   source_sink_sep,    flow_time,  flow_op_trange</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQInt_Stats DataFrame:</span>

<span class="sd">        columns =   NNQIntboot,     NNQIntAvg,          NNQIntStd</span>
<span class="sd">                    AlphaIntboot,   AlphaIntAvg,        AlphaIntStd</span>
<span class="sd">                    AlphaAuto,      AlphaAutoAvg,       AlphaAutoStd</span>

<span class="sd">        rows =      momentum,   source_sink_sep,    flow_time</span>
<span class="sd">        &#39;&#39;&#39;</span>




        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.NNQFull_Fit_Stats DataFrame:</span>

<span class="sd">        columns =   NNQFullboot,    NNQFullAvg,         NNQFullStd</span>
<span class="sd">                    boot</span>

<span class="sd">        rows =      momentum,   flow_time, fit_range</span>
<span class="sd">        boot elements are SetsOfFitFuns instances</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># # FitDict = [ ip, itflow , Fit_range ] fitting class</span>
        <span class="c1"># self.FitDict    = ODNested()</span>
        <span class="c1"># # FitDictAvg/Std [ ip ,  itflow , Fit_range , Fit_Parameter ] bs</span>
        <span class="c1"># self.FitDictAvg = ODNested()</span>
        <span class="c1"># self.FitDictStd = ODNested()</span>
        <span class="c1">#</span>
        <span class="c1"># # FitDict = [ ip, itflow , Fit_range ] fitting class</span>
        <span class="c1"># self.NNQFullFitDict    = ODNested()</span>
        <span class="c1"># # FitDictAvg/Std [ ip ,  itflow , Fit_range , Fit_Parameter ] bs</span>
        <span class="c1"># self.NNQFullFitDictAvg = ODNested()</span>
        <span class="c1"># self.NNQFullFitDictStd = ODNested()</span>

        <span class="c1">##</span>
        <span class="c1"># self.Tau_Fit_Stats = pa.DataFrame()</span>
        <span class="c1"># &#39;&#39;&#39;</span>
        <span class="c1"># self.Tau_Fit_Stats DataFrame:</span>
        <span class="c1">#</span>
        <span class="c1"># columns =   boot, Avg,      Std</span>
        <span class="c1">#</span>
        <span class="c1"># rows =      fit ranges , momentum , source sink sep , flow time</span>
        <span class="c1">#</span>
        <span class="c1"># &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetFunction</span><span class="p">(</span><span class="n">ConstantFitFun</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># self.SetFunction(Alpha_Prop_Fit_plin,4)</span>
        <span class="c1"># self.SetFunction(Alpha_Prop_Fit,3)</span>
        <span class="c1"># self.SetFunction(Alpha_Prop_Fit_2exp,5)</span>


        <span class="c1"># self.LoadPickle(DefWipe=DefWipe)</span>
        <span class="c1"># self.Read()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">man_load_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="NNQFullCorr.LoadCfgs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.LoadCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">LoadCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

    <span class="c1">## to be consistant with TwoPtCorr;</span>
<div class="viewcode-block" id="NNQFullCorr.GetCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.GetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CombineCfgLists</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.ImportPlotParams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.ImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">ImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>

<div class="viewcode-block" id="NNQFullCorr.GetFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.NN.GetFuns()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">=</span> <span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;NNCPEven&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.RemoveFuns"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.NN.RemoveFuns()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;NNCPEven&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.Get_Extrapolation"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Get_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">Get_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">keep_keys</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries_Wpar</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span>
                                                <span class="n">keep_keys</span><span class="o">=</span><span class="n">keep_keys</span><span class="p">,</span><span class="n">fmted</span><span class="o">=</span><span class="n">fmted</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Series_fix_key</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.CombineCfgLists"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.CombineCfgLists">[docs]</a>    <span class="k">def</span> <span class="nf">CombineCfgLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">CombineCfgs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">))</span></div>

        <span class="c1"># FO_cfgs = self.FOFull.Op_cfgs[&#39;configs&#39;]</span>
        <span class="c1"># comb_cfgs,comb_xsrc = [],[]</span>
        <span class="c1"># ilist = []</span>
        <span class="c1"># for (istream,iccfg),NN_cfg_data in self.NN.C2_cfgs.iterrows():</span>
        <span class="c1">#     if NN_cfg_data[&#39;configs&#39;] in FO_cfgs[istream].values:</span>
        <span class="c1">#         comb_cfgs.append(NN_cfg_data[&#39;configs&#39;])</span>
        <span class="c1">#         comb_xsrc.append(NN_cfg_data[&#39;xsrc_list&#39;])</span>
        <span class="c1">#         ilist.append((istream,iccfg))</span>
        <span class="c1"># indicies = pa.MultiIndex.from_tuples(ilist,names=[&#39;stream&#39;,&#39;config_number&#39;])</span>
        <span class="c1"># cfglist = pa.Series(comb_cfgs,index=indicies).to_frame(name=&#39;configs&#39;)</span>
        <span class="c1"># cfglist.loc[:,&#39;xsrc_list&#39;] = pa.Series(comb_xsrc,index=indicies)</span>
        <span class="c1"># self.ImportCfgList(cfglist)</span>

<div class="viewcode-block" id="NNQFullCorr.Stats"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Stats">[docs]</a>    <span class="k">def</span> <span class="nf">Stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoStats</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span> <span class="n">val</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">def</span> <span class="nf">DoAvg</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">Avg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">def</span> <span class="nf">DoStd</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">Std</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">val</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="c1">## maybe effmass and alpha not here???</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoAvg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStd</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoAvg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoAvg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStd</span><span class="p">)</span>
        <span class="c1"># self.EffMass()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AlphaRatio</span><span class="p">(</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="n">DoAuto</span><span class="p">)</span></div>

    <span class="c1">## not needed, taken care of when bootstrapping</span>
    <span class="c1"># def NNQFullCombPreBS(self):</span>
    <span class="c1">#     self.NNQFull = np.array([np.multiply.outer(iC2,Op) for iC2,iOp in zip(self.C2,self.Op)])</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    I&#39;m thinking types could be:</span>
<span class="sd">        from_src_sink_sum       is summing from source and sink, outwards</span>
<span class="sd">        from_src_sum            is summing from source</span>
<span class="sd">        from_sink_sum           is summing from sink</span>
<span class="sd">        from_center_sum         is summing from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sym_sum                is summing symmetrically from source</span>
<span class="sd">        from_sink_sym_sum               is summing symmetrically from sink</span>
<span class="sd">        from_center_sym_sum             is summing symmetrically from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sink           is values from source and sink, outwards</span>
<span class="sd">        from_src                is values from source</span>
<span class="sd">        from_sink               is values from sink</span>
<span class="sd">        from_center             is values from central point (tsink+tsrc)/2</span>

<span class="sd">        from_src_sym                is values symmetrically from source</span>
<span class="sd">        from_sink_sym               is values symmetrically from sink</span>
<span class="sd">        from_center_sym             is values symmetrically from central point (tsink+tsrc)/2</span>

<span class="sd">        etc...</span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="NNQFullCorr.Create_Tsrc_Fun"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Create_Tsrc_Fun">[docs]</a>    <span class="k">def</span> <span class="nf">Create_Tsrc_Fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ictflow</span><span class="p">,</span><span class="n">it_sink</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it_sink</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">it_sink</span> <span class="o">=</span> <span class="n">untstr</span><span class="p">(</span><span class="n">it_sink</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;tsink&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
        <span class="c1"># if it_sink &gt; self.nt/2:</span>
        <span class="c1">#     t_mid = (self.nt-it_sink)/2</span>
        <span class="c1"># else:</span>
        <span class="c1">#     t_mid = it_sink/2</span>
        <span class="c1"># if &#39;from_src_sink&#39; in self.tr_sum_type:</span>
        <span class="c1">#     def Tsrc_Fun(this_series):</span>
        <span class="c1">#         ## tsrc_list = [ ixsrc ]</span>
        <span class="c1">#         out_list = []</span>
        <span class="c1">#         for itsrc in this_series[&#39;tsrc_list&#39;]:</span>
        <span class="c1">#             ## op_series = [ tflow, t_src ]</span>
        <span class="c1">#             flow_op = this_series[&#39;Op&#39;][ictflow]</span>
        <span class="c1">#             tflow_src = np.roll(flow_op,-itsrc)</span>
        <span class="c1">#             tflow_sink = np.roll(tflow_src,-it_sink)</span>
        <span class="c1">#             tflow_src_left = tflow_src[::-1]</span>
        <span class="c1">#             tflow_sink_left = tflow_sink[::-1]</span>
        <span class="c1">#             tflow_src_left[0] = np.float64(0.0)</span>
        <span class="c1">#             tflow_sink_left[0] = np.float64(0.0)</span>
        <span class="c1">#             if it_sink &gt; self.nt/2:</span>
        <span class="c1">#                 # tflow_src_left[:t_mid] = tflow_sink[:t_mid]= np.float64(0.0)</span>
        <span class="c1">#                 this_out = (np.lib.pad(tflow_src_left[:t_mid],(0,self.nt-t_mid),&#39;constant&#39;,constant_values=(0,0.))</span>
        <span class="c1">#                             + tflow_src + tflow_sink_left +</span>
        <span class="c1">#                             np.lib.pad(tflow_sink[:t_mid],(0,self.nt-t_mid),&#39;constant&#39;,constant_values=(0,0.)))</span>
        <span class="c1">#             else:</span>
        <span class="c1">#                 # tflow_src[:t_mid] = tflow_sink_left[:t_mid] = np.float64(0.0)</span>
        <span class="c1">#                 this_out = (np.lib.pad(tflow_src[:t_mid],(0,self.nt-t_mid),&#39;constant&#39;,constant_values=(0,0.))</span>
        <span class="c1">#                             + tflow_src_left + tflow_sink +</span>
        <span class="c1">#                             np.lib.pad(tflow_sink_left[:t_mid],(0,self.nt-t_mid),&#39;constant&#39;,constant_values=(0,0.)))</span>
        <span class="c1">#             if &#39;_sum&#39; in self.tr_sum_type:</span>
        <span class="c1">#                 denom_list = [2.] + [2.+ival*4 for ival in range(1,t_mid+1)]</span>
        <span class="c1">#                 last_denom = denom_list[-1]</span>
        <span class="c1">#                 denom_list = denom_list + [ival*2 + last_denom for ival in range(1,self.nt-t_mid)]</span>
        <span class="c1">#                 this_out = np.cumsum(this_out)</span>
        <span class="c1">#                 out_list.append(this_out*(self.nt/np.array(denom_list,dtype=np.float64)))</span>
        <span class="c1">#             else:</span>
        <span class="c1">#                 out_list.append(this_out*self.nt)</span>
        <span class="c1">#         return pa.Series([out_list],index=[&#39;iFO&#39;])</span>
        <span class="c1"># else:</span>
        <span class="k">def</span> <span class="nf">Tsrc_Fun</span><span class="p">(</span><span class="n">this_series</span><span class="p">):</span>
            <span class="c1">## tsrc_list = [ ixsrc ]</span>
            <span class="n">out_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="n">this_series</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="s1">&#39;from_center&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">n_roll</span> <span class="o">=</span> <span class="p">(</span><span class="n">itsrc</span><span class="o">+</span><span class="n">it_sink</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
                <span class="k">elif</span> <span class="s1">&#39;src&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">n_roll</span> <span class="o">=</span> <span class="n">itsrc</span>
                <span class="k">elif</span> <span class="s1">&#39;from_sink&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">n_roll</span> <span class="o">=</span> <span class="p">(</span><span class="n">itsrc</span><span class="o">+</span><span class="n">it_sink</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="o">+</span> <span class="s1">&#39; sum time not supported.&#39;</span><span class="p">)</span>
                <span class="c1">## op_series = [ tflow, t_src ]</span>
                <span class="n">flow_op</span> <span class="o">=</span> <span class="n">this_series</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">ictflow</span><span class="p">]</span>
                <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">flow_op</span><span class="p">,</span><span class="o">-</span><span class="n">n_roll</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;_src_sink&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">tflow_rolled_tsink</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">,</span><span class="o">-</span><span class="n">it_sink</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="n">tflow_rolled</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">tflow_rolled_tsink</span> <span class="o">=</span> <span class="n">tflow_rolled_tsink</span><span class="o">+</span><span class="n">tflow_rolled_tsink</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="s1">&#39;_rev&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="n">tflow_rolled</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">tflow_rolled_tsink</span> <span class="o">=</span> <span class="n">tflow_rolled_tsink</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="p">(</span><span class="n">tflow_rolled</span> <span class="o">+</span> <span class="n">tflow_rolled_tsink</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
                <span class="k">elif</span> <span class="s1">&#39;_rev&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">tflow_rolled</span> <span class="o">=</span> <span class="n">tflow_rolled</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;_sum&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span> <span class="ow">and</span> <span class="s1">&#39;_src_sink&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">tflow_rolled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflow_rolled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
                            <span class="n">tflow_rolled</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tflow_rolled</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="mf">2.</span>
                    <span class="n">out_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">))</span>
                <span class="k">elif</span> <span class="s1">&#39;_mult&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">out_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflow_rolled</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">out_list</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Tsrc_Fun</span></div>

<div class="viewcode-block" id="NNQFullCorr.Create_NNQ_fun"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Create_NNQ_fun">[docs]</a>    <span class="k">def</span> <span class="nf">Create_NNQ_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">it_sum</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;_FO2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;_mult&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;_sum&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                    <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">it_sum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">scale_coeff</span> <span class="o">-=</span> <span class="mf">1.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale_coeff</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">def</span> <span class="nf">NNQ_fun</span><span class="p">(</span><span class="n">this_df</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iC2&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])[:,</span><span class="n">it_sum</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">scale_coeff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">NNQ_fun</span><span class="p">(</span><span class="n">this_df</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iC2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])[:,</span><span class="n">it_sum</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">NNQ_fun</span></div>

<div class="viewcode-block" id="NNQFullCorr.Create_NNQ_CPEven_fun"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Create_NNQ_CPEven_fun">[docs]</a>    <span class="k">def</span> <span class="nf">Create_NNQ_CPEven_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">it_sum</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">NNQ_fun</span><span class="p">(</span><span class="n">this_df</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iC2_CPEven&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])[:,</span><span class="n">it_sum</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">NNQ_fun</span></div>


<div class="viewcode-block" id="NNQFullCorr.Create_NNQ2_fun"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Create_NNQ2_fun">[docs]</a>    <span class="k">def</span> <span class="nf">Create_NNQ2_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;_mult&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
            <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;_sum&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;_sym&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">jt_sum</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">jt_sum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">scale_coeff</span> <span class="o">-=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">jt_sum</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale_coeff</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">def</span> <span class="nf">NNQ2_fun</span><span class="p">(</span><span class="n">this_df</span><span class="p">):</span>
            <span class="k">return</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iC2&#39;</span><span class="p">]</span><span class="o">*</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])[:,</span><span class="n">it_sum</span><span class="p">]</span><span class="o">*</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">])[:,</span><span class="n">jt_sum</span><span class="p">])</span><span class="o">/</span><span class="n">scale_coeff</span>
        <span class="k">return</span> <span class="n">NNQ2_fun</span></div>
    <span class="c1">## DefWipe can be &#39;C2&#39; or &#39;Flow&#39; to only delete that specific data</span>
    <span class="c1">## You can even call self.FlowCombinePreBS(OtherOpp) if you wanted to look at other flowed operators too!</span>
<div class="viewcode-block" id="NNQFullCorr.Bootstrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Bootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">Bootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># self.C2 = [ ip , it , iconf ]</span>
        <span class="c1"># self.Op = [ itflow , iconf ]</span>
        <span class="k">if</span> <span class="n">tflowlist</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="c1">## Do not wipe the data, we need it for combining on the configuration level!</span>
        <span class="c1"># self.NN.Bootstrap(WipeData=False)</span>
        <span class="c1"># self.FOFull.FlowBootstrap(tflowlist=tflowlist,WipeData=False,show_timer=False)</span>
        <span class="c1"># ReadAll = (len(self.tflowlist) == 0)</span>

        <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
            <span class="n">NNQFulllcfg</span><span class="p">,</span><span class="n">NNQIntlcfg</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
            <span class="n">Qcfg</span><span class="p">,</span><span class="n">QIntcfg</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
            <span class="n">P5NNcfg</span><span class="p">,</span><span class="n">P5NNIntcfg</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">NNQFulll</span><span class="p">,</span><span class="n">NNQFulllAvg</span><span class="p">,</span><span class="n">NNQFulllStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">NNQIntl</span><span class="p">,</span><span class="n">NNQIntlAvg</span><span class="p">,</span><span class="n">NNQIntlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">indexintl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">indexl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span>   <span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">],</span>
                                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Booting &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">icp</span><span class="p">,</span><span class="n">ip</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">):</span>
            <span class="n">ic2pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                <span class="n">NNQFulllcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">NNQIntlcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
                <span class="n">Qcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">QIntcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                <span class="n">P5NNcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">P5NNIntcfg</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                    <span class="n">NNQFulllcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">NNQIntlcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
                    <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                    <span class="n">P5NNcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">P5NNIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">strit</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">C2_ip_it_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ic2pt</span><span class="p">][</span><span class="n">it</span><span class="p">])</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">C2_ip_it_fun</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;iC2&#39;</span><span class="p">)</span>
                <span class="n">tdata_xsrc_avg</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iC2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
                    <span class="n">tdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;iC2_CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">C2_ip_it_fun</span><span class="p">)</span>
                    <span class="n">tdata_xsrc_avg2</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iC2_CPEven&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

                <span class="c1"># tdata = self.NN.C2_cfgs[&#39;C2&#39;].apply(lambda x : np.array(x[icp][it])).to_frame(&#39;iC2&#39;)</span>
                <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
                    <span class="n">strtflows</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span>
                    <span class="n">op_int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">]))</span>
                    <span class="n">int_data</span> <span class="o">=</span> <span class="n">tdata_xsrc_avg</span> <span class="o">*</span> <span class="n">op_int</span>
                    <span class="k">if</span> <span class="s1">&#39;_FO2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">int_data</span> <span class="o">=</span> <span class="n">int_data</span> <span class="o">*</span> <span class="n">op_int</span>
                    <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                        <span class="n">NNQFulllcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="n">NNQIntlcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">int_data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
                        <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                            <span class="n">P5NNcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                            <span class="n">P5NNIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tdata_xsrc_avg</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                            <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_int</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span><span class="p">:</span>
                            <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_int</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span><span class="p">:</span>
                            <span class="n">Q2list</span> <span class="o">=</span> <span class="n">op_int</span><span class="o">.</span><span class="n">values</span><span class="o">**</span><span class="mi">2</span>
                            <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q2list</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Q2list</span><span class="p">))</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
                            <span class="n">NNQlist</span> <span class="o">=</span> <span class="p">(</span><span class="n">tdata_xsrc_avg2</span> <span class="o">*</span> <span class="n">op_int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
                            <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NNQlist</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span><span class="p">:</span>
                            <span class="n">NNQ2list</span> <span class="o">=</span> <span class="p">(</span><span class="n">tdata_xsrc_avg</span> <span class="o">*</span> <span class="n">op_int</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
                            <span class="n">QIntcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NNQ2list</span><span class="p">)</span>


                    <span class="n">Intboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;G_</span><span class="si">{2}</span><span class="s1">(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">int_data</span><span class="p">)</span>
                    <span class="n">indexintl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">))</span>
                    <span class="n">NNQIntl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Intboot</span><span class="p">)</span>
                    <span class="n">NNQIntlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Intboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="n">NNQIntlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Intboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                    <span class="c1"># print self.tflowlist , strtflows</span>
                    <span class="c1"># print &#39;test&#39;,ip,strit,strtflows</span>

                    <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;tsrc_list&#39;</span><span class="p">,</span><span class="s1">&#39;Op&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Create_Tsrc_Fun</span><span class="p">(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;iFO&#39;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">it_sum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">:</span>
                        <span class="n">tsum_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">)</span>
                        <span class="n">thisdata</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Create_NNQ_fun</span><span class="p">(</span><span class="n">it_sum</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                            <span class="n">NNQFulllcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisdata</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                            <span class="n">P5NN_vals</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iC2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">values</span>
                            <span class="n">Q_vals</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[:,</span><span class="n">it_sum</span><span class="p">]))</span><span class="o">.</span><span class="n">values</span>
                            <span class="c1"># Qcfg[-1][-1][-1].append(Q_vals/np.float(self.nt))</span>
                            <span class="n">P5NNcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P5NN_vals</span><span class="p">)</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q_vals</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span><span class="p">:</span>
                            <span class="n">Q_vals</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[:,</span><span class="n">it_sum</span><span class="p">]))</span><span class="o">.</span><span class="n">values</span>
                            <span class="c1"># Qcfg[-1][-1][-1].append(Q_vals/np.float(self.nt))</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Q_vals</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span><span class="p">:</span>
                            <span class="k">def</span> <span class="nf">ThisFun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[:,</span><span class="n">it_sum</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                            <span class="n">Q2_vals</span> <span class="o">=</span> <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;iFO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ThisFun</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Q2_vals</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Q2_vals</span><span class="p">))</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
                            <span class="n">this_NNQ</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Create_NNQ_CPEven_fun</span><span class="p">(</span><span class="n">it_sum</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_NNQ</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span> <span class="p">)</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span><span class="p">:</span>
                            <span class="n">this_NNQ2</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Create_NNQ2_fun</span><span class="p">(</span><span class="n">it_sum</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_NNQ2</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                            <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                            <span class="k">for</span> <span class="n">jt_sum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">:</span>
                                <span class="n">this_NNQ2</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Create_NNQ2_fun</span><span class="p">(</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="n">Qcfg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_NNQ2</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span>
                        <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">))</span>
                        <span class="c1"># for icfg,icfg_data in zip(self.FOFull.flowcfglist,thisdata):</span>

                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;IExpect not implemented after pandas rework. on the TODO list!&#39;</span><span class="p">)</span>
                            <span class="c1"># if isinstance(self.IExpect,float):</span>
                            <span class="c1">#     self.NNQFullboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=tdata,</span>
                            <span class="c1">#                                                    thiseps=self.IExpect,QforImprov=tflowdata)</span>
                            <span class="c1">#     # thisfile = &#39;./temp/&#39;+&#39;_&#39;([ip,strit,strtflows,epsstr(self.IExpect)])+&#39;.py3p&#39;</span>
                            <span class="c1">#     # if os.path.isfile(thisfile):</span>
                            <span class="c1">#     #     with open(thisfile,&#39;rb&#39;) as f:</span>
                            <span class="c1">#     #         self.NNQFullboot[ip][strit][strtflows] = pickle.load(f)</span>
                            <span class="c1">#     # else:</span>
                            <span class="c1">#     #     for ieps in np.arange(0.1,self.IExpect,0.1):</span>
                            <span class="c1">#     #         mkdir_p(&#39;./temp&#39;)</span>
                            <span class="c1">#     #         with open(thisfile.replace(epsstr(self.IExpect),epsstr(ieps)),&#39;wb&#39;) as f:</span>
                            <span class="c1">#     #             pickle.dump(BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,data=tdata,</span>
                            <span class="c1">#     #                                                thiseps=ieps,QforImprov=tflowdata),f)</span>
                            <span class="c1"># elif self.IExpect == True:</span>
                            <span class="c1">#     self.NNQFullboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=tdata,QforImprov=tflowdata)</span>
                            <span class="c1"># elif self.IExpect == False:</span>
                            <span class="c1">#     self.NNQFullboot[ip][strit][strtflows] = BootStrap(self.nboot, name=&#39;G_{2}(&#39;+&#39;,&#39;.join([ip,strit,strtflows])+&#39;)&#39;,cfgvals=thisdata)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;G_</span><span class="si">{2}</span><span class="s1">(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">thisdata</span><span class="p">)</span>
                            <span class="n">NNQFulll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                            <span class="n">NNQFulllAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                            <span class="n">NNQFulllStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                        <span class="c1"># thistimer.Lap()</span>
                        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">strit</span><span class="p">,</span><span class="n">strtflows</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_col_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">NNQFulllcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FlowOp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Qcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;P5C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P5NNcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;NNQ2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Qcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQFulll</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQFulllAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQFulllStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexintl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexintl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">NNQIntlcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FlowOpInt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">QIntcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2Int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P5NNIntcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;NNQ2Int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">QIntcfg</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQIntl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQIntlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">NNQIntlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="n">WipeData</span> <span class="o">=</span> <span class="n">WipeData</span><span class="p">)</span></div>

<div class="viewcode-block" id="NNQFullCorr.ObsToName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.ObsToName">[docs]</a>    <span class="k">def</span> <span class="nf">ObsToName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisop</span><span class="p">):</span>
        <span class="n">thisobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="n">thisop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">thisobs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\alpha_{&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;}&#39;</span><span class="p">)</span></div>

    <span class="c1"># ## thisInfo must contain correct information for combining the correlators (the smearings, the eigenvectors, etc...)</span>
    <span class="c1"># def GetCombCorr(self,thisInfo):</span>
    <span class="c1">#     from SetsOfTwoPtCorrs import SetOfNNQFull</span>
    <span class="c1">#     sinklab,jsmcoeffs,sm2ptList,InfoList = GetInfoList(thisInfo)</span>

    <span class="c1">#     C2Set = SetOfNNQFull(cfglist=self.NNQFull_cfgs[[&#39;configs&#39;,&#39;xsrc_list&#39;]],InfoDict = InfoList)</span>
    <span class="c1">#     C2Set.LoadPickle(CheckCfgs=CheckCfgs)</span>
    <span class="c1">#     thisname,thisleglab,jsmlab = CreateNameAndLL(C2Set.SetC2,sinklab)</span>
    <span class="c1">#     thisfun = GenSinkFun(jsmcoeffs)</span>
    <span class="c1">#     thisfile = self.filename.replace(self.jsm,sinklab)</span>
    <span class="c1">#     thisLL = self.LegLab.replace(self.jsm,sinklab)</span>
    <span class="c1">#     # self.SetCustomName(thisfile,thisLL)</span>
    <span class="c1">#     # self.jsm = jsmlab</span>
    <span class="c1">#     return C2Set.CombineCorrs(thisfun,filename=thisfile,LegLab=thisLL,jsmlab=jsmlab)</span>


<div class="viewcode-block" id="NNQFullCorr.SetCustomName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.SetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">SetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>  <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Observ</span><span class="p">])</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">tsrc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ism</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Observ</span><span class="p">])</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span>
            <span class="k">if</span> <span class="s1">&#39;CPOdd&#39;</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="n">Qeps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">string</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Observ</span><span class="p">)])</span>
                                        <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;\ &#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span> <span class="c1">## customise this how you like</span>
            <span class="k">if</span> <span class="s1">&#39;CPOdd&#39;</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ProjStr</span><span class="o">+</span><span class="s1">&#39;$&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;IExpect&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+=</span> <span class="s1">&#39; Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">IExpect</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+=</span> <span class="s1">&#39; Ieps&#39;</span><span class="o">+</span><span class="n">epsstr</span><span class="p">(</span><span class="n">Qeps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="n">stringLL</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fo_for_cfgs</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/alpha/&#39;</span><span class="o">+</span><span class="n">fo_for_cfgs</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/alpha/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFulldir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span></div>


<div class="viewcode-block" id="NNQFullCorr.ImportCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.ImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span>
            <span class="c1"># self.NNQFull_cfgs[&#39;Op&#39;] = pa.Series(self.FOFull.Op_cfgs.loc[:,&#39;Op&#39;].values,self.NNQFull_cfgs.index)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.Update_Stream_List"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">ncfg_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsrcAvg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">xsrcAvg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">nMeas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;filename&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;LegLab&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span></div>



<div class="viewcode-block" id="NNQFullCorr.RemoveVals"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.RemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="o">==</span> <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;C2_2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2_2&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;Flow&#39;</span> <span class="o">==</span>  <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">FlowRemoveVals</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">WipeData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="s1">&#39;Flow&#39;</span><span class="p">)</span></div>

    <span class="c1">## self.C2 = [ ip, it , iconf ]</span>
<div class="viewcode-block" id="NNQFullCorr.Read"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">Full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">C2_cfgs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NN2</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">Full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN2</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ncfg_list&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span></div>


    <span class="c1"># def ReadAndBoot(self):</span>
    <span class="c1">#     self.Read()</span>
    <span class="c1">#     self.Bootstrap()</span>

    <span class="c1"># def ImportFitRanges(self,fit_range):</span>
    <span class="c1">#     self.fit_range = fit_range</span>
    <span class="c1">#     if isinstance(self.fit_range,basestring):</span>
    <span class="c1">#         self.fit_range = [self.fit_range]</span>


<div class="viewcode-block" id="NNQFullCorr.CheckCol"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.CheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">CheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thiscol</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in color to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="NNQFullCorr.CheckSym"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.CheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">CheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thissym</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in symbol to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>

<div class="viewcode-block" id="NNQFullCorr.GetShift"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.GetShift">[docs]</a>    <span class="k">def</span> <span class="nf">GetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># if self.thisshiftscale == &#39;Not Set&#39;:</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span></div>
        <span class="c1"># else:</span>
        <span class="c1">#     return self.thisshiftscale</span>

<div class="viewcode-block" id="NNQFullCorr.SetTflowFit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.SetTflowFit">[docs]</a>    <span class="k">def</span> <span class="nf">SetTflowFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tflow</span><span class="p">):</span>
        <span class="c1"># if tflow not in self.tflowlist and tflow != &#39;Not Set&#39;:</span>
        <span class="c1">#     print &#39;Warning: &#39;, tflow, &#39; not in flow list, tflowfit not added&#39;</span>
        <span class="c1"># else:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="n">tflow</span></div>

<div class="viewcode-block" id="NNQFullCorr.SetTFit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.SetTFit">[docs]</a>    <span class="k">def</span> <span class="nf">SetTFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tsink</span><span class="p">):</span>
        <span class="c1"># if tsink not in [&#39;t&#39;+str(it) for it in xrange(1,self.nt+1)] and tsink != &#39;Not Set&#39;:</span>
        <span class="c1">#     print &#39;Warning: &#39;, tsink, &#39; not in  list, tsinkfit not added&#39;</span>
        <span class="c1"># else:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span> <span class="o">=</span> <span class="n">tsink</span></div>

<div class="viewcode-block" id="NNQFullCorr.SetFunction"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.SetFunction">[docs]</a>    <span class="k">def</span> <span class="nf">SetFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Fun</span><span class="p">,</span><span class="n">npar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">=</span> <span class="n">Fun</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npar</span> <span class="o">=</span> <span class="n">npar</span></div>



    <span class="c1"># def Fit_TauDep(self,tau_min,tau_max,imom,itsink,itflow,tau_fit_fun=&#39;PreDef&#39;):</span>
    <span class="c1">#     if tau_fit_fun != &#39;PreDef&#39;: self.tau_fit_fun = tau_fit_fun</span>
    <span class="c1">#     fitr = &#39;taufitr&#39;+str(untstr(tau_min))+&#39;-&#39;+str(untstr(tau_max))</span>
    <span class="c1">#     tau_fit_name = &#39;_&#39;.join([fitr,imom,itsink,itflow])</span>
    <span class="c1">#     fit_data = self.NNQFull_Stats[&#39;Alphaboot&#39;][imom,itsink,itflow]</span>
    <span class="c1">#     fit_data = fit_data[tau_min:tau_max]</span>
    <span class="c1">#     parse_data = pa.DataFrame(columns=[&#39;ydata&#39;,&#39;xdata&#39;],index=[0])</span>
    <span class="c1">#     parse_data[&#39;ydata&#39;][0] = fit_data.values</span>
    <span class="c1">#     parse_data[&#39;xdata&#39;][0] = [map(untstr,list(fit_data.index)),[self.nt]*len(fit_data.index)]</span>
    <span class="c1">#     fit_class = ff.Fitting(Funs=self.tau_fit_fun,data=parse_data,name=tau_fit_name)</span>
    <span class="c1">#     fit_class.FitBoots()</span>
    <span class="c1">#     return fit_class</span>
    <span class="c1">#</span>
    <span class="c1"># def Fit_All_Tau(self,fit_range,mom_list=&#39;All&#39;,tsink_list=&#39;All&#39;,tflow_list=&#39;All&#39;,tau_fit_fun=&#39;PreDef&#39;):</span>
    <span class="c1">#     flist,aflist,sflist,index_list = [],[],[],[]</span>
    <span class="c1">#     if mom_list == &#39;All&#39;: mom_list = self.pform</span>
    <span class="c1">#     if tsink_list == &#39;All&#39;: tsink_list = [&#39;t&#39;+str(it+1) for it in self.boot_nt_list]</span>
    <span class="c1">#     if tflow_list == &#39;All&#39;: tflow_list = self.tflowlist</span>
    <span class="c1">#     for ifitr,imom,itsink,itflow in itertools.product(fit_range,mom_list,tsink_list,tflow_list):</span>
    <span class="c1">#         if isinstance(ifitr,basestring):</span>
    <span class="c1">#             ifit_min,ifit_max = map(int,ifitr.replace(&#39;taufitr&#39;,&#39;&#39;).split(&#39;-&#39;))</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             ifit_min,ifit_max = ifitr</span>
    <span class="c1">#         flist.append(self.Fit_TauDep(ifit_min,ifit_max,imom,itsink,itflow,tau_fit_fun))</span>
    <span class="c1">#         aflist.append(flist[-1].fit_data[&#39;ParamsAvg&#39;])</span>
    <span class="c1">#         sflist.append(flist[-1].fit_data[&#39;ParamsStd&#39;])</span>
    <span class="c1">#         ikey = flist[-1].name.split(&#39;_&#39;)</span>
    <span class="c1">#         index_list.append(ikey[:-2]+ [ikey[-2]+&#39;_&#39;+ikey[-1]])</span>
    <span class="c1">#     indicies = pa.MultiIndex.from_tuples(index_list,names=[&#39;fit_range&#39;,&#39;momentum&#39;,&#39;source_sink_sep&#39;,&#39;flow_times&#39;])</span>
    <span class="c1">#     if len(index_list) &gt; 0:</span>
    <span class="c1">#         if &#39;boot&#39; in self.Tau_Fit_Stats.columns:</span>
    <span class="c1">#             if tuple(index_list[-1]) not in self.Tau_Fit_Stats.index:</span>
    <span class="c1">#                 this_df = pa.DataFrame()</span>
    <span class="c1">#                 this_df.loc[:,&#39;boot&#39;] = pa.Series(flist,index=indicies)</span>
    <span class="c1">#                 this_df.loc[:,&#39;Avg&#39;] = pa.Series(aflist,index=indicies)</span>
    <span class="c1">#                 this_df.loc[:,&#39;Std&#39;] = pa.Series(sflist,index=indicies)</span>
    <span class="c1">#                 self.Tau_Fit_Stats = self.Tau_Fit_Stats.append(this_df)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             self.Tau_Fit_Stats.loc[:,&#39;boot&#39;] = pa.Series(flist,index=indicies)</span>
    <span class="c1">#             self.Tau_Fit_Stats.loc[:,&#39;Avg&#39;] = pa.Series(aflist,index=indicies)</span>
    <span class="c1">#             self.Tau_Fit_Stats.loc[:,&#39;Std&#39;] = pa.Series(sflist,index=indicies)</span>
    <span class="c1">#         self.Write()</span>

<div class="viewcode-block" id="NNQFullCorr.ImportFitRanges"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.ImportFitRanges">[docs]</a>    <span class="k">def</span> <span class="nf">ImportFitRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="p">,</span><span class="n">tsum_fit_range</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_range</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setsoffits implementation now only takes 1 fit range to scan over, choosing first&#39;</span><span class="p">)</span>
            <span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tsum_fit_range</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setsoffits implementation now only takes 1 fit range to scan over, choosing first&#39;</span><span class="p">)</span>
            <span class="n">tsum_fit_range</span> <span class="o">=</span> <span class="n">tsum_fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;PreDef&#39;</span> <span class="o">==</span> <span class="n">fit_range</span><span class="p">:</span>
            <span class="n">fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;PreDef&#39;</span> <span class="o">==</span> <span class="n">tsum_fit_range</span><span class="p">:</span>
            <span class="n">tsum_fit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># self.fit_range = list(itertools.product(fit_range,tsum_fit_range))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_range</span><span class="p">,</span><span class="n">tsum_fit_range</span><span class="p">]</span></div>

    <span class="c1"># def ImportFitRangesNP(self,fit_range,tsum_fit_range):</span>
    <span class="c1">#     if isinstance(fit_range,basestring):</span>
    <span class="c1">#         fit_range = [fit_range]</span>
    <span class="c1">#     if isinstance(tsum_fit_range,basestring):</span>
    <span class="c1">#         tsum_fit_range = [tsum_fit_range]</span>
    <span class="c1">#     if &#39;PreDef&#39; == fit_range[0]:</span>
    <span class="c1">#         fit_range = [self.PredefFits[0]]</span>
    <span class="c1">#     if &#39;PreDef&#39; == tsum_fit_range[0]:</span>
    <span class="c1">#         tsum_fit_range = [self.PredefFits[1]]</span>
    <span class="c1">#     self.fit_range = [[ifitr,itsumfitr] for ifitr,itsumfitr in zip(fit_range,tsum_fit_range)]</span>



<div class="viewcode-block" id="NNQFullCorr.FitAlpha"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.FitAlpha">[docs]</a>    <span class="k">def</span> <span class="nf">FitAlpha</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                    <span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fitting alpha not implemented (yet) for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Please define funciton using .SetFunction(Fun,npar) for fitting before calling .FitAlpha()&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportFitRanges</span><span class="p">(</span><span class="n">fit_range</span><span class="p">,</span><span class="n">tsum_ranges</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iGuess</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">=</span> <span class="n">iGuess</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">==</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;tflowfit not set, please set by using .SetTflowFit()&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="o">=</span> <span class="n">thistflowlist</span>
        <span class="n">lFit</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">ifit</span><span class="p">,</span><span class="n">isumfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span> <span class="o">==</span> <span class="s1">&#39;Default&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span> <span class="o">=</span> <span class="n">unxmlfitr_int</span><span class="p">(</span><span class="n">isumfit</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">,</span><span class="s1">&#39;fitr&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># llist = [ival[0][0] for ival in self.NNQFull_Stats[&#39;Alphaboot&#39;].groupby(level=(&#39;momentum&#39;,&#39;flow_time&#39;))]</span>
        <span class="c1"># if show_timer: thistimer = Timer( linklist=llist,name=&#39;Alpha Fits &#39;)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">pdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)):</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="o">!=</span> <span class="s1">&#39;p000&#39;</span> <span class="ow">or</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span> <span class="ow">or</span> <span class="n">ifit</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="ow">or</span> <span class="n">isumfit</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                <span class="c1"># if show_timer: thistimer.Lap(flag=ip+&#39; not being fit &#39;)</span>
                <span class="k">continue</span>
            <span class="c1"># ifit_str = &#39;_&#39;.join([ifit,isumfit])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">WipeFit</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">)],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># if show_timer: thistimer.Lap(flag=&#39;,&#39;.join([ip,itflow])+&#39; already present&#39;)</span>
                    <span class="k">continue</span>

            <span class="c1"># ifitmin,ifitmax = np.array(unxmlfitr(ifit),dtype=np.float64)</span>
            <span class="c1"># isumfitmin,isumfitmax = np.array(unxmlfitr(isumfit.replace(&#39;tsum&#39;,&#39;&#39;)),dtype=np.float64)</span>

            <span class="c1"># ##debugging</span>
            <span class="c1"># print</span>
            <span class="c1"># print &#39;FitData:&#39;</span>
            <span class="c1"># for it,iy in zip(tdatarange[0],ydata):</span>
            <span class="c1">#     print it, iy</span>
            <span class="c1"># print</span>
            <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">EstDir</span><span class="p">:</span>
                <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">,</span><span class="s1">&#39;Estimate&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">)</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; Fits&#39;</span>
            <span class="c1"># fit_info[&#39;paramlist&#39;] = [r&#39;\alpha&#39;]</span>
            <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pdata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ip</span><span class="p">,:,</span><span class="n">itflow</span><span class="p">,:])</span>
            <span class="n">this_test</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanBox_fitr</span><span class="p">(</span><span class="n">ifit</span><span class="p">,</span><span class="n">isumfit</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span>
                                            <span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_fit_len_tsum</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
                <span class="n">lFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_fit</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_col_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">DoFit</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">val</span><span class="o">.</span><span class="n">DoFits</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoFit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>

    <span class="c1">## implement setsoffits here</span>
<div class="viewcode-block" id="NNQFullCorr.AlphaPlotVstiFitr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotVstiFitr">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotVstiFitr</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistfitr</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">thismom</span><span class="o">=</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span>
                            <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">fit_min_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setsoffits have not implemented vstifitr yet, skipping&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># if self.is_NNQ2sub:</span>
        <span class="c1">#     print &#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span>
        <span class="c1">#     return plot_class</span>
        <span class="c1"># self.CheckCol(thiscol)</span>
        <span class="c1"># self.CheckSym(thissym)</span>
        <span class="c1"># self.thisshiftscale = &#39;Not Set&#39;</span>
        <span class="c1"># if isinstance(thistfitr,(list,tuple,np.ndarray)):</span>
        <span class="c1">#     thistfitr = &#39;fitr&#39;+&#39;-&#39;.join(map(str,thistfitr))</span>
        <span class="c1"># if not isinstance(fit_max,basestring):</span>
        <span class="c1">#     fit_max = str(int(fit_max))</span>
        <span class="c1"># fitr_list = []</span>
        <span class="c1"># if fit_min_list != &#39;All&#39;:</span>
        <span class="c1">#     for imin in fit_min_list:</span>
        <span class="c1">#         if isinstance(imin,basestring):</span>
        <span class="c1">#             tsum_fitr = &#39;tsumfitr&#39;+imin+&#39;-&#39;+fit_max</span>
        <span class="c1">#         else:</span>
        <span class="c1">#             tsum_fitr = &#39;tsumfitr&#39;+str(imin)+&#39;-&#39;+fit_max</span>
        <span class="c1">#         fit_str = thistfitr+&#39;_&#39;+tsum_fitr</span>
        <span class="c1">#         if WipeFit or &#39;boot&#39; not in self.NNQFull_Fit_Stats.columns or (thismom,flowtime,fit_str) not in self.NNQFull_Fit_Stats[&#39;boot&#39;].index:</span>
        <span class="c1">#             print thismom,flowtime,fit_str , &#39;Not found, attempting to fit now&#39;</span>
        <span class="c1">#             self.FitAlpha(fit_range=[thistfitr],thistflowlist = [flowtime],tsum_ranges=[tsum_fitr],WipeFit=WipeFit)</span>
        <span class="c1">#         fitr_list.append(fit_str)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     if &#39;boot&#39; not in self.NNQFull_Fit_Stats.columns or (thismom,flowtime) not in self.NNQFull_Fit_Stats[&#39;boot&#39;].index:</span>
        <span class="c1">#         raise EnvironmentError(&#39;No fit ranges found for &#39;+&#39; &#39;.join([thismom,flowtime]))</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         alpha_hold = self.NNQFull_Fit_Stats.loc[(thismom,flowtime,slice(None)),&#39;boot&#39;]</span>
        <span class="c1">#         alpha_hold = pa.Series(alpha_hold.values,[ival[2] for ival in list(alpha_hold.index)])</span>
        <span class="c1">#         fitr_list = list(alpha_hold[alpha_hold.index.str.contains(thistfitr+&quot;_tsumfitr.*-&quot;+fit_max)].index)</span>
        <span class="c1">#</span>
        <span class="c1"># thisdata = self.NNQFull_Fit_Stats.loc[(thismom,flowtime,fitr_list),&#39;boot&#39;]</span>
        <span class="c1"># thisdata = thisdata.apply(lambda x : x.fit_data[&#39;Params&#39;].iloc[0])</span>
        <span class="c1"># xlist = list(thisdata.index)</span>
        <span class="c1"># if isinstance(xlist[0],tuple):</span>
        <span class="c1">#     xlist = [ix[-1] for ix in xlist]</span>
        <span class="c1"># plotx = map(lambda x : x.replace(thistfitr+&#39;_tsumfitr&#39;,&#39;&#39;),xlist)</span>
        <span class="c1"># plotx = map(lambda x : int(x.replace(&#39;-&#39;+fit_max,&#39;&#39;)),plotx)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(ival.Avg,ival.Std) for ival in thisdata.values])</span>
        <span class="c1"># plotshift = self.thisshift*np.abs(plotx[-1]-plotx[0])</span>
        <span class="c1"># thisleglab = self.LegLab +&#39;$\ &#39;+ tflowTOLeg(flowtime) + &#39;\ t_{e}=&#39;+fit_max+&#39;$&#39;</span>
        <span class="c1"># if thismom != &#39;p000&#39;: thisleglab = thisleglab+&#39;\ &#39;+thismom.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="c1"># # if Auto: thisleglab  = thisleglab + &#39; Auto&#39;</span>
        <span class="c1"># hold_series = pa.Series()</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = plotx</span>
        <span class="c1"># hold_series[&#39;y_data&#39;] = ploty</span>
        <span class="c1"># hold_series[&#39;yerr_data&#39;] = plotyerr</span>
        <span class="c1"># hold_series[&#39;xerr_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;type&#39;] = &#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;fit_class&#39;] = None</span>
        <span class="c1"># hold_series[&#39;label&#39;] = thisleglab</span>
        <span class="c1"># hold_series[&#39;symbol&#39;] = self.thissym</span>
        <span class="c1"># hold_series[&#39;color&#39;] = self.thiscol</span>
        <span class="c1"># hold_series[&#39;shift&#39;] = plotshift</span>
        <span class="c1"># hold_series[&#39;otherXvals&#39;] = None</span>
        <span class="c1"># hold_series[&#39;xaxis&#39;] = None</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = None</span>
        <span class="c1"># hold_series[&#39;ShowPar&#39;] = r&#39;\alpha&#39;</span>
        <span class="c1"># hold_series[&#39;Phys&#39;] = None</span>
        <span class="c1"># plot_class.AppendData(hold_series)</span>
        <span class="c1"># initial_time = tstr(thistfitr.replace(&#39;fitr&#39;,&#39;&#39;).split(&#39;-&#39;)[0])</span>
        <span class="c1"># plot_class = self.PlotIntLine(plot_class,thismom,flowtime,initial_time,self.thiscol)</span>
        <span class="c1"># return plot_class</span>


<div class="viewcode-block" id="NNQFullCorr.AlphaPlotVstfFitr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotVstfFitr">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotVstfFitr</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistfitr</span><span class="p">,</span><span class="n">fit_min</span><span class="p">,</span><span class="n">thismom</span><span class="o">=</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span>
                            <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">fit_max_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setsoffits have not implemented vstffitr yet, skipping&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># if self.is_NNQ2sub:</span>
        <span class="c1">#     print &#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span>
        <span class="c1">#     return plot_class</span>
        <span class="c1"># self.CheckCol(thiscol)</span>
        <span class="c1"># self.CheckSym(thissym)</span>
        <span class="c1"># self.thisshiftscale = &#39;Not Set&#39;</span>
        <span class="c1"># if isinstance(thistfitr,(list,tuple,np.ndarray)):</span>
        <span class="c1">#     thistfitr = &#39;fitr&#39;+&#39;-&#39;.join(map(str,thistfitr))</span>
        <span class="c1"># if not isinstance(fit_min,basestring):</span>
        <span class="c1">#     fit_min = str(int(fit_min))</span>
        <span class="c1"># fitr_list = []</span>
        <span class="c1"># if fit_max_list != &#39;All&#39;:</span>
        <span class="c1">#     for imax in fit_max_list:</span>
        <span class="c1">#         if isinstance(imax,basestring):</span>
        <span class="c1">#             tsum_fitr = &#39;tsumfitr&#39;+fit_min+&#39;-&#39;+imax</span>
        <span class="c1">#         else:</span>
        <span class="c1">#             tsum_fitr = &#39;tsumfitr&#39;+fit_min+&#39;-&#39;+str(imax)</span>
        <span class="c1">#         fit_str = thistfitr+&#39;_&#39;+tsum_fitr</span>
        <span class="c1">#         if WipeFit or &#39;boot&#39; not in self.NNQFull_Fit_Stats.columns or (thismom,flowtime,fit_str) not in self.NNQFull_Fit_Stats[&#39;boot&#39;].index:</span>
        <span class="c1">#             print thismom,flowtime,fit_str , &#39;Not found, attempting to fit now&#39;</span>
        <span class="c1">#             self.FitAlpha(fit_range=[thistfitr],thistflowlist = [flowtime],tsum_ranges=[tsum_fitr],WipeFit=WipeFit)</span>
        <span class="c1">#         fitr_list.append(fit_str)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     if &#39;boot&#39; not in self.NNQFull_Fit_Stats.columns or (thismom,flowtime) not in self.NNQFull_Fit_Stats[&#39;boot&#39;].index:</span>
        <span class="c1">#         raise EnvironmentError(&#39;No fit ranges found for &#39;+&#39; &#39;.join([thismom,flowtime]))</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         alpha_hold = self.NNQFull_Fit_Stats.loc[(thismom,flowtime,slice(None)),&#39;boot&#39;]</span>
        <span class="c1">#         alpha_hold = pa.Series(alpha_hold.values,[ival[2] for ival in list(alpha_hold.index)])</span>
        <span class="c1">#         fitr_list = list(alpha_hold[alpha_hold.index.str.contains(thistfitr+&#39;_tsumfitr&#39;+fit_min+&#39;-&#39;)].index)</span>
        <span class="c1">#</span>
        <span class="c1"># thisdata = self.NNQFull_Fit_Stats.loc[(thismom,flowtime,fitr_list),&#39;boot&#39;]</span>
        <span class="c1"># # thisdata = thisdata[fitr_list]</span>
        <span class="c1"># thisdata = thisdata.apply(lambda x : x.fit_data[&#39;Params&#39;].iloc[0])</span>
        <span class="c1">#</span>
        <span class="c1"># xlist = list(thisdata.index)</span>
        <span class="c1"># if isinstance(xlist[0],tuple):</span>
        <span class="c1">#     xlist = [ix[-1] for ix in xlist]</span>
        <span class="c1"># plotx = map(lambda x : int(x.replace(thistfitr+&#39;_tsumfitr&#39;+fit_min+&#39;-&#39;,&#39;&#39;)),xlist)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(ival.Avg,ival.Std) for ival in thisdata.values])</span>
        <span class="c1"># plotshift = self.thisshift*np.abs(plotx[-1]-plotx[0])</span>
        <span class="c1"># thisleglab = self.LegLab +&#39;$\ &#39;+ tflowTOLeg(flowtime) + &#39;\ t_{i}=&#39;+fit_min+&#39;$&#39;</span>
        <span class="c1"># if thismom != &#39;p000&#39;: thisleglab = thisleglab+&#39;\ &#39;+thismom.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="c1"># # if Auto: thisleglab  = thisleglab + &#39; Auto&#39;</span>
        <span class="c1"># hold_series = pa.Series()</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = plotx</span>
        <span class="c1"># hold_series[&#39;y_data&#39;] = ploty</span>
        <span class="c1"># hold_series[&#39;yerr_data&#39;] = plotyerr</span>
        <span class="c1"># hold_series[&#39;xerr_data&#39;] = None</span>
        <span class="c1"># hold_series[&#39;type&#39;] = &#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;fit_class&#39;] = None</span>
        <span class="c1"># hold_series[&#39;label&#39;] = thisleglab</span>
        <span class="c1"># hold_series[&#39;symbol&#39;] = self.thissym</span>
        <span class="c1"># hold_series[&#39;color&#39;] = self.thiscol</span>
        <span class="c1"># hold_series[&#39;shift&#39;] = plotshift</span>
        <span class="c1"># hold_series[&#39;otherXvals&#39;] = None</span>
        <span class="c1"># hold_series[&#39;xaxis&#39;] = None</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = None</span>
        <span class="c1"># hold_series[&#39;ShowPar&#39;] = r&#39;\alpha&#39;</span>
        <span class="c1"># hold_series[&#39;Phys&#39;] = None</span>
        <span class="c1"># plot_class.AppendData(hold_series)</span>
        <span class="c1"># initial_time = tstr(thistfitr.replace(&#39;fitr&#39;,&#39;&#39;).split(&#39;-&#39;)[0])</span>
        <span class="c1"># plot_class = self.PlotIntLine(plot_class,thismom,flowtime,initial_time,self.thiscol)</span>
        <span class="c1"># return plot_class</span>



    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
    <span class="c1">## thistflowlist is array of tflows to plot over (currently supports length 1 arrays).</span>
    <span class="c1">## ToDo: make color and symbol and shift iterate over this. Currently handeled externally (SetsOfCorrs.py) with repeated calls</span>
<div class="viewcode-block" id="NNQFullCorr.AlphaPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlot</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlimAlpha</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                    <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">spec_tsum_list</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                    <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;Alphaboot&#39;</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
        <span class="k">if</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="ow">or</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df_col_name</span><span class="p">,</span><span class="s1">&#39;not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="c1"># if isinstance(xlims[0],basestring): xlims = map(untstr,xlims)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tsum_list</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">tsum_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">if</span> <span class="n">spec_tsum_list</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">spec_tsum_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tsum_list</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">tsum_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tsum_list</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">jt_sum</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">spec_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># for ip,it_sum,iflow in itertools.product(momlist,tsum_list,thistflowlist):</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;Int&#39;</span> <span class="ow">in</span> <span class="n">it_sum</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="c1"># pdata = thisdata.swaplevel(1,2)[ip,iflow]</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="s1">&#39; not found in Op Integrated Alpha keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
                <span class="c1"># pdata = thisdata.swaplevel(1,3)[ip,it_sum,iflow]</span>
                <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">iflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">,</span><span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">plot_class</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
                <span class="c1"># pdata = thisdata.swaplevel(1,3)[ip,it_sum,iflow]</span>
                <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">iflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">it_sum</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">plot_class</span>
        <span class="c1"># if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span>  <span class="o">=</span> <span class="n">thisleglab</span> <span class="o">+</span> <span class="s1">&#39; Auto&#39;</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in databoot])</span>
        <span class="c1"># tlist,databoot = pdata.keys()[xlims[0]:xlims[1]],pdata.values[xlims[0]:xlims[1]]</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(map(untstr,tlist))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="NNQFullCorr.AlphaPlotImproveFit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotImproveFit">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotImproveFit</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlimAlpha</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">this_par</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="c1"># if isinstance(xlims[0],basestring): xlims = map(untstr,xlims)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span><span class="p">,</span><span class="n">iflow</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># for ip,iflow in itertools.product(momlist,thistflowlist):</span>
        <span class="c1"># thisleglab = self.LegLab</span>
        <span class="c1"># if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="n">fit_scan</span> <span class="o">=</span> <span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fitr_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">if</span> <span class="s1">&#39;tsumfitr&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fitr</span><span class="p">:</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="n">fitr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;fitr&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fit_scan</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">this_par</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">this_par</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_par</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">this_par</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">this_par</span><span class="p">]</span>
        <span class="n">this_key_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">ifitr</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">this_par</span><span class="p">)</span> <span class="k">for</span> <span class="n">ifitr</span> <span class="ow">in</span> <span class="n">fitr_list</span><span class="p">]</span>
        <span class="n">this_key_select</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">fitr</span><span class="p">,</span><span class="n">this_par</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">([</span><span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">this_key_list</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fit_scan</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">fitr_list</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span>


        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key_select</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

        <span class="c1"># plot_class.get_xlim(*xlims)</span>



<div class="viewcode-block" id="NNQFullCorr.AlphaPlotTflow"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotTflow">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotTflow</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">tflowplot</span> <span class="o">=</span> <span class="n">defxlimOp</span><span class="p">,</span>
                        <span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistsinklist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># def WithinBounds(tlist):</span>
        <span class="c1">#     output,indicies = [],[]</span>
        <span class="c1">#     for ic,ilist in enumerate(tlist):</span>
        <span class="c1">#         if untflowstr(ilist) in tflowplot:</span>
        <span class="c1">#             output.append(ilist)</span>
        <span class="c1">#             indicies.append(ic)</span>
        <span class="c1">#     return output,indicies</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;Alphaboot&#39;</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
            <span class="k">if</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="ow">or</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Auto not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">tflowplot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tflowplot</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">tsum_list</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="n">tsum_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">if</span> <span class="n">thistsinklist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistsinklist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistsinklist</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tsum_list</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">tsum_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tsum_list</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">tsum_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tsum_list</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="n">ip</span><span class="p">,</span> <span class="n">it_sum</span><span class="p">,</span><span class="n">itsink</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistsinklist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># for ip,it_sum,itsink in itertools.product(momlist,tsum_list,thistsinklist):</span>
        <span class="k">if</span> <span class="s1">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;p000&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;Int&#39;</span> <span class="ow">in</span> <span class="n">it_sum</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="s1">&#39; not found in Op Integrated Alpha keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">tflowdata</span> <span class="o">=</span> <span class="n">thisdata</span><span class="p">[</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">]</span>
            <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">it_sum</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">itsink</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">tflowdata</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)[</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">it_sum</span><span class="p">]</span>
            <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span> <span class="o">=</span> <span class="n">thisleglab</span> <span class="o">+</span> <span class="s1">&#39; Auto&#39;</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># tflowlist,indicies = WithinBounds(np.array(tflowlist))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">itf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">]</span>
        <span class="n">tflowlist</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">([</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="c1"># print</span>
        <span class="c1"># print thisshift</span>
        <span class="c1"># print plotshift</span>
        <span class="c1"># print [tflowlist[0],tflowlist[-1]]</span>
        <span class="c1"># print np.array(tflowlist)+plotshift</span>
        <span class="c1"># databoot = np.array(databoot)[indicies]</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in databoot])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="NNQFullCorr.PlotIntTsink"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.PlotIntTsink">[docs]</a>    <span class="k">def</span> <span class="nf">PlotIntTsink</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_flow</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlimAlpha</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting anything other than PlotAlphaTsum not implemented for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span> <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">xlims</span><span class="p">))</span>
        <span class="c1"># xlim_str = [tstr(ix+1) for ix in xlims]</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;Alphaboot&#39;</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
            <span class="k">if</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="ow">or</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Auto not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_mom</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">this_mom</span> <span class="o">=</span> <span class="n">this_mom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_flow</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">plot_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print plot_data</span>
            <span class="c1"># print list(plot_data.keys())</span>
            <span class="c1"># # print plot_data.apply(lambda x : x.Avg)</span>
            <span class="c1"># print xlim_str</span>
            <span class="c1"># print plot_data.loc[xlim_str[0]:xlim_str[1]]</span>
            <span class="c1"># plot_data = plot_data.loc[xlim_str[0]:xlim_str[1]]</span>
            <span class="c1"># xdata = map(untstr,list(plot_data.keys()))</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $\alpha_</span><span class="si">{Int}</span><span class="s1">$&#39;</span>
            <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span> <span class="o">+=</span> <span class="s1">&#39; Auto&#39;</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">this_mom</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">this_flow</span><span class="p">)</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = )</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">((</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_flow</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;has no NNQ Integrated result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="NNQFullCorr.PlotIntLine"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.PlotIntLine">[docs]</a>    <span class="k">def</span> <span class="nf">PlotIntLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_flow</span><span class="p">,</span><span class="n">this_tsink</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;Alphaboot&#39;</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
        <span class="k">if</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Auto not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_tsink</span><span class="p">,</span><span class="n">this_flow</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="n">linelab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\alpha_</span><span class="si">{Int}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">linelab</span> <span class="o">=</span> <span class="s1">&#39;Auto &#39;</span> <span class="o">+</span> <span class="n">linelab</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_tsink</span><span class="p">,</span><span class="n">this_flow</span><span class="p">)</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linelab</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = )</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">((</span><span class="n">this_mom</span><span class="p">,</span><span class="n">this_tsink</span><span class="p">,</span><span class="n">this_flow</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;has no NNQ Integrated result&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>



<div class="viewcode-block" id="NNQFullCorr.Plot_Tau_Fit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Plot_Tau_Fit">[docs]</a>    <span class="k">def</span> <span class="nf">Plot_Tau_Fit</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">mom</span><span class="p">,</span><span class="n">tsink</span><span class="p">,</span>
                        <span class="n">tflow</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PlotAlpha or PlotAlphaTsum are only done for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitr</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="n">fitr_list</span> <span class="o">=</span> <span class="n">fitr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">tflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">Series_fix_key</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">tflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">Series_fix_key</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>
        <span class="c1"># if isinstance(fit_plot,pa.Series):</span>
        <span class="c1">#     fit_plot = fit_plot.iloc[0]</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fit &#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">untstr</span><span class="p">(</span><span class="n">tsink</span><span class="p">)]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="NNQFullCorr.Plot_Tsink_Fit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Plot_Tsink_Fit">[docs]</a>    <span class="k">def</span> <span class="nf">Plot_Tsink_Fit</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">mom</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span>
                        <span class="n">tflow</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PlotAlpha or PlotAlphaTsum are only done for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitr</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="n">fitr_list</span> <span class="o">=</span> <span class="n">fitr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mom</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">mom</span> <span class="o">=</span> <span class="n">mom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">WipeFit</span> <span class="ow">or</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">tflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">Series_fix_key</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">tflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">Series_fix_key</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>

        <span class="c1"># if isinstance(fit_plot,pa.Series):</span>
        <span class="c1">#     fit_plot = fit_plot.iloc[0]</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fit &#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">untstr</span><span class="p">(</span><span class="n">tsum</span><span class="p">)]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>



<div class="viewcode-block" id="NNQFullCorr.AlphaPlotTsum"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotTsum">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotTsum</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistsinklist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                        <span class="n">thistflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">fit_list</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">spec_tsum_list</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fit_list</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">fit_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec_tsum_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">spec_tsum_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spec_tsum_list</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">fit_list</span> <span class="o">=</span> <span class="n">fit_list</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="n">fit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">fit_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">fit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;Alphaboot&#39;</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
        <span class="n">this_logic</span> <span class="o">=</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="n">this_logic</span> <span class="o">=</span> <span class="n">this_logic</span> <span class="ow">or</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_logic</span> <span class="o">=</span> <span class="n">this_logic</span> <span class="ow">or</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span>
        <span class="k">if</span> <span class="n">this_logic</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df_col_name</span><span class="p">,</span><span class="s1">&#39; not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">thistsinklist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistsinklist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistsinklist</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="c1"># for fitr,ip,itflow,itsink in itertools.product(fit_list,momlist,thistflowlist,thistsinklist):</span>
        <span class="n">fitr</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">jt_sum</span>  <span class="o">=</span> <span class="n">fit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistsinklist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">spec_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="c1"># pdata = thisdata.swaplevel(1,3)[ip,it_sum,iflow]</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">jt_sum</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">,</span><span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="c1"># tflowdata = thisdata[ip,itsink,itflow,slice(None),jt_sum]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span> <span class="n">itsink</span> <span class="p">,</span><span class="s1">&#39; not found in Alphaboot keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="c1"># tflowdata = thisdata[ip,itsink,itflow]</span>
        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="c1"># if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="n">thisleglab</span> <span class="o">+=</span> <span class="s1">&#39; Auto&#39;</span>
        <span class="c1"># this_slice = slice(self.boot_tsum_list[0],self.boot_tsum_list[-1])</span>

        <span class="c1"># tsum_plot = map(untstr,tflowdata.keys()[this_slice])</span>
        <span class="c1"># if len(tsum_plot) == 0:</span>
        <span class="c1">#     plotshift = thisshift</span>
        <span class="c1"># else:</span>
        <span class="c1">#     plotshift = self.GetShift([tsum_plot[0],tsum_plot[-1]],thisshift)</span>
        <span class="c1"># print</span>
        <span class="c1"># print thisshift</span>
        <span class="c1"># print plotshift</span>
        <span class="c1"># print [tsum_plot[0],tsum_plot[-1]]</span>
        <span class="c1"># print np.array(tsum_plot)+plotshift</span>
        <span class="n">dataavg</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">dataerr</span> <span class="o">=</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># databoot = np.array(databoot)</span>
        <span class="c1"># dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in databoot])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotIntLine</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="n">Auto</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;None&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fitr</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Auto</span><span class="p">:</span>
            <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Tau_Fit</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
    <span class="c1"># plot_class.get_xlim(*xlims)</span>

<div class="viewcode-block" id="NNQFullCorr.AlphaPlotCovar"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotCovar">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotCovar</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistsinklist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                        <span class="n">thistflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">spec_tsum_list</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec_tsum_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">spec_tsum_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spec_tsum_list</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">df_col_name</span> <span class="o">=</span> <span class="s1">&#39;AlphaAuto&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="n">this_logic</span> <span class="o">=</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_logic</span> <span class="o">=</span> <span class="n">df_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span>
        <span class="k">if</span> <span class="n">this_logic</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df_col_name</span><span class="p">,</span><span class="s1">&#39; not computed for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">thistsinklist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsinkfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistsinklist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistsinklist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistsinklist</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_fit_list</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="c1"># for fitr,ip,itflow,itsink in itertools.product(fit_list,momlist,thistflowlist,thistsinklist):</span>
        <span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">jt_sum</span>  <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistsinklist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">spec_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="c1"># pdata = thisdata.swaplevel(1,3)[ip,it_sum,iflow]</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">jt_sum</span><span class="p">,</span><span class="s1">&#39;C12&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">,</span><span class="s1">&#39; not found in Alpha keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="c1"># tflowdata = thisdata[ip,itsink,itflow,slice(None),jt_sum]</span>
            <span class="n">covarl</span><span class="p">,</span><span class="n">indexl</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">icovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">covar</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">jc</span><span class="p">,</span><span class="n">jcovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">icovar</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">jc</span> <span class="o">&gt;=</span> <span class="n">ic</span><span class="p">:</span>
                            <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jc</span><span class="o">+</span><span class="mi">1</span><span class="p">),))</span>
                            <span class="n">covarl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jcovar</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Covar_matrix&#39;</span><span class="p">])</span>
                <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">covarl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="s1">&#39;C12&#39;</span><span class="p">)</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="n">df_col_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itsink</span><span class="p">,</span> <span class="n">itsink</span> <span class="p">,</span><span class="s1">&#39; not found in Alphaboot keys&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">covarl</span><span class="p">,</span><span class="n">indexl</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="c1"># try:</span>
            <span class="c1">#     tflowdata = thisdata.loc[(ip,itsink,itflow,slice(None))]</span>
            <span class="c1"># except Exception as err:</span>
            <span class="c1">#     out_str = &#39;not in tflowdata:\n&#39; + &#39;, &#39;.join([ip,itsink,itflow,&#39;None&#39;])</span>
            <span class="c1">#     out_str += &#39;\ntotal_list:\n&#39;+&#39;\n&#39;.join([&#39;, &#39;.join(ival) for ival in list(thisdata.index)])</span>
            <span class="c1">#     raise EnvironmentError(str(err)+&#39;\n&#39;+out_str)</span>
            <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">icovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">covar</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">jc</span><span class="p">,</span><span class="n">jcovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">icovar</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">jc</span> <span class="o">&gt;=</span> <span class="n">ic</span><span class="p">:</span>
                            <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jc</span><span class="o">+</span><span class="mi">1</span><span class="p">),))</span>
                            <span class="n">covarl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jcovar</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Covar_matrix&#39;</span><span class="p">])</span>
                <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">covarl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>

        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">+</span> <span class="s1">&#39; Covar&#39;</span>
        <span class="c1"># if len(momlist) &gt; 1: thisleglab = thisleglab+&#39;\ &#39;+ip.replace(&#39;p&#39;,&#39;p=&#39;)</span>
        <span class="c1"># this_slice = slice(self.boot_tsum_list[0],self.boot_tsum_list[-1])</span>

        <span class="c1"># tsum_plot = map(untstr,tflowdata.keys()[this_slice])</span>
        <span class="c1"># if len(tsum_plot) == 0:</span>
        <span class="c1">#     plotshift = thisshift</span>
        <span class="c1"># else:</span>
        <span class="c1">#     plotshift = self.GetShift([tsum_plot[0],tsum_plot[-1]],thisshift)</span>
        <span class="c1"># print</span>
        <span class="c1"># print thisshift</span>
        <span class="c1"># print plotshift</span>
        <span class="c1"># print [tsum_plot[0],tsum_plot[-1]]</span>
        <span class="c1"># print np.array(tsum_plot)+plotshift</span>
        <span class="c1"># databoot = np.array(databoot)</span>
        <span class="c1"># dataavg,dataerr = zip(*[(idata.Avg,idata.Std) for idata in databoot])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;scatter_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
    <span class="c1"># plot_class.get_xlim(*xlims)</span>


    <span class="c1">#state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="NNQFullCorr.AlphaFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaFitPlot</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                        <span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">thispar</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># autocorrelation has not fits (currenlty)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">fitr</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitr</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>
        <span class="n">ip</span><span class="p">,</span><span class="n">iflow</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fitr_list</span> <span class="o">=</span> <span class="n">fitr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thispar</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thispar</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">thispar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thispar</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thispar</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\alpha_</span><span class="si">{fit}</span><span class="s1">&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="NNQFullCorr.AlphaPlotDist"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotDist">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotDist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="n">tsink</span><span class="p">,</span><span class="n">spec_tsum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mom</span><span class="o">=</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># autocorrelation has not fits (currenlty)</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="n">ikey</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tsink</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="n">spec_tsum</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span> <span class="ow">or</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ikey</span> <span class="p">,</span><span class="s1">&#39;is not in NNQFull_Stats, skipping distribution plot&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">this_boot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ikey</span> <span class="o">=</span> <span class="p">(</span><span class="n">mom</span><span class="p">,</span><span class="n">tsink</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">tsum</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;Alphaboot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="ow">or</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ikey</span> <span class="p">,</span><span class="s1">&#39;is not in NNQFull_Stats, skipping distribution plot&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="n">this_boot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span>
        <span class="c1"># this_boot = self.NNQFull_Stats.loc[ikey,&#39;Alphaboot&#39;]</span>
        <span class="c1"># thisleglab = self.LegLab +&#39;$\ &#39;+ &#39;\ &#39;.join([mom,tsink,tflowTOLeg(tflow),tsum]) + &#39;$&#39;</span>
        <span class="n">thisleglab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="c1">#+&#39;$\ &#39;+ &#39;\ &#39;.join([mom,tsink,tflowTOLeg(tflow),tsum]) + &#39;$&#39;</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;histogram_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;boot_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_boot</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisleglab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">#state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="NNQFullCorr.AlphaPlotVsEnergy"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaPlotVsEnergy">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaPlotVsEnergy</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span>
                            <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">Auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">PhysEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">thispar</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span><span class="p">):</span>
        <span class="c1"># autocorrelation has not fits (currenlty)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PlotAlpha or PlotAlphaTsum are only done for NNQ2Sub&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">Auto</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">fitr</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitr</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">momlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">momlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfit</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">thistflowlist</span><span class="p">]</span>
        <span class="n">imom</span><span class="p">,</span><span class="n">iflow</span> <span class="o">=</span> <span class="n">momlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fitr_list</span> <span class="o">=</span> <span class="n">fitr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thispar</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thispar</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">thispar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iflow</span><span class="p">],</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>

        <span class="n">this_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thispar</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thispar</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thispar</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">iflow</span><span class="p">,</span><span class="n">this_fun</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitr_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Fmt_pmom_index</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">this_key_select</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)</span> <span class="o">+</span> <span class="n">this_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># ploty.append(this_fit.fit_data[&#39;ParamsAvg&#39;][r&#39;\alpha&#39;])</span>
        <span class="c1"># plotyerr.append(this_fit.fit_data[&#39;ParamsStd&#39;][r&#39;\alpha&#39;])</span>
        <span class="c1"># thisplotx = [self.NN.latparams.EnergyFromRecRel(kmom,self.NN.latparams.GetNucleonMass(Phys=False)) for kmom in self.NNQFull_Fit_Stats.loc[(slice(None),iflow,fitr),&#39;boot&#39;].iterkeys()]</span>
        <span class="c1"># ## into GeV</span>
        <span class="c1"># if PhysEnergy: thisplotx = map(lambda x : x*self.NN.latparams.hbarcdivlat,thisplotx)</span>
        <span class="c1"># plotshift = self.GetShift([thisplotx[0],thisplotx[-1]],thisshift)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key_select</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="NNQFullCorr.items"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="NNQFullCorr.iteritems"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.iteritems">[docs]</a>    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>


<div class="viewcode-block" id="NNQFullCorr.itemsAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="NNQFullCorr.values"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="NNQFullCorr.valuesAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="NNQFullCorr.keys"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span>



<div class="viewcode-block" id="NNQFullCorr.EffMass"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.EffMass">[docs]</a>    <span class="k">def</span> <span class="nf">EffMass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">lEff</span><span class="p">,</span><span class="n">lEffA</span><span class="p">,</span><span class="n">lEffS</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span><span class="s1">&#39;flow_op_trange&#39;</span><span class="p">)):</span>
            <span class="n">next_tdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)[</span><span class="n">ip</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">itflow</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">idata</span><span class="p">),</span><span class="n">idata_shift</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)[</span><span class="n">ip</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="n">next_tdata</span><span class="p">):</span>
                <span class="n">thisEff</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span><span class="o">/</span><span class="n">idata_shift</span><span class="p">)</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                <span class="n">thisEff</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">))</span>
                <span class="n">lEff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="p">)</span>
                <span class="n">lEffA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lEffS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEff</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEff</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEffA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEffS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>

<div class="viewcode-block" id="NNQFullCorr.RatFunAndDer"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.RatFunAndDer">[docs]</a>    <span class="k">def</span> <span class="nf">RatFunAndDer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;OnlySub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],((</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># elif self.is_NNQ2sub or self.is_NNSingQ2sub:</span>
        <span class="c1">#     def chit(*vals):</span>
        <span class="c1">#         return (vals[0]-vals[2])/vals[1]</span>
        <span class="c1">#     def chitder(*vals):</span>
        <span class="c1">#         return [1.0/vals[1],(vals[2]-vals[0])/(vals[1]**2.),-1.0/vals[1]]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQsub</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">chit</span><span class="p">,</span><span class="n">chitder</span><span class="p">)</span></div>

<span class="c1"># add instead of subtract</span>
    <span class="c1"># def RatFunAndDer(self):</span>
    <span class="c1">#     if self.is_Qsub or self.is_Q2sub:</span>
    <span class="c1">#         def chit(*vals):</span>
    <span class="c1">#             return vals[0]/vals[1]+vals[2]</span>
    <span class="c1">#         def chitder(*vals):</span>
    <span class="c1">#             return [1.0/vals[1],-vals[0]/(vals[1]**2.),vals[1]/vals[1]]</span>
    <span class="c1">#     elif self.is_NNQ2sub or self.is_NNSingQ2sub or self.is_NNQsub:</span>
    <span class="c1">#         def chit(*vals):</span>
    <span class="c1">#             return (vals[0]+vals[2])/vals[1]</span>
    <span class="c1">#         def chitder(*vals):</span>
    <span class="c1">#             return [1.0/vals[1],(vals[2]+vals[0])/(vals[1]**2.),1.0/vals[1]]</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         def chit(*vals):</span>
    <span class="c1">#             return vals[0]/vals[1]</span>
    <span class="c1">#         def chitder(*vals):</span>
    <span class="c1">#             return [1.0/vals[1],-vals[0]/(vals[1]**2.)]</span>
    <span class="c1">#     return (chit,chitder)</span>

<div class="viewcode-block" id="NNQFullCorr.AlphaRatio"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.AlphaRatio">[docs]</a>    <span class="k">def</span> <span class="nf">AlphaRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">cpevenInfo</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">)</span>
        <span class="n">cpevenInfo</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CPEven&#39;</span>
        <span class="n">cpevenInfo</span><span class="p">[</span><span class="s1">&#39;pmom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
                <span class="c1">## NOT FEASABLE, too much memory me thinks...</span>
                <span class="n">DoAuto</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># raise EnvironmentError(&#39;Autocorrelation analysis not implemented for combining Alpha Fulls&#39;)</span>

            <span class="c1">## TODO, autocorrelation needs to be done for combining correlators...</span>
            <span class="kn">from</span> <span class="nn">SetsOfTwoPtCorrs</span> <span class="k">import</span> <span class="n">SetOfTwoPt</span>
            <span class="n">sinklab</span><span class="p">,</span><span class="n">jsmcoeffs</span><span class="p">,</span><span class="n">sm2ptList</span><span class="p">,</span><span class="n">InfoList</span> <span class="o">=</span> <span class="n">GetInfoList</span><span class="p">(</span><span class="n">cpevenInfo</span><span class="p">)</span>
            <span class="n">C2Set</span> <span class="o">=</span> <span class="n">SetOfTwoPt</span><span class="p">(</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span><span class="n">InfoDict</span> <span class="o">=</span> <span class="n">InfoList</span><span class="p">)</span>
            <span class="n">C2Set</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># for iset in C2Set.SetC2.values():</span>
            <span class="c1">#     if len(iset.C2) == 0 and DoAuto:</span>
            <span class="c1">#         iset.LoadPickle(DefWipe=True,CheckCfgs=True,CheckMom=True,WipeData=not DoAuto)</span>
            <span class="n">thisname</span><span class="p">,</span><span class="n">thisleglab</span><span class="p">,</span><span class="n">jsmlab</span> <span class="o">=</span> <span class="n">CreateNameAndLL</span><span class="p">(</span><span class="n">C2Set</span><span class="o">.</span><span class="n">SetC2</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="n">thisfun</span> <span class="o">=</span> <span class="n">GenSinkFun</span><span class="p">(</span><span class="n">jsmcoeffs</span><span class="p">)</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="n">thisLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsm</span><span class="p">,</span><span class="n">sinklab</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,</span><span class="n">thisLL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsm</span> <span class="o">=</span> <span class="n">jsmlab</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span> <span class="o">=</span> <span class="n">C2Set</span><span class="o">.</span><span class="n">CombineCorrs</span><span class="p">(</span><span class="n">thisfun</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">thisfile</span><span class="p">,</span><span class="n">LegLab</span><span class="o">=</span><span class="n">thisLL</span><span class="p">,</span><span class="n">jsmlab</span><span class="o">=</span><span class="n">jsmlab</span><span class="p">)</span>
            <span class="n">thisname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ForAlpha&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">thisname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span><span class="n">cpevenInfo</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="c1"># self.NNCPEven = self.NNCPEven.GetCombCorr(cpevenInfo)</span>
            <span class="n">thisname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ForAlpha&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">thisname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="ow">not</span> <span class="n">DoAuto</span><span class="p">)</span>
            <span class="c1"># if &#39;C2&#39; not in self.NNCPEven.C2_cfgs and DoAuto:</span>
            <span class="c1">#     self.NNCPEven.LoadPickle(DefWipe=True,CheckCfgs=True,CheckMom=True,WipeData=not DoAuto)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NNCPEven complete: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="c1"># if DoAuto and &#39;NNQFull&#39; in self.NNQFull_cfgs and self.IsComb:</span>
        <span class="c1">#     raise EnvironmentError(&#39;Autocorrelation analysis not implemented for Alpha Full&#39;)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RatioNNQ2sub</span><span class="p">(</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="n">DefWipeG2</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="n">DoAuto</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span> <span class="n">show_timer</span><span class="p">)</span>
            <span class="k">return</span>


        <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ict_sum</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
            <span class="n">it_sum</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">)</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">))</span>
            <span class="n">idata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">idata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                <span class="n">q_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span>
                <span class="n">q_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;q(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">q_data</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                    <span class="n">P5NN_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;P5C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span>
                    <span class="n">P5NN_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C2(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">P5NN_data</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;OnlySub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="p">((</span><span class="n">q_boot</span> <span class="o">*</span> <span class="n">P5NN_boot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thisboot</span> <span class="o">-</span> <span class="p">((</span><span class="n">q_boot</span> <span class="o">*</span> <span class="n">P5NN_boot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thisboot</span> <span class="o">-</span> <span class="n">q_boot</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print &#39;iscomb&#39;,self.IsComb</span>
            <span class="c1"># print &#39;nncpeven&#39;,self.NNCPEven</span>
            <span class="c1"># print &#39;nncpodd&#39;,self.NN</span>
            <span class="c1"># print &#39;flow&#39;,self.FOFull</span>
            <span class="c1"># print (ip,it,itflow, idata.Avg,idata.Std,</span>
            <span class="c1">#                     self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Avg,self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Std,</span>
            <span class="c1">#                     thisboot.Avg, thisboot.Std)</span>
            <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">))</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>

        <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor Int &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span> <span class="k">continue</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="n">idata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">idata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Qsub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Q2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNSingQ2sub</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                <span class="n">q_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOpInt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
                <span class="n">q_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;q(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">q_data</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                    <span class="n">P5NN_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2Int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
                    <span class="n">P5NN_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C2(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">P5NN_data</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;OnlySub&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr_sum_type</span><span class="p">:</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="p">((</span><span class="n">q_boot</span> <span class="o">*</span> <span class="n">P5NN_boot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thisboot</span> <span class="o">-</span> <span class="p">((</span><span class="n">q_boot</span> <span class="o">*</span> <span class="n">P5NN_boot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thisboot</span> <span class="o">-</span> <span class="n">q_boot</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print &#39;iscomb&#39;,self.IsComb</span>
            <span class="c1"># print &#39;nncpeven&#39;,self.NNCPEven</span>
            <span class="c1"># print &#39;nncpodd&#39;,self.NN</span>
            <span class="c1"># print &#39;flow&#39;,self.FOFull</span>
            <span class="c1"># print (ip,it,itflow, idata.Avg,idata.Std,</span>
            <span class="c1">#                     self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Avg,self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Std,</span>
            <span class="c1">#                     thisboot.Avg, thisboot.Std)</span>
            <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: no NNQInt was found for:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>


        <span class="k">if</span> <span class="n">DoAuto</span> <span class="ow">and</span> <span class="s1">&#39;NNQFull&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="n">thisfuns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RatFunAndDer</span><span class="p">()</span>
            <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ict_sum</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
                <span class="n">tsum_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">)</span>
                <span class="n">it_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># cant do these checks XO.... dictionaries are better!</span>
                <span class="c1"># if ip not in self.NNCPEven.C2.keys(): continue</span>
                <span class="c1"># if it not in self.NNCPEven.C2[ip].keys(): continue</span>
                <span class="c1"># if (&#39;C2&#39; not in self.NNCPEven.C2_cfgs</span>
                <span class="c1">#     or icp*self.nt+ict &gt;= self.NNCPEven.C2_cfgs[&#39;C2&#39;].size): continue</span>
                <span class="n">auto_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
                    <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;FlowOp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                        <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;P5C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span>

                <span class="c1"># print &#39;debug&#39;,idata[5],twoptdata[5]</span>
                <span class="c1"># if len(idata) != len(twoptdata):</span>
                <span class="c1">#     errorstr = &#39;&#39;&#39;</span>
                <span class="c1">#     NNQ and NN have different configuration lists, \n</span>
                <span class="c1">#     maybe force delete the pickled files for NN, \n</span>
                <span class="c1">#     or select a different -stats from- directory corresponding to operator Q or W</span>
                <span class="c1">#     &#39;&#39;&#39;</span>
                <span class="c1">#     raise EnvironmentError(errorstr)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">))</span>

                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="n">thisfuns</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span> \
                                                    <span class="s1">&#39;\ &#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$ &#39;</span><span class="o">+</span>\
                                                    <span class="n">tsum_str</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">auto_df</span><span class="p">,</span><span class="n">save_covar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>


            <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor Int &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
                <span class="n">it_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># cant do these checks XO.... dictionaries are better!</span>
                <span class="c1"># if ip not in self.NNCPEven.C2.keys(): continue</span>
                <span class="c1"># if it not in self.NNCPEven.C2[ip].keys(): continue</span>
                <span class="c1"># if (&#39;C2&#39; not in self.NNCPEven.C2_cfgs</span>
                <span class="c1">#     or icp*self.nt+ict &gt;= self.NNCPEven.C2_cfgs[&#39;C2&#39;].size): continue</span>
                <span class="n">auto_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_improved</span><span class="p">:</span>
                    <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;FlowOpInt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOpInt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_P5NNQsub</span><span class="p">:</span>
                        <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;C2Int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2Int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
                <span class="c1"># print &#39;debug&#39;,idata[5],twoptdata[5]</span>
                <span class="c1"># if len(idata) != len(twoptdata):</span>
                <span class="c1">#     errorstr = &#39;&#39;&#39;</span>
                <span class="c1">#     NNQ and NN have different configuration lists, \n</span>
                <span class="c1">#     maybe force delete the pickled files for NN, \n</span>
                <span class="c1">#     or select a different -stats from- directory corresponding to operator Q or W</span>
                <span class="c1">#     &#39;&#39;&#39;</span>
                <span class="c1">#     raise EnvironmentError(errorstr)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>

                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="n">thisfuns</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">auto_df</span><span class="p">,</span><span class="n">save_covar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;NNQFull&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;NNQInt&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;FlowOp&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOp&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;FlowOpInt&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;FlowOpInt&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;P5C2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;P5C2&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;C2Int&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;C2Int&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span></div>

<div class="viewcode-block" id="NNQFullCorr.RatioNNQ2sub"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.RatioNNQ2sub">[docs]</a>    <span class="k">def</span> <span class="nf">RatioNNQ2sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipeG2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoAuto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bootstrap &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ict_sum</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),(</span><span class="n">jct_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
            <span class="n">it_sum</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">)</span>
            <span class="n">jt_sum</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">jt_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tss&#39;</span><span class="p">)</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">))</span>
            <span class="c1"># idata.Stats()</span>
            <span class="n">NNq2_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">][</span><span class="n">jct_sum</span><span class="p">])</span>
            <span class="n">NNq2_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQ2(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">NNq2_data</span><span class="p">)</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span> <span class="o">-</span> <span class="n">NNq2_boot</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print &#39;iscomb&#39;,self.IsComb</span>
            <span class="c1"># print &#39;nncpeven&#39;,self.NNCPEven</span>
            <span class="c1"># print &#39;nncpodd&#39;,self.NN</span>
            <span class="c1"># print &#39;flow&#39;,self.FOFull</span>
            <span class="c1"># print (ip,it,itflow, idata.Avg,idata.Std,</span>
            <span class="c1">#                     self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Avg,self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Std,</span>
            <span class="c1">#                     thisboot.Avg, thisboot.Std)</span>
            <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">))</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>

        <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor Int &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                        <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="c1"># idata.Stats()</span>
            <span class="n">NNq2_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2Int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
            <span class="n">NNq2_boot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQ2(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">NNq2_data</span><span class="p">)</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span> <span class="o">-</span> <span class="n">NNq2_boot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print &#39;iscomb&#39;,self.IsComb</span>
            <span class="c1"># print &#39;nncpeven&#39;,self.NNCPEven</span>
            <span class="c1"># print &#39;nncpodd&#39;,self.NN</span>
            <span class="c1"># print &#39;flow&#39;,self.FOFull</span>
            <span class="c1"># print (ip,it,itflow, idata.Avg,idata.Std,</span>
            <span class="c1">#                     self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Avg,self.NNCPEven.C2_Stats[&#39;boot&#39;][ip,it].Std,</span>
            <span class="c1">#                     thisboot.Avg, thisboot.Std)</span>
            <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Alphaboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">DoAuto</span> <span class="ow">and</span> <span class="s1">&#39;NNQFull&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="n">thisfuns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RatFunAndDer</span><span class="p">()</span>
            <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_spec_tsum_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ict_sum</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),(</span><span class="n">jct_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
                <span class="n">tsum_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">)</span>
                <span class="n">jtsum_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">jt_sum</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tss&#39;</span><span class="p">)</span>
                <span class="n">it_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># cant do these checks XO.... dictionaries are better!</span>
                <span class="c1"># if ip not in self.NNCPEven.C2.keys(): continue</span>
                <span class="c1"># if it not in self.NNCPEven.C2[ip].keys(): continue</span>
                <span class="c1"># if (&#39;C2&#39; not in self.NNCPEven.C2_cfgs</span>
                <span class="c1">#     or icp*self.nt+ict &gt;= self.NNCPEven.C2_cfgs[&#39;C2&#39;].size): continue</span>
                <span class="n">auto_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;NNQ2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">][</span><span class="n">ict_sum</span><span class="p">][</span><span class="n">jct_sum</span><span class="p">])</span>
                <span class="c1"># print &#39;debug&#39;,idata[5],twoptdata[5]</span>
                <span class="c1"># if len(idata) != len(twoptdata):</span>
                <span class="c1">#     errorstr = &#39;&#39;&#39;</span>
                <span class="c1">#     NNQ and NN have different configuration lists, \n</span>
                <span class="c1">#     maybe force delete the pickled files for NN, \n</span>
                <span class="c1">#     or select a different -stats from- directory corresponding to operator Q or W</span>
                <span class="c1">#     &#39;&#39;&#39;</span>
                <span class="c1">#     raise EnvironmentError(errorstr)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">,</span><span class="n">jtsum_str</span><span class="p">))</span>

                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="n">thisfuns</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span>   <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span> \
                                                    <span class="s1">&#39;\ &#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$ &#39;</span><span class="o">+</span><span class="n">tsum_str</span><span class="o">+</span><span class="n">jtsum_str</span><span class="p">,</span>
                                            <span class="n">data</span><span class="o">=</span><span class="n">auto_df</span><span class="p">,</span><span class="n">save_covar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">tsum_str</span><span class="p">,</span><span class="n">jtsum_str</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>


            <span class="n">lAl</span><span class="p">,</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">lAlStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">this_gen</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autcor Int &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">pform</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_nt_list</span><span class="p">),</span>
                                            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">icp</span><span class="p">,</span><span class="n">ip</span><span class="p">),(</span><span class="n">ict</span><span class="p">,</span><span class="n">it</span><span class="p">),(</span><span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">:</span>
                <span class="n">it_str</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># cant do these checks XO.... dictionaries are better!</span>
                <span class="c1"># if ip not in self.NNCPEven.C2.keys(): continue</span>
                <span class="c1"># if it not in self.NNCPEven.C2[ip].keys(): continue</span>
                <span class="c1"># if (&#39;C2&#39; not in self.NNCPEven.C2_cfgs</span>
                <span class="c1">#     or icp*self.nt+ict &gt;= self.NNCPEven.C2_cfgs[&#39;C2&#39;].size): continue</span>
                <span class="n">auto_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;CPEven&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNCPEven</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">auto_df</span><span class="p">[</span><span class="s1">&#39;NNQ2Int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2Int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">icp</span><span class="p">][</span><span class="n">ict</span><span class="p">][</span><span class="n">ictflow</span><span class="p">])</span>
                <span class="c1"># print &#39;debug&#39;,idata[5],twoptdata[5]</span>
                <span class="c1"># if len(idata) != len(twoptdata):</span>
                <span class="c1">#     errorstr = &#39;&#39;&#39;</span>
                <span class="c1">#     NNQ and NN have different configuration lists, \n</span>
                <span class="c1">#     maybe force delete the pickled files for NN, \n</span>
                <span class="c1">#     or select a different -stats from- directory corresponding to operator Q or W</span>
                <span class="c1">#     &#39;&#39;&#39;</span>
                <span class="c1">#     raise EnvironmentError(errorstr)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it_str</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>

                <span class="n">thisAuto</span> <span class="o">=</span>  <span class="n">AutoCorrelate</span><span class="p">(</span>  <span class="n">Fun</span><span class="o">=</span><span class="n">thisfuns</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ip</span><span class="o">+</span><span class="s1">&#39; $t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">auto_df</span><span class="p">,</span><span class="n">save_covar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">lAl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lAlAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lAlStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_col_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAuto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AlphaAutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAlStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;NNQFull&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQFull&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;NNQInt&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQInt&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;NNQ2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;NNQ2Int&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;NNQ2Int&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span></div>


    <span class="c1"># def ReadAndBootAndEffM(self,DefWipe=False):</span>
    <span class="c1">#     if os.path.isfile(self.PickleFile) and not DefWipe:</span>
    <span class="c1">#         self.LoadPickle()</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self.ReadAndBoot()</span>
    <span class="c1">#         self.EffMass()</span>

<div class="viewcode-block" id="NNQFullCorr.RemoveAllBoots"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.RemoveAllBoots">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveAllBoots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">RemoveAllBoots</span><span class="p">)</span></div>


<div class="viewcode-block" id="NNQFullCorr.Write"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="c1"># self.FOFull.FlowWrite()</span>
        <span class="c1"># if not self.IsComb:</span>
        <span class="c1">#     self.NN.Write()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsComb</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Not outputted&#39;</span>
        <span class="c1">#     self.NN.HumanFile = self.NN.HumanFile.replace(self.NN.jsm,self.jsm)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;FlowOp_File&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;TwoPtCorr_CPEven_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CPEvenFile</span>
        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>

        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Default (see FitFunctions.py)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">thispar</span> <span class="o">=</span> <span class="s1">&#39;Par&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iparam</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="s1">&#39;Initial_Guess&#39;</span><span class="p">][</span><span class="n">thispar</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlphaiGuess</span><span class="p">[</span><span class="n">iparam</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">fitdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitdict</span><span class="p">,</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span> <span class="k">continue</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitdict</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>


        <span class="c1"># if &#39;boot&#39; in self.Tau_Fit_Stats:</span>
        <span class="c1">#     for (ifitr,imom,itsink,itflow),idata in self.Tau_Fit_Stats[&#39;boot&#39;].iteritems():</span>
        <span class="c1">#         if isinstance(idata,ff.Fitting):</span>
        <span class="c1">#             continue</span>
        <span class="c1">#         outDict[&#39;Tau_Fits&#39;][imom][itflow][itsink][ifitr] = fitdict.GetOutputDict()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NNQ2sub</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">col_key</span><span class="p">,</span><span class="n">col_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQ_subNNQ2_Stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Avg&#39;</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="ow">or</span> <span class="s1">&#39;Std&#39;</span> <span class="ow">in</span> <span class="n">col_key</span><span class="p">:</span> <span class="k">continue</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">,</span><span class="n">jt_sum</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">col_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="n">col_key</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it_sum</span><span class="p">][</span><span class="n">jt_sum</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col_key</span><span class="p">,</span><span class="n">col_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;Avg&#39;</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="ow">or</span> <span class="s1">&#39;Std&#39;</span> <span class="ow">in</span> <span class="n">col_key</span><span class="p">:</span> <span class="k">continue</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">col_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="n">col_key</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it_sum</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">col_key</span><span class="p">,</span><span class="n">col_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;Avg&#39;</span> <span class="ow">in</span> <span class="n">col_key</span> <span class="ow">or</span> <span class="s1">&#39;Std&#39;</span> <span class="ow">in</span> <span class="n">col_key</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">col_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span><span class="s1">&#39;Avg&#39;</span><span class="p">):</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="n">col_key</span><span class="o">+</span><span class="s1">&#39;_Int&#39;</span><span class="p">][</span><span class="n">ip</span><span class="p">][</span><span class="n">it</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveVals</span><span class="p">()</span>

        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>
        <span class="c1">## pickles rest of data for reading</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span><span class="p">),</span><span class="n">ixsrc_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">icfg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;n_xsrc_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ixsrc_list</span><span class="p">))</span>
        <span class="c1">## TODO, include fitting in the excell file</span>
        <span class="n">WriteExcel</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,{</span><span class="s1">&#39;NNQFull_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">),</span>
                                    <span class="s1">&#39;NNQInt_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">)},</span>
                    <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.stats&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.stats&#39;</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;NNQFull_Stats&#39;</span><span class="p">]</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="n">out_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>
        <span class="c1">##################################</span>

<div class="viewcode-block" id="NNQFullCorr.ReadAndWrite"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.ReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">SaveMem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">NoFit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">(</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">SaveMem</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveAllBoots</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>


<div class="viewcode-block" id="NNQFullCorr.FixRead"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Info</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFull&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flowPickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFull</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNQFull_Fit_col_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_col_names</span>
        <span class="c1">## this is to check updated function</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Fun&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;Fun&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Fun&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Fun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fun</span>
                <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;npar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npar</span>
                <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNQFull_Fit_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;PickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;ExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;HumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNQFull_Fit_col_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_col_names</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;pform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pform</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;boot_tsum_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNfile&#39;</span><span class="p">]):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;NNfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNfile</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFullfile&#39;</span><span class="p">]):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FOFullfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FOFullfile</span>
        <span class="k">if</span> <span class="s1">&#39;is_improved&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;is_improved&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if not os.path.isfile(readdict[&#39;ppparams&#39;].PickleFile):</span>
        <span class="c1">#     readdict[&#39;ppparams&#39;].PickleFile = self.ppparams.PickleFile</span>
        <span class="c1">#     readdict[&#39;ppparams&#39;].HumanFile = self.ppparams.HumanFile</span>
        <span class="c1">#     readdict[&#39;qparams&#39;].PickleFile = self.qparams.PickleFile</span>
        <span class="c1">#     readdict[&#39;qparams&#39;].HumanFile = self.qparams.HumanFile</span>
        <span class="c1">#     readdict[&#39;Info&#39;][&#39;outdir&#39;] = self.Info[&#39;outdir&#39;]</span>
        <span class="k">return</span> <span class="n">readdict</span></div>

    <span class="c1">## TODO: Pickle load and dump self.NN and self.FOFull from their respective directories.</span>
    <span class="c1">##       At this point, I am just dumping this whole class instead. (doubles up data)</span>
<div class="viewcode-block" id="NNQFullCorr.LoadPickle"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">SaveMem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading Pickle&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
        <span class="n">read_pickle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">stream_name</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">legacy</span><span class="p">:</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;NNQFull_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckMom</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span>
            <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">pformTOpstr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">nopref</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQInt_Stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQInt_Stats&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loading pickle:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;NNQFull_Stats_name&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats_name</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">Wipe_All_Fits</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file, fits need to be recomputed&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting legacy file read&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span>
                <span class="c1"># self.ReadAndWrite(WipeData=WipeData)</span>
            <span class="c1"># self.Write()</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;NNQFull_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckMom</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span>
            <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;checkmomlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">pformTOpstr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">nopref</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQFull_Stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;momentum&#39;</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;AlphaAuto&#39;</span> <span class="ow">in</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;NNQInt_Stats&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file found, reading and writing to proper file&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">SaveMem</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">RemoveAllBoots</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;temp&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using legacy backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">CheckMom</span><span class="o">=</span><span class="n">CheckMom</span><span class="p">,</span><span class="n">legacy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, legacy file &#39;</span> <span class="p">,</span> <span class="n">read_pickle</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;temp&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">SaveMem</span><span class="o">=</span><span class="n">SaveMem</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pickle file not found:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;or legacy file&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">read_pickle</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;temp&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">SaveMem</span><span class="o">=</span><span class="n">SaveMem</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span></div>
    <span class="c1">## Operator overloading</span>


    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span>

<div class="viewcode-block" id="NNQFullCorr.sin"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.sin">[docs]</a>    <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQFullCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                         <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="NNQFullCorr.cos"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.cos">[docs]</a>    <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQFullCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                         <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="NNQFullCorr.Overload_wrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.NNQFullCorr.Overload_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">Overload_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">this_fun</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">NNQFullCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_cfgs</span><span class="p">[[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;xsrc_list&#39;</span><span class="p">]],</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQFull_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,self,NNQFull2)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">NNQFullCorr</span><span class="p">):</span>
            <span class="c1"># for (ip,it,itflow,it_sum),iNNQFull in self.NNQFull_Stats[&#39;boot&#39;].iteritems():</span>
            <span class="c1">#     print &#39;DEBUG&#39;,ip,it,itflow,it_sum</span>
            <span class="c1">#     if (ip,it,itflow,it_sum) not in NNQFull2.NNQFull_Stats.index: continue</span>
                <span class="n">result</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span>
                                                                <span class="n">NNQFull2</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                <span class="k">if</span>  <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span>   <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span>
                                                                    <span class="n">NNQFull2</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">iNNQFull</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="n">NNQ_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">result</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQFull</span><span class="p">,</span> <span class="n">NNQFull2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)])</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">it_sum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span>
                                                                                <span class="n">NNQFull2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">iNNQFull</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">result</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQFull</span><span class="p">,</span> <span class="n">NNQFull2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">it_sum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span>
                                                                        <span class="n">NNQFull2</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">iNNQFull</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">result</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_sum</span><span class="p">)]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">iNNQFull</span><span class="p">,</span> <span class="n">NNQFull2</span><span class="p">[</span><span class="n">itflow</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">it_sum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">boot_tsum_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span> <span class="n">NNQFull2</span><span class="p">[</span><span class="n">itflow</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span> <span class="n">NNQFull2</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span> <span class="n">NNQFull2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">),</span> <span class="n">NNQFull2</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQFull_Stats</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NNQInt_Stats</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with NNQFullCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="n">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">)</span>


    <span class="c1">## Right multiplication functions</span>


    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">add</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">sub</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">mul</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NNQFull2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">NNQFullCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">NNQFull2</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Overload_wrap</span><span class="p">(</span><span class="n">NNQFull2</span><span class="p">,</span><span class="n">flip_fun_2arg</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">pow</span><span class="p">))</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr">[docs]</a><span class="k">class</span> <span class="nc">FlowedTwoPtCorr</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; C2(t_f,t) uses bootstrap class</span>
<span class="sd">        t_f = flow time</span>
<span class="sd">        t = time</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SetOfCorrs.SetOfTwoPt&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQCorr&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQFullCorr&#39;</span><span class="p">,</span><span class="s1">&#39;VarMethod.VariationalTwoPt&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span><span class="n">Info</span><span class="o">=</span><span class="p">{},</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;nt&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## Initialising plotting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>
        <span class="c1">## the actual shift ammount needs to be scaled by the x axis size</span>
        <span class="c1">## see GetShift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>

        <span class="c1">#self.C2 = [ ip , it , ,istream , iconf ]</span>
        <span class="c1"># self.C2     = np.array([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_cfgs DataFrame:</span>

<span class="sd">        columns =   config_numbers , Op[itflow, it]</span>

<span class="sd">        rows =      stream , configuration</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span><span class="s1">&#39;source_sink_separation&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_Stats DataFrame:</span>

<span class="sd">        columns =   boot,   Avg,        Std</span>
<span class="sd">                    EffM,   EffMAvg,    EffMStd</span>

<span class="sd">        rows =      flow_time, time separation</span>
<span class="sd">        &#39;&#39;&#39;</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_fit_range&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.C2_Fit_Stats DataFrame:</span>

<span class="sd">        columns =   boot,   Avg,        Std</span>

<span class="sd">        rows =      states fitted to, flow_time, time fit range</span>

<span class="sd">        Avg/Std elements are pa.Series instances with:</span>
<span class="sd">            index = fit parameters</span>
<span class="sd">            values = Avg/Std values</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="c1"># # FitDict = [ States_Fitted_To, ip, Fit_range ] fitting class</span>
        <span class="c1"># self.FitDict    = ODNested()</span>
        <span class="c1"># # FitDictAvg/Std [ States_Fitted_To , ip ,  Fit_range , Fit_Parameter ] bs</span>
        <span class="c1"># self.FitDictAvg = ODNested()</span>
        <span class="c1"># self.FitDictStd = ODNested()</span>


        <span class="k">if</span> <span class="s1">&#39;Adjoint_Flow&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Adjoint_Flow&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>


        <span class="c1">## toggle to show exact configurations and sources used in xml outputfiles</span>
        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## used to pick out different configuraiton/source lists.</span>
        <span class="c1">## for example, if there are less flowed operators than 2 point correlators, passing &#39;TopCharge&#39; will read that result</span>
        <span class="k">if</span> <span class="s1">&#39;fo_for_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;fo_for_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="kc">False</span>



        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;Fits&#39;] = [ (&#39;state#&#39; , &#39;fit#-#&#39; ) , ...]</span>
        <span class="k">if</span> <span class="s1">&#39;Fits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span> <span class="o">=</span> <span class="p">[]</span>



        <span class="c1">## Info can contain projector used (or type of meson in psibar Gamma psi)</span>
        <span class="k">if</span> <span class="s1">&#39;MesOrBar&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;MesOrBar&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span> <span class="o">=</span> <span class="s1">&#39;Meson&#39;</span> <span class="c1">## Default to baryon</span>


        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;iGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>

        <span class="c1">## will attempt to find all replica streams in directory.</span>
        <span class="c1">## set self.nstream to number of streams you want to find.</span>
        <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">iinfo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">iinfo</span> <span class="ow">in</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>


        <span class="c1"># ## x_source list has been pushed to cfglist, this is depriciated</span>
        <span class="c1"># if &#39;xsrc&#39; in Info.keys(): self.xsrc = [&#39;xsrc&#39;+str(isrc) f</span>
        <span class="c1"># else: self.xsrc = [&#39;xsrc1&#39;]</span>

        <span class="c1">## kappa up down (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">listout</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">## this is used display only these flowtimes, Still reads and writes all</span>
        <span class="k">if</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">defxlimOp</span> <span class="c1">## default to read all flow times</span>

        <span class="k">for</span> <span class="n">ict</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;t_f&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">itflow</span><span class="p">):</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">listout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^</span><span class="si">{3}</span><span class="s1">\times &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span> <span class="o">=</span> <span class="n">datadir</span><span class="o">+</span><span class="s1">&#39;Flow/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;-*-/&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Create_Streams_Dirs</span><span class="p">()</span>
        <span class="c1">## cfglist { configuration : [ x-source numbers ] }</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="n">Info</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span> <span class="o">=</span> <span class="mf">1.0</span>


    <span class="c1"># ## thisInfo must contain correct information for combining the correlators (the smearings, the eigenvectors, etc...)</span>
    <span class="c1"># def GetCombCorr(self,thisInfo):</span>
    <span class="c1">#     from SetsOfTwoPtCorrs import SetOfTwoPt</span>
    <span class="c1">#     sinklab,jsmcoeffs,sm2ptList,InfoList = GetInfoList(thisInfo)</span>

    <span class="c1">#     C2Set = SetOfTwoPt(cfglist=self.NNQ_cfgs[[&#39;configs&#39;,&#39;xsrc_list&#39;]],InfoDict = InfoList)</span>
    <span class="c1">#     C2Set.LoadPickle(CheckCfgs=CheckCfgs)</span>
    <span class="c1">#     thisname,thisleglab,jsmlab = CreateNameAndLL(C2Set.SetC2,sinklab)</span>
    <span class="c1">#     thisfun = GenSinkFun(jsmcoeffs)</span>
    <span class="c1">#     thisfile = self.filename.replace(self.jsm,sinklab)</span>
    <span class="c1">#     thisLL = self.LegLab.replace(self.jsm,sinklab)</span>
    <span class="c1">#     # self.SetCustomName(thisfile,thisLL)</span>
    <span class="c1">#     # self.jsm = jsmlab</span>
    <span class="c1">#     return C2Set.CombineCorrs(thisfun,filename=thisfile,LegLab=thisLL,jsmlab=jsmlab)</span>

<div class="viewcode-block" id="FlowedTwoPtCorr.Create_Streams_Dirs"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Create_Streams_Dirs">[docs]</a>    <span class="k">def</span> <span class="nf">Create_Streams_Dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">All_Streams</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Check_Streams</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">thisdir</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.All_Streams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.All_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">All_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)):</span>
            <span class="n">this_stream</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">this_stream</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_stream</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> No Streams found&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.Check_Streams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Check_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">Check_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">))</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">this_check</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">this_check</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> stream directory not found, as well as </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.GetCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.GetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">CheckCfgFolder</span><span class="p">(</span><span class="n">thisdir</span><span class="p">):</span>
            <span class="n">outbool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisdir</span><span class="o">+</span><span class="s1">&#39;/_Adjoint_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">outbool</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisdir</span><span class="o">+</span><span class="s1">&#39;/_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

        <span class="n">cfglist</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">idir</span> <span class="o">=</span> <span class="n">idir</span> <span class="o">+</span> <span class="s1">&#39;Comb/&#39;</span>
            <span class="k">for</span> <span class="n">icfg</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">)):</span>
                <span class="k">if</span> <span class="s1">&#39;cfg&#39;</span> <span class="ow">in</span> <span class="n">ifile</span> <span class="ow">and</span> <span class="n">CheckCfgFolder</span><span class="p">(</span><span class="n">ifile</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span>
                    <span class="n">cfglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ifile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;cfg&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No configs found for directory:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; , &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span><span class="p">))</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
        <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">cfglist</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">cfg_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;int_configs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">cfg_df</span><span class="p">[</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfg_df</span><span class="p">)</span></div>



    <span class="c1"># def MakeOutputFile(self):</span>
    <span class="c1">#     self.name = &#39;_&#39;.join([self.tsrc,self.ism,self.jsm])</span>
    <span class="c1">#     self.HumanFile = &#39;/&#39;+self.kappafolder+&#39;/G2/&#39;+self.name+&#39;.xml&#39;</span>
    <span class="c1">#     self.PickleFile = &#39;/&#39;+self.kappafolder+&#39;/G2/Pickle/&#39;+self.name+&#39;.py3p&#39;</span>


    <span class="c1">## Routines for Plotting ###############################################</span>

<div class="viewcode-block" id="FlowedTwoPtCorr.ImportPlotParams"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.ImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">ImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.CheckCol"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.CheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">CheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thiscol</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in color to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.CheckSym"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.CheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">CheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thissym</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in symbol to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.GetShift"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.GetShift">[docs]</a>    <span class="k">def</span> <span class="nf">GetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># if self.thisshiftscale == &#39;Not Set&#39;:</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span></div>
        <span class="c1"># else:</span>
        <span class="c1">#     return self.thisshiftscale</span>




    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.LogPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.LogPlot">[docs]</a>    <span class="k">def</span> <span class="nf">LogPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlim</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_times&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_times&#39;</span><span class="p">)</span>
            <span class="n">tlist</span><span class="p">,</span><span class="n">databoot</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                <span class="n">scale</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">Avg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="n">logdata</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span><span class="o">/</span><span class="n">scale</span>
                <span class="n">logdata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logdata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">tlist</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39;$\ &#39;</span><span class="o">+</span> <span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span><span class="o">=</span><span class="n">scale</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>

    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.Plot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Plot">[docs]</a>    <span class="k">def</span> <span class="nf">Plot</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">defxlim</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
            <span class="n">tlist</span><span class="p">,</span><span class="n">databoot</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">pdata</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">scale</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">Avg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">databoot</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">/</span><span class="n">scale</span>
                <span class="n">data</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">tlist</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Scale</span><span class="o">=</span><span class="n">scale</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># plot_class.get_xlim(*xlims)</span>


    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.EffMassPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.EffMassPlot">[docs]</a>    <span class="k">def</span> <span class="nf">EffMassPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="n">defxlim</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoPhys</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">thisval</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">hbarcdivlat</span>
            <span class="n">thisval</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">thisval</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1">## resets thisshiftscale so that you can plot EffMass and Log plot next to eachother,</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="n">m_getattr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Phys</span><span class="p">:</span> <span class="n">pdata</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoPhys</span><span class="p">)</span>
            <span class="n">dataavg</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">m_getattr</span><span class="p">,</span><span class="s1">&#39;Avg&#39;</span><span class="p">))</span>
            <span class="n">dataerr</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">m_getattr</span><span class="p">,</span><span class="s1">&#39;Std&#39;</span><span class="p">))</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">dataavg</span> <span class="o">=</span> <span class="n">dataavg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">dataerr</span> <span class="o">=</span> <span class="n">dataerr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="c1">## np.abs makes negative effective masses coming from G2^-1 be positive.</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39;$\ &#39;</span><span class="o">+</span> <span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.FlowRatPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.FlowRatPlot">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRatPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="n">defxlim</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoStats</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="c1"># thisval = value*self.latparams.hbarcdivlat</span>
            <span class="n">thisvalue</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># thisvalue = thisvalue.Log()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisvalue</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span> <span class="n">thisvalue</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">thisvalue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1">## resets thisshiftscale so that you can plot EffMass and Log plot next to eachother,</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="n">m_getattr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="s1">&#39; not found in effective mass list&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;t_f0.00&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoStats</span><span class="p">)</span>
            <span class="n">dataavg</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">m_getattr</span><span class="p">,</span><span class="s1">&#39;Avg&#39;</span><span class="p">))</span>
            <span class="n">dataerr</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">m_getattr</span><span class="p">,</span><span class="s1">&#39;Std&#39;</span><span class="p">))</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">pdata</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">dataavg</span> <span class="o">=</span> <span class="n">dataavg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">dataerr</span> <span class="o">=</span> <span class="n">dataerr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

            <span class="c1">## np.abs makes negative effective masses coming from G2^-1 be positive.</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39;$\ &#39;</span><span class="o">+</span> <span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.AllFlowRatPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.AllFlowRatPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AllFlowRatPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">tsink</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoStats</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="c1"># thisval = value*self.latparams.hbarcdivlat</span>
            <span class="n">thisvalue</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># thisvalue = thisvalue.Log()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisvalue</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span> <span class="n">thisvalue</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">thisvalue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1">## resets thisshiftscale so that you can plot EffMass and Log plot next to eachother,</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thisshiftscale</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">([</span><span class="n">untflowstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">untflowstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span><span class="p">,</span><span class="n">tlist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
            <span class="n">pdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)[</span><span class="n">tsink</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;t_f0.00&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)[</span><span class="n">tsink</span><span class="p">]</span>
            <span class="c1"># pdata = pdata.Log()</span>
            <span class="n">pdata</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">itflow</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1">## np.abs makes negative effective masses coming from G2^-1 be positive.</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlist</span><span class="p">)))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39;$\ &#39;</span><span class="o">+</span> <span class="n">tsinkTOLeg</span><span class="p">(</span><span class="n">tsink</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after LogPlot or the xlims wont work properly</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.LogFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.LogFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">LogFitPlot</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span>
                    <span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span> <span class="s1">&#39; not found in FitDict, performing fit now&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),[</span><span class="n">fitr</span><span class="p">])</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;log_fit&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">]</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after EffMassPlot or the xlims wont work properly</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.EffMassFitPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.EffMassFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">EffMassFitPlot</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span> <span class="s1">&#39; not found in FitDict, performing fit now&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),[</span><span class="n">fitr</span><span class="p">])</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;effm_fit&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">]</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">fitr</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phys</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
    <span class="c1">## ##################### ###############################################</span>

    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
    <span class="c1">## make sure to plot this after EffMassPlot or the xlims wont work properly</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.RecRelPlot"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.RecRelPlot">[docs]</a>    <span class="k">def</span> <span class="nf">RecRelPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DoPhys</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">thisval</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">hbarcdivlat</span>
            <span class="n">thisval</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">thisval</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="c1"># fitr_params = self.FitDict[state][fitr]</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">plotx</span><span class="p">,</span><span class="n">plotxerr</span> <span class="o">=</span> <span class="p">[],[],[],[]</span>
        <span class="k">for</span> <span class="n">imom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;flow_time&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">imom</span><span class="p">,</span><span class="n">fitr</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">imom</span><span class="p">,</span><span class="n">fitr</span> <span class="p">,</span> <span class="s1">&#39; has not been done, performing fit now&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),[</span><span class="n">fitr</span><span class="p">])</span>
            <span class="n">this_fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">,</span><span class="n">imom</span><span class="p">,</span><span class="n">fitr</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fit</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="n">this_fit</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span>
            <span class="n">thiszboot</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Phys</span><span class="p">:</span>
                <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thisboot</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">hbarcdivlat</span>
                <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">xboot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">EnergyFromRecRel</span><span class="p">(</span><span class="n">imom</span><span class="p">,</span><span class="n">thiszboot</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Phys</span><span class="p">:</span>
                <span class="n">xboot</span> <span class="o">=</span> <span class="n">xboot</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">hbarcdivlat</span>
            <span class="n">xboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">plotxerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShift</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">plotx</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">plotx</span><span class="p">)),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotxerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;effm_fit&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">state</span><span class="p">,</span><span class="n">fitr</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LogScale</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phys</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>



<div class="viewcode-block" id="FlowedTwoPtCorr.SetCustomName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.SetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">SetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-def-&#39;</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">])</span>
            <span class="n">Prefix</span> <span class="o">=</span> <span class="s1">&#39;Flowed&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span><span class="p">:</span>
                <span class="n">Prefix</span> <span class="o">=</span> <span class="s1">&#39;_Adjoint&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Prefix</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">])</span>
            <span class="c1"># self.filename = self.name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">string</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;Adjoint&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span> <span class="c1">## customise this how you like</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span> <span class="c1">## customise this how you like</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="n">stringLL</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fo_for_cfgs</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="n">fo_for_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fo_for_cfgs</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span><span class="o">+</span><span class="n">fo_for_cfgs</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/G2/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2dir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.ImportCfgList"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.ImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">stream_list</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="c1"># if isinstance(cfglist,(dict,OrderedDict,pa.Series)): cfglist = cfglist.keys()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="n">stream_list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1">## cfglist must be 2-d array, first dimension is stream, second dimension is configuraiton number</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cfglist</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">icf</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">is_cfg</span><span class="p">):</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfglist</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span> <span class="o">=</span> <span class="n">cfglist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.Update_Stream_List"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-def-&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;filename&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;LegLab&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.Stats"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Stats">[docs]</a>    <span class="k">def</span> <span class="nf">Stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">lAvg</span><span class="p">,</span><span class="n">lStd</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">it_flow</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">iC2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">iC2</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">lAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iC2</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iC2</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.RemoveVals"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.RemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span><span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.Read"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># def FixTime(this_data):</span>
        <span class="c1">#     output = []</span>
        <span class="c1">#     for flow_data in this_data:</span>
        <span class="c1">#         max_index = flow_data.index(max(flow_data))</span>
        <span class="c1">#         rolled = np.roll(np.array(flow_data),-max_index).tolist()</span>
        <span class="c1">#         output.append(rolled)</span>
        <span class="c1">#     return output</span>

        <span class="k">def</span> <span class="nf">ReadMesonFile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file not found&#39;</span><span class="p">,</span><span class="n">thisfile</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">[],[]</span>

            <span class="n">read_the_flow</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">read_this_flow</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">tflow_list</span><span class="p">,</span> <span class="n">meson_list</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">:</span>
                    <span class="n">strip_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">strip_line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">read_the_flow</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">read_this_flow</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">elif</span> <span class="n">read_the_flow</span><span class="p">:</span>
                        <span class="n">read_the_flow</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">tflow</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">strip_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">tflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                            <span class="n">read_this_flow</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">tflow_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflow</span><span class="p">)</span>
                            <span class="n">meson_list</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">elif</span> <span class="n">read_this_flow</span><span class="p">:</span>
                        <span class="n">t_sep</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">cmplx</span> <span class="o">=</span> <span class="n">strip_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        <span class="n">meson_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">tflow_list</span><span class="p">,</span><span class="n">meson_list</span>

        <span class="c1">## making interpolator number more human readable</span>
        <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">thisfile</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">MesOrBar</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Adjoint</span><span class="p">:</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="s1">&#39;_Adjoint&#39;</span><span class="o">+</span><span class="n">thisfile</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">istream_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="s1">&#39;cfg&#39;</span><span class="o">+</span><span class="n">icfg</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">this_tflow_list</span><span class="p">,</span><span class="n">file_data</span> <span class="o">=</span> <span class="n">ReadMesonFile</span><span class="p">(</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">thisfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTsrc</span><span class="p">(</span><span class="n">file_data</span><span class="p">):</span>
                    <span class="n">err_str</span> <span class="o">=</span> <span class="s1">&#39;TsrcErr With: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">thisfile</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">err_str</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">err_str</span> <span class="o">=</span> <span class="s1">&#39;Error with file: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">thisfile</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">err_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">err_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_tflow_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_tflow_list</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;not enough flow times in file </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">thisfile</span><span class="p">)</span>
            <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.CheckTsrc"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.CheckTsrc">[docs]</a>    <span class="k">def</span> <span class="nf">CheckTsrc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_data</span><span class="p">):</span>
        <span class="n">this_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span>
        <span class="n">left_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">this_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,:</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">this_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">right_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">this_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">this_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">left_test</span> <span class="ow">or</span> <span class="n">right_test</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.Bootstrap"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Bootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">Bootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;C2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="n">lC2</span><span class="p">,</span><span class="n">lC2Avg</span><span class="p">,</span><span class="n">lC2Std</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">):</span>
                <span class="n">strit</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">itflow</span><span class="p">,</span><span class="n">strit</span><span class="p">))</span>
                <span class="c1"># def debugthis(val):</span>
                <span class="c1">#     print val[ictflow][it]</span>
                <span class="c1"># print self.C2_cfgs[&#39;C2&#39;].apply(debugthis)</span>
                <span class="n">this_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">][</span><span class="n">it</span><span class="p">]</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_lambda</span><span class="p">)</span>

                <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;G_</span><span class="si">{2}</span><span class="s1">(&#39;</span><span class="o">+</span><span class="n">itflow</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">strit</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span><span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">)</span>
                <span class="n">rlist</span> <span class="o">=</span> <span class="n">thisboot</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
                <span class="n">lC2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                <span class="n">lC2Avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lC2Std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Col_Names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2Avg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lC2Std</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span></div>


    <span class="c1"># def ReadAndBoot(self):</span>
    <span class="c1">#     self.Read()</span>
    <span class="c1">#     self.Bootstrap()</span>

<div class="viewcode-block" id="FlowedTwoPtCorr.ImportFitRanges"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.ImportFitRanges">[docs]</a>    <span class="k">def</span> <span class="nf">ImportFitRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">]</span></div>


    <span class="c1">## Fitting the correlator</span>
    <span class="c1">## fit_range is either list of fit ranges to fit the correlator to, or a single fit range</span>
    <span class="c1">## formatted as fitr#-# where # are the min and max fit values.</span>
    <span class="c1">## states correspond to how many states to fit to (currenlty only working for states = 1 or 2)</span>
<div class="viewcode-block" id="FlowedTwoPtCorr.Fit"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Fit">[docs]</a>    <span class="k">def</span> <span class="nf">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****** Warning******&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TODO: fits in ImpSOF have problem related to exp(mass) in fit, please fix before using&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****** Warning******&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">RunPredefFits</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span> <span class="ow">and</span> <span class="n">fit_range</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">izip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">izip</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">iGuess</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">izip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">fit_range</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">izip</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">iGuess</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">fit_range</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">izip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PredefFits</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">izip</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">izip</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">iGuess</span><span class="o">=</span><span class="n">izip</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">EstDir</span><span class="o">=</span><span class="n">EstDir</span><span class="p">,</span><span class="n">Ratio</span><span class="o">=</span><span class="n">Ratio</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;PreDef&#39;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span><span class="n">fit_range</span><span class="p">]:</span>
            <span class="n">RunPredefFits</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">iGuess</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span> <span class="o">=</span> <span class="n">iGuess</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;state&#39;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportFitRanges</span><span class="p">(</span><span class="n">fit_range</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># thisfitfun = C2OneStateFitFunNoExp</span>
            <span class="n">thisfitfun</span> <span class="o">=</span> <span class="n">C2OneStateFitFun</span>
            <span class="n">npar</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># thisfitfun = C2TwoStateFitFunNoExp</span>
            <span class="n">thisfitfun</span> <span class="o">=</span> <span class="n">C2TwoStateFitFun</span>
            <span class="n">npar</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;fitting state is only implemented up to 2 state so far. Cannot do &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
        <span class="n">ststr</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">legstate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;SF&#39;</span>
        <span class="n">lFit</span><span class="p">,</span><span class="n">lFitA</span><span class="p">,</span><span class="n">lFitS</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">tflowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_time&#39;</span><span class="p">):</span>
            <span class="c1"># print &#39;Fitting state&#39;,str(state) , &#39; &#39; , ifit</span>
            <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_range</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ststr</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ifit</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">WipeFit</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="n">ststr</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ifit</span><span class="p">)],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ststr</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ifit</span><span class="p">))</span>
                <span class="n">ifitmin</span><span class="p">,</span><span class="n">ifitmax</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">unxmlfitr</span><span class="p">(</span><span class="n">ifit</span><span class="p">)))</span>
                <span class="c1"># print &#39;     Fitting &#39;, itflow</span>
                <span class="n">tdatarange</span> <span class="o">=</span> <span class="p">[[]]</span>
                <span class="n">ydata</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="n">tflowdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">tint</span> <span class="o">=</span> <span class="n">untstr</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">ifitmin</span> <span class="o">&lt;=</span> <span class="n">tint</span> <span class="o">&lt;=</span> <span class="n">ifitmax</span><span class="p">:</span>
                        <span class="n">tdatarange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tint</span><span class="p">)</span>
                        <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tdata</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">EstDir</span><span class="p">:</span>
                    <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="p">[</span><span class="n">thisfitfun</span><span class="p">,</span><span class="n">npar</span><span class="p">,</span><span class="s1">&#39;Estimate&#39;</span><span class="p">],</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">tdatarange</span><span class="p">,</span><span class="n">ydata</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="n">legstate</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">ifit</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="p">[</span><span class="n">thisfitfun</span><span class="p">,</span><span class="n">npar</span><span class="p">],</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">tdatarange</span><span class="p">,</span><span class="n">ydata</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="n">legstate</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">ifit</span><span class="p">,</span><span class="n">iGuess</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iGuess</span><span class="p">)</span>
                <span class="n">thistest</span> <span class="o">=</span> <span class="n">thisff</span><span class="o">.</span><span class="n">FitBoots</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">thistest</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">thisff</span><span class="o">.</span><span class="n">UnExpParams</span><span class="p">(</span><span class="n">paramkeys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">,))</span>
                        <span class="n">thisff</span><span class="o">.</span><span class="n">ImportFunction</span><span class="p">(</span> <span class="n">C2OneStateFitFunNoExp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">thisff</span><span class="o">.</span><span class="n">UnExpParams</span><span class="p">(</span><span class="n">paramkeys</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span><span class="s1">&#39;DE&#39;</span><span class="p">))</span>
                        <span class="n">thisff</span><span class="o">.</span><span class="n">ImportFunction</span><span class="p">(</span> <span class="n">C2TwoStateFitFunNoExp</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

                    <span class="n">lFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisff</span><span class="p">)</span>
                    <span class="n">lFitA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisff</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;ParamsAvg&#39;</span><span class="p">])</span>
                    <span class="n">lFitS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisff</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;ParamsStd&#39;</span><span class="p">])</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Col_Names</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFitA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFitS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFit</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFitA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lFitS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>



    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="FlowedTwoPtCorr.items"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.iteritems"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.iteritems">[docs]</a>    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.itemsAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.values"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.valuesAvgStd"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.keys"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_stats</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## TODO this is incorrect, fix if required</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span>


<div class="viewcode-block" id="FlowedTwoPtCorr.EffMass"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.EffMass">[docs]</a>    <span class="k">def</span> <span class="nf">EffMass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lEM</span><span class="p">,</span><span class="n">lEMA</span><span class="p">,</span><span class="n">lEMS</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nextt</span> <span class="o">=</span> <span class="p">(</span><span class="n">untstr</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">thisEmass</span> <span class="o">=</span> <span class="p">(</span><span class="n">idata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">,</span><span class="n">tstr</span><span class="p">(</span><span class="n">nextt</span><span class="p">)])</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
            <span class="n">thisEmass</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">lEM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="p">)</span>
            <span class="n">lEMA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lEMS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisEmass</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEM</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEMA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;EffMStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lEMS</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

    <span class="c1"># def ReadAndBootAndEffM(self,DefWipe=False):</span>
    <span class="c1">#     if os.path.isfile(self.PickleFile) and not DefWipe:</span>
    <span class="c1">#         self.LoadPickle()</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self.ReadAndBoot()</span>
    <span class="c1">#         self.EffMass()</span>


<div class="viewcode-block" id="FlowedTwoPtCorr.Write"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span>

        <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">incfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncfg_list</span><span class="p">):</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ncfg_&#39;</span><span class="o">+</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">incfg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span>

        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">istate</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ifitr</span><span class="p">),</span><span class="n">fitdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">][</span><span class="n">istate</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">ifitr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitdict</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>


        <span class="c1"># for ststr,statedict in self.FitDict.iteritems():</span>
        <span class="c1">#     if len(statedict.keys()) == 0: continue</span>
        <span class="c1">#     for ip,pdict in statedict.iteritems():</span>
        <span class="c1">#         for ifit,fitdict in pdict.iteritems():</span>
        <span class="c1">#             for ipar,pardict in fitdict.Params.iteritems():</span>
        <span class="c1">#                 thisfmtflag = &#39;f&#39;</span>
        <span class="c1">#                 if ipar == &#39;A_Ep&#39;: thisfmtflag = &#39;e&#39;</span>
        <span class="c1">#                 outDict[&#39;Fits&#39;][ststr][ip][ifit][ipar] = AvgStdToFormat(pardict.Avg,pardict.Std,frmtflag=thisfmtflag)</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;Chi^2_pdf&#39;] = AvgStdToFormat(fitdict.Chi2DoF.Avg,fitdict.Chi2DoF.Std)</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;MaxIter&#39;] = fitdict.MaxIter</span>
        <span class="c1">#             outDict[&#39;Fits&#39;][ststr][ip][ifit][&#39;Prec&#39;] = fitdict.Prec</span>


        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">tflowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;C2boot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;EffM&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">),</span><span class="n">tflowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;EffM&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>



        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>

        <span class="c1">## TODO, include fitting in the excell file</span>
        <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,{</span><span class="s1">&#39;C2_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="p">)},</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>

        <span class="c1">## pickles rest of data for reading</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span></div>
    <span class="c1">##################################</span>

<div class="viewcode-block" id="FlowedTwoPtCorr.ReadAndWrite"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.ReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EffMass</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">NoFit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>


<div class="viewcode-block" id="FlowedTwoPtCorr.FixRead"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;PickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;ExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;HumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="k">return</span> <span class="n">readdict</span></div>

<div class="viewcode-block" id="FlowedTwoPtCorr.LoadPickle"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># print &#39;filename &#39; , self.PickleFile</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="c1"># print &#39;Loading Pickle for &#39; , self.name</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">checklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">checklist</span> <span class="o">=</span> <span class="n">checklist</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;C2_cfgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">checklist</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Wipe_All_Fits</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file, fits need to be recomputed&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">C2_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span>
                <span class="c1"># self.Write()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">NoFit</span><span class="o">=</span><span class="n">NoFit</span><span class="p">)</span></div>
    <span class="c1">## Operator overloading</span>

    <span class="c1">#Too Much work, only works for one operator. Please use SetCustomName after doing all algebraic manipulation</span>


<div class="viewcode-block" id="FlowedTwoPtCorr.UpdateName"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.FlowedTwoPtCorr.UpdateName">[docs]</a>    <span class="k">def</span> <span class="nf">UpdateName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">C2</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;pow2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>
        <span class="k">def</span> <span class="nf">GetLegSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;^</span><span class="si">{2}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>

        <span class="k">def</span> <span class="nf">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">opp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\times &#39;</span><span class="p">)</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">oppout</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;pow&#39;</span><span class="p">,</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">oppout</span>

        <span class="n">outname</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">oppLL</span> <span class="o">=</span> <span class="n">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span> <span class="c1">## \times looks better :)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">C22</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">C22</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="s1">&#39; Comb &#39;</span><span class="p">,</span><span class="n">GetLegSelf</span><span class="p">(</span><span class="n">oppLL</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iname</span><span class="p">,</span><span class="n">iname2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iname</span> <span class="ow">in</span> <span class="n">iname2</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iname2</span> <span class="ow">in</span> <span class="n">iname</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="o">+</span><span class="n">opp</span><span class="o">+</span><span class="n">iname2</span><span class="p">)</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iLegLab</span><span class="p">,</span><span class="n">iLegLab2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">op1LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\ &#39;</span><span class="p">),</span><span class="n">op2LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\ &#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iLegLab</span> <span class="ow">in</span> <span class="n">iLegLab2</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iLegLab2</span> <span class="ow">in</span> <span class="n">iLegLab</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLegLab</span><span class="o">+</span><span class="n">oppLL</span><span class="o">+</span><span class="n">iLegLab2</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">C22</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">outname</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                    <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">C22</span><span class="o">.</span><span class="n">LegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span> <span class="p">,</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">C2</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span><span class="p">,</span><span class="n">C22</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
        <span class="c1"># print r&#39;$&#39;+r&#39;\ &#39;.join(outLL)+&#39;$&#39;</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iLL</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outLL</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">iLL</span><span class="p">:</span>
                <span class="n">outLL</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">iLL</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;^{&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">),</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span></div>




    <span class="c1">## Numerical operatoions</span>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># result.UpdateName(&#39;+&#39;,self,C22)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">+</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">+</span> <span class="n">C22</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># result.UpdateName(&#39;-&#39;,self,C22)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">-</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">-</span> <span class="n">C22</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># result.UpdateName(&#39;x&#39;,self,C22)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">*</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">*</span> <span class="n">C22</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="n">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># result.UpdateName(&#39;div&#39;,self,C22)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">/</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">/</span> <span class="n">C22</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>


    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">C22</span><span class="o">.</span><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># result.UpdateName(&#39;pow&#39;,self,C22)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">**</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="n">C22</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">**</span> <span class="n">C22</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>


    <span class="c1">## Right multiplication functions</span>


    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C22</span> <span class="o">+</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,C22,self)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span>  <span class="n">C22</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C22</span> <span class="o">-</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,C22,self)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span>  <span class="n">C22</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C22</span> <span class="o">*</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,C22,self)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span>  <span class="n">C22</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C22</span> <span class="o">/</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,C22,self)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span>  <span class="n">C22</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">C22</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C22</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C22</span> <span class="o">**</span> <span class="bp">self</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Info</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LegLab</span><span class="p">,</span><span class="n">fo_for_cfgs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fo_for_cfgs</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># result.UpdateName(&#39;+&#39;,C22,self)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">C2_Stats</span> <span class="o">=</span>  <span class="n">C22</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">C2_Stats</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">C22</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">C22</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with TwoPointCorr class&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ival</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>







<div class="viewcode-block" id="TestTPCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TestTPCorr">[docs]</a><span class="k">def</span> <span class="nf">TestTPCorr</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfo</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfo</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/TestFit2.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test Two Point Corr&#39;</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fitr9-20&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;fitr5-20&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="TestNNQCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TestNNQCorr">[docs]</a><span class="k">def</span> <span class="nf">TestNNQCorr</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/TestNNQ.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test Alpha&#39;</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span>
    <span class="n">dataflow</span> <span class="o">=</span> <span class="n">NNQCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">dataflow</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">dataflow</span><span class="o">.</span><span class="n">AlphaPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                                   <span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span>
                                   <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">dataflow</span><span class="o">.</span><span class="n">AlphaFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;fitr8-15&#39;</span><span class="p">,</span>
                                      <span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="n">dataflow</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dataflow</span></div>

<div class="viewcode-block" id="TestNNQFullCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TestNNQFullCorr">[docs]</a><span class="k">def</span> <span class="nf">TestNNQFullCorr</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/TestNNQFull.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test Alpha Full&#39;</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;pmom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0 0 0&#39;</span><span class="p">]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CPOdd&#39;</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.01</span><span class="p">,</span><span class="mf">5.01</span><span class="p">,</span><span class="mf">6.01</span><span class="p">])</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tsum_fit_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts28&#39;</span><span class="p">,</span><span class="s1">&#39;ts30&#39;</span><span class="p">,</span><span class="s1">&#39;ts32&#39;</span><span class="p">]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tsum_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts28&#39;</span><span class="p">,</span><span class="s1">&#39;ts30&#39;</span><span class="p">,</span><span class="s1">&#39;ts32&#39;</span><span class="p">]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;nrandt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># defInfoFlow[&#39;tsum_fit_list&#39;] = [&#39;ts&#39;+str(it) for it in range(1,11)]</span>
    <span class="c1"># defInfoFlow[&#39;tsum_list&#39;] = [&#39;ts&#39;+str(it) for it in range(1,11)]</span>
    <span class="n">dataflow</span> <span class="o">=</span> <span class="n">NNQFullCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">dataflow</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">dataflow</span><span class="o">.</span><span class="n">AlphaPlot</span><span class="p">(</span> <span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ts10&#39;</span><span class="p">],</span>
                                    <span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">dataflow</span><span class="o">.</span><span class="n">AlphaFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,[</span><span class="s1">&#39;fitr8-15&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr0-10&#39;</span><span class="p">],</span><span class="n">momlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p000&#39;</span><span class="p">],</span><span class="n">thistflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="n">dataflow</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
    <span class="c1"># dataflow.Fit_All_Tau([[&#39;ts1&#39;,&#39;ts10&#39;]])</span>
    <span class="k">return</span> <span class="n">dataflow</span></div>

<div class="viewcode-block" id="ReformatC2"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.ReformatC2">[docs]</a><span class="k">def</span> <span class="nf">ReformatC2</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">out_filename</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;CFGNUMB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_filename</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;CFGNUMB not in out_filename.&#39;</span><span class="p">)</span>
    <span class="n">meta</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span> <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">imom</span><span class="p">,</span><span class="n">momdata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">mom_file</span> <span class="o">=</span> <span class="n">out_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;MOMNUMB&#39;</span><span class="p">,</span><span class="s1">&#39;p_&#39;</span><span class="o">+</span><span class="n">meta</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">imom</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">mom_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Nucleon_CFGNUMB.txt&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">momdata</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">mom_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;CFGNUMB&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span><span class="n">idata</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="TestFlowCorr"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TestFlowCorr">[docs]</a><span class="k">def</span> <span class="nf">TestFlowCorr</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;Adjoint_Flow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/TestFlowMes.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test Flowed Fermions&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;x_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;source_sink_separation (lattice units)&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;y_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;effective mass&#39;</span>
    <span class="c1"># this_info[&#39;ylims&#39;] = [-5,5]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">FlowedTwoPtCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">this_xrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f0.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Black&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f0.40&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># data_plot = data.EffMassFitPlot(data_plot,1,&#39;fitr20-25&#39;,tflowlist=[&#39;t_f0.00&#39;])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f2.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="c1"># data_plot = data.EffMassFitPlot(data_plot,1,&#39;fitr20-25&#39;,tflowlist=[&#39;t_f2.00&#39;])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f6.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=-</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="c1"># data_plot = data.EffMassFitPlot(data_plot,1,&#39;fitr20-25&#39;,tflowlist=[&#39;t_f6.00&#39;])</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EffMassPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f10.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Orange&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
    <span class="c1"># data_plot = data.EffMassFitPlot(data_plot,1,&#39;fitr20-25&#39;,tflowlist=[&#39;t_f10.00&#39;])</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>


    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/TestFlowRatMes.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio of flowed to non-flowed correlators&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;x_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;source_sink_separation (lattice units)&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;y_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">this_xrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">FlowedTwoPtCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f0.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Black&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f0.40&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f2.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f6.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=-</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">this_xrange</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f10.00&#39;</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Orange&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/AllFlowRatMes.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio of flowed to non-flowed correlators&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;x_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;flow time $\sqrt</span><span class="si">{8t_f}</span><span class="s1">[fm]&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;y_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio&#39;</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">FlowedTwoPtCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span>
    <span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">AllFlowRatPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">tsink</span><span class="o">=</span><span class="s1">&#39;t28&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ReadBootFile"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.ReadBootFile">[docs]</a><span class="k">def</span> <span class="nf">ReadBootFile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">ReadXml</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ReadXml</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
    <span class="n">out_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">imom</span><span class="p">,</span><span class="n">mom_data</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Results&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">t_data</span> <span class="ow">in</span> <span class="n">mom_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">out_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out_data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Results&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Results&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

<div class="viewcode-block" id="AvgBootData"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.AvgBootData">[docs]</a><span class="k">def</span> <span class="nf">AvgBootData</span><span class="p">(</span><span class="n">this_path</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ifile</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">this_path</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">):</span>
        <span class="n">this_data</span><span class="p">,</span><span class="n">mom_list</span> <span class="o">=</span> <span class="n">ReadBootFile</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">mom_list</span></div>

<div class="viewcode-block" id="AvgBootDir"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.AvgBootDir">[docs]</a><span class="k">def</span> <span class="nf">AvgBootDir</span><span class="p">(</span><span class="n">this_path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ifile</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">this_path</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ifile</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Formatting:&#39;</span> <span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="n">out_file_Avg</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">+</span><span class="s1">&#39;_Avg.txt&#39;</span>
            <span class="n">out_file_Err</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">+</span><span class="s1">&#39;_Err.txt&#39;</span>
            <span class="n">this_data</span><span class="p">,</span><span class="n">this_data_err</span><span class="p">,</span><span class="n">mom_list</span> <span class="o">=</span> <span class="n">AvgBootData</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">imom</span><span class="p">,</span><span class="n">mom_data</span><span class="p">,</span><span class="n">mom_data_err</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mom_list</span><span class="p">,</span><span class="n">this_data</span><span class="p">,</span><span class="n">this_data_err</span><span class="p">):</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">out_file_Avg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">imom</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="n">mom_data</span><span class="p">)</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">out_file_Err</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">imom</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">),</span><span class="n">mom_data_err</span><span class="p">)</span></div>

<div class="viewcode-block" id="TestLoadFile"><a class="viewcode-back" href="../TwoPtCorrelators.html#TwoPtCorrelators.TestLoadFile">[docs]</a><span class="k">def</span> <span class="nf">TestLoadFile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">TwoPointCorr</span><span class="o">.</span><span class="n">Construct_2pt_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">tpdata</span> <span class="o">=</span> <span class="n">TestTPCorr</span><span class="p">()</span>
    <span class="n">nnqdata</span> <span class="o">=</span> <span class="n">TestNNQCorr</span><span class="p">()</span>
    <span class="c1"># nnqfull = TestNNQFullCorr()</span>
    <span class="c1"># flowdata = TestFlowCorr()</span>
    <span class="c1"># this_file = &#39;/home/jackdra/LQCD/Results/DebugResults/RC32x64Kud01375400Ks01364000/G2/Pickle/MassForFF.py3p&#39;</span>
    <span class="c1"># test_object = TestLoadFile(this_file)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing 2ptcorr complete, see tpdata and nnqdata variables&#39;</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jack Dragos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
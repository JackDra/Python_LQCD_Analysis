
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Jose_Plots &#8212; LQCD Analysis Codebase TF Fits documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">LQCD Analysis Codebase TF Fits documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Jose_Plots</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># data = [0.000450407533726283, -9.56943763353717e-22, 0.00125881827032569, 1.45686539151048e-21, 0.00144307889177642, 7.33567031666753e-22, 0.00110937528111652, -3.34872438764729e-22, 0.00087627896599212, -1.05972499343127e-21, 0.000684362650375569, 2.96072498157164e-22, 0.000476396547438195, -2.38728848426779e-22, 0.000311467405236602, 7.3551219857596e-23, 0.000203458813921517, -5.15695413138528e-24, 0.000128290916647265, 1.58230603893444e-23, 7.89872580503493e-05, -5.75633695805945e-24, 5.24843401587603e-05, 1.02084912022841e-23, 3.6917769494426e-05, 0.000631482945704443, -5.74599720040254e-23, 0.000929791000522095, 1.92607066928412e-22, 0.00117727057735764, 2.91128801527452e-23, 0.000940934205012497, 2.73349265118964e-22, 0.000328144847069594, 3.51550144747903e-22]</span>
<span class="c1">#</span>
<span class="c1"># data = [idata for idata in data if idata &gt; 10e-10]</span>
<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="c1"># pl.plot(data)</span>
<span class="c1"># pl.savefig(&#39;/home/jackdra/LQCD/Scripts/Python_Analysis/TestGraphs/flow_plot_test.pdf&#39;)</span>
<span class="c1"># pl.clf()</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">NullPlotData</span> <span class="k">import</span> <span class="n">null_series</span>
<span class="kn">from</span> <span class="nn">PlotData</span> <span class="k">import</span> <span class="n">Plotting</span>
<span class="kn">from</span> <span class="nn">MomParams</span> <span class="k">import</span> <span class="n">hbarc</span>
<span class="kn">from</span> <span class="nn">BootStrapping</span> <span class="k">import</span> <span class="n">BootStrap</span>
<span class="kn">from</span> <span class="nn">SetsOfFits</span> <span class="k">import</span> <span class="n">SetOfFitFuns</span>
<span class="c1"># from PredefFitFuns import c3FitFun,C2OneStateFitFunNoExp,C2TwoStateFitFunNoExp</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3ContFitFun</span><span class="p">,</span><span class="n">c3FitFun</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3FitFun_NoA</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3PolyFun</span><span class="p">,</span><span class="n">c3PolyFun2</span><span class="p">,</span><span class="n">c3PolyFun3</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3PolyFun_skip1</span><span class="p">,</span><span class="n">c3PolyFun2_skip1</span><span class="p">,</span><span class="n">c3PolyFun3_skip1</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3ExpFitFun</span><span class="p">,</span><span class="n">c3ExpFitFun2</span><span class="p">,</span><span class="n">c3ExpFitFun_nosqrt</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">c3ExpFitFun2_nosqrt</span><span class="p">,</span><span class="n">c3ExpFitFun3_nosqrt</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">C2OSFAntiper</span><span class="p">,</span><span class="n">C2OSFAntiperDer</span>
<span class="kn">import</span> <span class="nn">FitFunctions</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">from</span> <span class="nn">ReadBinaryCfuns</span> <span class="k">import</span> <span class="n">RC2Full</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pik</span>

<span class="n">this_folder</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/FitRes/&#39;</span>
<span class="n">temp_folder</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/temp/&#39;</span>

<span class="n">Fit_ens_files</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">Fit_ens_files</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DataFrame_C_32X64_1.csv&#39;</span><span class="p">,</span><span class="s1">&#39;DataFrame_C_32X64_2.csv&#39;</span><span class="p">,</span><span class="s1">&#39;DataFrame_C_32X64_3.csv&#39;</span><span class="p">]</span>
<span class="n">Fit_ens_files</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DataFrame_C_16X32.csv&#39;</span><span class="p">,</span><span class="s1">&#39;DataFrame_C_20X40.csv&#39;</span><span class="p">,</span><span class="s1">&#39;DataFrame_C_28X56.csv&#39;</span><span class="p">]</span>

<span class="n">do_exraps</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">tree_antit</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">do_nucleon</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">double_tree_fix</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Mass_ens_files = {}</span>
<span class="c1"># Mass_ens_files[&#39;M&#39;] = [&#39;Ave_E_32X64_1.csv&#39;,&#39;Ave_E_32X64_2.csv&#39;,&#39;Ave_E_32X64_3.csv&#39;]</span>
<span class="c1"># Mass_ens_files[&#39;A&#39;] = [&#39;Ave_E_16X32.csv&#39;,&#39;Ave_E_20X40.csv&#39;,&#39;Ave_E_28X56.csv&#39;]</span>
<span class="c1">#</span>
<span class="c1"># AA0_ens_files = {}</span>
<span class="c1"># AA0_ens_files[&#39;M&#39;] = [&#39;AA0_ave_v2_32X64_1&#39;,&#39;AA0_ave_v2_32X64_2&#39;,&#39;AA0_ave_v2_32X64_3&#39;]</span>
<span class="c1"># AA0_ens_files[&#39;A&#39;] = [&#39;AA0_ave_v2_16X32&#39;,&#39;AA0_ave_v2_20X40&#39;,&#39;AA0_ave_v2_28X56&#39;]</span>
<span class="c1">#</span>
<span class="c1"># AA0_err_ens_files = {}</span>
<span class="c1"># AA0_err_ens_files[&#39;M&#39;] = [&#39;AA0_err_v2_32X64_1&#39;,&#39;AA0_err_v2_32X64_2&#39;,&#39;AA0_err_v2_32X64_3&#39;]</span>
<span class="c1"># AA0_err_ens_files[&#39;A&#39;] = [&#39;AA0_err_v2_16X32&#39;,&#39;AA0_err_v2_20X40&#39;,&#39;AA0_err_v2_28X56&#39;]</span>



<span class="n">M_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">,</span><span class="s1">&#39;mpi570&#39;</span><span class="p">,</span><span class="s1">&#39;mpi700&#39;</span><span class="p">]</span>
<span class="n">A_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">,</span><span class="s1">&#39;L20&#39;</span><span class="p">,</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span>
<span class="c1"># M_labels = [&#39;mpi410&#39;]</span>
<span class="c1"># A_labels = []</span>
<span class="n">tsink_ens_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">64</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">64</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;mpi700&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">64</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">32</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">40</span>
<span class="n">tsink_ens_dict</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">56</span>

<span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi700&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.1095</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0936</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0684</span>
<span class="n">t0_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.5377162290</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.3999592122</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi700&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.2590866059</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">1.3628954894</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">2.2386627909</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">4.9885618908</span>

<span class="n">t0_dict_err</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0015529386</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0011452810</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;mpi700&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0011742296</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">0.0015817442</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">0.0021913620</span>
<span class="n">t0_dict_err</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">0.0064980950</span>

<span class="c1"># from XmlFormatting import MakeValAndErr</span>
<span class="c1"># for ival_err,ival in zip(t0_dict_err.values(),t0_dict.values()):</span>
<span class="c1">#     print(MakeValAndErr(ival,ival_err,Dec=2))</span>
<span class="n">use_t0rat</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
    <span class="n">sqrt8t_key</span> <span class="o">=</span> <span class="s1">&#39;sqrt8t_t0rat&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">sqrt8t_key</span> <span class="o">=</span> <span class="s1">&#39;sqrt8t_fm&#39;</span>

<div class="viewcode-block" id="MakeFileList"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.MakeFileList">[docs]</a><span class="k">def</span> <span class="nf">MakeFileList</span><span class="p">(</span><span class="n">this_dict</span><span class="p">):</span>
    <span class="n">output_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ifile</span><span class="p">,</span><span class="n">ilab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_dict</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span><span class="n">M_labels</span><span class="p">):</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ilab</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_folder</span> <span class="o">+</span> <span class="n">ifile</span>
    <span class="k">for</span> <span class="n">ifile</span><span class="p">,</span><span class="n">ilab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_dict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span><span class="n">A_labels</span><span class="p">):</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ilab</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_folder</span> <span class="o">+</span> <span class="n">ifile</span>
    <span class="k">return</span> <span class="n">output_dict</span></div>

<span class="n">Fit_filelist</span> <span class="o">=</span> <span class="n">MakeFileList</span><span class="p">(</span><span class="n">Fit_ens_files</span><span class="p">)</span>

<span class="n">flow_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{val:.1f}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)]</span>
<span class="n">flow_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{val:.1f}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<div class="viewcode-block" id="ReadTLFileList"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.ReadTLFileList">[docs]</a><span class="k">def</span> <span class="nf">ReadTLFileList</span><span class="p">(</span><span class="n">this_dict</span><span class="p">):</span>
    <span class="n">output_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="n">this_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">tf_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">t_list</span><span class="p">,</span><span class="n">tf_list</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">iflow</span> <span class="ow">in</span> <span class="n">flow_list</span><span class="p">:</span>
            <span class="n">this_file</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;FLOW_TIME&#39;</span><span class="p">,</span><span class="n">iflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">do_nucleon</span><span class="p">:</span>
                <span class="n">this_data</span> <span class="o">=</span> <span class="n">RC2Full</span><span class="p">([</span><span class="n">this_file</span><span class="p">],[</span><span class="s1">&#39;0 0 0&#39;</span><span class="p">],</span>
                                    <span class="n">InterpNumb</span><span class="o">=</span><span class="s1">&#39;9&#39;</span><span class="p">,</span>
                                    <span class="n">MesOrBar</span><span class="o">=</span><span class="s1">&#39;Baryon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_data</span> <span class="o">=</span> <span class="n">RC2Full</span><span class="p">([</span><span class="n">this_file</span><span class="p">],[</span><span class="s1">&#39;0 0 0&#39;</span><span class="p">],</span>
                                    <span class="n">InterpNumb</span><span class="o">=</span><span class="s1">&#39;15&#39;</span><span class="p">,</span>
                                    <span class="n">MesOrBar</span><span class="o">=</span><span class="s1">&#39;Meson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_data</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
            <span class="n">tf_data</span> <span class="o">+=</span> <span class="n">this_data</span>
            <span class="n">t_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{it}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">this_data</span><span class="p">))]</span>
            <span class="n">tf_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">iflow</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">this_data</span><span class="p">]</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;t_sink&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">t_list</span><span class="p">)</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;t_flow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_list</span><span class="p">)</span>
        <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">double_tree_fix</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">output_dict</span></div>

<div class="viewcode-block" id="ReadFileList"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.ReadFileList">[docs]</a><span class="k">def</span> <span class="nf">ReadFileList</span><span class="p">(</span><span class="n">this_dict</span><span class="p">):</span>
    <span class="n">output_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="n">this_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_dict</span></div>

<span class="n">Fit_data</span> <span class="o">=</span> <span class="n">ReadFileList</span><span class="p">(</span><span class="n">Fit_filelist</span><span class="p">)</span>
<span class="c1"># this_kappa = &#39;k0.1250&#39;</span>
<span class="c1"># this_kappa = &#39;k0.1260&#39;</span>
<span class="c1"># this_kappa = &#39;k0.1270&#39;</span>
<span class="c1"># tree_kappa_list = [&#39;k0.1250&#39;,&#39;k0.1260&#39;,&#39;k0.1270&#39;]</span>
<span class="c1"># tree_kappa_list = [&#39;k0.1250&#39;]</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">tree_kappa_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k0.1250&#39;</span><span class="p">,</span><span class="s1">&#39;k0.1237&#39;</span><span class="p">,</span><span class="s1">&#39;k0.1225&#39;</span><span class="p">,</span><span class="s1">&#39;k0.1212&#39;</span><span class="p">,</span><span class="s1">&#39;k0.1200&#39;</span><span class="p">]</span>
<span class="n">tree_m0_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">ival</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">tree_kappa_list</span><span class="p">]</span>
<span class="n">tree_m0_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">ival</span> <span class="o">-</span> <span class="mi">8</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">tree_m0_list</span><span class="p">]</span>
<span class="n">tree_mp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ival</span><span class="p">)</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">tree_m0_list</span><span class="p">]</span>
<span class="n">tree_mpi_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">ival</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">tree_mp_list</span><span class="p">]</span>
<span class="n">tree_df_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">tree_df_info</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tree_kappa_list</span><span class="p">)</span>
<span class="n">tree_df_info</span><span class="p">[</span><span class="s1">&#39;m0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tree_m0_list</span><span class="p">)</span>
<span class="n">tree_df_info</span><span class="p">[</span><span class="s1">&#39;mp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tree_mp_list</span><span class="p">)</span>
<span class="n">tree_df_info</span><span class="p">[</span><span class="s1">&#39;mpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tree_mpi_list</span><span class="p">)</span>
<span class="n">tree_df_info</span> <span class="o">=</span> <span class="n">tree_df_info</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;kappa&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">tree_antit</span><span class="p">:</span>
    <span class="n">tree_base</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Treelev/&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">tree_base</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Treelev_Tper/&#39;</span>

<span class="n">tree_files</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ikappa</span> <span class="ow">in</span> <span class="n">tree_kappa_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">Fit_filelist</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s1">&#39;mpi&#39;</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">:</span>
            <span class="n">tree_files</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree_base</span><span class="o">+</span><span class="s1">&#39;/RC32x64_tree/RC32x64_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="o">+</span><span class="s1">&#39;_FLOW_TIME.xml&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_RC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ikey</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">this_RC</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_RC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_RC</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">tree_files</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span>        <span class="n">tree_base</span><span class="o">+</span><span class="n">this_RC</span><span class="o">+</span><span class="s1">&#39;_tree/&#39;</span><span class="o">+</span><span class="n">this_RC</span><span class="o">+</span><span class="s1">&#39;_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="o">+</span><span class="s1">&#39;_FLOW_TIME.xml&#39;</span>


<span class="n">tree_data</span> <span class="o">=</span> <span class="n">ReadTLFileList</span><span class="p">(</span><span class="n">tree_files</span><span class="p">)</span>
<span class="n">tree_data</span><span class="p">[</span><span class="s1">&#39;mpi410_k0.1200&#39;</span><span class="p">]</span>
<span class="n">effm_tree_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kn">from</span> <span class="nn">pynverse</span> <span class="k">import</span> <span class="n">inversefunc</span>
<span class="k">for</span> <span class="n">iens</span><span class="p">,</span><span class="n">ens_data</span> <span class="ow">in</span> <span class="n">tree_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">this_tsink</span> <span class="o">=</span> <span class="n">tsink_ens_dict</span><span class="p">[</span><span class="n">iens</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">val_list</span><span class="p">,</span><span class="n">AA0_list</span> <span class="o">=</span> <span class="p">[],[]</span>
    <span class="n">flow_0_data</span> <span class="o">=</span> <span class="n">ens_data</span><span class="p">[</span><span class="n">ens_data</span><span class="p">[</span><span class="s1">&#39;t_flow&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0.0&#39;</span><span class="p">][</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">flow_list</span><span class="p">:</span>
        <span class="n">flow_data</span> <span class="o">=</span> <span class="n">ens_data</span><span class="p">[</span><span class="n">ens_data</span><span class="p">[</span><span class="s1">&#39;t_flow&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">itflow</span><span class="p">]</span>
        <span class="n">flow_data</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,(</span><span class="n">tdata</span><span class="p">,</span><span class="n">tdatap1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">flow_data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">flow_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
            <span class="n">AA0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tdata</span><span class="o">/</span><span class="n">flow_0_data</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">do_nucleon</span><span class="p">:</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tdata</span><span class="o">/</span><span class="n">tdatap1</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Tshift</span> <span class="o">=</span> <span class="n">this_tsink</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">it</span>
<div class="viewcode-block" id="ThisEffMFun"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.ThisEffMFun">[docs]</a>                <span class="k">def</span> <span class="nf">ThisEffMFun</span><span class="p">(</span><span class="n">mass</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="o">-</span><span class="n">mass</span><span class="o">*</span><span class="n">Tshift</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="o">-</span><span class="n">mass</span><span class="o">*</span><span class="p">(</span><span class="n">Tshift</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span></div>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">inversefunc</span><span class="p">(</span><span class="n">ThisEffMFun</span><span class="p">,</span><span class="n">y_values</span><span class="o">=</span><span class="n">tdata</span><span class="o">/</span><span class="n">tdatap1</span><span class="p">)))</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">))</span>
        <span class="n">AA0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tree_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">val_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">tree_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">tree_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;AA0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">AA0_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">tree_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">iens</span><span class="p">,</span><span class="n">ens_data</span> <span class="ow">in</span> <span class="n">tree_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="n">ens_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;t_sink&#39;</span><span class="p">,</span><span class="s1">&#39;t_flow&#39;</span><span class="p">])[</span><span class="s1">&#39;EffM&#39;</span><span class="p">]</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iens</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>
<span class="k">for</span> <span class="n">ikappa</span><span class="p">,</span><span class="n">mpi_val</span> <span class="ow">in</span> <span class="n">tree_df_info</span><span class="p">[</span><span class="s1">&#39;mpi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpi_val</span><span class="p">]</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from kappa &#39;</span> <span class="o">+</span> <span class="n">ikappa</span>
    <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;from kappa &#39;</span> <span class="o">+</span> <span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

<span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/Test_EffM.pdf&#39;</span>
<span class="k">if</span> <span class="n">tree_antit</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Test_EffM&#39;</span><span class="p">,</span><span class="s1">&#39;Test_EffM_antit&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">do_nucleon</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Test_EffM&#39;</span><span class="p">,</span><span class="s1">&#39;Test_EffM_nucleon&#39;</span><span class="p">)</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$M_</span><span class="si">{eff}</span><span class="s1">$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$M_</span><span class="si">{eff}</span><span class="s1">$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{sink}</span><span class="s1">$&#39;</span>
<span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
<span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>

<span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">iens</span><span class="p">,</span><span class="n">ens_data</span> <span class="ow">in</span> <span class="n">tree_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># plot_data = ens_data.set_index([&#39;t_sink&#39;,&#39;t_flow&#39;])[&#39;AA0&#39;]</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="n">ens_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;t_sink&#39;</span><span class="p">,</span><span class="s1">&#39;t_flow&#39;</span><span class="p">])[</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iens</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>
<span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/Test_Corr.pdf&#39;</span>
<span class="k">if</span> <span class="n">tree_antit</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Test_Corr&#39;</span><span class="p">,</span><span class="s1">&#39;Test_Corr_antit&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">do_nucleon</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Test_Corr&#39;</span><span class="p">,</span><span class="s1">&#39;Test_Corr_nucleon&#39;</span><span class="p">)</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$Correlator$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$C$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{sink}</span><span class="s1">$&#39;</span>
<span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
<span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
<span class="c1"># tree_data[&#39;L16_k0.1250&#39;].set_index([&#39;t_sink&#39;,&#39;t_flow&#39;])[&#39;Corr&#39;][:,&#39;5.0&#39;]</span>
<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="c1"># flow_test = tree_data[&#39;mpi410_k0.1270&#39;]</span>
<span class="c1"># flow_test = flow_test[flow_test[&#39;t_flow&#39;] == &#39;0.0&#39;][&#39;Corr&#39;]</span>
<span class="c1"># flow_test = flow_test</span>
<span class="c1"># flow_test</span>
<span class="c1"># flow_test.plot(color=&#39;blue&#39;)</span>
<span class="c1"># # pl.savefig(&#39;/home/jackdra/LQCD/Scripts/Python_Analysis/TestGraphs/flow_plot_test2.pdf&#39;)</span>
<span class="c1"># # pl.clf()</span>
<span class="c1"># flow_test = tree_data[&#39;mpi410_k0.1250&#39;]</span>
<span class="c1"># flow_test = flow_test[flow_test[&#39;t_flow&#39;] == &#39;4.0&#39;]</span>
<span class="c1"># flow_test[&#39;Corr&#39;].plot(color=&#39;red&#39;)</span>
<span class="c1"># pl.savefig(&#39;/home/jackdra/LQCD/Scripts/Python_Analysis/TestGraphs/flow_plot_test.pdf&#39;)</span>
<span class="c1"># pl.clf()</span>

<div class="viewcode-block" id="DoLSFit"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.DoLSFit">[docs]</a><span class="k">def</span> <span class="nf">DoLSFit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">this_name</span><span class="p">,</span><span class="n">this_fun</span><span class="p">):</span>
    <span class="n">testdf</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">testdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;xdata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([[</span><span class="n">x_data</span><span class="p">]])</span>
    <span class="n">testdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;ydata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">y_data</span><span class="p">])</span>
    <span class="n">testfit</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">testdf</span><span class="p">,</span> <span class="n">Funs</span><span class="o">=</span><span class="n">this_fun</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">this_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">testfit</span><span class="o">.</span><span class="n">FitMean</span><span class="p">()</span></div>

<span class="n">tree_fit_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">iens</span><span class="p">,</span><span class="n">ens_data</span> <span class="ow">in</span> <span class="n">tree_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">tree_fit_file</span> <span class="o">=</span> <span class="n">temp_folder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">iens</span><span class="o">+</span><span class="s1">&#39;_tree_fit_data.p&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tree_fit_file</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
        <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">tree_fit_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">this_tsink</span> <span class="o">=</span> <span class="n">tsink_ens_dict</span><span class="p">[</span><span class="n">iens</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">def</span> <span class="nf">C2atT</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C2OSFAntiper</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">this_tsink</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">C2atT</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;C2atT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_tsink</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">C2DeratT</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">C2OSFAntiperDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">this_tsink</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">C2DeratT</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;C2DeratT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_tsink</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">this_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">C2atT</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">C2DeratT</span><span class="p">]</span>
        <span class="n">all_flow_list</span><span class="p">,</span><span class="n">tcut_list</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">E_list</span><span class="p">,</span><span class="n">A_list</span><span class="p">,</span><span class="n">chi_list</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;Begining fit for &#39;</span><span class="o">+</span><span class="n">iens</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">flow_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;     tflow:&#39;</span><span class="p">,</span> <span class="n">itflow</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">flow_data</span> <span class="o">=</span> <span class="n">ens_data</span><span class="p">[</span><span class="n">ens_data</span><span class="p">[</span><span class="s1">&#39;t_flow&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">itflow</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">itcut</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">this_tsink</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;         itcut:&#39;</span><span class="p">,</span> <span class="n">itcut</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
                <span class="n">fit_data</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;t_sink&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">itcut</span><span class="p">]</span>
                <span class="n">fit_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">[</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;t_sink&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">this_tsink</span><span class="o">-</span><span class="n">itcut</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;t_sink&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Corr&#39;</span><span class="p">]</span>
                <span class="n">test_fit_res</span> <span class="o">=</span> <span class="n">DoLSFit</span><span class="p">(</span><span class="n">xdata</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ydata</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="s1">&#39;test_fit&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="p">)</span>
                <span class="n">all_flow_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
                <span class="n">tcut_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itcut</span><span class="p">)</span>
                <span class="n">E_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_fit_res</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">])</span>
                <span class="n">A_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_fit_res</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;A_Ep&#39;</span><span class="p">])</span>
                <span class="n">chi_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_fit_res</span><span class="p">[</span><span class="s1">&#39;Chi2DoF&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fitting tree complete &#39;</span><span class="p">)</span>
        <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tcut_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;flow t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">all_flow_list</span><span class="p">)</span>
            <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;tmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tcut_list</span><span class="p">)</span>
            <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_list</span><span class="p">)</span>
            <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">A_list</span><span class="p">)</span>
            <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">][</span><span class="s1">&#39;chisq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chi_list</span><span class="p">)</span>
        <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">iens</span><span class="p">]</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">tree_fit_file</span><span class="p">)</span>
<span class="c1"># tree_fit_data[&#39;mpi410_k0.1250&#39;]</span>
<span class="c1"># # print(tree_fit_data[&#39;L16_k0.1250&#39;].to_string())</span>
<span class="c1"># tree_fit_data[&#39;L16_k0.1250&#39;]</span>
<span class="c1"># tree_fit_data[&#39;L16_k0.1250&#39;][tree_fit_data[&#39;L16_k0.1250&#39;][&#39;flow t&#39;]==&#39;4.0&#39;]</span>
<span class="c1"># test_fit = test_fit[test_fit[&#39;t_sink&#39;].apply(lambda x : int(x)) &gt; 15]</span>
<span class="c1"># test_fit = test_fit[test_fit[&#39;t_sink&#39;].apply(lambda x : int(x)) &lt; 64-15]</span>
<span class="c1"># xdata,ydata = test_fit[&#39;t_sink&#39;].apply(lambda x : float(x)),test_fit[&#39;Corr&#39;]</span>
<span class="c1"># this_fun = [C2atT,2,C2DeratT]</span>
<span class="c1"># test_fit_res = DoLSFit(xdata.values,ydata.values,&#39;test_fit&#39;,this_fun)</span>
<span class="c1"># test_fit_res</span>
<span class="c1"># fit_eval = np.array([C2atT([ival],[test_fit_res[&#39;Params&#39;][&#39;A_Ep&#39;],test_fit_res[&#39;Params&#39;][&#39;Energy&#39;]]) for ival in range(15,64-15-1)])</span>
<span class="c1"># ydata.values</span>
<span class="c1"># np.abs(fit_eval-ydata.values)</span>

<div class="viewcode-block" id="BootStrap_Vals"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.BootStrap_Vals">[docs]</a><span class="k">def</span> <span class="nf">BootStrap_Vals</span><span class="p">(</span><span class="n">this_DF</span><span class="p">):</span>
    <span class="n">A_list</span><span class="p">,</span><span class="n">E_list</span><span class="p">,</span><span class="n">chi_list</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[],[],[]</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iDF</span> <span class="ow">in</span> <span class="n">this_DF</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="s1">&#39;flow t&#39;</span><span class="p">,</span><span class="s1">&#39;tmin&#39;</span><span class="p">)):</span>
        <span class="n">A_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BootStrap</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iDF</span><span class="p">),</span><span class="n">bootvals</span><span class="o">=</span><span class="n">iDF</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">E_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BootStrap</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iDF</span><span class="p">),</span><span class="n">bootvals</span><span class="o">=</span><span class="n">iDF</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">chi_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BootStrap</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">iDF</span><span class="p">),</span><span class="n">bootvals</span><span class="o">=</span><span class="n">iDF</span><span class="p">[</span><span class="s1">&#39;chisq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;flow t&#39;</span><span class="p">,</span><span class="s1">&#39;tmin&#39;</span><span class="p">))</span>
        <span class="n">this_DF</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">this_DF</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">A_list</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">ilist</span><span class="p">)</span>
        <span class="n">this_DF</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_list</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">ilist</span><span class="p">)</span>
        <span class="n">this_DF</span><span class="p">[</span><span class="s1">&#39;chisq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">ilist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">this_DF</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span></div>

<div class="viewcode-block" id="MakeAdiv"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.MakeAdiv">[docs]</a><span class="k">def</span> <span class="nf">MakeAdiv</span><span class="p">(</span><span class="n">this_DF</span><span class="p">,</span><span class="n">flow_str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">out_list</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
    <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">this_DF</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tmin&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flow_str</span><span class="p">:</span>
            <span class="n">DF_tf0</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;flow t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0.0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">DF_tf0</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;flow t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">jkey</span><span class="p">,</span><span class="n">jval</span> <span class="ow">in</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">jval</span><span class="p">,</span><span class="s1">&#39;__div__&#39;</span><span class="p">):</span>
                <span class="n">outval</span> <span class="o">=</span> <span class="n">jval</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">DF_tf0</span><span class="p">)</span>
                <span class="n">outval</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outval</span> <span class="o">=</span> <span class="n">jval</span><span class="o">/</span><span class="n">DF_tf0</span>
            <span class="n">out_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outval</span><span class="p">)</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jkey</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">out_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span></div>

<span class="n">first_key</span><span class="p">,</span><span class="n">second_key</span> <span class="o">=</span> <span class="p">{},{}</span>
<span class="c1"># DefWipe = DefWipe or False</span>
<span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">Fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">data_file</span> <span class="o">=</span> <span class="n">temp_folder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_wtree_data.p&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">first_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">second_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">pik</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">BootStrap_Vals</span><span class="p">(</span><span class="n">ival</span><span class="p">)</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeAdiv</span><span class="p">(</span><span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;sqrt8t_fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;flow t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;REMOVE THIS, volume scaling&#39;</span><span class="p">)</span>
        <span class="c1"># Fit_data[ikey][&#39;sqrt8t_t0rat&#39;] = Fit_data[ikey][&#39;flow t&#39;].apply(lambda x : str(np.sqrt(x/t0_dict[ikey])))</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;sqrt8t_t0rat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;flow t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">tsink_ens_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;tmin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">hbarc</span><span class="o">/</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">ikappa</span> <span class="ow">in</span> <span class="n">tree_kappa_list</span><span class="p">:</span>
            <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span> <span class="n">MakeAdiv</span><span class="p">(</span><span class="n">tree_fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">],</span><span class="n">flow_str</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Fit_data[ikey][&#39;A(t)/A(0)_div_tree_&#39;+ikappa] = Fit_data[ikey][&#39;A(t)/A(0)&#39;]/Fit_data[ikey][&#39;A(t)/A(0)_tree_&#39;+ikappa]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;THIS FORCES IT TO tree itself, change comment to divide by tree level&#39;</span><span class="p">)</span>
            <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)_div_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span><span class="o">/</span><span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)&#39;</span><span class="p">]</span>
            <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;A(t)/A(0)_div_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
            <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;E_tree_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree_fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikappa</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
        <span class="n">first_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="n">sqrt8t_key</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">second_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">sqrt8t_key</span><span class="p">,</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">])</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pik</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">first_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">second_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">]),</span><span class="n">f</span><span class="p">)</span>
<span class="c1"># Fit_data[&#39;L20&#39;][&#39;A(t)/A(0)_tree_k0.1250&#39;][:,&#39;0.1872&#39;].plot()</span>
<span class="c1"># print(Fit_data[&#39;mpi410&#39;][&#39;A(t)/A(0)&#39;][:,&#39;2.1768&#39;].apply(lambda x : x.MakeValAndErr()).to_string())</span>
<span class="c1"># Fit_data[&#39;mpi410&#39;][&#39;A(t)/A(0)_div_tree_&#39;+ikappa].apply(lambda x : x.Stats())</span>
<span class="c1"># Fit_data[&#39;mpi410&#39;][&#39;A(t)/A(0)_div_tree_&#39;+ikappa].apply(lambda x : x.MakeValAndErr())</span>
<span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3FitFun_NoA,2]</span>
<span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c3PolyFun</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun,2]</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3FitFun,3]</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3FitFun_V2,2]</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [C2OneStateFitFunNoExp,2]</span>

<span class="n">fit_info_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c3FitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">fit_info_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_info</span><span class="p">)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun,1]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun2,2]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun3,3]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun_skip1,1]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun2_skip1,2]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun3_skip1,3]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3PolyFun,2]</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3FitFun,3]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun,1]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun2,2]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun_nosqrt,1]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun2_nosqrt,2]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun3_nosqrt,3]</span>
<span class="c1"># fit_info_list.append(fit_info)</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [C2OneStateFitFunNoExp,2]</span>
<span class="c1"># fit_info[&#39;iGuess&#39;] = [1,1]</span>
<span class="c1"># fit_info = {}</span>
<span class="c1"># fit_info[&#39;Funs&#39;] = [c3ExpFitFun,1]</span>
<span class="c1"># fit_info_list = [fit_info]</span>

<span class="n">fit_tmin_min</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">fit_tmin_max</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">tflow_fit_min</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tflow_fit_max</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">min_par_tflow</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">min_par_tmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">best_fit_picked</span> <span class="o">=</span> <span class="p">[(</span><span class="n">c3FitFun</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;fitr4-11&#39;</span><span class="p">,</span><span class="s1">&#39;fittwor17-22&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">best_fit_picked</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c3FitFun</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;fitr4-10&#39;</span><span class="p">,</span><span class="s1">&#39;fittwor14-14&#39;</span><span class="p">))</span>
<span class="n">best_fit_picked</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c3FitFun</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;fitr4-11&#39;</span><span class="p">,</span><span class="s1">&#39;fittwor17-18&#39;</span><span class="p">))</span>
<span class="n">best_fit_picked</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c3FitFun</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s1">&#39;fitr5-11&#39;</span><span class="p">,</span><span class="s1">&#39;fittwor22-26&#39;</span><span class="p">))</span>
<span class="n">min_hold</span> <span class="o">=</span> <span class="n">tflow_fit_min</span>
<span class="n">max_hold</span> <span class="o">=</span> <span class="n">tflow_fit_max</span>
<span class="n">tflow_fit_min</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tflow_fit_max</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">min_hold</span><span class="p">,</span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="n">max_hold</span><span class="p">,</span> <span class="s1">&#39; in fm corresponds to&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
        <span class="c1"># tflow_fit_min[ikey] = min_hold/(a_dict[ikey]*np.sqrt(8*t0_dict[ikey]))</span>
        <span class="c1"># tflow_fit_max[ikey] = max_hold/(a_dict[ikey]*np.sqrt(8*t0_dict[ikey]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Volume Scaling fix this too!&#39;</span><span class="p">)</span>
        <span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">min_hold</span><span class="o">/</span><span class="p">(</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">*</span><span class="n">tsink_ens_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
        <span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">max_hold</span><span class="o">/</span><span class="p">(</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">*</span><span class="n">tsink_ens_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span> <span class="s1">&#39; in units of sqrt(8t_</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_hold</span>
        <span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_hold</span>

<span class="n">cont_fit_info</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">cont_fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c3ContFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">tflow_picked</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">tmin_picked</span> <span class="o">=</span> <span class="n">fit_tmin_min</span>

<span class="n">Master_Fit_Data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>


<span class="n">A0Fit_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">fit_ilist</span><span class="p">,</span><span class="n">fit_data</span> <span class="o">=</span> <span class="p">[],[]</span>

<div class="viewcode-block" id="GetMass_minfit"><a class="viewcode-back" href="../Jose_Plots.html#Jose_Plots.GetMass_minfit">[docs]</a><span class="k">def</span> <span class="nf">GetMass_minfit</span><span class="p">(</span><span class="n">this_df</span><span class="p">,</span><span class="n">this_tflow</span><span class="p">,</span><span class="n">this_t</span><span class="p">):</span>
    <span class="n">this_df</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">this_df</span> <span class="o">=</span> <span class="n">this_df</span><span class="p">[</span><span class="n">this_df</span><span class="p">[</span><span class="n">sqrt8t_key</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">this_tflow</span><span class="p">]</span>
    <span class="n">this_df</span> <span class="o">=</span> <span class="n">this_df</span><span class="p">[</span><span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">this_t</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<span class="n">DoTree</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># picked_kappa = tree_kappa_list[4]</span>
<span class="n">picked_kappa</span> <span class="o">=</span> <span class="n">tree_kappa_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># picked_kappa = tree_kappa_list[2]</span>
<span class="k">if</span> <span class="n">DoTree</span><span class="p">:</span>
    <span class="c1"># this_arat_key = &#39;A(t)/A(0)_tree_&#39;+picked_kappa</span>
    <span class="c1"># file_kappa = &#39;AA0_tree_&#39;+picked_kappa.replace(&#39;k0.&#39;,&#39;k&#39;)</span>
    <span class="n">this_arat_key</span> <span class="o">=</span> <span class="s1">&#39;A(t)/A(0)_div_tree_&#39;</span><span class="o">+</span><span class="n">picked_kappa</span>
    <span class="n">file_kappa</span> <span class="o">=</span> <span class="s1">&#39;AA0_dtree_&#39;</span><span class="o">+</span><span class="n">picked_kappa</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;k0.&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">this_arat_key</span> <span class="o">=</span> <span class="s1">&#39;A(t)/A(0)&#39;</span>
    <span class="n">file_kappa</span> <span class="o">=</span> <span class="s1">&#39;AA0&#39;</span>


<span class="n">mpi_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">DefWipe</span> <span class="o">=</span> <span class="n">DefWipe</span> <span class="ow">or</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">Fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">fit_file</span> <span class="o">=</span> <span class="n">temp_folder</span><span class="o">+</span><span class="s1">&#39;/fit_&#39;</span><span class="o">+</span><span class="n">file_kappa</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_tmin_min</span><span class="o">*</span><span class="mi">10</span><span class="p">)),</span>
                                                         <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_tmin_max</span><span class="o">*</span><span class="mi">10</span><span class="p">))])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;.p&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fit_file</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fit_file</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">this_fit</span><span class="p">,</span><span class="n">this_df</span><span class="p">,</span><span class="n">mass_val</span> <span class="o">=</span> <span class="n">pik</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="n">mpi_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_val</span><span class="o">.</span><span class="n">Avg</span>
        <span class="n">mpi_dict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_val</span><span class="o">.</span><span class="n">Std</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># ival = ival.reset_index()</span>
        <span class="c1"># ival = ival[ival[&#39;tmin_fm&#39;].apply(lambda x : float(x)) &gt;fit_tmin_min]</span>
        <span class="c1"># ival = ival[fit_tmin_max&gt;ival[&#39;tmin_fm&#39;].apply(lambda x : float(x))]</span>
        <span class="c1"># ival = ival.set_index([sqrt8t_key,&#39;tmin_fm&#39;])</span>
        <span class="c1"># ival = pa.Series(ival.values,index=ival.index)</span>
        <span class="n">this_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="n">this_arat_key</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="n">ikey</span><span class="p">)</span>
        <span class="c1"># fit_info[&#39;Funs&#39;] = [ConstantFitFun,1]</span>
        <span class="c1"># fit_info[&#39;iGuess&#39;] = [0,0]</span>
        <span class="c1"># this_fit.ScanBox_FixEnd(tflow_fit_min,tflow_fit_max,</span>
        <span class="c1">#                         fit_tmin_min,fit_tmin_max,</span>
        <span class="c1">#                         fit_info,min_fit_len_1=min_par_tflow,min_fit_len_2=min_par_tmin,</span>
        <span class="c1">#                         from_xdata=True)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanBox_maxdim2</span><span class="p">(</span><span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span>
                                <span class="n">fit_tmin_min</span><span class="p">,</span><span class="n">fit_tmin_max</span><span class="p">,</span>
                                <span class="n">fit_info_list</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="n">min_par_tflow</span><span class="p">,</span>
                                <span class="n">min_fit_len_2</span><span class="o">=</span><span class="n">min_par_tmin</span><span class="p">,</span>
                                <span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
        <span class="n">this_df</span> <span class="o">=</span> <span class="n">ival</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="n">sqrt8t_key</span><span class="p">,</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">,</span><span class="n">this_arat_key</span><span class="p">]]</span>
        <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;ens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
        <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;t0_vals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span>
        <span class="n">mass_val</span> <span class="o">=</span> <span class="n">GetMass_minfit</span><span class="p">(</span><span class="n">Fit_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">][</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span><span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">fit_tmin_min</span><span class="p">)</span>
        <span class="n">mpi_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_val</span><span class="o">.</span><span class="n">Avg</span>
        <span class="n">mpi_dict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass_val</span><span class="o">.</span><span class="n">Std</span>
        <span class="c1"># this_df = this_df.set_index([sqrt8t_key,&#39;tmin_fm&#39;])</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fit_file</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pik</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">this_fit</span><span class="p">,</span><span class="n">this_df</span><span class="p">,</span><span class="n">mass_val</span><span class="p">),</span><span class="n">f</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
    <span class="n">fit_ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mpi_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="mi">1</span><span class="o">/</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
    <span class="n">fit_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_fit</span><span class="p">)</span>
    <span class="n">Master_Fit_Data</span> <span class="o">=</span> <span class="n">Master_Fit_Data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ilist</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">fit_ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])</span>
    <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;ens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="n">best_fit</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">Fit_Stats_fmt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ibest</span><span class="p">,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ibest</span><span class="p">,</span><span class="n">ifit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">best_fit_picked</span><span class="p">,</span><span class="n">fit_data</span><span class="p">)]</span>
    <span class="n">eval_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="n">tflow_picked</span><span class="p">,</span><span class="n">tmin_picked</span><span class="p">)</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
    <span class="n">chi_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">Get_Chi2DoF</span><span class="p">()</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
    <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Fit_Best_Eval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">eval_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Fit_Best_chi2pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">par_list_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
        <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">par_list_a</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;b&#39;</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">par_list_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
        <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">par_list_b</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">par_list_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
        <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">par_list_c</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">par_list_d</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifit</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">best_fit</span><span class="p">]</span>
        <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">par_list_d</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>

<span class="n">Master_Fit_Data</span> <span class="o">=</span> <span class="n">Master_Fit_Data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">sqrt8t_key</span><span class="p">,</span><span class="s1">&#39;tmin_fm&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="c1"># A0Fit_data[&#39;Fit&#39;].iloc[5].Fit_Stats_fmt[&#39;Fit&#39;].apply(lambda x : x.fit_data[&#39;Chi2DoF&#39;]).head()</span>
<span class="c1"># A0Fit_data[&#39;Fit&#39;].iloc[0].Fit_Stats_fmt[&#39;Fit&#39;].apply(lambda x : x.fit_data[&#39;Params&#39;])</span>
<span class="c1"># if sqrt8t_key in Master_Fit_Data.columns:</span>
<span class="c1">#     del Master_Fit_Data[sqrt8t_key]</span>
<span class="c1"># if &#39;tmin_fm&#39; in Master_Fit_Data.columns:</span>
<span class="c1">#     del Master_Fit_Data[&#39;tmin_fm&#39;]</span>
<span class="n">fit_file</span> <span class="o">=</span> <span class="n">temp_folder</span><span class="o">+</span><span class="s1">&#39;/fit_combine&#39;</span><span class="o">+</span><span class="n">file_kappa</span><span class="o">+</span><span class="s1">&#39;_fitr&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_tmin_min</span><span class="o">*</span><span class="mi">10</span><span class="p">)),</span>
                                                     <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_tmin_max</span><span class="o">*</span><span class="mi">10</span><span class="p">))])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;.p&#39;</span>

<span class="c1"># Master_Fit_Data</span>
<span class="c1"># Master_Fit_Data = Master_Fit_Data.reset_index()</span>
<span class="c1"># Master_Fit_Data[&#39;tmin_fm&#39;].apply(lambda x : float(x)) &gt;fit_tmin_min</span>
<span class="c1"># Master_Fit_Data = Master_Fit_Data[Master_Fit_Data[&#39;tmin_fm&#39;].apply(lambda x : float(x)) &gt;fit_tmin_min]</span>
<span class="c1"># Master_Fit_Data = Master_Fit_Data[fit_tmin_max&gt;Master_Fit_Data[&#39;tmin_fm&#39;].apply(lambda x : float(x))]</span>
<span class="n">DefWipe</span> <span class="o">=</span> <span class="n">DefWipe</span> <span class="ow">or</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">do_exraps</span><span class="p">:</span>
    <span class="n">par_fit_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fit_file</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fit_file</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">combine_fit</span><span class="p">,</span><span class="n">cont_fit</span><span class="p">,</span><span class="n">par_fit_list</span> <span class="o">=</span> <span class="n">pik</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">cont_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">combine_fit</span><span class="p">,</span><span class="n">par_fit_list</span> <span class="o">=</span> <span class="n">pik</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">combine_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Master_Fit_Data</span><span class="p">[</span><span class="n">this_arat_key</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;combined&#39;</span><span class="p">)</span>
        <span class="n">combine_fit</span><span class="o">.</span><span class="n">ScanBox_FixEnd_maxdim2</span><span class="p">(</span> <span class="n">tflow_fit_min</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">],</span><span class="n">tflow_fit_max</span><span class="p">[</span><span class="s1">&#39;mpi410&#39;</span><span class="p">],</span>
                                    <span class="n">fit_tmin_min</span><span class="p">,</span><span class="n">fit_tmin_max</span><span class="p">,</span>
                                    <span class="n">fit_info_list</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="n">min_par_tflow</span><span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="n">min_par_tmin</span><span class="p">,</span>
                                    <span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">combine_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
        <span class="n">combine_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
        <span class="n">combine_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cont_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Fit_Best_Eval&#39;</span><span class="p">]</span>
            <span class="n">cont_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">cont_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;cont_extrap&#39;</span><span class="p">)</span>
            <span class="n">cont_fit</span><span class="o">.</span><span class="n">ScanBox</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cont_fit_info</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">1</span>
                                <span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">cont_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="n">cont_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="n">cont_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;Par_a&#39;</span> <span class="ow">in</span> <span class="n">A0Fit_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">Par_a_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span>
            <span class="n">Par_a_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Par_a_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Par_a&#39;</span><span class="p">)</span>
            <span class="n">Par_a_fit</span><span class="o">.</span><span class="n">ScanBox</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cont_fit_info</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">1</span>
                                <span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Par_a_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="n">Par_a_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="n">Par_a_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
            <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Par_a_fit</span>

        <span class="k">if</span> <span class="s1">&#39;Par_b&#39;</span> <span class="ow">in</span> <span class="n">A0Fit_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">Par_b_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span>
            <span class="n">Par_b_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Par_b_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Par_b&#39;</span><span class="p">)</span>
            <span class="n">Par_b_fit</span><span class="o">.</span><span class="n">ScanBox</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cont_fit_info</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">1</span>
                                <span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Par_b_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="n">Par_b_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="n">Par_b_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
            <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Par_b_fit</span>

        <span class="k">if</span> <span class="s1">&#39;Par_c&#39;</span> <span class="ow">in</span> <span class="n">A0Fit_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">Par_c_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span>
            <span class="n">Par_c_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Par_c_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Par_c&#39;</span><span class="p">)</span>
            <span class="n">Par_c_fit</span><span class="o">.</span><span class="n">ScanBox</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cont_fit_info</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">1</span>
                                <span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Par_c_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="n">Par_c_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="n">Par_c_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
            <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Par_c_fit</span>

        <span class="k">if</span> <span class="s1">&#39;Par_d&#39;</span> <span class="ow">in</span> <span class="n">A0Fit_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">Par_d_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span>
            <span class="n">Par_d_fit</span> <span class="o">=</span> <span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Par_d_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Par_d&#39;</span><span class="p">)</span>
            <span class="n">Par_d_fit</span><span class="o">.</span><span class="n">ScanBox</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cont_fit_info</span><span class="p">,</span><span class="n">min_fit_len_1</span><span class="o">=</span><span class="mi">1</span>
                                <span class="p">,</span><span class="n">min_fit_len_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Par_d_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="n">Par_d_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="n">Par_d_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
            <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Par_d_fit</span>


        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fit_file</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pik</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">combine_fit</span><span class="p">,</span><span class="n">cont_fit</span><span class="p">,</span><span class="n">par_fit_list</span><span class="p">),</span><span class="n">f</span><span class="p">)</span>
                <span class="n">cont_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pik</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">combine_fit</span><span class="p">,</span><span class="n">par_fit_list</span><span class="p">),</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ifit</span> <span class="ow">in</span> <span class="n">par_fit_list</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">ifit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
    <span class="n">combine_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>


<span class="c1"># c = (1-0.66/0.43)/(np.log((0.22**2)/8)-((0.66/0.43)*np.log((0.11**2)/8)))</span>
<span class="c1"># b = (-0.43*(-0.11 + np.log((0.11**2)/8)))</span>
<span class="c1"># c</span>
<span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">Fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">second_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="n">this_arat_key</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="n">this_arat_key</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
    <span class="c1"># plot_fit = A0Fit_data[ikey].ReduceViaChi(nchi_cutoff=15)[0]</span>
    <span class="n">plot_fit</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;ens&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_fit</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span><span class="o">+</span><span class="s1">&#39; Fit&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

<span class="k">if</span> <span class="n">do_exraps</span><span class="p">:</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
    <span class="c1"># plot_comb = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
    <span class="n">plot_comb</span> <span class="o">=</span> <span class="n">combine_fit</span>
    <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_comb</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Combine Fit&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
    <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;combine_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

<span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/&#39;</span><span class="o">+</span><span class="n">file_kappa</span><span class="o">+</span><span class="s1">&#39;_master_&#39;</span><span class="o">+</span><span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
<span class="k">if</span> <span class="n">DoTree</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$A(t_</span><span class="si">{f}</span><span class="s1">)/A(0)$ Div Tree &#39;</span> <span class="o">+</span> <span class="n">picked_kappa</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$A(t_</span><span class="si">{f}</span><span class="s1">)/A(0)$&#39;</span>
<span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}}{\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}}$&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}[fm]$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$A(t_</span><span class="si">{f}</span><span class="s1">)/A(0)$&#39;</span>
<span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
<span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">ShowFigure</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>

<span class="k">if</span> <span class="n">do_exraps</span><span class="p">:</span>
    <span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
    <span class="c1"># hold_series[&#39;key_select&#39;] = (f&#39;{mpi_dict[&quot;mpi410&quot;]:.5f}&#39;,slice(None))</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Fit_Best_Eval&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.5f}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.3f}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">a_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])[</span><span class="s1">&#39;Fit_Best_Eval&#39;</span><span class="p">]</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs a&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\frac{\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}}{\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}}=&#39;</span><span class="o">+</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{tflow_picked:.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs a&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}=&#39;</span><span class="o">+</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{tflow_picked:.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span>
    <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs 1_div_t0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
    <span class="c1"># hold_series[&#39;key_select&#39;] = (slice(None),)</span>
    <span class="n">mpi_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">])[</span><span class="s1">&#39;Fit_Best_Eval&#39;</span><span class="p">]</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\frac{\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}}{\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}}=&#39;</span><span class="o">+</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{tflow_picked:.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt{8t_</span><span class="si">{f}</span><span class="s1">}=&#39;</span><span class="o">+</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{tflow_picked:.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span>
    <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs mpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_cont = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
        <span class="n">plot_cont</span> <span class="o">=</span> <span class="n">cont_fit</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_cont</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Continum Extrapolation&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;combine_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/&#39;</span><span class="o">+</span><span class="n">file_kappa</span><span class="o">+</span><span class="s1">&#39;_cont_&#39;</span><span class="o">+</span><span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="k">if</span> <span class="n">DoTree</span><span class="p">:</span>
        <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;cont. extraps. Div Tree &#39;</span> <span class="o">+</span> <span class="n">picked_kappa</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;cont. extraps.&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$m_{\pi} [GeV]$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$val(m_{\pi},a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">)$&#39;</span>
    <span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
    <span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">ShowFigure</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>

    <span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;Par_a&#39;</span> <span class="ow">in</span> <span class="n">par_fit_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_cont = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;param a&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;fitpar_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (f&#39;{mpi_dict[&quot;mpi410&quot;]:.5f}&#39;,slice(None))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.5f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.3f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">a_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Ens Results vs $a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$, par a&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs 1_div_t0 par a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (slice(None),)</span>
        <span class="n">mpi_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_a&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi, par a&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs mpi par a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>


    <span class="k">if</span> <span class="s1">&#39;Par_b&#39;</span> <span class="ow">in</span> <span class="n">par_fit_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_cont = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;param b&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;fitpar_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (f&#39;{mpi_dict[&quot;mpi410&quot;]:.5f}&#39;,slice(None))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.5f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.3f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">a_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Ens Results vs $a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$, par b&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs 1_div_t0 par b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (slice(None),)</span>
        <span class="n">mpi_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_b&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi, par b&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs mpi par b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>


    <span class="k">if</span> <span class="s1">&#39;Par_c&#39;</span> <span class="ow">in</span> <span class="n">par_fit_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_cont = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;param c&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;fitpar_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (f&#39;{mpi_dict[&quot;mpi410&quot;]:.5f}&#39;,slice(None))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.5f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.3f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">a_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Ens Results vs $a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$, par c&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs 1_div_t0 par c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (slice(None),)</span>
        <span class="n">mpi_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_c&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi, par c&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs mpi par c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

    <span class="k">if</span> <span class="s1">&#39;Par_d&#39;</span> <span class="ow">in</span> <span class="n">par_fit_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_cont = combine_fit.ReduceViaChi(nchi_cutoff=20)[0]</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = plot_comb.Fit_Stats.index[0]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_fit_list</span><span class="p">[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;param d&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;otherXvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;fitpar_d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (f&#39;{mpi_dict[&quot;mpi410&quot;]:.5f}&#39;,slice(None))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">A0Fit_data</span><span class="p">[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.5f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.3f}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">a_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$ fm&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Ens Results vs $a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">$, par d&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;ens results vs t_0 par d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;key_select&#39;] = (slice(None),)</span>
        <span class="n">mpi_plot_data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$m_{\pi}$ GeV&#39;</span><span class="p">])[</span><span class="s1">&#39;Par_d&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpi_plot_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ens Results vs mpi, par d&#39;</span>
        <span class="n">this_data</span><span class="p">[</span><span class="s1">&#39;ens results vs mpi par d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>


    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/&#39;</span><span class="o">+</span><span class="n">file_kappa</span><span class="o">+</span><span class="s1">&#39;_params_&#39;</span><span class="o">+</span><span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="k">if</span> <span class="n">DoTree</span><span class="p">:</span>
        <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;cont. extraps. Div Tree &#39;</span> <span class="o">+</span> <span class="n">picked_kappa</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;cont. extraps.&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$m_{\pi} [GeV]$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$val(m_{\pi},a^</span><span class="si">{2}</span><span class="s1">/t_</span><span class="si">{0}</span><span class="s1">)$&#39;</span>
    <span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
    <span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">ShowFigure</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>

<span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">Fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>
<span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/Mass_master.pdf&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Effective Mass&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{cut}</span><span class="s1"> [fm]$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$EffM[GeV]$&#39;</span>
<span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
<span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">ShowFigure</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>

<span class="n">this_data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">Fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_key</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">ivals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">itf</span><span class="p">,</span><span class="n">itc</span><span class="p">),</span><span class="n">this_ival</span> <span class="ow">in</span> <span class="n">ival</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ivals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_ival</span><span class="o">/</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">][(</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="n">itc</span><span class="p">)])</span>
        <span class="n">ivals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
    <span class="n">this_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ivals</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;E_GeV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_series</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_series</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
    <span class="n">this_data</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">hold_series</span>
<span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/jackdra/LQCD/Scripts/Jose_PoS/DataGraphs/Jacks/MM0_master.pdf&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Effective Mass Flowed Ratio&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{cut}</span><span class="s1"> [fm]$&#39;</span>
<span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$M(t_</span><span class="si">{f}</span><span class="s1">)/M(0)$&#39;</span>
<span class="c1"># this_info[&#39;xlims&#39;] = [0,10]</span>
<span class="c1"># this_info[&#39;ylims&#39;] = [0,15]</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_data</span><span class="o">=</span><span class="n">this_data</span><span class="p">,</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">ShowFigure</span><span class="p">()</span>
<span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>

<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="c1"># import numpy as np</span>
<span class="c1">#</span>
<span class="c1"># xvals = np.mgrid[0.1:1:100j]</span>
<span class="c1"># # yvals = 1 +2.8/(np.log((xvals**2)/8)-0.11)</span>
<span class="c1"># yvals1 = c3FitFun_NoA([xvals],[1.08,3.65])</span>
<span class="c1"># yvals2 = c3FitFun_NoA([xvals],[1.28,3.65])</span>
<span class="c1"># yvals3 = c3FitFun_NoA([xvals],[1.08,2.65])</span>
<span class="c1"># yvals4 = c3FitFun_NoA([xvals],[1.28,2.65])</span>
<span class="c1"># pl.clf()</span>
<span class="c1"># pl.plot(xvals,yvals1,label=&#39;1&#39;)</span>
<span class="c1"># pl.plot(xvals,yvals2,label=&#39;2&#39;)</span>
<span class="c1"># pl.plot(xvals,yvals3,label=&#39;3&#39;)</span>
<span class="c1"># pl.plot(xvals,yvals4,label=&#39;4&#39;)</span>
<span class="c1"># pl.legend()</span>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Jack Dragos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>
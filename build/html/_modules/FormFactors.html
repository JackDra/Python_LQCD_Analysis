

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FormFactors &mdash; LQCD Analysis Codebase TF Fits documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LQCD Analysis Codebase
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LQCD Analysis Codebase</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>FormFactors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for FormFactors</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">GammaMatricies</span> <span class="k">import</span> <span class="n">CorrSpinTrace</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">ODNested</span><span class="p">,</span><span class="n">mkdir_p</span>
<span class="kn">import</span> <span class="nn">MomParams</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>

<span class="kn">from</span> <span class="nn">BootStrapping</span> <span class="k">import</span> <span class="n">BootStrap</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">FormFactorO1</span><span class="p">,</span><span class="n">FormFactorO2</span><span class="p">,</span><span class="n">FormFactorO3</span>
<span class="kn">from</span> <span class="nn">TwoPtCorrelators</span> <span class="k">import</span> <span class="n">TwoPointCorr</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">,</span><span class="n">NNQFullCorr</span>
<span class="kn">from</span> <span class="nn">FitFunctions</span> <span class="k">import</span> <span class="n">Fitting</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">outputdir</span><span class="p">,</span><span class="n">defInfo</span><span class="p">,</span><span class="n">alpha_guess</span><span class="p">,</span><span class="n">myeps</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">WriteExcel</span><span class="p">,</span><span class="n">Construct_File_Object</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">AvgStdToFormat</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">WriteXml</span><span class="p">,</span><span class="n">WritePickle</span><span class="p">,</span><span class="n">ReadPickleWrap</span><span class="p">,</span><span class="n">ReadFuns</span><span class="p">,</span><span class="n">WriteFuns</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">DPfitfun</span><span class="p">,</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="n">A_x_exp_minus_m_x</span>
<span class="c1"># import dill as pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>


<span class="c1">## form factor parameters defined up here ########################################################################</span>

<span class="n">veclist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>

<span class="n">gi</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">veclist</span><span class="p">]</span>
<span class="n">giTop</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;Top&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">veclist</span><span class="p">]</span>
<span class="c1"># giTop = [&#39;g&#39;+str(i)+&#39;Top&#39; for i in [4]]</span>
<span class="n">giWein</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;Wein&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">veclist</span><span class="p">]</span>
<span class="n">gig5</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;g5&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">veclist</span><span class="p">]</span>
<span class="n">g5gi</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;g5&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">veclist</span><span class="p">]</span>
<span class="n">Pi</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;P&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>

<span class="n">gigj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">gii</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gi</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">gij</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gi</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">&gt;</span><span class="n">i</span><span class="p">:</span>
            <span class="n">gigj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gij</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">gjgi</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">gii</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gi</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">gij</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gi</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">j</span><span class="p">:</span>
            <span class="n">gjgi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gij</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># gic = [(&#39;g&#39;+str(i),&#39;cmplx&#39;) for i in veclist]</span>
<span class="c1"># giTopc = [(&#39;g&#39;+str(i),&#39;Top&#39;,&#39;cmplx&#39;) for i in veclist]</span>
<span class="c1"># # giTop = [&#39;g&#39;+str(i)+&#39;Top&#39; for i in [4]]</span>
<span class="c1"># giWeinc = [(&#39;g&#39;+str(i),&#39;Wein&#39;,&#39;cmplx&#39;) for i in veclist]</span>
<span class="c1"># gig5c = [(&#39;g&#39;+str(i),&#39;g5&#39;,&#39;cmplx&#39;) for i in veclist]</span>
<span class="c1"># g5gic = [(&#39;g5&#39;,&#39;g&#39;+str(i),&#39;cmplx&#39;) for i in veclist]</span>

<span class="c1"># gigjc = []</span>
<span class="c1"># for i,gii in enumerate(gi):</span>
<span class="c1">#     for j,gij in enumerate(gi):</span>
<span class="c1">#         if j&gt;i:</span>
<span class="c1">#             gigj.append((gii[0],gij[0],&#39;cmplx&#39;))</span>
<span class="c1"># gjgic = []</span>
<span class="c1"># for i,gii in enumerate(gi):</span>
<span class="c1">#     for j,gij in enumerate(gi):</span>
<span class="c1">#         if i&gt;j:</span>
<span class="c1">#             gjgi.append((gii[0],gij[0],&#39;cmplx&#39;))</span>



<span class="n">PiI</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="n">Pig5</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="n">Pigi</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="n">Pigig5</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Pigigj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">PigiTop</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="n">PigiWein</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># PiI,PiIc    = [],[]</span>
<span class="c1"># Pig5,Pig5c   = [],[]</span>
<span class="c1"># Pigi,Pigic   = [],[]</span>
<span class="c1"># Pigig5,Pigig5c = [],[]</span>
<span class="c1"># Pigigj,Pigigjc = [],[]</span>
<span class="c1"># PigiTop,PigiTopc   = [],[]</span>
<span class="c1"># PigiWein,PigiWeinc   = [],[]</span>
<span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">Pi</span><span class="p">:</span>
    <span class="n">PiI</span>    <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ip</span><span class="p">,[</span><span class="s1">&#39;I&#39;</span><span class="p">]))</span>
    <span class="n">Pig5</span>   <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ip</span><span class="p">,[</span><span class="s1">&#39;g5&#39;</span><span class="p">]))</span>
    <span class="n">Pigi</span>   <span class="o">+=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">igi</span> <span class="k">for</span> <span class="n">igi</span> <span class="ow">in</span> <span class="n">gi</span><span class="p">]</span>
    <span class="n">Pigig5</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">igig5</span> <span class="k">for</span> <span class="n">igig5</span> <span class="ow">in</span> <span class="n">gig5</span><span class="p">]</span>
    <span class="n">Pigigj</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">igigj</span> <span class="k">for</span> <span class="n">igigj</span> <span class="ow">in</span> <span class="n">gigj</span><span class="p">]</span>
    <span class="n">PigiTop</span>   <span class="o">+=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">igit</span> <span class="k">for</span> <span class="n">igit</span> <span class="ow">in</span> <span class="n">giTop</span><span class="p">]</span>
    <span class="n">PigiWein</span>   <span class="o">+=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">igiw</span> <span class="k">for</span> <span class="n">igiw</span> <span class="ow">in</span> <span class="n">giWein</span><span class="p">]</span>
    <span class="c1"># PiIc    += ((ip + (&#39;I&#39;,&#39;cmplx&#39;)),)</span>
    <span class="c1"># Pig5c   += ((ip + (&#39;g5&#39;,&#39;cmplx&#39;)),)</span>
    <span class="c1"># Pigic   += [ip+igi for igi in gic]</span>
    <span class="c1"># Pigig5c += [ip+igig5 for igig5 in gig5c]</span>
    <span class="c1"># Pigigjc += [ip+igigj for igigj in gigjc]</span>
    <span class="c1"># PigiTopc   += [ip+igit for igit in giTopc]</span>
    <span class="c1"># PigiWeinc   += [ip+igiw for igiw in giWeinc]</span>

<span class="c1"># CurrTypes = [&#39;Scalar&#39;,&#39;Vector&#39;,&#39;VectorTop&#39;,&#39;VectorWein&#39;,&#39;VectorTopNoV&#39;,&#39;PsScalar&#39;,&#39;PsVector&#39;,&#39;Tensor&#39;]</span>
<span class="c1">##TODO implement Tensor</span>
<span class="n">CurrTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Scalar&#39;</span><span class="p">,</span><span class="s1">&#39;Vector&#39;</span><span class="p">,</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">,</span><span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">,</span><span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">,</span><span class="s1">&#39;VectorWein&#39;</span><span class="p">,</span><span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">,</span><span class="s1">&#39;PsScalar&#39;</span><span class="p">,</span><span class="s1">&#39;PsVector&#39;</span><span class="p">,</span><span class="s1">&#39;Tensor&#39;</span><span class="p">,</span><span class="s1">&#39;GeGm&#39;</span><span class="p">]</span>
<span class="n">DerCurrTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;giDi&#39;</span><span class="p">]</span>
<span class="n">AllCurrTypes</span> <span class="o">=</span> <span class="n">CurrTypes</span> <span class="o">+</span> <span class="n">DerCurrTypes</span>

<span class="c1"># CurrOpps = {&#39;Scalar&#39;   : PiI,</span>
<span class="c1">#             &#39;Vector&#39;   : Pigi+Pigic,</span>
<span class="c1">#             &#39;VectorTop&#39;: Pigi+PigiTop+Pigic+PigiTopc,</span>
<span class="c1">#             &#39;VectorWein&#39;: Pigi+PigiWein+Pigic+PigiWeinc,</span>
<span class="c1">#             &#39;VectorTopNoV&#39;: PigiTop+PigiTopc,</span>
<span class="c1">#             &#39;PsScalar&#39; : Pig5+Pig5c,</span>
<span class="c1">#             &#39;PsVector&#39; : Pigig5+Pigig5c}</span>
<span class="c1">#             # &#39;Tensor&#39;   : Pigigj+Pigigjc}</span>


<span class="c1"># CurrOppsNoProj = {&#39;Scalar&#39;   : [(&#39;I&#39;,)],</span>
<span class="c1">#                   &#39;Vector&#39;   : gi+gic,</span>
<span class="c1">#                   &#39;VectorTop&#39;: gi+giTop+gic+giTopc,</span>
<span class="c1">#                   &#39;VectorWein&#39;: gi+giWein+gic+giWeinc,</span>
<span class="c1">#                   &#39;VectorTopNoV&#39;: giTop+giTopc,</span>
<span class="c1">#                   &#39;PsScalar&#39; : [(&#39;g5&#39;,),(&#39;g5&#39;,&#39;cmplx&#39;)],</span>
<span class="c1">#                   &#39;PsVector&#39; : gig5+gig5c}</span>
<span class="c1">#                   # &#39;Tensor&#39;   : gigj+gigjc}</span>

<span class="c1"># ## changes order of gamma matricies for  for gig5 and gigj</span>
<span class="c1"># CurrOppsNoProjSigBack = {&#39;Scalar&#39;   : [(&#39;I&#39;,)],</span>
<span class="c1">#                          &#39;Vector&#39;   : gi+gic,</span>
<span class="c1">#                          &#39;VectorTop&#39;: gi+giTop+gic+giTopc,</span>
<span class="c1">#                          &#39;VectorWein&#39;: gi+giWein+gic+giWeinc,</span>
<span class="c1">#                          &#39;VectorTopNoV&#39;: giTop+giTopc,</span>
<span class="c1">#                          &#39;PsScalar&#39; : [(&#39;g5&#39;,),(&#39;g5&#39;,&#39;cmplx&#39;)],</span>
<span class="c1">#                          &#39;PsVector&#39; : g5gi+g5gic}</span>
<span class="c1">#                          # &#39;Tensor&#39;   : gjgi+gjgic}</span>

<span class="n">CurrOpps</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>   <span class="p">:</span> <span class="n">PiI</span><span class="p">,</span>
            <span class="s1">&#39;Vector&#39;</span>   <span class="p">:</span> <span class="n">Pigi</span><span class="p">,</span>
            <span class="s1">&#39;GeGm&#39;</span>   <span class="p">:</span> <span class="n">Pigi</span><span class="p">,</span>
            <span class="s1">&#39;VectorTop&#39;</span><span class="p">:</span> <span class="n">Pigi</span><span class="o">+</span><span class="n">PigiTop</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="n">Pigi</span><span class="o">+</span><span class="n">PigiTop</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="n">Pigi</span><span class="o">+</span><span class="n">PigiTop</span><span class="p">,</span>
            <span class="s1">&#39;VectorWein&#39;</span><span class="p">:</span> <span class="n">Pigi</span><span class="o">+</span><span class="n">PigiWein</span><span class="p">,</span>
            <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="n">Pigi</span><span class="o">+</span><span class="n">PigiWein</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="n">PigiTop</span><span class="p">,</span>
            <span class="s1">&#39;PsScalar&#39;</span> <span class="p">:</span> <span class="n">Pig5</span><span class="p">,</span>
            <span class="s1">&#39;PsVector&#39;</span> <span class="p">:</span> <span class="n">Pigig5</span><span class="p">,</span>
            <span class="s1">&#39;Tensor&#39;</span>   <span class="p">:</span> <span class="n">Pigigj</span><span class="p">}</span>


<span class="n">CurrOppsNoProj</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>   <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;I&#39;</span><span class="p">,)],</span>
                  <span class="s1">&#39;Vector&#39;</span>   <span class="p">:</span> <span class="n">gi</span><span class="p">,</span>
                  <span class="s1">&#39;GeGm&#39;</span>   <span class="p">:</span> <span class="n">gi</span><span class="p">,</span>
                  <span class="s1">&#39;VectorTop&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                  <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                  <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                  <span class="s1">&#39;VectorWein&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giWein</span><span class="p">,</span>
                  <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giWein</span><span class="p">,</span>
                  <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="n">giTop</span><span class="p">,</span>
                  <span class="s1">&#39;PsScalar&#39;</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;g5&#39;</span><span class="p">,)],</span>
                  <span class="s1">&#39;PsVector&#39;</span> <span class="p">:</span> <span class="n">gig5</span><span class="p">,</span>
                  <span class="s1">&#39;Tensor&#39;</span>   <span class="p">:</span> <span class="n">gigj</span><span class="p">}</span>

<span class="c1">## changes order of gamma matricies for  for gig5 and gigj</span>
<span class="n">CurrOppsNoProjSigBack</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>   <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;I&#39;</span><span class="p">,)],</span>
                         <span class="s1">&#39;Vector&#39;</span>   <span class="p">:</span> <span class="n">gi</span><span class="p">,</span>
                         <span class="s1">&#39;GeGm&#39;</span>   <span class="p">:</span> <span class="n">gi</span><span class="p">,</span>
                         <span class="s1">&#39;VectorTop&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                         <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                         <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giTop</span><span class="p">,</span>
                         <span class="s1">&#39;VectorWein&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giWein</span><span class="p">,</span>
                         <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="n">gi</span><span class="o">+</span><span class="n">giWein</span><span class="p">,</span>
                         <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="n">giTop</span><span class="p">,</span>
                         <span class="s1">&#39;PsScalar&#39;</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;g5&#39;</span><span class="p">,)],</span>
                         <span class="s1">&#39;PsVector&#39;</span> <span class="p">:</span> <span class="n">g5gi</span><span class="p">,</span>
                         <span class="s1">&#39;Tensor&#39;</span>   <span class="p">:</span> <span class="n">gjgi</span><span class="p">}</span>


<span class="n">FFFitFuns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>      <span class="p">:</span> <span class="n">FormFactorO1</span><span class="p">,</span>
             <span class="s1">&#39;Vector&#39;</span>      <span class="p">:</span> <span class="n">FormFactorO2</span><span class="p">,</span>
             <span class="s1">&#39;GeGm&#39;</span>        <span class="p">:</span> <span class="n">FormFactorO2</span><span class="p">,</span>
             <span class="s1">&#39;VectorTop&#39;</span>   <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;VectorTopBNL&#39;</span>   <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;VectorTopBNL_mal&#39;</span>   <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;VectorWein&#39;</span>  <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;VectorWeinBNL&#39;</span>  <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">,</span>
             <span class="s1">&#39;PsScalar&#39;</span>    <span class="p">:</span> <span class="n">FormFactorO1</span><span class="p">,</span>
             <span class="s1">&#39;PsVector&#39;</span>    <span class="p">:</span> <span class="n">FormFactorO2</span><span class="p">,</span>
             <span class="s1">&#39;Tensor&#39;</span>      <span class="p">:</span> <span class="n">FormFactorO3</span><span class="p">}</span>



<span class="n">NoFFPars</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>   <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;Vector&#39;</span>   <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;GeGm&#39;</span>   <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;VectorTop&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;VectorWein&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;PsScalar&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;PsVector&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;Tensor&#39;</span>   <span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">FFParams</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>      <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;G_</span><span class="si">{S}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Vector&#39;</span>      <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorTop&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorTopBNL&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorTopBNL_mal&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;alpha F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;alpha tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;alpha tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorWein&#39;</span>  <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorWeinBNL&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;GeGm&#39;</span>        <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;G_</span><span class="si">{E}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;G_</span><span class="si">{M}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;PsScalar&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;G_</span><span class="si">{P}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;PsVector&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;G_</span><span class="si">{A}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;G_</span><span class="si">{P}</span><span class="s1">&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Tensor&#39;</span>      <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;H_</span><span class="si">{T}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;E_</span><span class="si">{T}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;tilde</span><span class="si">{H}</span><span class="s1">_</span><span class="si">{T}</span><span class="s1">&#39;</span><span class="p">]}</span>

<span class="n">FFQ2FitFun</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;Scalar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>         <span class="s1">&#39;G_</span><span class="si">{S}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>         <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;GeGm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>           <span class="s1">&#39;G_</span><span class="si">{E}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;G_</span><span class="si">{M}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;Nucleon_GeGm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>   <span class="s1">&#39;G_</span><span class="si">{E}</span><span class="s1">&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">A_x_exp_minus_m_x</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;G_</span><span class="si">{M}</span><span class="s1">&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;Nucleon_Vector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">A_x_exp_minus_m_x</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;PsScalar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>       <span class="s1">&#39;G_</span><span class="si">{P}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;PsVector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>       <span class="s1">&#39;G_</span><span class="si">{A}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;G_</span><span class="si">{P}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;Tensor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>         <span class="s1">&#39;H_</span><span class="si">{T}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;E_</span><span class="si">{T}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">A_x_exp_minus_m_x</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                           <span class="s1">&#39;tilde</span><span class="si">{H}</span><span class="s1">_</span><span class="si">{T}</span><span class="s1">&#39;</span>  <span class="p">:</span> <span class="p">(</span><span class="n">A_x_exp_minus_m_x</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>      <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;frac{F_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>   <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;frac{tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>   <span class="s1">&#39;alpha F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;alpha tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;alpha tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;alpha frac{tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorWein&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>     <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;frac{F_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>  <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;frac{tilde</span><span class="si">{F}</span><span class="s1">_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>

<span class="n">FFQ2FitFun</span><span class="p">[</span><span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>   <span class="s1">&#39;F_</span><span class="si">{1}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{2}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">DPfitfun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="s1">&#39;F_</span><span class="si">{3}</span><span class="s1">&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                            <span class="s1">&#39;frac{F_</span><span class="si">{3}</span><span class="s1">}{2m_</span><span class="si">{N}</span><span class="s1">}&#39;</span>   <span class="p">:</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span>


<span class="n">FF_Imp</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;P4_g4&#39;</span><span class="p">)</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;P3_g1&#39;</span><span class="p">)</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;P3_g2&#39;</span><span class="p">)</span>

<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;P3_g4_Top&#39;</span><span class="p">)</span>

<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorWein&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;Vector&#39;</span><span class="p">]</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorWein&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;P3_g4_Wein&#39;</span><span class="p">)</span>

<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorWein&#39;</span><span class="p">]</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">]</span>
<span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF_Imp</span><span class="p">[</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">]</span>



<span class="c1"># normalisation for Vector Current from arXiv:1006.1164v2 theta = 0 result from table IX beta = 1.9, Iwasaki gauge action, clover term Csw=1.715</span>
<span class="n">FFRenorm</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>      <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;Vector&#39;</span>      <span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorTop&#39;</span>   <span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorWein&#39;</span>  <span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;GeGm&#39;</span>        <span class="p">:</span> <span class="mf">0.7354</span><span class="p">,</span>
            <span class="s1">&#39;PsScalar&#39;</span>    <span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;PsVector&#39;</span>    <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;Tensor&#39;</span>      <span class="p">:</span> <span class="mi">1</span><span class="p">}</span>



<span class="c1">##############################################################################################</span>



<div class="viewcode-block" id="FormFact"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact">[docs]</a><span class="k">class</span> <span class="nc">FormFact</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>


    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    This class should produce all form factor combinations for a particular from factor type</span>
<span class="sd">    (e.g. vector, pseudo-vector, tensor etc...)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FormFact.Construct_FormFact_File"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.Construct_FormFact_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_FormFact_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">FormFact</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">currtype</span><span class="p">,</span><span class="n">q2list</span><span class="p">,</span><span class="n">pp2list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfo</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">currtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CurrTypes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">currtype</span><span class="o">+</span><span class="s1">&#39; not recognised as a current type in FormFactors.py&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currtype</span> <span class="o">=</span> <span class="n">currtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Top&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currtype</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Wein&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fffun</span> <span class="o">=</span> <span class="n">FFFitFuns</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currOp</span> <span class="o">=</span> <span class="n">CurrOpps</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currOpNP</span> <span class="o">=</span> <span class="n">CurrOppsNoProj</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currOpNPFSig</span> <span class="o">=</span> <span class="n">CurrOppsNoProjSigBack</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npar</span> <span class="o">=</span> <span class="n">NoFFPars</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span> <span class="o">=</span> <span class="n">FFParams</span><span class="p">[</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">mom2list</span><span class="o">=</span><span class="n">pp2list</span><span class="p">,</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">mom2list</span><span class="o">=</span><span class="n">q2list</span><span class="p">,</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^</span><span class="si">{3}</span><span class="s1">\times &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>

        <span class="n">tracespin</span> <span class="o">=</span> <span class="n">CorrSpinTrace</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span> <span class="o">=</span> <span class="n">tracespin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currtype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="c1"># if not isinstance(mass,basestring):</span>
        <span class="c1">#     self.SetMass(mass)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self.mass = &#39;Not Set&#39;</span>
        <span class="c1"># if not isinstance(alpha,basestring):</span>
        <span class="c1">#     self.SetAlpha(alpha,tflowlist)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self.alpha = &#39;Not Set&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># ## self.paramDict { icurrOp , ipkey , iqkey , imass (, tflow ) , ipar } bs</span>
        <span class="c1"># ## (, tflow) if cp odd form factor with flow times</span>
        <span class="c1"># self.paramDict = &#39;Not Set&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;mass_and_alpha&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span><span class="s1">&#39;form_factor&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Col_Names</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;mass_and_alpha&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">,</span><span class="s1">&#39;form_factor&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;mass&#39;</span><span class="p">,</span><span class="s1">&#39;form_factor&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;mass&#39;</span><span class="p">,</span><span class="s1">&#39;form_factor&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        columns = FF FFAvg FFStd</span>
<span class="sd">        rows are param_Col_Names</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        columns = FF FFAvg FFStd</span>
<span class="sd">        rows are param_Col_Names</span>
<span class="sd">        &#39;&#39;&#39;</span>



<div class="viewcode-block" id="FormFact.AppendName"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.AppendName">[docs]</a>    <span class="k">def</span> <span class="nf">AppendName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">this_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,(</span><span class="nb">dict</span><span class="p">,</span><span class="n">OrderedDict</span><span class="p">)):</span>
            <span class="n">this_str</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,(</span><span class="nb">dict</span><span class="p">,</span><span class="n">OrderedDict</span><span class="p">)):</span>
            <span class="n">this_str</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">this_str</span><span class="p">)</span></div>

<div class="viewcode-block" id="FormFact.SetCustomName"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.SetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">SetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="c1"># if len(self.tflowlist) &gt; 0:</span>
            <span class="c1">#     if self.tflowlist[0] == &#39;none&#39;:</span>
            <span class="c1">#         self.name = &#39;_&#39;.join([  self.currtype,&#39;q&#39;+&#39;&#39;.join(map(str,self.qparams.mom2list)),</span>
            <span class="c1">#                                 &#39;pp&#39;+&#39;&#39;.join(map(str,self.ppparams.mom2list))])</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         self.name = &#39;_&#39;.join([  self.currtype,&#39;q&#39;+&#39;&#39;.join(map(str,self.qparams.mom2list)),</span>
            <span class="c1">#                                 &#39;pp&#39;+&#39;&#39;.join(map(str,self.ppparams.mom2list)),self.tflowlist[0]])</span>
            <span class="c1"># else:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>  <span class="bp">self</span><span class="o">.</span><span class="n">currtype</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">mom2list</span><span class="p">)),</span>
                                    <span class="s1">&#39;pp&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">mom2list</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">string</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">+</span> <span class="s1">&#39;FFcoeffs/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFcoeffDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span></div>



<div class="viewcode-block" id="FormFact.GetRedFFParms"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.GetRedFFParms">[docs]</a>    <span class="k">def</span> <span class="nf">GetRedFFParms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetFFParams</span><span class="p">()</span>
        <span class="n">vall</span><span class="p">,</span><span class="n">keyl</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">vall_nd</span><span class="p">,</span><span class="n">qsqrdlist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">Avgl</span><span class="p">,</span><span class="n">Stdl</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">keycombl</span><span class="p">,</span><span class="n">coeffl</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iFF</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Col_Names</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iFF</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">iq</span> <span class="o">=</span> <span class="n">this_key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_key</span> <span class="o">=</span> <span class="n">ikey</span>
                <span class="n">iq</span> <span class="o">=</span> <span class="n">ikey</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">thisqsqrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Getpsqrdform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
            <span class="n">checkbool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">FFvals</span> <span class="o">=</span> <span class="n">iFF</span><span class="o">.</span><span class="n">values</span>
            <span class="n">FFvalsAvg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hold_val</span><span class="o">.</span><span class="n">Avg</span> <span class="k">for</span> <span class="n">hold_val</span> <span class="ow">in</span> <span class="n">FFvals</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iffavg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FFvalsAvg</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">iffavg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">myeps</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">ic</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">FFvalsAvg</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, form factor is all zero for:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ics</span><span class="p">,(</span><span class="n">pref_ff</span><span class="p">,</span><span class="n">prev_qsqrd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">vall_nd</span><span class="p">,</span><span class="n">qsqrdlist</span><span class="p">)):</span>
                <span class="n">prev_ffAvg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hold_val</span><span class="o">.</span><span class="n">Avg</span> <span class="k">for</span> <span class="n">hold_val</span> <span class="ow">in</span> <span class="n">pref_ff</span><span class="p">])</span>
                <span class="n">comp_rat</span> <span class="o">=</span> <span class="n">prev_ffAvg</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">/</span><span class="n">FFvalsAvg</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
                <span class="n">rat_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">denomen</span><span class="p">,</span><span class="n">numer</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">FFvalsAvg</span><span class="p">,</span><span class="n">prev_ffAvg</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">denomen</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">numer</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">rat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numer</span><span class="o">/</span><span class="n">denomen</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">rat_list</span> <span class="o">==</span> <span class="n">comp_rat</span><span class="p">)</span> <span class="ow">and</span> <span class="n">prev_qsqrd</span> <span class="o">==</span> <span class="n">thisqsqrd</span><span class="p">:</span>
                    <span class="n">checkbool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">keycombl</span><span class="p">[</span><span class="n">ics</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
                    <span class="n">coeffl</span><span class="p">[</span><span class="n">ics</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_rat</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">checkbool</span><span class="p">:</span>
                <span class="n">keycombl</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">this_key</span><span class="p">])</span>
                <span class="n">coeffl</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
                <span class="n">vall</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">FFvals</span><span class="p">)</span>
                <span class="n">vall_nd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">FFvals</span><span class="p">))</span>
                <span class="n">qsqrdlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisqsqrd</span><span class="p">)</span>
                <span class="n">Avgl</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ival</span><span class="o">.</span><span class="n">Avg</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">FFvals</span><span class="p">]</span>
                <span class="n">Stdl</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ival</span><span class="o">.</span><span class="n">Std</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">FFvals</span><span class="p">]</span>
                <span class="n">keyl</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iFF</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">keyl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Col_Names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vall</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FFAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Avgl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FFStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Stdl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combine_keys_forRF</span> <span class="o">=</span> <span class="n">keycombl</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coeffs_forRF</span> <span class="o">=</span> <span class="n">coeffl</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, error with reducing form factor list&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">])</span></div>
    <span class="c1">## imass is input parameter since we can use bootstrapped values</span>
    <span class="c1">## wrapped by MassFFParams()</span>
<div class="viewcode-block" id="FormFact.GetFFParms"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.GetFFParms">[docs]</a>    <span class="k">def</span> <span class="nf">GetFFParms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if thismass != &#39;PreDef&#39;: self.SetMass(thismass)</span>
        <span class="c1"># if thisalpha != &#39;PreDef&#39; and self.doflow: self.SetAlpha(thisalpha,thistflowlist)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">==</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;mass not set, either pass into MassFFParams() or use SetMass()&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">itflow</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Test&#39;</span><span class="p">:</span><span class="n">alpha_guess</span><span class="p">}</span>
        <span class="n">plist</span><span class="p">,</span><span class="n">pAvg</span><span class="p">,</span><span class="n">pStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;no tflowlist present with flowed operators&#39;</span><span class="p">)</span>
        <span class="n">looplist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currOp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">momformlist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">momformlist</span><span class="p">]</span>
        <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span> <span class="o">=</span> <span class="n">looplist</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FF &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">icurrOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currOp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">momformlist</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">momformlist</span><span class="p">:</span>
                    <span class="n">ipvec</span><span class="p">,</span><span class="n">iqvec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">TOpvec</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">actual</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">TOpvec</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">actual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                    <span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">TOpform</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="s1">&#39;pp&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">TOpform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
                    <span class="n">hold</span><span class="p">,</span><span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">iqvec</span><span class="p">,</span><span class="n">ipvec</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ccheck</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">rcheck</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">hold</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ArithmeticError</span><span class="p">(</span><span class="s1">&#39;Operator &#39;</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">icurrOp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;pp&#39;</span><span class="o">+</span><span class="n">ip</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="o">+</span><span class="n">iq</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39; has both real and imaginary components, check Form Factor coeff construction&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">ccheck</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">Opout</span> <span class="o">=</span> <span class="n">icurrOp</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;cmplx&#39;</span><span class="p">,)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Opout</span> <span class="o">=</span> <span class="n">icurrOp</span>
                    <span class="k">for</span> <span class="n">imass</span><span class="p">,</span><span class="n">bootmass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">ialpha</span><span class="p">,</span><span class="n">bootalpha</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                    <span class="n">holdlist</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">]</span>
                                    <span class="c1"># print bootmass.Avg,iqvec,ipvec,icurrOp</span>
                                    <span class="c1"># print rcheck, ccheck</span>
                                    <span class="c1"># print hold</span>
                                    <span class="n">thisalpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">bootalpha</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">bootmass</span><span class="o">.</span><span class="n">bootvals</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bootalpha</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                                        <span class="n">thisalpha</span> <span class="o">=</span> <span class="n">bootalpha</span><span class="o">.</span><span class="n">bootvals</span>
                                    <span class="k">for</span> <span class="n">bmass</span><span class="p">,</span><span class="n">balpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bootmass</span><span class="o">.</span><span class="n">bootvals</span><span class="p">,</span><span class="n">thisalpha</span><span class="p">):</span>
                                        <span class="n">hold</span><span class="p">,</span><span class="n">rdump</span><span class="p">,</span><span class="n">cdump</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">iqvec</span><span class="p">,</span><span class="n">ipvec</span><span class="p">,</span><span class="n">bmass</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">balpha</span><span class="p">)</span>
                                        <span class="k">if</span> <span class="n">rcheck</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                                <span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hold</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                                        <span class="k">if</span> <span class="n">ccheck</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                                <span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hold</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
                                    <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">])</span> <span class="o">!=</span> <span class="n">bootmass</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span> <span class="k">continue</span>
                                        <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Opout</span><span class="p">),</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">imass</span><span class="p">,</span><span class="n">ialpha</span><span class="p">]),</span><span class="n">itflow</span><span class="p">,</span><span class="n">ipar</span><span class="p">))</span>
                                        <span class="n">this_param</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="n">bootmass</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">ipar</span><span class="p">,</span><span class="n">bootvals</span><span class="o">=</span><span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">])</span>
                                        <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="p">)</span>
                                        <span class="n">pAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                                        <span class="n">pStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">holdlist</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">bmass</span> <span class="ow">in</span> <span class="n">bootmass</span><span class="o">.</span><span class="n">bootvals</span><span class="p">:</span>
                                <span class="n">hold</span><span class="p">,</span><span class="n">rdump</span><span class="p">,</span><span class="n">cdump</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">iqvec</span><span class="p">,</span><span class="n">ipvec</span><span class="p">,</span><span class="n">bmass</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">rcheck</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                        <span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hold</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">ccheck</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                        <span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hold</span><span class="p">[</span><span class="n">icpar</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">icpar</span><span class="p">,</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">):</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">])</span> <span class="o">!=</span> <span class="n">bootmass</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span> <span class="k">continue</span>
                                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Opout</span><span class="p">),</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">ipar</span><span class="p">))</span>
                                <span class="n">this_param</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="n">bootmass</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">ipar</span><span class="p">,</span><span class="n">bootvals</span><span class="o">=</span><span class="n">holdlist</span><span class="p">[</span><span class="n">icpar</span><span class="p">])</span>
                                <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="p">)</span>
                                <span class="n">pAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                                <span class="n">pStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_param</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                    <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Col_Names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FFAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FFStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>




    <span class="c1">## self.mass ends up as BootStrap class</span>
<div class="viewcode-block" id="FormFact.SetMass"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.SetMass">[docs]</a>    <span class="k">def</span> <span class="nf">SetMass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mass</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mass</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;C2_Fit_Stats in TwoPointCorr not calculated, please run Fit() on TwoPointCorr instance&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">istate</span><span class="p">,</span><span class="n">ip</span><span class="p">),</span><span class="n">fitdata</span> <span class="ow">in</span> <span class="n">mass</span><span class="o">.</span><span class="n">C2_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ip</span> <span class="o">!=</span> <span class="s1">&#39;p000&#39;</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">ifitr</span><span class="p">,</span><span class="n">this_data</span> <span class="o">=</span> <span class="n">fitdata</span><span class="o">.</span><span class="n">GetMaxFitr</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="s1">&#39;C2_&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istate</span><span class="p">,</span><span class="n">ifitr</span><span class="p">])]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span><span class="n">Fitting</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Fitting class instance has no parameter Energy&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="s1">&#39;C2_&#39;</span><span class="o">+</span><span class="n">mass</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">][</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="s1">&#39;C2_&#39;</span><span class="o">+</span><span class="n">mass</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span>
        <span class="k">elif</span> <span class="n">mass</span> <span class="o">==</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;mass input type not recognisied (see FormFactors.py, SetMass())&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FormFact.GetFuns"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;FFFun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">fffun</span> <span class="o">=</span> <span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFFun_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">fffun_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FormFact.RemoveFuns"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;FFFun&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">,</span><span class="s1">&#39;__name__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FFFun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fffun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fffun</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">fffun</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFFun</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">fffun</span></div>


    <span class="c1">## self.Alpha ends up as BootStrap class</span>
<div class="viewcode-block" id="FormFact.SetAlpha"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.SetAlpha">[docs]</a>    <span class="k">def</span> <span class="nf">SetAlpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">tflowlist</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">NNQFullCorr</span><span class="p">):</span>
            <span class="c1"># if self.kappafolder not in  [&#39;&#39;,alpha.kappafolder+&#39;/&#39;]:</span>
            <span class="c1">#     raise IOError(&#39;kappa folders used in FormFact (from FormFactors.py) have changed, check alpha and mass used.&#39;)</span>
            <span class="c1"># self.kappafolder = alpha.kappafolder + &#39;/&#39;</span>
            <span class="c1"># self.SetCustomName(string=self.name)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No fits have been performed on the AlphaFull object passed to Form Factors&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No zero momentum found in NNQFull_Fit_Stats in TwoPointCorr, try running Fit()&#39;</span><span class="p">)</span>
                <span class="n">ifitr</span><span class="p">,</span><span class="n">this_data</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQFull_Fit_Stats</span><span class="o">.</span><span class="n">at</span><span class="p">[(</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">GetMaxFitr</span><span class="p">()</span>
                <span class="n">ifitr</span> <span class="o">=</span> <span class="n">ifitr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;fittwor&#39;</span><span class="p">,</span><span class="s1">&#39;tsumfitr&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">][</span><span class="s1">&#39;alpha_&#39;</span><span class="o">+</span><span class="n">ifitr</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">):</span>
            <span class="c1"># if self.kappafolder not in  [&#39;&#39;,alpha.kappafolder+&#39;/&#39;]:</span>
            <span class="c1">#     raise IOError(&#39;kappa folders used in FormFact (from FormFactors.py) have changed, check alpha and mass used.&#39;)</span>
            <span class="c1"># self.kappafolder = alpha.kappafolder + &#39;/&#39;</span>
            <span class="c1"># self.SetCustomName(string=self.name)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No fits have been performed on the Alpha object passed to Form Factors&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No zero momentum found in NNQ_Fit_Stats in TwoPointCorr, try running Fit()&#39;</span><span class="p">)</span>
                <span class="n">ifitr</span><span class="p">,</span><span class="n">this_data</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NNQ_Fit_Stats</span><span class="o">.</span><span class="n">at</span><span class="p">[(</span><span class="s1">&#39;p000&#39;</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">GetMaxFitr</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">][</span><span class="s1">&#39;alpha_&#39;</span><span class="o">+</span><span class="n">ifitr</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">firstflow</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">firstflow</span><span class="p">],</span><span class="n">Fitting</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No tflow found in alpha.keys(), alpha can be dictionary with tflows&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Fitting class instance has no parameter Energy&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">][</span><span class="s1">&#39;alpha_&#39;</span><span class="o">+</span><span class="n">alpha</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">firstflow</span><span class="p">],</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">tflowlist</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No tflow found in alpha.keys(), alpha can be dictionary with tflows&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">][</span><span class="s1">&#39;alpha_&#39;</span><span class="o">+</span><span class="n">alpha</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="s1">&#39;No Alpha&#39;</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="s1">&#39;Not Set&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">!=</span> <span class="s1">&#39;Not Set&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;alpha input type not recognisied (see FormFactors.py, SetAlpha())&#39;</span><span class="p">)</span></div>





    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">]</span>

    <span class="c1">## if data is instance of FormFact (e.g. data = FormFact(...)</span>
    <span class="c1">## for iOp,ipkey,iqkey,imass,ipar,data in data.items():</span>
    <span class="c1">##    etc.....</span>
<div class="viewcode-block" id="FormFact.items"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="FormFact.iteritems"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.iteritems">[docs]</a>    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="FormFact.iteritemsRed"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.iteritemsRed">[docs]</a>    <span class="k">def</span> <span class="nf">iteritemsRed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="FormFact.itemsMass"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.itemsMass">[docs]</a>    <span class="k">def</span> <span class="nf">itemsMass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass } bs</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">icurrOp</span><span class="p">,</span><span class="n">currdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">ipkey</span><span class="p">,</span><span class="n">pdata</span> <span class="ow">in</span> <span class="n">currdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">iqkey</span><span class="p">,</span><span class="n">qdata</span> <span class="ow">in</span> <span class="n">pdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">qdata</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="FormFact.itemsParList"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.itemsParList">[docs]</a>    <span class="k">def</span> <span class="nf">itemsParList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass } bs</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="n">this_levels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;mass_and_alpha&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">flow_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">this_levels</span><span class="p">):</span>
                <span class="n">this_fdata</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">]</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_levels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">),</span><span class="n">flow_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">this_levels</span><span class="p">):</span>
                <span class="n">this_fdata</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">]</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="FormFact.itemsParListRed"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.itemsParListRed">[docs]</a>    <span class="k">def</span> <span class="nf">itemsParListRed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass } bs</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="n">this_levels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;mass_and_alpha&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">flow_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">this_levels</span><span class="p">):</span>
                <span class="n">this_fdata</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">]</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_levels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">),</span><span class="n">flow_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">this_levels</span><span class="p">):</span>
                <span class="n">this_fdata</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">]</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">this_fdata</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="FormFact.itemsAvgStd"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FormFact.values"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass , ipar } bs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="FormFact.valuesAvgStd"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass , ipar } bs</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ivals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">ivals</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FormFact.keys"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

<div class="viewcode-block" id="FormFact.keysOpMoms"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.keysOpMoms">[docs]</a>    <span class="k">def</span> <span class="nf">keysOpMoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass , ipar } bs</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">)):</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="FormFact.keysOpMomsRed"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.keysOpMomsRed">[docs]</a>    <span class="k">def</span> <span class="nf">keysOpMomsRed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## self.paramDict { icurrOp , ipkey , iqkey , imass , ipar } bs</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">icurrOp</span><span class="p">,</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramRed_Stats</span><span class="p">[</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;sink_momentum&#39;</span><span class="p">,</span><span class="s1">&#39;current_momentum&#39;</span><span class="p">)):</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">icurrOp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">ipkey</span><span class="p">,</span><span class="n">iqkey</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="FormFact.Write"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;FFparams&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FixDictArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">,</span><span class="s1">&#39;FF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FixDictArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">)</span>
        <span class="c1">## TODO, output more information about momenta if you would like</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;q2max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">mom2max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;q2min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">mom2min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;pp2max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">mom2max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;pp2min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">mom2min</span>
        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">))</span>
        <span class="n">firstkey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;massAvg_&#39;</span><span class="o">+</span><span class="n">firstkey</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span>
        <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;massStd_&#39;</span><span class="o">+</span><span class="n">firstkey</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span>
        <span class="k">for</span> <span class="n">icFF</span><span class="p">,</span><span class="n">iFF</span> <span class="ow">in</span> <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;FFparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">excel_params</span><span class="p">[</span><span class="n">icFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">iFF</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">excel_params</span><span class="p">[</span><span class="n">ictflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">itflow</span>
        <span class="k">del</span> <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;FFparams&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                <span class="n">firstdata</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstdata</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                    <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;AlphaAvg_&#39;</span><span class="o">+</span><span class="n">firstkey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstdata</span><span class="o">.</span><span class="n">Avg</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;AlphaAvg_&#39;</span><span class="o">+</span><span class="n">firstkey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstdata</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                <span class="n">firstdata</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">itflow</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstdata</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                    <span class="n">excel_params</span><span class="p">[</span><span class="s1">&#39;AlphaStd_&#39;</span><span class="o">+</span><span class="n">firstkey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstdata</span><span class="o">.</span><span class="n">Std</span>

        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">massdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">massdata</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">massdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">massdata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">massdata</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">alphatflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">firstalpha</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alphatflow</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">alpha_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alphatflow</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstalpha</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="n">alpha_key</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">firstalpha</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">firstalpha</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="n">alpha_key</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstalpha</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gammakey</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ipar</span><span class="p">),</span><span class="n">paramdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">thisqsqrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Getpsqrdform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
                <span class="c1">## TODO, this is incorrectly order with respect to qsqrd, need to write function to fix this somewhere</span>
                <span class="c1">## also, you can play around with the ordering of keys to get the formating you like !!</span>
                <span class="c1"># self.outDict[imass][ipp][itflow][self.qparams.Getpsqrdform(iq,pre=&#39;q&#39;)][&#39;Coeff_of_&#39;+ipar][&#39;_&#39;.join([gammakey,iq])] = AvgStdToFormat(paramdata.Avg,paramdata.Std)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">+=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">if</span> <span class="n">ipar</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gammakey</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">ipar</span><span class="p">),</span><span class="n">paramdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">thisqsqrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Getpsqrdform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
                <span class="c1">## TODO, this is incorrectly order with respect to qsqrd, need to write function to fix this somewhere</span>
                <span class="c1">## also, you can play around with the ordering of keys to get the formating you like !!</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">+=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">if</span> <span class="n">ipar</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gammakey</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">itflow</span><span class="p">,</span><span class="n">ipar</span><span class="p">),</span><span class="n">paramdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteritemsRed</span><span class="p">():</span>
                <span class="n">thisqsqrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Getpsqrdform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
                <span class="c1">## TODO, this is incorrectly order with respect to qsqrd, need to write function to fix this somewhere</span>
                <span class="c1">## also, you can play around with the ordering of keys to get the formating you like !!</span>
                <span class="c1"># self.outDict[imass][ipp][itflow][self.qparams.Getpsqrdform(iq,pre=&#39;q&#39;)][&#39;Coeff_of_&#39;+ipar][&#39;_&#39;.join([gammakey,iq])] = AvgStdToFormat(paramdata.Avg,paramdata.Std)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">+=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">if</span> <span class="n">ipar</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gammakey</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">iq</span><span class="p">,</span><span class="n">imass</span><span class="p">,</span><span class="n">ipar</span><span class="p">),</span><span class="n">paramdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteritemsRed</span><span class="p">():</span>
                <span class="n">thisqsqrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Getpsqrdform</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span><span class="n">pre</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
                <span class="c1">## TODO, this is incorrectly order with respect to qsqrd, need to write function to fix this somewhere</span>
                <span class="c1">## also, you can play around with the ordering of keys to get the formating you like !!</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">+=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">paramdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">numlen</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;) &#39;</span><span class="o">+</span><span class="n">ipar</span> <span class="o">+</span> <span class="s1">&#39; +&#39;</span>
                <span class="k">if</span> <span class="n">ipar</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffpars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Equations_Reduced&#39;</span><span class="p">][</span><span class="n">imass</span><span class="p">][</span><span class="n">ipp</span><span class="p">][</span><span class="n">thisqsqrd</span><span class="p">][</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">gammakey</span><span class="p">,</span><span class="n">iq</span><span class="p">])][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">outDict</span><span class="p">})</span>

        <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,{</span><span class="s1">&#39;FF_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_Stats</span><span class="p">)},</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

        <span class="c1">## pickles rest of data for reading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="FormFact.LoadKappaDir"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.LoadKappaDir">[docs]</a>    <span class="k">def</span> <span class="nf">LoadKappaDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">mass</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;kappa folders used in FormFact (from FormFactors.py) have changed, check alpha and mass used.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">=</span> <span class="n">mass</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">NNQFullCorr</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">NNQCorr</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;kappa folders used in FormFact (from FormFactors.py) have changed, check alpha and mass used.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">NN</span><span class="o">.</span><span class="n">kappafolder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="FormFact.LoadPickle"><a class="viewcode-back" href="../FormFactors.html#FormFactors.FormFact.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">thisalpha</span><span class="o">=</span><span class="s1">&#39;No Alpha&#39;</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="p">[],</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># if self.doflow and thisalpha == &#39;No Alpha&#39;:</span>
        <span class="c1">#     raise EnvironmentError(&#39;alpha is needed for FormFact when using FO form factor.&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LoadKappaDir</span><span class="p">(</span><span class="n">thismass</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">thisalpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetMass</span><span class="p">(</span><span class="n">thismass</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetAlpha</span><span class="p">(</span><span class="n">thisalpha</span><span class="p">,</span><span class="n">thistflowlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AppendName</span><span class="p">()</span>

        <span class="c1"># print &#39;loading &#39;, self.PickleFile, &#39;with DefWipe &#39; , DefWipe</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="c1"># print &#39;Loading Pickle for &#39; , self.name</span>

            <span class="n">thispickle</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">)</span>
            <span class="c1"># print thistflowlist, thispickle[&#39;tflowlist&#39;],self.doflow</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">thistflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">thistflowlist</span> <span class="o">==</span> <span class="n">thispickle</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">doflow</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">thispickle</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">thismass</span><span class="p">,</span><span class="n">thisalpha</span><span class="o">=</span><span class="n">thisalpha</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="n">thistflowlist</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GetFFParms</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GetRedFFParms</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetFFParms</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetRedFFParms</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div></div>



<div class="viewcode-block" id="TestFF"><a class="viewcode-back" href="../FormFactors.html#FormFactors.TestFF">[docs]</a><span class="k">def</span> <span class="nf">TestFF</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">this_curr</span><span class="o">=</span><span class="s1">&#39;VectorTop&#39;</span><span class="p">,</span><span class="n">qsqrdlist</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
    <span class="kn">import</span> <span class="nn">TwoPtCorrelators</span> <span class="k">as</span> <span class="nn">co</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfo</span><span class="p">,</span><span class="n">defInfoFlow</span>
    <span class="c1"># import numpy as np</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">TwoPointCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfo</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
    <span class="c1"># dataff = FormFact(&#39;Vector&#39;,[0,1])</span>
    <span class="c1"># dataff.LoadPickle(data)</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;Interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CPOdd&#39;</span>
    <span class="n">dataalpha</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">NNQCorr</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">dataalpha</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
    <span class="n">dataalpha</span><span class="o">.</span><span class="n">FitAlpha</span><span class="p">()</span>
    <span class="n">dataffalpha</span> <span class="o">=</span> <span class="n">FormFact</span><span class="p">(</span> <span class="n">this_curr</span><span class="p">,</span><span class="n">qsqrdlist</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="n">dataffalpha</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">thisalpha</span><span class="o">=</span><span class="n">dataalpha</span><span class="p">,</span><span class="n">thistflowlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t_f6.01&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">dataffalpha</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">TestFF</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data is in data&#39;</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jack Dragos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FlowOpps &mdash; LQCD Analysis Codebase TF Fits documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LQCD Analysis Codebase
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LQCD Analysis Codebase</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>FlowOpps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for FlowOpps</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>


<span class="c1">#IMPORT THIS FIRST, put in base import file</span>
<span class="c1"># import matplotlib</span>
<span class="c1"># matplotlib.use(&#39;Agg&#39;) # Must be before importing matplotlib.pyplot or pylab!</span>
<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="c1">##</span>

<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">nboot</span><span class="p">,</span><span class="n">defSparam</span><span class="p">,</span><span class="n">datadir</span><span class="p">,</span><span class="n">outputdir</span><span class="p">,</span><span class="n">flow_new_format</span><span class="p">,</span><span class="n">Wipe_All_Fits</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">ReadFuns</span><span class="p">,</span><span class="n">WriteFuns</span><span class="p">,</span><span class="n">ReadWithMeta</span><span class="p">,</span><span class="n">WriteWithMeta</span><span class="p">,</span><span class="n">Construct_File_Object</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">chitcoeff</span><span class="p">,</span><span class="n">defxlimOp</span><span class="p">,</span><span class="n">TflowToPhys</span><span class="p">,</span><span class="n">Qeps</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">cfgfmtdir</span><span class="p">,</span><span class="n">this_dir</span>
<span class="kn">import</span> <span class="nn">MomParams</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">BootStrapping</span> <span class="k">import</span> <span class="n">BootStrap</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">ODNested</span><span class="p">,</span><span class="n">mkdir_p</span><span class="p">,</span><span class="n">CheckClass</span><span class="p">,</span><span class="n">Series_TO_ODict</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">fmt_file_type</span><span class="p">,</span><span class="n">StreamToNumb</span>
<span class="c1"># from XmlFormatting import tstr,untstr,tflowstr,untflowstr,unxmlfitr,AvgStdToFormat,tflowTOLeg</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">tstr</span><span class="p">,</span><span class="n">untstr</span><span class="p">,</span><span class="n">tflowstr</span><span class="p">,</span><span class="n">untflowstr</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">unxmlfitr_int</span><span class="p">,</span><span class="n">AvgStdToFormat</span><span class="p">,</span><span class="n">tflowTOLeg</span><span class="p">,</span><span class="n">KeyForamtting</span>
<span class="c1"># from XmlFormatting import tstr,tflowstr,untflowstr,unxmlfitr,AvgStdToFormat,tflowTOLeg</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">MakeValAndErr</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">WriteXml</span><span class="p">,</span><span class="n">WritePickle</span><span class="p">,</span><span class="n">ReadPickleWrap</span><span class="p">,</span><span class="n">WriteExcel</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">Autocorr</span> <span class="k">import</span> <span class="n">AutoCorrelate</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">Chi_Prop_Fit_2exp</span><span class="p">,</span><span class="n">LinearFitFun</span>
<span class="kn">from</span> <span class="nn">NullPlotData</span> <span class="k">import</span> <span class="n">null_series</span>
<span class="kn">from</span> <span class="nn">ReadFO</span> <span class="k">import</span> <span class="n">FlowReadTopCharge</span><span class="p">,</span><span class="n">FlowReadTopCharge_New</span><span class="p">,</span><span class="n">ReadTsInFlowOp</span>
<span class="c1"># from PredefFitFuns import RandTFitFun</span>
<span class="c1"># import cPickle as pickle</span>
<span class="c1"># import dill as pickle</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">re</span><span class="o">,</span><span class="nn">os</span>
<span class="c1"># import FitFunctions as ff</span>
<span class="kn">import</span> <span class="nn">SetsOfFits</span> <span class="k">as</span> <span class="nn">sff</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="k">as</span> <span class="nn">ope</span>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">How to use:</span>

<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="GetOppFromStr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.GetOppFromStr">[docs]</a><span class="k">def</span> <span class="nf">GetOppFromStr</span><span class="p">(</span><span class="n">thisOp</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ope</span><span class="o">.</span><span class="n">add</span>
    <span class="k">elif</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ope</span><span class="o">.</span><span class="n">sub</span>
    <span class="k">elif</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span> <span class="ow">or</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ope</span><span class="o">.</span><span class="n">mul</span>
    <span class="k">elif</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ope</span><span class="o">.</span><span class="n">div</span>
    <span class="k">elif</span> <span class="n">thisOp</span> <span class="o">==</span> <span class="s1">&#39;leftI&#39;</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">returnopp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">returnopp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Operation combination not supported &#39;</span> <span class="o">+</span> <span class="n">thisOp</span><span class="p">)</span></div>

<div class="viewcode-block" id="CombineInfo"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.CombineInfo">[docs]</a><span class="k">def</span> <span class="nf">CombineInfo</span><span class="p">(</span><span class="n">Info</span><span class="p">,</span><span class="n">Info2</span><span class="p">,</span><span class="n">Opp</span><span class="p">):</span>
    <span class="n">InfoOut</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">Info</span><span class="p">)</span>
    <span class="c1">## Info can contain fit ranges to be calculated</span>
    <span class="c1">## must bein form Info[&#39;FlowFits&#39;] = [ (&#39;state#&#39; , &#39;fit#-#&#39; ) , ...]</span>


    <span class="k">if</span> <span class="s1">&#39;FlowFits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;FlowFits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;FlowFits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span>


    <span class="c1">## Info can contain fit ranges to be calculated</span>
    <span class="c1">## must bein form Info[&#39;FlowFitFun&#39;] = (Function Object , number of parameters )</span>
    <span class="k">if</span> <span class="s1">&#39;FlowFitFun&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;FlowFitFun&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, different fit functions present, using host fit funtion&#39;</span><span class="p">)</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;FlowFitFun&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span>

    <span class="c1">## kappa up down (in integer form)</span>
    <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]:</span>
                <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">+</span><span class="n">Opp</span><span class="o">+</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span>

    <span class="c1">## kappa strange (in integer form)</span>
    <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]:</span>
                <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">+</span><span class="n">Opp</span><span class="o">+</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span>

    <span class="c1">## Current obersvables are TopCharge and Weinberg</span>
    <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">+</span><span class="n">Opp</span><span class="o">+</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>


    <span class="c1">## this is used display only these flowtimes, Still reads and writes all</span>
    <span class="k">if</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">])):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, different flow time lists present, using host fit funtion&#39;</span><span class="p">)</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>

    <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
    <span class="k">if</span> <span class="s1">&#39;iGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;iGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, different initial condition found, using host initail conidition&#39;</span><span class="p">)</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;iGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, different Sparams, using host initail conidition&#39;</span><span class="p">)</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>


    <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;stream list missmatch&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;stream list missmatch&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;stream list missmatch&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info2</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">InfoOut</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Info2</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">InfoOut</span></div>



<div class="viewcode-block" id="FlowOp"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp">[docs]</a><span class="k">class</span> <span class="nc">FlowOp</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Op(tf) uses bootstrap class</span>
<span class="sd">        tf = flow time</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FlowOp.Construct_FO_File"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Construct_FO_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_FO_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">)</span></div>

    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span>  <span class="s1">&#39;FlowOpps.FlowOpFullSquared&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;TwoPtCorrelators.TwoPointCorr&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQCorr&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;TwoPtCorrelators.NNQFullCorr&#39;</span><span class="p">,</span><span class="s1">&#39;VarMethod.VariationalTwoPt&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;RatioCorrelators.RatioCorr&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;RatioCorrelators.RatioFOCorr&#39;</span><span class="p">,</span><span class="s1">&#39;RatioCorrelators.RatioFOFullCorr&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span><span class="n">Info</span><span class="o">=</span><span class="p">{},</span> <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">LLname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">GetFolderFileOp</span><span class="p">(</span><span class="n">thistype</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                <span class="k">if</span>  <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">thistype</span>  <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;FlowNewForm&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">thistype</span> <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;FlowNewForm&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">in</span> <span class="n">thistype</span> <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;FlowNewForm&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thistype &#39;</span> <span class="p">,</span> <span class="n">thistype</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Type of operator not known, please select TopCharge or Weinberg&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span>  <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">thistype</span>  <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;topcharge&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">thistype</span> <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;weinopp&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thistype &#39;</span> <span class="p">,</span> <span class="n">thistype</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Type of operator not known, please select TopCharge or Weinberg&#39;</span><span class="p">)</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>

        <span class="c1"># self.thischecklist = [&#39;nboot&#39;,&#39;kud&#39;,&#39;ks&#39;,&#39;tflowlist&#39;,&#39;cfglist&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">,</span><span class="s1">&#39;Sparam&#39;</span><span class="p">,</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## Initialising plotting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span>  <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op_cfgs DataFrame:</span>

<span class="sd">        columns =   config_numbers , Op[itflow]</span>

<span class="sd">        rows =      stream , configuration</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>
<span class="sd">                    Auto, AutoAvg,  AutoStd</span>

<span class="sd">        rows =      flow time</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>

        <span class="c1"># # Opboot { itf } bs</span>
        <span class="c1"># self.Opboot = ODNested()</span>
        <span class="c1"># self.OpAvg  = ODNested()</span>
        <span class="c1"># self.OpStd  = ODNested()</span>
        <span class="c1">#</span>
        <span class="c1"># # Opboot { itf } bs</span>
        <span class="c1"># self.OpAuto = ODNested()</span>
        <span class="c1"># self.OpAutoAvg  = ODNested()</span>
        <span class="c1"># self.OpAutoStd  = ODNested()</span>

        <span class="c1">## will be of type SetOfFitFuns from SetOfFits.py</span>
        <span class="c1"># self.flowFit_Stats = None</span>
        <span class="c1"># &#39;&#39;&#39;</span>
        <span class="c1"># self.Op_Stats DataFrame:</span>
        <span class="c1">#</span>
        <span class="c1"># columns =   boot, Avg,      Std</span>
        <span class="c1">#</span>
        <span class="c1"># rows =      fit range</span>
        <span class="c1"># &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># # FlowFitDict [ Fit_range ,  Fit_Parameter ] bs</span>
        <span class="c1"># self.flowFitDict    = ODNested()</span>
        <span class="c1"># self.flowFitDictAvg = ODNested()</span>
        <span class="c1"># self.flowFitDictStd = ODNested()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^</span><span class="si">{3}</span><span class="s1">\times &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>

        <span class="k">if</span> <span class="s1">&#39;Do_Chi&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Do_Chi&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">defSparam</span>

        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;FlowFits&#39;] = [ (&#39;state#&#39; , &#39;fit#-#&#39; ) , ...]</span>
        <span class="k">if</span> <span class="s1">&#39;FlowFits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>


        <span class="c1">## Info can contain initial guess for fits, make sure it array of correct length</span>
        <span class="k">if</span> <span class="s1">&#39;FlowiGuess&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowiGuess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowiGuess&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowiGuess</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">## Defaults to value set for function in FitFunctions.py</span>

        <span class="k">if</span> <span class="s1">&#39;cfg_file_type&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">cfg_file_type</span>


        <span class="k">if</span> <span class="s1">&#39;n_block&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_block</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;n_block&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_block</span> <span class="o">=</span> <span class="mi">1</span>


        <span class="c1">## Info can contain fit ranges to be calculated</span>
        <span class="c1">## must bein form Info[&#39;FlowFitFun&#39;] = (Function Object , number of parameters )</span>
        <span class="k">if</span> <span class="s1">&#39;FlowFitFun&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">thisFun</span><span class="p">,</span><span class="n">thisnpar</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;FlowFitFun&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetFunction</span><span class="p">(</span><span class="n">thisFun</span><span class="p">,</span><span class="n">thisnpar</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetFunction</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>


        <span class="c1">## kappa up down (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## Current obersvables are TopCharge and Weinberg</span>
        <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">=</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="c1">## default to TopCharge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1">## this is used display only these flowtimes, Still reads and writes all</span>
        <span class="k">if</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">defxlimOp</span> <span class="c1">## default to read all flow times</span>


        <span class="c1">## this is used display only these flowtimes, Still reads and writes all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span> <span class="o">=</span> <span class="n">flow_new_format</span>
        <span class="c1"># if &#39;FlowNewForm&#39; in Info.keys(): self.FlowNewForm = Info[&#39;FlowNewForm&#39;]</span>
        <span class="c1"># else: self.FlowNewForm = False ## default to read all flow times</span>

        <span class="c1">## will attempt to find all replica streams in directory.</span>
        <span class="c1">## set self.nstream to number of streams you want to find.</span>
        <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">iinfo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">iinfo</span> <span class="ow">in</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>


        <span class="n">listout</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ict</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;t_f&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">itflow</span><span class="p">):</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span> <span class="o">=</span> <span class="p">[</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">listout</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">listout</span><span class="p">)</span>

        <span class="n">thisfolder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span> <span class="o">=</span> <span class="n">GetFolderFileOp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfilename</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;_flow_b1.90_ng&#39;</span><span class="p">,</span><span class="s1">&#39;.out&#39;</span><span class="p">]</span>

        <span class="n">kappafolder</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="c1"># self.flowfilename = [&#39;RC32x64_B1900&#39;+kappafolder+&#39;C1715&#39;,&#39;_&#39;,&#39;_k&#39;+self.kud.replace(&#39;kud&#39;,&#39;&#39;)+&#39;_&#39;+self.tsrc+filejsm+fileism+&#39;_nucleon.2cf.xml&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span> <span class="o">=</span> <span class="n">Info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span> <span class="o">=</span> <span class="n">datadir</span><span class="o">+</span><span class="n">thisfolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;-*-/PerGF/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">man_load_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span>

<div class="viewcode-block" id="FlowOp.LoadCfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.LoadCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">LoadCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">LLname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Create_Streams_Dirs</span><span class="p">()</span>

        <span class="c1">## cfglist { configuration : [ x-source numbers ] }</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetCfgList</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOp.Create_Streams_Dirs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Create_Streams_Dirs">[docs]</a>    <span class="k">def</span> <span class="nf">Create_Streams_Dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">All_Streams</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Check_Streams</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">thisdir</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="FlowOp.All_Streams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.All_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">All_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)):</span>
            <span class="n">this_stream</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">this_stream</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_stream</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> No Streams found&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOp.Check_Streams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Check_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">Check_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">))</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">this_check</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">this_check</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> stream directory not found, as well as </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)))</span></div>


<div class="viewcode-block" id="FlowOp.GetInterp"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.GetInterp">[docs]</a>    <span class="k">def</span> <span class="nf">GetInterp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_to</span><span class="p">):</span>
        <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; t0fit&#39;</span>
        <span class="n">left_t0</span><span class="p">,</span><span class="n">right_t0</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span><span class="mi">100</span>
        <span class="k">for</span> <span class="n">it0</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">it0</span><span class="o">-</span><span class="n">this_to</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">it0</span><span class="o">-</span><span class="n">this_to</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">left_t0</span><span class="o">-</span><span class="n">this_to</span><span class="p">):</span>
                <span class="n">left_t0</span> <span class="o">=</span> <span class="n">it0</span>
            <span class="k">elif</span> <span class="n">it0</span><span class="o">-</span><span class="n">this_to</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">it0</span><span class="o">-</span><span class="n">this_to</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">right_t0</span><span class="o">-</span><span class="n">this_to</span><span class="p">):</span>
                <span class="n">right_t0</span> <span class="o">=</span> <span class="n">it0</span>
        <span class="c1"># fit_min = list(self.Op_Stats.index).index(tflowstr(left_t0))</span>
        <span class="c1"># fit_max = list(self.Op_Stats.index).index(tflowstr(right_t0))</span>
        <span class="c1"># fit_loc = fit_min + ((this_to-left_t0)*((right_t0-left_t0)/(fit_max-fit_min)))</span>
        <span class="c1"># print(&#39;DEBUG&#39;,fit_min,fit_max)</span>
        <span class="c1"># print(self.Op_Stats[&#39;boot&#39;])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">this_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="n">left_t0</span><span class="p">,</span><span class="n">right_t0</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="c1"># self.t0_fit.SortChi()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">Fit_Stats</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="n">this_to</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOp.Compute_t0"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Compute_t0">[docs]</a>    <span class="k">def</span> <span class="nf">Compute_t0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nfit</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">fix_energy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1">## THIS FUNCTION ASSUMES DATA IS &lt;E(t)&gt;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;t0_values&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t0_values alread computed, skipping&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; t0fit&#39;</span>
        <span class="k">if</span> <span class="n">fix_energy</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t2boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t2boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t2boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
        <span class="n">this_df</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">)</span>
        <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t2boot_min_p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t2boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">this_df</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t2boot_min_p3&#39;</span><span class="p">])</span>
        <span class="n">t0_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">this_df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">nfit</span><span class="p">])))</span>
        <span class="n">t0_min</span><span class="p">,</span><span class="n">t0_max</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t0_list</span><span class="p">)),</span><span class="n">tflowstr</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">t0_list</span><span class="p">))</span>
        <span class="n">fit_min</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t0_min</span><span class="p">)</span>
        <span class="n">fit_max</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t0_max</span><span class="p">)</span>
        <span class="c1"># print(&#39;DEBUG&#39;,fit_min,fit_max)</span>
        <span class="c1"># print(self.Op_Stats[&#39;boot&#39;])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;t2boot&#39;</span><span class="p">])</span>
        <span class="n">this_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="c1"># self.t0_fit.SortChi()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>
        <span class="n">t0_list</span><span class="p">,</span><span class="n">tf_min_list</span><span class="p">,</span><span class="n">tf_max_list</span><span class="p">,</span><span class="n">fitr_list</span><span class="p">,</span><span class="n">fit_len</span> <span class="o">=</span> <span class="p">[],[],[],[],[]</span>
        <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">fit_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_fit</span><span class="o">.</span><span class="n">Fit_Stats_fmt</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">linear_term</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">const_term</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.3</span><span class="o">-</span><span class="n">const_term</span><span class="p">)</span><span class="o">/</span><span class="n">linear_term</span>
            <span class="n">t0</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">t0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
            <span class="n">fitr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span> <span class="o">=</span> <span class="n">unxmlfitr_int</span><span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tf_fitr_min</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="n">fit_min</span><span class="p">]</span>
            <span class="n">tf_fitr_max</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="n">fit_max</span><span class="p">]</span>
            <span class="n">tf_min_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf_fitr_min</span><span class="p">)</span>
            <span class="n">tf_max_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf_fitr_max</span><span class="p">)</span>
            <span class="n">fit_len</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_max</span> <span class="o">-</span> <span class="n">fit_min</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_len</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">t0_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;tf_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_min_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;tf_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_max_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;fitr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fitr_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;fit_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit_len</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fit_len&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;sqrt8tf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;sqrt8tf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Set_t0</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Op&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOp.FlowGetCfgList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowGetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">FlowGetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">SplitCfg</span><span class="p">(</span><span class="n">ifile</span><span class="p">):</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;_ng.*&#39;</span><span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icfg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: file does not have cfg number&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">icfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_ng&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.out&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">icfg</span>

        <span class="n">cfglist</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">low_test</span><span class="p">,</span><span class="n">upper_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">icfg</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;_*&#39;</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">low_test</span> <span class="ow">in</span> <span class="n">ifile</span> <span class="ow">or</span> <span class="n">upper_test</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">:</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span>
                    <span class="n">cfglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SplitCfg</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No configs found for directory:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; , &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">cfglist</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">cfg_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;int_configs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cfg_df</span><span class="p">[</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfg_df</span><span class="p">)</span></div>


    <span class="c1"># def MakeOutputFile(self):</span>
    <span class="c1">#     self.name = &#39;_&#39;.join([self.tsrc,self.ism,self.jsm])</span>
    <span class="c1">#     self.HumanFile = &#39;/&#39;+kappafolder+&#39;/G2/&#39;+self.name+&#39;.xml&#39;</span>
    <span class="c1">#     self.PickleFile = &#39;/&#39;+kappafolder+&#39;/G2/Pickle/&#39;+self.name+&#39;.py3p&#39;</span>


    <span class="c1">## Routines for Plotting ###############################################</span>

<div class="viewcode-block" id="FlowOp.FlowCheckCol"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowCheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="c1"># if &#39;PreDefine&#39; == thiscol :</span>
            <span class="c1"># if &#39;Not Set&#39; == self.thiscol:</span>
                <span class="c1"># raise IOError(&#39;Pass in color to initialize it&#39;)</span>
        <span class="c1"># else:</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thiscol</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="FlowOp.FlowCheckSym"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowCheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="c1"># if &#39;PreDefine&#39; == thissym :</span>
            <span class="c1"># if &#39;Not Set&#39; == self.thissym:</span>
                <span class="c1"># raise IOError(&#39;Pass in symbol to initialize it&#39;)</span>
        <span class="c1"># else:</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thissym</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>


<div class="viewcode-block" id="FlowOp.FlowGetShift"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowGetShift">[docs]</a>    <span class="k">def</span> <span class="nf">FlowGetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisshift</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span></div>


<div class="viewcode-block" id="FlowOp.PlotMonteTime"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.PlotMonteTime">[docs]</a>    <span class="k">def</span> <span class="nf">PlotMonteTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">stream</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="c1"># print &#39;Warning: no configurations in memory for &#39;+self.flowname + &#39; attempting to read again&#39;</span>
            <span class="c1"># self.FlowRead()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: no configurations in memory for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; not doing monteplot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">stream</span> <span class="o">==</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thiscol</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="n">thiscol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">vall</span><span class="p">,</span><span class="n">indexl</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">dump</span><span class="p">),</span><span class="n">cfg_vals</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">flow_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">cfg_vals</span><span class="p">):</span>
                <span class="n">vall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow_val</span><span class="p">)</span>
                <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">StreamToNumb</span><span class="p">(</span><span class="n">istream</span><span class="p">),</span><span class="n">icfg</span><span class="p">,</span><span class="n">itflow</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No data to plot for montetime for &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Stream&#39;</span><span class="p">,</span><span class="s1">&#39;Config Number&#39;</span><span class="p">,</span><span class="s1">&#39;Flow Time&#39;</span><span class="p">])</span>
        <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vall</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisshift</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">thisshift</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">StreamToNumb</span><span class="p">(</span><span class="n">stream</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">flowtime</span><span class="p">)</span>
        <span class="c1"># thisshift = np.abs(hold_series[&#39;x_data&#39;][0]-hold_series[&#39;x_data&#39;][-1])*thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.plot(plotx+thisshift,ploty,label=,color=thiscol)</span>
        <span class="c1"># pl.scatter(plotx+thisshift,ploty,label=self.flowLegLab+&#39; $&#39;+tflowTOLeg(flowtime)+&#39;$&#39;,color=self.thiscol)</span>



    <span class="c1">## MultQ means Q * deltaQ&lt;eps</span>
<div class="viewcode-block" id="FlowOp.PlotMonteTimeDeltaEps"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.PlotMonteTimeDeltaEps">[docs]</a>    <span class="k">def</span> <span class="nf">PlotMonteTimeDeltaEps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">stream</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="n">thiseps</span><span class="o">=</span><span class="n">Qeps</span><span class="p">,</span><span class="n">MultQ</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="c1"># print &#39;Warning: no configurations in memory for &#39;+self.flowname + &#39; attempting to read again&#39;</span>
            <span class="c1"># self.FlowRead()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: no configurations in memory for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; not doing monteplot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">stream</span> <span class="o">==</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">thiscol</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="n">thiscol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">thisindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flowtime</span><span class="p">)</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">][</span><span class="n">stream</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="n">MultQ</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp</span><span class="p">[</span><span class="n">thisindex</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">iOp</span><span class="p">[</span><span class="n">thisindex</span><span class="p">])</span><span class="o">&lt;</span><span class="n">thiseps</span><span class="p">)</span> <span class="k">for</span> <span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">stream</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">iOp</span><span class="p">[</span><span class="n">thisindex</span><span class="p">])</span><span class="o">&lt;</span><span class="n">thiseps</span><span class="p">)</span> <span class="k">for</span> <span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">stream</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisshift</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">thisshift</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="n">stream</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; $&#39;</span><span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">flowtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$ &#39;</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOp.PlotTauIntWOpt"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.PlotTauIntWOpt">[docs]</a>    <span class="k">def</span> <span class="nf">PlotTauIntWOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">FlowRad</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1"># if not hasattr(self,&#39;OpAuto&#39;):</span>
        <span class="c1">#     print &#39;Warning, Depreciated result has no autocorrelation results, skipping TauIntWOpt plot&#39;</span>
        <span class="c1">#     return</span>
        <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span><span class="p">,</span><span class="n">tlistplot</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">)))</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">xlims</span><span class="p">)):</span>
                <span class="n">tlistplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tlistplot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no flow times found for plot&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">)))</span>
        <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetShift</span><span class="p">([</span><span class="n">tflowphys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowphys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


        <span class="c1"># pl.errorbar(tflowphys+thisshift,dataavg,dataerr,label=,fmt=,color=self.thiscol)</span>
        <span class="c1"># pl.xlim(xlims[0],xlims[-1])</span>




    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowOp.FlowPlotAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowPlotAuto">[docs]</a>    <span class="k">def</span> <span class="nf">FlowPlotAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                     <span class="n">FlowRad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">t0_xvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="c1"># if not hasattr(self,&#39;OpAuto&#39;):</span>
        <span class="c1">#     print &#39;Warning, Depreciated result has no autocorrelation results, skipping Auto plot&#39;</span>
        <span class="c1">#     return</span>
        <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span><span class="p">,</span><span class="n">tlistplot</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">)))</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">xlims</span><span class="p">)):</span>
                <span class="n">tlistplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tlistplot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no flow times found for plot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">this_s8t0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Get_t0</span><span class="p">()[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t0_xvals error:&#39;</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
                <span class="n">t0_xvals</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">tflowphys</span><span class="p">,</span><span class="n">tflowphys_err</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">):</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">itflow</span><span class="p">)</span><span class="o">/</span><span class="n">this_s8t0</span>
                <span class="n">it</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">tflowphys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">tflowphys_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">)</span>
            <span class="n">tflowphys_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys_err</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">)))</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="c1"># tflowphys = np.array(list(map(untflowstr,tlistplot)))</span>
        <span class="c1"># tflowphys = TflowToPhys(np.array(tflowphys),self.latparams.latspace)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetShift</span><span class="p">([</span><span class="n">tflowphys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowphys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys_err</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(tflowphys+thisshift,dataavg,dataerr,label=self.flowLegLab+&#39; Auto&#39;,fmt=self.thissym,color=self.thiscol)</span>
        <span class="c1"># pl.xlim(xlims[0],xlims[-1])</span>

<div class="viewcode-block" id="FlowOp.FlowPlot_mul_tf2"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowPlot_mul_tf2">[docs]</a>    <span class="k">def</span> <span class="nf">FlowPlot_mul_tf2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                         <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">FlowRad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">BorA</span><span class="o">=</span><span class="s1">&#39;boot&#39;</span><span class="p">,</span>                        <span class="n">mul</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">tpow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t0_xvals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">just_E</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">lab_append</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                         <span class="p">,</span><span class="n">forcet0</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span><span class="p">,</span><span class="n">tlistplot</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">if</span> <span class="n">BorA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">BorA</span><span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1">Not Present in Op_Stats: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="n">BorA</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">)))</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">xlims</span><span class="p">)):</span>
                <span class="n">tlistplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">just_E</span><span class="p">:</span>
                    <span class="n">plot_val</span> <span class="o">=</span>  <span class="p">(</span><span class="n">idata</span> <span class="o">*</span> <span class="mi">6</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">mul</span><span class="p">:</span>
                    <span class="n">plot_val</span> <span class="o">=</span>  <span class="n">idata</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">))</span><span class="o">**</span><span class="n">tpow</span>
                    <span class="c1"># plot_val = plot_val * self.latparams.nxyz**3</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plot_val</span> <span class="o">=</span>  <span class="n">idata</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">))</span><span class="o">**</span><span class="n">tpow</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">plot_val</span> <span class="o">=</span> <span class="n">plot_val</span> <span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">plot_val</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_val</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_val</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tlistplot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no flow times found for plot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">forcet0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">this_s8t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">forcet0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">this_s8t0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Get_t0</span><span class="p">()[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t0_xvals error:&#39;</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
                <span class="n">t0_xvals</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">tflowphys</span><span class="p">,</span><span class="n">tflowphys_err</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">):</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">itflow</span><span class="p">)</span><span class="o">/</span><span class="n">this_s8t0</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">forcet0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">it</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                    <span class="n">tflowphys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="n">tflowphys_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tflowphys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">forcet0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">tflowphys_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys_err</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">)))</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetShift</span><span class="p">([</span><span class="n">tflowphys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowphys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys</span>
        <span class="k">if</span> <span class="n">t0_xvals</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">forcet0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys_err</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># hold_series[&#39;flowphys&#39;] = self.latparams.latspace</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">lab_append</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="n">BorA</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39; Auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;fmt_class&#39;] = KeyForamtting(self.latparams)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## make sure all xlims are the same, because this sets the window of xlim (needed for calculating shifts)</span>
<div class="viewcode-block" id="FlowOp.FlowPlot"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowPlot">[docs]</a>    <span class="k">def</span> <span class="nf">FlowPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                 <span class="n">FlowRad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">t0_xvals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">lab_append</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="n">dataavg</span><span class="p">,</span><span class="n">dataerr</span><span class="p">,</span><span class="n">tlistplot</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">it</span><span class="p">)))</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">xlims</span><span class="p">)):</span>
                <span class="n">tlistplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
                <span class="n">dataavg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">dataerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tlistplot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no flow times found for plot&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">this_s8t0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Get_t0</span><span class="p">()[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t0_xvals error:&#39;</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
                <span class="n">t0_xvals</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">tflowphys</span><span class="p">,</span><span class="n">tflowphys_err</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">):</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">itflow</span><span class="p">)</span><span class="o">/</span><span class="n">this_s8t0</span>
                <span class="n">it</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">tflowphys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">tflowphys_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">)</span>
            <span class="n">tflowphys_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys_err</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">tlistplot</span><span class="p">)))</span>
            <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="c1"># tflowphys = np.array(list(map(untflowstr,tlistplot)))</span>
        <span class="c1"># tflowphys = TflowToPhys(np.array(tflowphys),self.latparams.latspace)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetShift</span><span class="p">([</span><span class="n">tflowphys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tflowphys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys</span>
        <span class="k">if</span> <span class="n">t0_xvals</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys_err</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataavg</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="c1"># hold_series[&#39;flowphys&#39;] = self.latparams.latspace</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span> <span class="n">lab_append</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span> <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="c1"># hold_series[&#39;fmt_class&#39;] = KeyForamtting(self.latparams)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(tflowphys+thisshift,dataavg,dataerr,label=self.flowLegLab,fmt=self.thissym,color=self.thiscol)</span>
        <span class="c1"># pl.xlim(xlims[0],xlims[-1])</span>


    <span class="c1">## state is 1 or 2 state fit</span>
    <span class="c1">## fitr is fit range e.g. fitr5-10</span>
    <span class="c1">## fit range of &#39;Data&#39; is just the original fit range</span>
<div class="viewcode-block" id="FlowOp.FlowFitPlot"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowFitPlot">[docs]</a>    <span class="k">def</span> <span class="nf">FlowFitPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">fitr</span><span class="p">,</span><span class="n">xlims</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">legparindex</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fitr</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="n">plot_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetShift</span><span class="p">(</span><span class="n">TflowToPhys</span><span class="p">(</span><span class="n">plot_class</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">),</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">fitr</span> <span class="p">,</span> <span class="s1">&#39; has not been done, performing fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">(</span><span class="n">fitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="p">[</span><span class="n">fitr</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlims</span>
            <span class="c1"># hold_series[&#39;flowphys&#39;] = self.latparams.latspace</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisparam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># hold_series[&#39;fmt_class&#39;] = KeyForamtting(self.latparams)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="FlowOp.FlowObsToName"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowObsToName">[docs]</a>    <span class="k">def</span> <span class="nf">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;TopChargexTopCharge&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;Q^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span>
        <span class="k">elif</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;WeinbergxWeinberg&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;W^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">obs</span> <span class="ow">and</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;WQ&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="o">==</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;Q&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="o">==</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;W&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obs</span></div>

<div class="viewcode-block" id="FlowOp.FlowSetCustomName"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowSetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">FlowSetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">RTDir</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">==</span> <span class="s1">&#39;--&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-def-&#39;</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="n">string</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># print &#39;setting Legend to &#39;,stringLL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="n">stringLL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps_NewForm/&#39;</span> <span class="o">+</span> <span class="n">RTDir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span> <span class="o">=</span>  <span class="n">cfgfmtdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps_NewForm/&#39;</span> <span class="o">+</span> <span class="n">RTDir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps/&#39;</span> <span class="o">+</span> <span class="n">RTDir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span> <span class="o">=</span>  <span class="n">cfgfmtdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps/&#39;</span> <span class="o">+</span> <span class="n">RTDir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.cfgs&#39;</span></div>



<div class="viewcode-block" id="FlowOp.Get_Flattened_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Get_Flattened_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Get_Flattened_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">index_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="n">col_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="n">red_col_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_list</span><span class="p">)</span>
        <span class="n">new_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itf</span><span class="p">,</span><span class="n">tfdata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39;Op&#39;</span><span class="p">]):</span>
                <span class="n">this_tf</span> <span class="o">=</span> <span class="n">untflowstr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">[</span><span class="n">itf</span><span class="p">])</span>
                <span class="n">new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ikey</span><span class="p">,</span><span class="n">red_col_list</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">+</span><span class="p">[</span><span class="n">tfdata</span><span class="p">,</span><span class="n">this_tf</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">col_list</span><span class="p">),</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">index_fun</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;config_number&#39;</span><span class="p">]</span>
        <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="n">new_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_df</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOp.Format_Flattened_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Format_Flattened_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Format_Flattened_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_df</span><span class="p">):</span>
        <span class="n">indexl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">,</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;Op&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]:</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="n">icol</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">ikey</span><span class="p">,</span><span class="n">ival</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">this_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()):</span>
            <span class="n">this_stream_cfg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">[</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">]]</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_stream_cfg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]:</span>
                <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">[</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">]],</span><span class="n">ic</span><span class="p">))</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_stream_cfg</span><span class="p">)</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">if</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]:</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflowstr</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]))</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">new_df</span></div>


<div class="viewcode-block" id="FlowOp.Write_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Write_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Write_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;read_cfgs_from_file&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;to_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;to_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;to_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="c1"># this_df,dump = self.Get_Flattened_Cfgs()</span>
        <span class="n">WriteWithMeta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">),</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOp.ChopDepVarList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.ChopDepVarList">[docs]</a>    <span class="k">def</span> <span class="nf">ChopDepVarList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_df</span><span class="p">,</span><span class="n">read_meta</span><span class="p">):</span>
        <span class="n">isin</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">read_meta</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isin</span><span class="p">:</span>
            <span class="n">same_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">read_meta</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">same_list</span><span class="p">:</span>
                <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">read_meta</span> <span class="o">==</span> <span class="n">it</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">]</span>
                <span class="k">def</span> <span class="nf">Chop_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">)[</span><span class="n">index_list</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Chop_fun</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">,</span><span class="n">isin</span></div>

<div class="viewcode-block" id="FlowOp.Read_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Read_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Read_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_tflowlist</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cfg_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span> <span class="ow">and</span> <span class="s1">&#39;stream_cfgs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
                <span class="n">second_class</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">cfg_data</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">])</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">second_class</span><span class="p">,[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">])</span>
                <span class="c1"># cfg_bool = np.array(self.Op_cfgs[&#39;stream_cfgs&#39;].values) == np.array(cfg_data[&#39;stream_cfgs&#39;].values)</span>
                <span class="c1"># if isinstance(cfg_bool,np.ndarray):</span>
                <span class="c1">#     cfg_bool = all(cfg_bool)</span>
                <span class="c1"># if show_timer and not cfg_bool:</span>
                <span class="c1">#     print &#39;\n&#39;+GetCfgMissmatch(  np.array(self.Op_cfgs[&#39;stream_cfgs&#39;].values),</span>
                <span class="c1">#                             np.array(cfg_data[&#39;stream_cfgs&#39;].values))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">cfg_bool</span><span class="p">:</span>
                <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ChopDepVarList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_tflowlist</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>

        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;read_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;read_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;read_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;-def-&#39;</span> <span class="ow">in</span> <span class="n">this_file</span><span class="p">:</span>
                <span class="n">this_file</span> <span class="o">=</span> <span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-def-&#39;</span><span class="p">,</span><span class="s1">&#39;-*-&#39;</span><span class="p">)</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cfg FNF: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">this_file</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">this_file</span> <span class="o">=</span> <span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cfg FNF: &#39;</span> <span class="o">+</span> <span class="n">this_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Reading Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="n">meta_data</span><span class="p">,</span><span class="n">cfg_data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="c1"># cfg_data = self.Format_Flattened_Cfgs(cfg_data)</span>
        <span class="n">cfg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MakeStreamCfgs</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span>
        <span class="n">cfg_data</span><span class="p">,</span><span class="n">check_bool</span> <span class="o">=</span> <span class="n">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">meta_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="n">check_bool</span>
        <span class="k">if</span> <span class="n">check_bool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> file incorrect,&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; found backup file&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; reading unformatted&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span></div>

        <span class="c1"># return cfg_data is not None and all(self.Op_cfgs[&#39;stream_cfgs&#39;].values == cfg_data[&#39;stream_cfgs&#39;].values)</span>
<div class="viewcode-block" id="FlowOp.MakeStreamCfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.MakeStreamCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">MakeStreamCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;stream_cfgs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="p">:</span>
            <span class="n">cfglist</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;00&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span><span class="n">index</span><span class="o">=</span><span class="n">cfglist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cfglist</span></div>

<div class="viewcode-block" id="FlowOp.FlowImportCfgList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">FlowImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">stream_list</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="c1"># if isinstance(cfglist,(dict,OrderedDict,pa.Series)): cfglist = cfglist.keys()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="n">stream_list</span>
            <span class="c1">## cfglist must be 2-d array, first dimension is stream, second dimension is configuraiton number</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cfglist</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">icf</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">is_cfg</span><span class="p">):</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfglist</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MakeStreamCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span></div>

<div class="viewcode-block" id="FlowOp.Update_Stream_List"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
            <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowname&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowLegLab&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOp.FlowStats"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowStats">[docs]</a>    <span class="k">def</span> <span class="nf">FlowStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">Avglist</span><span class="p">,</span><span class="n">Stdlist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
            <span class="n">iOp</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">Avglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iOp</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">Stdlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iOp</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Avglist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Stdlist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOp.FlowRemoveVals"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowRemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="FlowOp.FlowRead"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowRead">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_comb</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1">## making interpolator number more human readable</span>
        <span class="c1"># if len(self.flowname.split(&#39;_&#39;)) &gt; 3:</span>
        <span class="c1">#     raise IOError(&#39;Do not read after combining correlators, please recreate the correlator&#39;)</span>
        <span class="c1"># ntflow = 0</span>


        <span class="k">if</span> <span class="s1">&#39;file_names&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No values found for &#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ifile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="c1"># ifile = self.flowdir_list[istream]+icfg.join(self.flowfilename)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                    <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">FlowReadTopCharge_New</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span><span class="n">tf_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">FlowReadTopCharge</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span><span class="n">tf_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tflow</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">tflow</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;flowed operator does not contain all flow times, check flow time list or remove file if corrupt&#39;</span><span class="p">)</span>
            <span class="c1"># print</span>
            <span class="c1"># print &#39;Debug&#39;</span>
            <span class="c1"># print ifile</span>
            <span class="c1"># for iflow,itop in zip(tflow,topcharge):</span>
            <span class="c1">#     print iflow,itop</span>
            <span class="c1"># if ntflow != len(tflow) and ntflow != 0:</span>
            <span class="c1">#     print &#39;Warning, tflow list has changed for file&#39;</span>
            <span class="c1">#     print self.flowfiledir+ifile</span>
            <span class="c1">#     print &#39;base comparision ntflow is &#39; , ntflow , &#39; , this file has &#39; , len(tflow)</span>
            <span class="c1">#     continue</span>
            <span class="c1"># ntflow = max(len(tflow),ntflow)</span>
                <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topcharge</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No values found for &#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
            <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;No config files found anywhere.&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ifile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span><span class="o">+</span><span class="n">icfg</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilename</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                    <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">FlowReadTopCharge_New</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">FlowReadTopCharge</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tflow</span>  <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">]):</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">tflow</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;flowed operator does not contain all flow times, check flow time list or remove file if corrupt&#39;</span><span class="p">)</span>
            <span class="c1"># print</span>
            <span class="c1"># print &#39;Debug&#39;</span>
            <span class="c1"># print ifile</span>
            <span class="c1"># for iflow,itop in zip(tflow,topcharge):</span>
            <span class="c1">#     print iflow,itop</span>
            <span class="c1"># if ntflow != len(tflow) and ntflow != 0:</span>
            <span class="c1">#     print &#39;Warning, tflow list has changed for file&#39;</span>
            <span class="c1">#     print self.flowfiledir+ifile</span>
            <span class="c1">#     print &#39;base comparision ntflow is &#39; , ntflow , &#39; , this file has &#39; , len(tflow)</span>
            <span class="c1">#     continue</span>
            <span class="c1"># ntflow = max(len(tflow),ntflow)</span>
                <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topcharge</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># if self.flowncfg*len(tflow) != len(thisdata):</span>
        <span class="c1">#     print &#39;ncfg&#39;,self.flowncfg,&#39;tflowlen&#39;, len(tflow)</span>
        <span class="c1">#     print &#39;thidata&#39;,len(thisdata)</span>
        <span class="c1">#     raise IOError(&#39;read in different ncfg * tflow than in file&#39;)</span>
        <span class="c1"># thisdata = thisdata.reshape(self.flowncfg,len(tflow))</span>
        <span class="c1"># thisdata = np.array(thisdata)</span>
        <span class="c1"># self.Op = np.rollaxis(thisdata,0,thisdata.ndim)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Write_Cfgs</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOp.FlowBootAndWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowBootAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOp.FlowFitAndWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowFitAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowFitAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>


    <span class="c1">## ease of use function to create &lt;Q^2&gt; or &lt;W^2&gt;</span>
<div class="viewcode-block" id="FlowOp.FlowMakeOppSquared"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowMakeOppSquared">[docs]</a>    <span class="k">def</span> <span class="nf">FlowMakeOppSquared</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowCombinePreBS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="c1"># output = output.CombinePreBS(output,&#39;x&#39;) ## For Fun</span>
        <span class="n">output</span><span class="o">.</span><span class="n">BootAndWrite</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="FlowOp.GetCombOpp"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.GetCombOpp">[docs]</a>    <span class="k">def</span> <span class="nf">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp1</span><span class="p">,</span><span class="n">opp2</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">opp1</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">opp2</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;QW&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">opp2</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Q2&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">opp1</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">opp2</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;QW&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">opp2</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;W2&#39;</span></div>

<div class="viewcode-block" id="FlowOp.GetChitFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.GetChitFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetChitFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscoeff</span><span class="p">,</span><span class="n">thispow</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">thiscoeff</span><span class="o">*</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="n">thispow</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">thiscoeff</span><span class="o">*</span><span class="n">thispow</span><span class="o">*</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">thispow</span><span class="o">-</span><span class="mi">1</span><span class="p">))]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">chit</span><span class="p">,</span><span class="n">chitder</span><span class="p">)</span></div>






    <span class="c1">## ease of use function to create chit = (hbarc/(latspace*nxyz**(0.75)*nt**(0.25)))</span>
    <span class="c1">## or chitW = (h barc/((latspace*nxyz**(0.75)*nt**(0.25)))**0.5)</span>
<div class="viewcode-block" id="FlowOp.FlowMakeChit"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowMakeChit">[docs]</a>    <span class="k">def</span> <span class="nf">FlowMakeChit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">OtherOpp</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Improve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ShowPrint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">RandT</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
            <span class="n">combfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Chit&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
            <span class="n">combfile</span> <span class="o">=</span> <span class="n">combfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Chit&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
            <span class="n">combfile</span> <span class="o">=</span> <span class="n">combfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Improve</span><span class="p">:</span> <span class="n">combfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.py3p&#39;</span><span class="p">,</span><span class="s1">&#39;Improv.py3p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">combfile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading Pickle for &#39;</span><span class="p">,</span> <span class="n">combfile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># output.flowPickleFile = combfile</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="n">combfile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Chit&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Chit&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Chit&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
                <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadeddict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCombOpp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>

            <span class="n">thischeck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">thischeck</span><span class="p">):</span>
                <span class="n">output</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>

                <span class="c1"># output.FlowLoadPickle()</span>
                <span class="n">output</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
                <span class="n">output</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
                <span class="n">output</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
                <span class="c1"># if RandT == &#39;None&#39;:</span>
                <span class="c1">#     output.FlowSetCustomName(string=output.flowname+&#39;_RandT&#39;+str(RandT),stringLL=output.flowLegLab+&#39;_RandT&#39;+str(RandT),RTDir=&#39;RandT&#39;)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
                <span class="n">output</span><span class="o">.</span><span class="n">FlowFitAndWrite</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">output</span>
        <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Combinging operators &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">OtherOpp</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">Improve</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="ow">and</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowCombinePreBS</span><span class="p">(</span><span class="n">OtherOpp</span><span class="p">,</span><span class="s1">&#39;leftI&#39;</span><span class="p">)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Improve</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Improved is only currently for Q^2&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowCombinePreBS</span><span class="p">(</span><span class="n">OtherOpp</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Ophold</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">])</span>
        <span class="c1"># print &#39;debug&#39;</span>
        <span class="c1"># for ikey,iout in output.Opboot.iteritems():</span>
        <span class="c1">#     print ikey, iout.Avg,iout.Std</span>
        <span class="k">if</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
                <span class="c1"># output = chitcoeff(self.nranget,self.latparams.nxyz,self.latparams.latspace,&#39;WQ&#39;) * output**(1/6.)</span>
                <span class="c1"># output.FlowSetCustomName(&#39;_&#39;.join([self.kud,self.ks,&#39;ChitQW&#39;]),&#39;$&#39;+&#39;\ &#39;.join([self.latparams.GetPionMassLab(),</span>
                <span class="c1">#                                                                               r&#39;\frac{1}{V^{1/6}}&lt;QW&gt;^{1/6}&#39;])+&#39;$&#39;)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;WQ&#39;</span><span class="p">)</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">*</span> <span class="n">output</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;ChitQW&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                 <span class="sa">r</span><span class="s1">&#39;\frac</span><span class="si">{1}{V}</span><span class="s1">&lt;QW&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;QW&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                 <span class="sa">r</span><span class="s1">&#39;&lt;QW&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="n">thispow</span> <span class="o">=</span> <span class="mf">1.0</span>

                <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Coefficient of &lt;QW&gt; is&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span><span class="p">,</span> <span class="s1">&#39; giving a result in GeV^(6)&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;QQ&#39;</span><span class="p">)</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mf">0.25</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">*</span> <span class="n">output</span><span class="o">**</span><span class="n">thispow</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;ChitQ2&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                 <span class="sa">r</span><span class="s1">&#39;\frac</span><span class="si">{1}</span><span class="s1">{V^{1/4}}&lt;Q^</span><span class="si">{2}</span><span class="s1">&gt;^{1/4}&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;Q2&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                 <span class="sa">r</span><span class="s1">&#39;&lt;Q^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Improve</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">+=</span> <span class="s1">&#39; Improve&#39;</span>
                <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Coefficient of &lt;QQ&gt; is&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="p">,</span><span class="s1">&#39; giving a result in GeV&#39;</span><span class="p">)</span>
                <span class="c1"># self.chitcoeff = thispow = 1</span>
                <span class="c1"># output.FlowSetCustomName(&#39;_&#39;.join([self.kud,self.ks,&#39;ChitQ2&#39;]),&#39;$&#39;+&#39;\ &#39;.join([self.latparams.GetPionMassLab(),</span>
                <span class="c1">#                                                                               r&#39;&lt;Q^{2}&gt;&#39;])+&#39;$&#39;)</span>
        <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;WW&#39;</span><span class="p">)</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mf">0.125</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">*</span> <span class="n">output</span><span class="o">**</span><span class="n">thispow</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;ChitW2&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                    <span class="sa">r</span><span class="s1">&#39;\frac</span><span class="si">{1}</span><span class="s1">{V^{1/8}}&lt;W^</span><span class="si">{2}</span><span class="s1">&gt;^{1/8}&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;W2&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                    <span class="sa">r</span><span class="s1">&#39;&lt;W^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Coefficient of &lt;WW&gt; is&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="p">,</span><span class="s1">&#39; giving a result in GeV&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">OtherOpp</span><span class="o">.</span><span class="n">Observ</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;QW&#39;</span><span class="p">)</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">*</span> <span class="n">output</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;ChitWQ&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                              <span class="sa">r</span><span class="s1">&#39;\frac</span><span class="si">{1}{V}</span><span class="s1">&lt;WQ&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">thispow</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span>   <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="s1">&#39;WQ&#39;</span><span class="p">]),</span>
                                                <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span>
                                                              <span class="sa">r</span><span class="s1">&#39;&lt;WQ&gt;&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Coefficient of &lt;WQ&gt; is&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="p">,</span><span class="s1">&#39; giving a result in GeV^(6)&#39;</span><span class="p">)</span>
        <span class="c1">## Improve does not work for this yet, so skip.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Improve</span><span class="p">:</span>
            <span class="n">autol</span><span class="p">,</span><span class="n">avgl</span><span class="p">,</span><span class="n">stdl</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">keyl</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autocorrelating &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
                <span class="c1"># print itflow, hold, np.mean(output.Opboot[itflow].bootvals)**(1/thispow)/self.chitcoeff,output.OpAuto[itflow].Avg, np.mean(output.Opboot[itflow].bootvals)</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="n">Ophold</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;Op&#39;</span><span class="p">)</span>
                <span class="n">autol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AutoCorrelate</span><span class="p">(</span><span class="n">Fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GetChitFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span><span class="p">,</span><span class="n">thispow</span><span class="p">),</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                                      <span class="n">name</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tdata</span><span class="p">))</span>
                <span class="n">keyl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
                <span class="n">avgl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">autol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">stdl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">autol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ShowPrint</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
            <span class="n">output</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">keyl</span>
            <span class="n">index_list</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">keyl</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">autol</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">avgl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">stdl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">RandT</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;_RandT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">RandT</span><span class="p">),</span><span class="n">stringLL</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="s1">&#39;_RandT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">RandT</span><span class="p">),</span><span class="n">RTDir</span><span class="o">=</span><span class="s1">&#39;RandT&#39;</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">chitcoeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span>
        <span class="k">if</span> <span class="n">RandT</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">FlowFitAndWrite</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="c1">## this function is used for creating operators like &lt;Q^2&gt; or &lt;QW&gt;</span>
    <span class="c1">## Process is , create 2class, class1/2.Read() , class_comb = class1.CombinePreBS(class2) , class_comb.Bootstrap() , class_comb.Write() etc..</span>

<div class="viewcode-block" id="FlowOp.FlowCombinePreBS_FixFT_Interp"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowCombinePreBS_FixFT_Interp">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCombinePreBS_FixFT_Interp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="mf">6.01</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Phys</span><span class="p">:</span>
            <span class="n">flow_time</span><span class="o">=</span><span class="n">flow_time</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">flow_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
        <span class="k">def</span> <span class="nf">SortFun_pos</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">flow_time</span><span class="o">-</span><span class="n">val</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1000</span>
        <span class="k">def</span> <span class="nf">SortFun_neg</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">flow_time</span><span class="o">-</span><span class="n">val</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1000</span>
        <span class="n">left_flow</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">flow_list</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">SortFun_pos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">right_flow</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">flow_list</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">SortFun_neg</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">left_flow</span> <span class="o">=</span> <span class="s1">&#39;t_f&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">left_flow</span><span class="p">)</span>
        <span class="n">right_flow</span> <span class="o">=</span> <span class="s1">&#39;t_f&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">right_flow</span><span class="p">)</span>
        <span class="n">left_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowCombinePreBS_FixFT</span><span class="p">(</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="n">Operation</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="n">left_flow</span><span class="p">)</span>
        <span class="n">right_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowCombinePreBS_FixFT</span><span class="p">(</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="n">Operation</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="n">right_flow</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">left_data</span><span class="p">,</span><span class="n">right_data</span><span class="p">,</span><span class="n">left_flow</span><span class="p">,</span><span class="n">right_flow</span></div>

<div class="viewcode-block" id="FlowOp.FlowCombinePreBS_FixFT"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowCombinePreBS_FixFT">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCombinePreBS_FixFT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">thisOpFun</span> <span class="o">=</span> <span class="n">GetOppFromStr</span><span class="p">(</span><span class="n">Operation</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;FlowCombinePreBS_FixFT only takes FlowOp types, not &#39;</span><span class="o">+</span><span class="n">FlowOps2</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="n">Info</span><span class="o">=</span><span class="n">CombineInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">Operation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)),</span>
                        <span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">this_Op</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># print &#39;DEBUG 3, &#39;</span>
        <span class="c1"># print self, len(self.Op),</span>
        <span class="c1"># print FlowOps2,len(FlowOps2.Op)</span>
        <span class="c1"># print</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flow_time</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">flow_time</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">flow_time</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">flow_time</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;flow_time passed to function is: &#39;</span><span class="o">+</span><span class="n">flow_time</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;not found in list </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">out_str</span><span class="p">)</span>
            <span class="n">flow_time</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flow_time</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Configuration lists differ, make sure .cfglist are identical&#39;</span><span class="p">)</span>
            <span class="n">this_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
            <span class="n">this_Op</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisOpFun</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">]),</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">][</span><span class="n">flow_time</span><span class="p">]))</span>
        <span class="n">this_index</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">this_index</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">this_Op</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">this_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>



<div class="viewcode-block" id="FlowOp.FlowCombinePreBS"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowCombinePreBS">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCombinePreBS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
        <span class="n">thisOpFun</span> <span class="o">=</span> <span class="n">GetOppFromStr</span><span class="p">(</span><span class="n">Operation</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">FlowOps2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;FlowCombinePreBS only takes FlowOp types, not &#39;</span><span class="o">+</span><span class="n">FlowOps2</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="n">Info</span><span class="o">=</span><span class="n">CombineInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">Operation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)),</span>
                        <span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">this_Op</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">this_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># print &#39;DEBUG 3, &#39;</span>
        <span class="c1"># print self, len(self.Op),</span>
        <span class="c1"># print FlowOps2,len(FlowOps2.Op)</span>
        <span class="c1"># print</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Configuration lists differ, make sure .cfglist are identical&#39;</span><span class="p">)</span>
            <span class="n">this_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
            <span class="n">this_Op</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisOpFun</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">FlowOps2</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">ikey</span><span class="p">])))</span>
        <span class="n">this_index</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">this_index</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">this_Op</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">this_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>




<div class="viewcode-block" id="FlowOp.FlowImportPlotParams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">FlowImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>

<div class="viewcode-block" id="FlowOp.FlowBootstrap"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowBootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Improve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;n_block&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_block</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">tflowlist</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="n">ReadAll</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="n">bootl</span><span class="p">,</span><span class="n">avgl</span><span class="p">,</span><span class="n">stdl</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">keyl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bootstrapping &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">):</span>
            <span class="n">strit</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span> <span class="c1">## XmlFormatting.py</span>
            <span class="k">if</span> <span class="n">strit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="ow">or</span> <span class="n">tflows</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="ow">or</span> <span class="n">ReadAll</span><span class="p">:</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span>
                <span class="c1">##ONLY FOR CHIT</span>
                <span class="k">if</span> <span class="n">Improve</span><span class="p">:</span>
                    <span class="n">iboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">strit</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span><span class="n">QforImprov</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span>
                                           <span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">,</span><span class="n">n_block</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_block</span><span class="p">)</span>
                    <span class="n">bootl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iboot</span><span class="o">.</span><span class="n">GetSingleBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_block</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">iboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">strit</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span>
                                           <span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">,</span><span class="n">n_block</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_block</span><span class="p">)</span>
                    <span class="n">bootl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iboot</span><span class="o">.</span><span class="n">GetSingleBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_block</span><span class="p">))</span>
                <span class="n">rlist</span> <span class="o">=</span> <span class="n">iboot</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
                <span class="n">keyl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strit</span><span class="p">)</span>
                <span class="n">avgl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">stdl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">keyl</span>
            <span class="n">index_list</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">keyl</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">bootl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">avgl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">stdl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowAutocorr</span><span class="p">(</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="FlowOp.GetObsFun"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.GetObsFun">[docs]</a>    <span class="k">def</span> <span class="nf">GetObsFun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">Ident</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">IdentDer</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Ident</span><span class="p">,</span><span class="n">IdentDer</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOp.FlowAutocorr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowAutocorr">[docs]</a>    <span class="k">def</span> <span class="nf">FlowAutocorr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># if not hasattr(self,&#39;OpAuto&#39;):</span>
        <span class="c1">#     return</span>
        <span class="k">if</span> <span class="n">tflowlist</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">tflowlist</span>
        <span class="n">ReadAll</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">autol</span><span class="p">,</span><span class="n">aavgl</span><span class="p">,</span><span class="n">astdl</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">keyl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autocorrelating &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span><span class="p">):</span>
            <span class="n">strit</span> <span class="o">=</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span> <span class="c1">## XmlFormatting.py</span>
            <span class="k">if</span> <span class="n">strit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="ow">or</span> <span class="n">tflows</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="ow">or</span> <span class="n">ReadAll</span><span class="p">:</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;Op&#39;</span><span class="p">)</span>
                <span class="n">keyl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strit</span><span class="p">)</span>
                <span class="n">autol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AutoCorrelate</span><span class="p">(</span> <span class="n">Fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GetObsFun</span><span class="p">(),</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">strit</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tdata</span><span class="p">))</span>
                <span class="n">aavgl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">autol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">astdl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">autol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keyl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">keyl</span>
            <span class="n">index_list</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">keyl</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">autol</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">aavgl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">astdl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOp.Get_Extrapolation"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Get_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">Get_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># print &#39;No fits found for extrapolation, attempting to fit now.&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># raise EnvironmentError(&#39;Flowed Operator Fit Failed&#39;)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">(</span><span class="n">fmted</span><span class="o">=</span><span class="n">fmted</span><span class="p">)</span></div>



    <span class="c1">## knoledge of number of parameters is needed</span>
<div class="viewcode-block" id="FlowOp.FlowSetFunction"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowSetFunction">[docs]</a>    <span class="k">def</span> <span class="nf">FlowSetFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Fun</span><span class="p">,</span><span class="n">npar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span> <span class="o">=</span> <span class="n">Fun</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">Fun</span><span class="p">,</span><span class="s1">&#39;__name__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FFun_name</span> <span class="o">=</span> <span class="n">Fun</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flownpar</span> <span class="o">=</span> <span class="n">npar</span></div>


    <span class="c1">## Fitting the correlator</span>
    <span class="c1">## flowfit_range is list of fit ranges to fit the correlator to</span>
    <span class="c1">## formatted as fitr#-# where # are the min and max fit values.</span>
    <span class="c1">## states correspond to how many states to fit to (currenlty only working for states = 1 or 2)</span>
<div class="viewcode-block" id="FlowOp.FlowFit"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowFit">[docs]</a>    <span class="k">def</span> <span class="nf">FlowFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">flowfit_range</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">FlowiGuess</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">EstDir</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Please define funciton using .SetFunction(Fun,npar) for fitting before calling .Fit()&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;PreDef&#39;</span> <span class="o">!=</span> <span class="n">flowfit_range</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span> <span class="o">=</span> <span class="n">flowfit_range</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">FlowiGuess</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowiGuess</span> <span class="o">=</span> <span class="n">FlowiGuess</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flownpar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thisparam</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thisparam</span> <span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span>

        <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">EstDir</span><span class="p">:</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flownpar</span><span class="p">,</span><span class="s1">&#39;Estimate&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flownpar</span><span class="p">)</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;iGuess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowiGuess</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; Fits&#39;</span>
        <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;paramunits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;GeV&#39;</span>
        <span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span> <span class="o">=</span> <span class="n">unxmlfitr_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span><span class="p">)</span>
        <span class="c1"># print(&#39;DEBUG&#39;,fit_min,fit_max)</span>
        <span class="c1"># print(self.Op_Stats[&#39;boot&#39;])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">this_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="FlowOp.Flowitems"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Flowitems">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>



<div class="viewcode-block" id="FlowOp.FlowitemsAvgStd"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowitemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">FlowitemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">it</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowOp.Flowvalues"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Flowvalues">[docs]</a>    <span class="k">def</span> <span class="nf">Flowvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="FlowOp.FlowvaluesAvgStd"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowvaluesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">FlowvaluesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span></div>


<div class="viewcode-block" id="FlowOp.Flowkeys"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Flowkeys">[docs]</a>    <span class="k">def</span> <span class="nf">Flowkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>



<div class="viewcode-block" id="FlowOp.Flownext"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.Flownext">[docs]</a>    <span class="k">def</span> <span class="nf">Flownext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span></div>

    <span class="c1">## incase next gets overloaded</span>
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flownext</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="FlowOp.FlowWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ExtraInfo</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>



        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowncfg_list&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">incfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ncfg_&#39;</span><span class="o">+</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">incfg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;chitcoeff&#39;</span><span class="p">):</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;chit_coeff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chitcoeff</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;t0_values&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">irow</span><span class="p">,</span><span class="n">rowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0_values</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">this_key</span> <span class="o">=</span> <span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;tf_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_to_&#39;</span><span class="o">+</span><span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;tf_max&#39;</span><span class="p">]</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">this_key</span><span class="p">][</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">this_key</span><span class="p">][</span><span class="s1">&#39;sqrt8tf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;sqrt8tf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">rowdata</span><span class="p">[</span><span class="s1">&#39;sqrt8tf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>


        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>




        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Opboot&#39;</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="c1"># if hasattr(self,&#39;FlowFun&#39;):</span>
        <span class="c1">#     outDict[&#39;FlowFits&#39;][&#39;Function&#39;] = self.FlowFun.__name__</span>
        <span class="c1"># elif hasattr(self,&#39;FlowFun_name&#39;):</span>
        <span class="c1">#     outDict[&#39;FlowFits&#39;][&#39;Function&#39;] = self.FlowFun_name</span>
        <span class="c1"># if self.flowiGuess == &#39;None&#39;:</span>
        <span class="c1">#     outDict[&#39;FlowFits&#39;][&#39;Initial_Guess&#39;] = &#39;Default (see FitFunctions.py)&#39;</span>
        <span class="c1"># else:</span>
        <span class="c1">#     for iparam in xrange(1,self.flownpar+1):</span>
        <span class="c1">#         thispar = &#39;Par&#39;+str(iparam)</span>
        <span class="c1">#         outDict[&#39;FlowFits&#39;][&#39;Initial_Guess&#39;][thispar] = self.flowiGuess[iparam]</span>
            <span class="c1"># for thispar,parbs in fitdict.Params.iteritems():</span>
            <span class="c1">#     outDict[&#39;FlowFits&#39;][ifit][thispar] = AvgStdToFormat(parbs.Avg,parbs.Std)</span>
            <span class="c1"># outDict[&#39;FlowFits&#39;][ifit][&#39;Chi^2_pdf&#39;] = AvgStdToFormat(fitdict.Chi2DoF.Avg,fitdict.Chi2DoF.Std)</span>
            <span class="c1"># outDict[&#39;FlowFits&#39;][ifit][&#39;MaxIter&#39;] = fitdict.MaxIter</span>
            <span class="c1"># outDict[&#39;FlowFits&#39;][ifit][&#39;Prec&#39;] = fitdict.Prec</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;S_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span>
            <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto&#39;</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto_Wopt&#39;</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">Wopt</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto_tau&#39;</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">tau</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">tauerr</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;FlowFits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowncfg_list&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">ExtraInfo</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">ExtraInfo</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">outDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">ival</span>



        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>

        <span class="c1">## write to excel file</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span><span class="p">,{</span><span class="s1">&#39;Op_results&#39;</span><span class="p">:</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">)},</span><span class="n">flowcfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowncfg_list&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>

        <span class="c1">## pickles rest of data for reading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOp.GetFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="p">,</span><span class="s1">&#39;GetFuns&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;FlowFun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span> <span class="o">=</span> <span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowFun_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun_name</span></div>

<div class="viewcode-block" id="FlowOp.RemoveFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="p">,</span><span class="s1">&#39;RemoveFuns&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;FlowFun&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span><span class="p">,</span><span class="s1">&#39;__name__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowFun</span></div>

    <span class="c1">##################################</span>

<div class="viewcode-block" id="FlowOp.FlowReadAndWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tflowlist</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOp.FixRead"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowInfo&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowfit_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfit_range</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowCfgFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowLegLab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="c1"># readdict[&#39;read_cfgs_from_file&#39;] = self.read_cfgs_from_file</span>
        <span class="k">if</span> <span class="s1">&#39;is_comb&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;is_comb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_comb</span>
        <span class="k">if</span> <span class="s1">&#39;cfg_file_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;FFun_name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FFun_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFun_name</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, fit function in file&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FFun_name&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;is not what was asked for&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FFun_name</span><span class="p">)</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FFun_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFun_name</span>
        <span class="k">if</span> <span class="s1">&#39;FlowNewForm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">readdict</span></div>


<div class="viewcode-block" id="FlowOp.FlowLoadPickle"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowLoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">FlowLoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># print &#39;Loading Pickle for &#39; , self.flowPickleFile</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="n">thischeck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span>
            <span class="c1">## TODO: implement cfglist check with new style</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span><span class="p">:</span> <span class="n">thischeck</span> <span class="o">=</span> <span class="n">thischeck</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">]</span>
            <span class="c1"># checkdict = deepcopy(self.__dict__)</span>
            <span class="c1"># checkdict[&#39;flowPickleFile&#39;] = self.flowPickleFile.replace(&#39;.bak&#39;,&#39;&#39;)</span>
            <span class="c1"># checkdict[&#39;flowExcelFile&#39;] = self.flowExcelFile.replace(&#39;.bak&#39;,&#39;&#39;)</span>
            <span class="c1"># checkdict[&#39;flowHumanFile&#39;] = self.flowHumanFile.replace(&#39;.bak&#39;,&#39;&#39;)</span>
            <span class="k">if</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">loadeddict</span><span class="p">,</span><span class="n">thischeck</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Wipe_All_Fits</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="p">,</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flowFit_Stats</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using backupfile for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span><span class="o">+</span><span class="s1">&#39;.bak&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.bak.xlsx&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="p">,</span> <span class="s1">&#39; has different parameters than this instance, reading and writing over file now&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FlowReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="c1"># self.FlowWrite()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowReadAndWrite</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span></div>
    <span class="c1">## Operator overloading</span>

    <span class="c1">#Too Much work, only works for one operator. Please use SetCustomName after doing all algebraic manipulation</span>

    <span class="c1">## this could to with some improving.... or some more generallity somewhere</span>

<div class="viewcode-block" id="FlowOp.FlowUpdateName"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOp.FlowUpdateName">[docs]</a>    <span class="k">def</span> <span class="nf">FlowUpdateName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">Op</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;x0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;pow2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>
        <span class="k">def</span> <span class="nf">GetLegSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 2&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">imes 0&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;^</span><span class="si">{2}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;div&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;divself&#39;</span>
            <span class="k">elif</span> <span class="n">opp</span> <span class="o">==</span> <span class="s1">&#39;pow&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;powself&#39;</span>

        <span class="k">def</span> <span class="nf">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">):</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">opp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\times &#39;</span><span class="p">)</span>
            <span class="n">oppout</span> <span class="o">=</span> <span class="n">oppout</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;pow&#39;</span><span class="p">,</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">oppout</span>

        <span class="n">outname</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">oppLL</span> <span class="o">=</span> <span class="n">LLFormatOp</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span> <span class="c1">## \times looks better :)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowLegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">Op2</span><span class="o">.</span><span class="n">flowLegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowname</span> <span class="o">==</span> <span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span><span class="p">:</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowname</span><span class="p">,</span><span class="n">GetOppSelf</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="s1">&#39; Comb &#39;</span><span class="p">,</span><span class="n">GetLegSelf</span><span class="p">(</span><span class="n">oppLL</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iname</span><span class="p">,</span><span class="n">iname2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">flowname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iname</span> <span class="ow">in</span> <span class="n">iname2</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iname2</span> <span class="ow">in</span> <span class="n">iname</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outname</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iname</span><span class="o">+</span><span class="n">opp</span><span class="o">+</span><span class="n">iname2</span><span class="p">)</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iflowLegLab</span><span class="p">,</span><span class="n">iflowLegLab2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">op1LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span><span class="n">op2LL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\ &#39;</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">iflowLegLab</span> <span class="ow">in</span> <span class="n">iflowLegLab2</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iflowLegLab2</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">iflowLegLab2</span> <span class="ow">in</span> <span class="n">iflowLegLab</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iflowLegLab</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">outLL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iflowLegLab</span><span class="o">+</span><span class="n">oppLL</span><span class="o">+</span><span class="n">iflowLegLab2</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="n">op1LL</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowLegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowname</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="n">Op2</span><span class="o">.</span><span class="n">name</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="n">Op2</span><span class="o">.</span><span class="n">name</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="n">Op</span><span class="o">.</span><span class="n">flowname</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Op2</span><span class="p">)</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Op2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Op2</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                        <span class="n">outname</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">flowname</span><span class="p">,</span><span class="n">opp</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Op2</span><span class="p">)</span>
                        <span class="n">outLL</span> <span class="o">=</span> <span class="n">op1LL</span><span class="p">,</span><span class="n">oppLL</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Op2</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="n">op2LL</span> <span class="o">=</span> <span class="n">Op2</span><span class="o">.</span><span class="n">flowLegLab</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## removes $ symbols, re adds at end</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span><span class="n">BootStrap</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="n">Op</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">opp</span> <span class="p">,</span><span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="n">Op</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">outname</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span> <span class="p">,</span><span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span>
                <span class="n">outLL</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Op</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span> <span class="o">+</span> <span class="n">opp</span><span class="p">,</span><span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span>
                    <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Op</span><span class="p">)</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="n">op2LL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Op</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Op</span><span class="p">))</span> <span class="o">+</span> <span class="n">opp</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Op</span><span class="p">))</span> <span class="o">+</span> <span class="n">oppLL</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>

        <span class="c1"># print r&#39;$&#39;+r&#39;\ &#39;.join(outLL)+&#39;$&#39;</span>
        <span class="n">outLL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iLL</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outLL</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">iLL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">iLL</span><span class="p">:</span>
                <span class="n">outLL</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">iLL</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;^{&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}&#39;</span>
        <span class="k">if</span> <span class="n">outname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">outLL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span>
                <span class="n">outLL</span> <span class="o">=</span> <span class="n">outLL</span><span class="p">[</span><span class="n">outLL</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">),</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outLL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outname</span><span class="p">))</span></div>

    <span class="c1">## Numerical operatoions</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">FlowOp</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">Op2</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">+</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">+</span> <span class="n">Op2</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">FlowOp</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">Op2</span><span class="o">.</span><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">-</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">-</span> <span class="n">Op2</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">FlowOp</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">Op2</span><span class="o">.</span><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">*</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">*</span> <span class="n">Op2</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">FlowOp</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">Op2</span><span class="o">.</span><span class="n">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">/</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ibs</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ibs</span> <span class="ow">in</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="o">.</span><span class="n">bootvals</span><span class="p">]):</span>
                            <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s1">&#39;Dividing by zero found in bootstrap division for &#39;</span><span class="o">+</span><span class="n">Op2</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># if Op2 == 0:</span>
                <span class="c1">#     raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division&#39;)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">/</span> <span class="n">Op2</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">result</span>


    <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ipar</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ipar</span> <span class="ow">in</span> <span class="n">FlowOp</span><span class="o">.</span><span class="n">parentlist</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">Op2</span><span class="o">.</span><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                                  <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;pow&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span> <span class="o">**</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="n">Op2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>

            <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">result</span>


    <span class="c1">## Right multiplication functions</span>


    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="n">Op2</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">iOp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Op2</span> <span class="o">+</span> <span class="n">iOp</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">Op2</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">iOp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Op2</span> <span class="o">-</span> <span class="n">iOp</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">Op2</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">*</span> <span class="n">iOp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Op2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span><span class="n">Op2</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">/</span> <span class="n">iOp</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">ibs</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ibs</span> <span class="ow">in</span> <span class="n">iOp</span><span class="o">.</span><span class="n">bootvals</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s1">&#39;Dividing by zero found in bootstrap division for &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">iOp</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Op2</span> <span class="o">/</span> <span class="n">iOp</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">iOp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s1">&#39;Dividing by zero found in bootstrap division&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Op2</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">thisnboot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span>
                              <span class="n">Info</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">FlowUpdateName</span><span class="p">(</span><span class="s1">&#39;pow&#39;</span><span class="p">,</span><span class="n">Op2</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2</span><span class="p">,</span><span class="n">FlowOp</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Op2</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">**</span> <span class="n">iOp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Op2</span> <span class="o">**</span> <span class="n">iOp</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Op2</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;Invalid value to combine with FlowOp class&#39;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">is_comb</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>


    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>






<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################</span>







<div class="viewcode-block" id="FlowOpFullSquared"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared">[docs]</a><span class="k">class</span> <span class="nc">FlowOpFullSquared</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Op(tf,t) uses bootstrap class</span>
<span class="sd">        tf = flow time</span>
<span class="sd">        t = time slice</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FlowOpFullSquared.Construct_FOFull_File"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Construct_FOFull_File">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_FOFull_File</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Construct_File_Object</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">FlowOpFullSquared</span><span class="p">)</span></div>

    <span class="c1">## Info is a dictionary containing information for the correlator:</span>
    <span class="c1">## see comments below to see what is required.</span>
    <span class="c1">## missing elements just ignores that field</span>

    <span class="c1">## TODO: create variational flag and interface with this function.</span>

    <span class="c1">## array of all classes that inherit this class. Append this when adding new classes please!</span>
    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[</span>  <span class="s1">&#39;TwoPtCorrelators.TwoPointCorr&#39;</span><span class="p">,</span><span class="s1">&#39;TwoPtCorrelators.NNQCorr&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;TwoPtCorrelators.NNQFullCorr&#39;</span><span class="p">,</span><span class="s1">&#39;VarMethod.VariationalTwoPt&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;RatioCorrelators.RatioCorr&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;RatioCorrelators.RatioFOCorr&#39;</span><span class="p">,</span><span class="s1">&#39;RatioCorrelators.RatioFOFullCorr&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thisnboot</span><span class="o">=</span><span class="n">nboot</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span><span class="n">Info</span><span class="o">=</span><span class="p">{},</span> <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Not Set&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">LLname</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                 <span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">GetFolderFileOp</span><span class="p">(</span><span class="n">thistype</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                <span class="k">if</span>  <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">thistype</span>  <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;FlowNewForm&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span>
                <span class="k">elif</span>  <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">thistype</span> <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;FlowNewForm&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thistype &#39;</span> <span class="p">,</span> <span class="n">thistype</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Type of operator not known, please select TopCharge or Weinberg&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span>  <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">thistype</span>  <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;Flow&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span>
                <span class="k">elif</span>  <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">thistype</span> <span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;Flow&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thistype &#39;</span> <span class="p">,</span> <span class="n">thistype</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Type of operator not known, please select TopCharge or Weinberg&#39;</span><span class="p">)</span>

        <span class="c1">## these class elemnts are checked when loading in pickled file</span>

        <span class="c1"># self.thischecklist = [&#39;nboot&#39;,&#39;kud&#39;,&#39;ks&#39;,&#39;tflowlist&#39;,&#39;cfglist&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thischecklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">,</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeParameters</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^</span><span class="si">{3}</span><span class="s1">\times &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## Initialising plotting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span>


        <span class="c1">## Op.... are the individual results for each time and flow time</span>
        <span class="c1"># #self.Op = [ itf , it , iconf ]</span>
        <span class="c1"># self.Op     = np.array([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span>  <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op_cfgs DataFrame:</span>

<span class="sd">        columns =   config_numbers , Op[itflow,it]</span>

<span class="sd">        rows =      stream , configuration</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="c1">## when bootstrapping, the random source selection is done as well</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>

<span class="sd">        rows =      flow time, it_src</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op_avg_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>
<span class="sd">                    Auto, AutoAvg,  AutoStd</span>

<span class="sd">        rows =      flow time</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">## &lt;Q^2&gt; data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Chi_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>
<span class="sd">                    Auto, AutoAvg,  AutoStd</span>

<span class="sd">        rows =      flow time</span>
<span class="sd">        &#39;&#39;&#39;</span>



        <span class="c1">## &lt;Q(0)Q(t)&gt; data</span>
        <span class="c1"># #self.Op2 = [ itf , it_distance , itsum , it_src , iconf ]</span>
        <span class="c1"># self.Op2     = np.array([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op2_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>

<span class="sd">        rows =      flow time , time separation , sum time, source time</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">## averaged over source locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Op2_avg_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>
<span class="sd">                    Auto, AutoAvg,  AutoStd</span>

<span class="sd">        rows =      flow time , time separation , sum time</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">## averaged over source locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Col_Names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sum_time&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        self.Prop_Fit_Stats DataFrame:</span>

<span class="sd">        columns =   boot, Avg,      Std</span>

<span class="sd">        rows =      sum time , flow time</span>

<span class="sd">        type = SetOfFitFuns</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span> <span class="o">=</span> <span class="n">thisnboot</span>

        <span class="c1">## for autocorrelation analysis</span>
        <span class="k">if</span> <span class="s1">&#39;Sparam&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sparam&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span> <span class="o">=</span> <span class="n">defSparam</span>

        <span class="k">if</span> <span class="s1">&#39;show_cfgs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="c1">## kappa up down (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## kappa strange (in integer form)</span>
        <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1">## Current obersvables are TopCharge and Weinberg</span>
        <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">=</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="c1">## default to TopCharge</span>

        <span class="k">if</span> <span class="s1">&#39;cfg_file_type&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span> <span class="o">=</span> <span class="n">cfg_file_type</span>

        <span class="c1">## this is used display only these flowtimes, Still reads and writes all</span>
        <span class="k">if</span> <span class="s1">&#39;tflowlist&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">defxlimOp</span> <span class="c1">## default to read all flow times</span>



        <span class="c1">## number of random sources per gauge field to average over</span>
        <span class="k">if</span> <span class="s1">&#39;nrandt&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;nrandt&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>

        <span class="k">if</span> <span class="s1">&#39;Op_fold&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_fold</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Op_fold&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_fold</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1">## number of random sources per gauge field to average over</span>
        <span class="k">if</span> <span class="s1">&#39;nranget&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">nranget</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;nranget&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nranget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span>


        <span class="c1">## number of values summed after to.</span>
        <span class="c1">## default is 1 (for single source) and all (to give back original Q^2 result)</span>
        <span class="k">if</span> <span class="s1">&#39;tsum_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsum_list&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;tsum_list&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">)]</span>

        <span class="c1">## include the calculation of &lt;Q^2&gt;</span>
        <span class="k">if</span> <span class="s1">&#39;Do_Chi&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Do_Chi&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1">## selects if the sum is taken or not.</span>
        <span class="k">if</span> <span class="s1">&#39;Sum_Range&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sum_range</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sum_Range&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sum_range</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1">## selects if the sum is taken or not.</span>
        <span class="k">if</span> <span class="s1">&#39;Sublat_Method&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span> <span class="o">=</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;Sublat_Method&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
            <span class="c1"># self.prop_fit_fun = [Chi_Prop_Fit_2exp,5]</span>


        <span class="c1">## will attempt to find all replica streams in directory.</span>
        <span class="c1">## set self.nstream to number of streams you want to find.</span>
        <span class="k">if</span> <span class="s1">&#39;stream_list&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">iinfo</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">iinfo</span> <span class="ow">in</span> <span class="n">Info</span><span class="p">[</span><span class="s1">&#39;stream_list&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span> <span class="o">=</span> <span class="n">flow_new_format</span>
        <span class="c1"># if &#39;FlowNewForm&#39; in Info.keys(): self.FlowNewForm = Info[&#39;FlowNewForm&#39;]</span>
        <span class="c1"># else: self.FlowNewForm = False ## default to read all flow times</span>


        <span class="c1"># print &#39;DEBUG&#39;</span>
        <span class="c1"># print &#39;tsumlist&#39;,self.tsum_list</span>
        <span class="c1"># print &#39;nrandt&#39;,self.nrandt</span>

        <span class="n">listout</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ict</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;t_f&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">itflow</span><span class="p">):</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">listout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowfloat</span> <span class="o">=</span> <span class="p">[</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">listout</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">listout</span><span class="p">)</span>

        <span class="n">thisfolder</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span> <span class="o">=</span> <span class="n">GetFolderFileOp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfilename</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;_flow_b1.90_ng&#39;</span><span class="p">,</span><span class="s1">&#39;.out&#39;</span><span class="p">]</span>

        <span class="n">kappafolder</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfilelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;t_t</span><span class="si">{:2.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">itflow</span><span class="p">))</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">]</span>
        <span class="c1"># self.flowfilename = [&#39;RC32x64_B1900&#39;+kappafolder+&#39;C1715&#39;,&#39;_&#39;,&#39;_k&#39;+self.kud.replace(&#39;kud&#39;,&#39;&#39;)+&#39;_&#39;+self.tsrc+filejsm+fileism+&#39;_nucleon.2cf.xml&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span> <span class="o">=</span> <span class="n">datadir</span><span class="o">+</span><span class="n">thisfolder</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;-*-/&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">==</span> <span class="s1">&#39;TopCharge&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;QQ&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thispow</span> <span class="o">=</span> <span class="mf">0.25</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">Observ</span> <span class="o">==</span> <span class="s1">&#39;Weinberg&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span> <span class="o">=</span> <span class="n">chitcoeff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">,</span><span class="s1">&#39;WW&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thispow</span> <span class="o">=</span> <span class="mf">0.125</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Observable not recognised&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thispow</span> <span class="o">=</span> <span class="mf">1.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Create_Streams_Dirs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span> <span class="o">=</span> <span class="n">Info</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">man_load_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoadCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span>

<div class="viewcode-block" id="FlowOpFullSquared.LoadCfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.LoadCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">LoadCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">LLname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="c1">## cfglist { configuration : [ x-source numbers ] }</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetCfgList</span><span class="p">()</span>

        <span class="c1">## predefine a time picking</span>
        <span class="c1">## self.timelist [ it0_rand , istream, icfg]</span>
        <span class="k">if</span> <span class="s1">&#39;PickedTimes&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ImportTimeList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">[</span><span class="s1">&#39;PickedTimes&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MakeRandomTimeList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">LLname</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.GetFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;prop_fit_fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span> <span class="o">=</span> <span class="p">[</span><span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_npar</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;prop_fit_der_name&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ReadFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_der_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.RemoveFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.RemoveFuns">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;prop_fit_fun&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_npar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_der_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">WriteFuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.Create_Streams_Dirs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Create_Streams_Dirs">[docs]</a>    <span class="k">def</span> <span class="nf">Create_Streams_Dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">All_Streams</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Check_Streams</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">thisdir</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisdir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.All_Streams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.All_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">All_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ifolder</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)):</span>
            <span class="n">this_stream</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;-.*-&#39;</span><span class="p">,</span><span class="n">ifolder</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">this_stream</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_stream</span><span class="p">)</span></div>
        <span class="c1"># if len(self.stream_list) == 0:</span>
        <span class="c1">#     raise IOError(self.flowfiledir+&#39;\n No Streams found&#39;)</span>

<div class="viewcode-block" id="FlowOpFullSquared.Check_Streams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Check_Streams">[docs]</a>    <span class="k">def</span> <span class="nf">Check_Streams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">))</span>
            <span class="n">this_check</span> <span class="o">=</span> <span class="n">this_check</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">this_check</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> stream directory not found, as well as </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">flowfiledir</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-*-&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span></div>




<div class="viewcode-block" id="FlowOpFullSquared.FlowReadAndWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">OnlyQ</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">OnlyQ</span><span class="o">=</span><span class="n">OnlyQ</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">OnlyQ</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FixRead"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FixRead">[docs]</a>    <span class="k">def</span> <span class="nf">FixRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">readdict</span><span class="p">):</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowInfo&#39;</span><span class="p">][</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowInfo</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">outputdir</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">PickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;latparams&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">HumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">HumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;nrandt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;nranget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nranget</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;tsum_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowncfg_list&#39;</span><span class="p">):</span>
            <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowncfg_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Op_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Op_avg_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Chi_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Op2_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;Op2_avg_Stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span>
        <span class="c1"># print &#39;DEBUGGING PERPOUSES, please comment line below&#39;</span>
        <span class="c1"># if self.prop_fit_fun[0].__name__ != readdict[&#39;prop_fit_fun&#39;][0].__name__:</span>
        <span class="c1">#     readdict[&#39;Prop_Fit_Stats&#39;] = self.Prop_Fit_Stats</span>
        <span class="c1">#     readdict[&#39;prop_fit_fun&#39;] = self.prop_fit_fun</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowfilelist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilelist</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowfilepref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowdir_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowPickleFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowHumanFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;flowExcelFile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;cfg_file_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="n">readdict</span><span class="p">[</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span>
        <span class="k">return</span> <span class="n">readdict</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowLoadPickle"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowLoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">FlowLoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">OnlyQ</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DefWipe</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading Pickle for &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="n">ReadPickleWrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
            <span class="n">loadeddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FixRead</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="c1"># thischeck = self.thischecklist</span>
            <span class="c1"># if CheckCfgs: thischeck = thischeck + [&#39;flowcfglist&#39;]</span>
            <span class="c1"># if CheckClass(self.__dict__,loadeddict,thischeck):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loadeddict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Wipe_All_Fits</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Legacy file, fits need to be recomputed&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="c1"># print &#39;DEBUG&#39;</span>
            <span class="c1"># print self.Prop_Fit_Stats</span>
            <span class="c1"># else:</span>
            <span class="c1">#     print &#39;Warning, file &#39; , self.flowHumanFile , &#39; has different parameters than this instance, reading and writing over file now&#39;</span>
            <span class="c1">#     print</span>
            <span class="c1"># self.FlowWrite()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowReadAndWrite</span><span class="p">(</span>  <span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span>
                                <span class="n">OnlyQ</span><span class="o">=</span><span class="n">OnlyQ</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowGetCfgList_New"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowGetCfgList_New">[docs]</a>    <span class="k">def</span> <span class="nf">FlowGetCfgList_New</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">SplitCfg</span><span class="p">(</span><span class="n">ifile</span><span class="p">):</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;_ng.*&#39;</span><span class="p">,</span><span class="n">ifile</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">icfg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: file does not have cfg number&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>
            <span class="n">icfg</span> <span class="o">=</span> <span class="n">icfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_ng&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.out&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">icfg</span>

        <span class="n">cfglist</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">low_test</span><span class="p">,</span><span class="n">upper_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;PerGF/&#39;</span>
            <span class="k">for</span> <span class="n">icfg</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">low_test</span> <span class="ow">in</span> <span class="n">ifile</span> <span class="ow">or</span> <span class="n">upper_test</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">:</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span>
                    <span class="n">cfglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SplitCfg</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No configs found for directory:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; , &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">cfglist</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">cfg_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;int_configs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cfg_df</span><span class="p">[</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfg_df</span><span class="p">)</span></div>



<div class="viewcode-block" id="FlowOpFullSquared.FlowGetCfgList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowGetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">FlowGetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowGetCfgList_New</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">def</span> <span class="nf">CheckCfgFolder</span><span class="p">(</span><span class="n">thisdir</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">icheck</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilelist</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisdir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">icheck</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">cfglist</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">:</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">idir</span> <span class="o">=</span> <span class="n">idir</span> <span class="o">+</span> <span class="s1">&#39;Comb/&#39;</span>
            <span class="k">for</span> <span class="n">icfg</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">)):</span>
                <span class="k">if</span> <span class="s1">&#39;cfg&#39;</span> <span class="ow">in</span> <span class="n">ifile</span> <span class="ow">and</span> <span class="n">CheckCfgFolder</span><span class="p">(</span><span class="n">ifile</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span>
                    <span class="n">cfglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ifile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;cfg&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No configs found for directory:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; , &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">cfglist</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">cfg_df</span> <span class="o">=</span> <span class="n">cfg_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;int_configs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cfg_df</span><span class="p">[</span><span class="s1">&#39;int_configs&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfg_df</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Write_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Write_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Write_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;read_cfgs_from_file&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;to_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;to_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;to_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="c1"># this_df,dump = self.Get_Flattened_Cfgs()</span>
        <span class="n">this_t_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])))</span>
        <span class="n">this_meta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">this_t_list</span><span class="p">])</span>
        <span class="n">WriteWithMeta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">,</span><span class="n">this_meta</span><span class="p">,</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.ChopDepVarList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.ChopDepVarList">[docs]</a>    <span class="k">def</span> <span class="nf">ChopDepVarList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_df</span><span class="p">,</span><span class="n">read_meta</span><span class="p">,</span><span class="n">show_err</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">read_tflow</span><span class="p">,</span><span class="n">read_t</span> <span class="o">=</span> <span class="n">read_meta</span>
        <span class="n">this_t</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">))</span>
        <span class="n">isin</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">this_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>
        <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;euclidian_times&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">ithis_list</span><span class="p">,</span><span class="n">icheck_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="n">this_t</span><span class="p">,</span><span class="n">read_t</span><span class="p">),(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">read_tflow</span><span class="p">)]):</span>
            <span class="c1"># isin = isin and set(ithis_list).issubset(icheck_list)</span>
            <span class="n">isin</span> <span class="o">=</span> <span class="n">isin</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isin</span><span class="p">:</span>
                <span class="n">same_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">same_list</span><span class="p">:</span>
                    <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">it</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">ithis_list</span><span class="p">]</span>
                    <span class="n">this_index</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_list</span>
            <span class="k">elif</span> <span class="n">show_err</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> missmatch in &#39;</span><span class="p">,</span><span class="n">name_list</span><span class="p">[</span><span class="n">ic</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ithis_list</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">icheck_list</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">isin</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">Chop_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">)[</span><span class="n">this_index</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Chop_fun</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">,</span><span class="n">isin</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Read_Cfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Read_Cfgs">[docs]</a>    <span class="k">def</span> <span class="nf">Read_Cfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_tflowlist</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cfg_data</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>
            <span class="k">if</span> <span class="n">CheckCfgs</span> <span class="ow">and</span> <span class="s1">&#39;stream_cfgs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
                <span class="n">second_class</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">cfg_data</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">])</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="n">CheckClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span><span class="n">second_class</span><span class="p">,[</span><span class="s1">&#39;Op_cfgs&#39;</span><span class="p">])</span>
                <span class="c1"># cfg_bool = np.array(self.Op_cfgs[&#39;stream_cfgs&#39;].values) == np.array(cfg_data[&#39;stream_cfgs&#39;].values)</span>
                <span class="c1"># if isinstance(cfg_bool,np.ndarray):</span>
                <span class="c1">#     cfg_bool = all(cfg_bool)</span>
                <span class="c1"># if show_timer and not cfg_bool:</span>
                <span class="c1">#     print &#39;\n&#39;+GetCfgMissmatch(  np.array(self.Op_cfgs[&#39;stream_cfgs&#39;].values),</span>
                <span class="c1">#                             np.array(cfg_data[&#39;stream_cfgs&#39;].values))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cfg_bool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">cfg_bool</span><span class="p">:</span>
                <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ChopDepVarList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">read_tflowlist</span><span class="p">,</span><span class="n">show_err</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">cfg_data</span><span class="p">,</span><span class="n">outbool</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">False</span>


        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg_file_type</span>
        <span class="k">if</span> <span class="s1">&#39;read_&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;read_&#39;</span><span class="o">+</span><span class="n">file_type</span>
        <span class="n">this_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">+</span><span class="n">fmt_file_type</span><span class="p">(</span><span class="n">file_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;read_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;-def-&#39;</span> <span class="ow">in</span> <span class="n">this_file</span> <span class="ow">or</span> <span class="s1">&#39;--&#39;</span> <span class="ow">in</span> <span class="n">this_file</span><span class="p">:</span>
                <span class="n">this_file</span> <span class="o">=</span> <span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-def-&#39;</span><span class="p">,</span><span class="s1">&#39;-*-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-*-&#39;</span><span class="p">)</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cfg FNF: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">this_file</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">this_file</span> <span class="o">=</span> <span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cfg FNF: &#39;</span> <span class="o">+</span> <span class="n">this_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Reading Cfgs &#39;</span><span class="o">+</span><span class="n">this_file</span><span class="p">)</span>
        <span class="n">meta_data</span><span class="p">,</span><span class="n">cfg_data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">)</span>
        <span class="c1"># cfg_data = self.Format_Flattened_Cfgs(cfg_data)</span>
        <span class="n">cfg_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MakeStreamCfgs</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span>
        <span class="n">cfg_data</span><span class="p">,</span><span class="n">check_bool</span> <span class="o">=</span> <span class="n">CheckCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">,</span><span class="n">meta_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_bool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfg_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> file incorrect,&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.cfgs&#39;</span><span class="p">,</span><span class="s1">&#39;.cfgs.bak&#39;</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; found backup file&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; reading unformatted&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">read_cfgs_from_file</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.MakeRandomTimeList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.MakeRandomTimeList">[docs]</a>    <span class="k">def</span> <span class="nf">MakeRandomTimeList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="c1"># raise EnvironmentError(&#39;configuration list need to be read in before getting random time list&#39;)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: configuration list need to be read in before getting random time list&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">readnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
            <span class="c1">## timelist [  irandt , istream, icfg ]</span>
            <span class="n">timelist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">icfg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">istream</span><span class="p">):</span>
                    <span class="n">timelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">readnt</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;random_time_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">timelist</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)],</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

        <span class="c1"># self.timelist = np.random.randint(0,readnt,(self.flowncfg,self.nrandt))</span>

<div class="viewcode-block" id="FlowOpFullSquared.ImportTimeList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.ImportTimeList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportTimeList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timelist_in</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;configuration list need to be read in before import random time list&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timelist_in</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;random_time_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timelist_in</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">## timelist_in must be of shape [ itsrc_number, istream, icfg]</span>
            <span class="n">timelist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">isrc</span> <span class="ow">in</span> <span class="n">timelist_in</span><span class="p">:</span>
                <span class="n">this_timelist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="n">isrc</span><span class="p">:</span>
                    <span class="n">this_timelist</span> <span class="o">+=</span> <span class="n">istream</span>
                <span class="n">timelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_timelist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;random_time_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">timelist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>



<div class="viewcode-block" id="FlowOpFullSquared.FlowRead_New"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowRead_New">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRead_New</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FlowReadTopCharge_New</span><span class="p">(</span><span class="n">thisfile</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">):</span>
                <span class="n">readfile</span> <span class="o">=</span> <span class="n">thisfile</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ng00&#39;</span><span class="p">,</span><span class="s1">&#39;ng&#39;</span><span class="p">)):</span>
                <span class="n">readfile</span> <span class="o">=</span> <span class="n">thisfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ng00&#39;</span><span class="p">,</span><span class="s1">&#39;ng&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, file not found&#39;</span><span class="p">,</span><span class="n">thisfile</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">[],[],[]</span>
            <span class="c1"># print &#39;DEBUG reading: &#39;,readfile</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readfile</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
                <span class="n">tflowlist</span><span class="p">,</span><span class="n">oplist</span> <span class="o">=</span> <span class="p">[],[]</span>
                <span class="n">euclid_tlist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">flow_line</span><span class="p">,</span><span class="n">skip_t</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="kc">False</span>
                <span class="k">for</span> <span class="n">iline</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ifile</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">flow_line</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span><span class="p">,</span><span class="n">cmplxdump</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with file: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">readfile</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> on line: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iline</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">tflowstr</span><span class="p">(</span><span class="n">tflow</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
                            <span class="n">tflowlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">tflow</span><span class="p">))</span>
                            <span class="n">oplist</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                            <span class="n">euclid_tlist</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                            <span class="n">skip_t</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">skip_t</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="c1"># oplist.append(topcharge)</span>
                        <span class="n">flow_line</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">flow_line</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">skip_t</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">skip_t</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="n">et</span><span class="p">,</span><span class="n">topcharge</span><span class="p">,</span><span class="n">cmplxdump</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">et</span><span class="p">,</span><span class="n">topcharge</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with file: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">readfile</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> on line: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iline</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                        <span class="n">oplist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topcharge</span><span class="p">)</span>
                        <span class="n">euclid_tlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">et</span><span class="p">)</span>
            <span class="n">tflowlist</span><span class="p">,</span><span class="n">oplist</span><span class="p">,</span><span class="n">euclid_tlist</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">oplist</span><span class="p">,</span><span class="n">euclid_tlist</span><span class="p">))])</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">tflowlist</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">oplist</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">euclid_tlist</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">):</span>
            <span class="c1"># if &#39;random_time_list&#39; not in self.Op_cfgs :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MakeRandomTimeList</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No values found for &#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ifile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;PerGF/&#39;</span><span class="o">+</span><span class="n">icfg</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilename</span><span class="p">)</span>
            <span class="n">tflow</span><span class="p">,</span><span class="n">topcharge</span><span class="p">,</span><span class="n">euclid_t</span> <span class="o">=</span> <span class="n">FlowReadTopCharge_New</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>

            <span class="n">missing_tf</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">et_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tflow</span><span class="p">,</span><span class="n">euclid_t</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">itflow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tflow</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">et_list</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">:</span>
                    <span class="n">missing_tf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_tf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="c1"># print self.tflowfloat</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;flowed operator does not contain all flow times, check flow time list or remove file if corrupt&#39;</span><span class="p">)</span>
            <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topcharge</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="c1"># thisdata = np.array(thisdata)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Failed reading (see above) caused error. fix files please.&#39;</span><span class="p">)</span>
        <span class="c1">## self.Op_cfgs[&#39;Op&#39;][istream,icfg] = [ itflow , it ]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># self.Op = np.rollaxis(thisdata,0,thisdata.ndim)</span>
        <span class="c1"># ## self.Op = [ it , icfg , itflow ]</span>
        <span class="c1"># self.CreateOpCorr(show_timer=show_timer)</span>
        <span class="c1">## self.Op = [ itflow , it , icfg  ]</span>
        <span class="c1"># print(&#39;read raw cofgs complete:&#39;)</span>
        <span class="c1"># print(str(self.Op_cfgs))</span>
        <span class="k">if</span> <span class="s1">&#39;random_time_list&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MakeRandomTimeList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowRead"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowRead">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="o">=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>


        <span class="c1">## making interpolator number more human readable</span>
        <span class="c1"># if len(self.flowname.split(&#39;_&#39;)) &gt; 3:</span>
        <span class="c1">#     raise IOError(&#39;Do not read after combining correlators, please recreate the correlator&#39;)</span>
        <span class="c1"># ntflow = 0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead_New</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">cfg_file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">):</span>
            <span class="c1"># if &#39;random_time_list&#39; not in self.Op_cfgs :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MakeRandomTimeList</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">thisdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;No values found for &#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">istream_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowdir_list</span><span class="p">[</span><span class="n">istream</span><span class="p">]</span>
            <span class="n">idir</span> <span class="o">=</span> <span class="s1">&#39;cfg&#39;</span><span class="o">+</span><span class="n">icfg</span>
            <span class="n">tflow</span><span class="p">,</span><span class="n">thisop</span> <span class="o">=</span> <span class="p">[],[]</span>
            <span class="k">for</span> <span class="n">itflowfile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowfilelist</span><span class="p">:</span>
                <span class="n">holdtflow</span><span class="p">,</span><span class="n">holdtop</span><span class="p">,</span><span class="n">holdError</span> <span class="o">=</span> <span class="n">ReadTsInFlowOp</span><span class="p">(</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">itflowfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">holdError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">istream_dir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">idir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">itflowfile</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed to read in this file&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="n">tflow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">holdtflow</span><span class="p">)</span>
                <span class="n">thisop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">holdtop</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">holdError</span><span class="p">:</span> <span class="n">thisdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisop</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="c1"># thisdata = np.array(thisdata)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Failed reading (see above) caused error. fix files please.&#39;</span><span class="p">)</span>
        <span class="c1">## self.Op_cfgs[&#39;Op&#39;][istream,icfg] = [ itflow , it ]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">thisdata</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># self.Op = np.rollaxis(thisdata,0,thisdata.ndim)</span>
        <span class="c1"># ## self.Op = [ it , icfg , itflow ]</span>
        <span class="c1"># self.CreateOpCorr(show_timer=show_timer)</span>
        <span class="c1">## self.Op = [ itflow , it , icfg  ]</span>
        <span class="k">if</span> <span class="s1">&#39;random_time_list&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MakeRandomTimeList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write_Cfgs</span><span class="p">(</span><span class="n">file_type</span><span class="o">=</span><span class="n">cfg_file_type</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowBootAndWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowBootAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.CreateOpCorrDummy"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.CreateOpCorrDummy">[docs]</a>    <span class="k">def</span> <span class="nf">CreateOpCorrDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">it_range</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nranget</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">itsum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">tflow</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">itsum</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.CreateChiTinv"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.CreateChiTinv">[docs]</a>    <span class="k">def</span> <span class="nf">CreateChiTinv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="n">tsrc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            tsrc_data   pa.Series()</span>
<span class="sd">            rows =      stream , configuration</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">yield</span> <span class="n">tflow</span><span class="p">,</span> <span class="n">tsrc_data</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.SublatMethod"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.SublatMethod">[docs]</a>    <span class="k">def</span> <span class="nf">SublatMethod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># if PostRead: self.Op = np.rollaxis(self.Op,0,self.Op.ndim)</span>
        <span class="c1">## self.Op = [ itflow , it , icfg  ]</span>
        <span class="n">Oplen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="n">flowdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">it_range</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nranget</span><span class="p">)):</span>

                <span class="c1"># degenerate_props = (it_range == 0 or it_range == self.latparams.nt/2.)</span>
                <span class="c1"># for itsum in self.tsum_list:</span>
                <span class="k">for</span> <span class="n">itsum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span><span class="p">:</span>
                    <span class="n">strit_range</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_range</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp_NewForm/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>
                    <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="n">strit_range</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">))</span> <span class="ow">or</span> <span class="n">DefWipe</span><span class="p">:</span>
                        <span class="k">def</span> <span class="nf">This_Apply_Fun</span><span class="p">(</span><span class="n">flow_val</span><span class="p">):</span>
                            <span class="n">tsrc_data</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Oplen</span><span class="p">):</span>
                                <span class="n">sublat_data</span> <span class="o">=</span> <span class="mf">0.0</span>
                                <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">iy</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">it_range</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">it_range</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                                    <span class="n">sublat_data</span> <span class="o">+=</span> <span class="n">flow_val</span><span class="p">[(</span><span class="n">itsrc</span><span class="o">+</span><span class="n">ix</span><span class="p">)</span><span class="o">%</span><span class="n">Oplen</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[(</span><span class="n">itsrc</span><span class="o">+</span><span class="n">iy</span><span class="p">)</span><span class="o">%</span><span class="n">Oplen</span><span class="p">]</span>
                                    <span class="c1"># if not degenerate_props:</span>
                                    <span class="c1">#     sublat_data += flow_val[(Oplen-(itsrc+ix))%Oplen]*flow_val[(Oplen-(itsrc+iy))%Oplen]</span>
                                <span class="n">tsrc_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sublat_data</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">tsrc_data</span>
                        <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">flowdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">This_Apply_Fun</span><span class="p">)</span>
                        <span class="c1">## yielded value [ itsrc]</span>
                        <span class="k">yield</span> <span class="n">tflow</span><span class="p">,</span> <span class="n">it_range</span><span class="p">,</span> <span class="n">itsum</span><span class="p">,</span> <span class="n">tsrc_data</span><span class="p">,</span><span class="n">thisfile</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">False</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.CreateOpCorrSumR"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.CreateOpCorrSumR">[docs]</a>    <span class="k">def</span> <span class="nf">CreateOpCorrSumR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">GetIndicies</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">ts</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">thislen</span><span class="p">):</span>
            <span class="n">to_tr_TO_to_ts_tr</span>   <span class="o">=</span> <span class="p">[]</span>
            <span class="n">to_tr_TO_to_ts_mintr</span>   <span class="o">=</span> <span class="p">[]</span>
            <span class="n">to_TO_ts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
            <span class="n">to_ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">to</span><span class="o">+</span><span class="n">ts</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span>
            <span class="k">if</span> <span class="n">to_ts</span> <span class="o">&lt;=</span> <span class="n">to</span><span class="p">:</span>
                <span class="n">this_ilist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_list</span><span class="p">[</span><span class="n">to</span><span class="p">:],</span><span class="n">index_list</span><span class="p">[:</span><span class="n">to_ts</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_ilist</span> <span class="o">=</span> <span class="n">index_list</span><span class="p">[</span><span class="n">to</span><span class="p">:</span><span class="n">to_ts</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tr</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">to_TO_ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_ilist</span><span class="p">)</span>
                <span class="n">to_tr_TO_to_ts_tr</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">this_ilist</span><span class="o">+</span><span class="n">itr</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span><span class="p">)</span>
                <span class="n">to_tr_TO_to_ts_mintr</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">this_ilist</span><span class="o">-</span><span class="n">itr</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">to_TO_ts</span><span class="p">,</span><span class="n">to_tr_TO_to_ts_tr</span><span class="p">,</span><span class="n">to_tr_TO_to_ts_mintr</span>


        <span class="c1"># if PostRead: self.Op = np.rollaxis(self.Op,0,self.Op.ndim)</span>
        <span class="c1">## self.Op = [ itflow , it , icfg  ]</span>
        <span class="n">Oplen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="n">flowdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">it_range</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nranget</span><span class="p">)):</span>
                <span class="c1"># degenerate_props = (it_range == 0 or it_range == self.latparams.nt/2.)</span>
                <span class="k">for</span> <span class="n">itsum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span><span class="p">:</span>
                    <span class="n">strit_range</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_range</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
                    <span class="n">its</span> <span class="o">=</span> <span class="n">untstr</span><span class="p">(</span><span class="n">itsum</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp_NewForm/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>
                    <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="n">strit_range</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">))</span> <span class="ow">or</span> <span class="n">DefWipe</span><span class="p">:</span>
                        <span class="k">def</span> <span class="nf">This_Apply_Fun</span><span class="p">(</span><span class="n">flow_val</span><span class="p">):</span>
                            <span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">irightmin</span> <span class="o">=</span> <span class="n">GetIndicies</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">its</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">Oplen</span><span class="p">)</span>
                            <span class="c1">## first value is tr = 0, so dont double count for +- tr</span>
                            <span class="n">flow_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flow_val</span><span class="p">)</span>

                            <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iright</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
                            <span class="k">for</span> <span class="n">iileft</span><span class="p">,</span><span class="n">iiright</span><span class="p">,</span><span class="n">iirightmin</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ileft</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">iright</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">irightmin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                                <span class="n">tsrc_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iiright</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">iiright</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iirightmin</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iirightmin</span><span class="p">])</span>

                            <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Oplen</span><span class="p">):</span>
                                <span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">irightmin</span> <span class="o">=</span> <span class="n">GetIndicies</span><span class="p">(</span><span class="n">itsrc</span><span class="p">,</span><span class="n">its</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">Oplen</span><span class="p">)</span>
                                <span class="c1">## first value is tr = 0, so dont double count for +- tr</span>
                                <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tsrc_data</span><span class="p">,[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iright</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
                                <span class="k">for</span> <span class="n">iileft</span><span class="p">,</span><span class="n">iiright</span><span class="p">,</span><span class="n">iirightmin</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ileft</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">iright</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">irightmin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                                    <span class="n">tsrc_data</span><span class="p">[</span><span class="n">itsrc</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="n">itsrc</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iiright</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="n">iiright</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iirightmin</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="n">itsrc</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsrc_data</span><span class="p">[</span><span class="n">itsrc</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iirightmin</span><span class="p">])</span>
                                <span class="c1">#iterates over [flattened itflow, it_range,itsum,itsrc]</span>
                            <span class="k">return</span> <span class="n">tsrc_data</span>
                        <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">flowdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">This_Apply_Fun</span><span class="p">)</span>
                        <span class="c1">## yielded value [ itsrc]</span>
                        <span class="k">yield</span> <span class="n">tflow</span><span class="p">,</span> <span class="n">it_range</span><span class="p">,</span> <span class="n">itsum</span><span class="p">,</span> <span class="n">tsrc_data</span><span class="p">,</span><span class="n">thisfile</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">False</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.CreateOpCorr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.CreateOpCorr">[docs]</a>    <span class="k">def</span> <span class="nf">CreateOpCorr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">GetIndicies</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">ts</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">thislen</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
            <span class="n">to_ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">to</span><span class="o">+</span><span class="n">ts</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span>
            <span class="k">if</span> <span class="n">to_ts</span> <span class="o">&lt;=</span> <span class="n">to</span><span class="p">:</span>
                <span class="n">this_ilist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_list</span><span class="p">[</span><span class="n">to</span><span class="p">:],</span><span class="n">index_list</span><span class="p">[:</span><span class="n">to_ts</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_ilist</span> <span class="o">=</span> <span class="n">index_list</span><span class="p">[</span><span class="n">to</span><span class="p">:</span><span class="n">to_ts</span><span class="p">]</span>
            <span class="n">to_TO_ts</span> <span class="o">=</span> <span class="n">this_ilist</span>
            <span class="n">to_tr_TO_to_ts_tr</span> <span class="o">=</span> <span class="p">(</span><span class="n">this_ilist</span><span class="o">+</span><span class="n">tr</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span>
            <span class="n">to_tr_TO_to_ts_mintr</span> <span class="o">=</span> <span class="p">(</span><span class="n">this_ilist</span><span class="o">-</span><span class="n">tr</span><span class="p">)</span><span class="o">%</span><span class="n">thislen</span>
            <span class="n">is_deg</span> <span class="o">=</span> <span class="n">to_tr_TO_to_ts_tr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">to_tr_TO_to_ts_mintr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">to_TO_ts</span><span class="p">,</span><span class="n">to_tr_TO_to_ts_tr</span><span class="p">,</span><span class="n">to_tr_TO_to_ts_mintr</span><span class="p">,</span><span class="n">is_deg</span>


        <span class="c1"># if PostRead: self.Op = np.rollaxis(self.Op,0,self.Op.ndim)</span>
        <span class="c1">## self.Op = [ itflow , it , icfg  ]</span>
        <span class="n">Oplen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
        <span class="k">for</span> <span class="n">ictflow</span><span class="p">,</span><span class="n">tflow</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="n">flowdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">ictflow</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">it_range</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nranget</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">itsum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span><span class="p">:</span>
                    <span class="n">its</span> <span class="o">=</span> <span class="n">untstr</span><span class="p">(</span><span class="n">itsum</span><span class="p">)</span>
                    <span class="n">strit_range</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_range</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp_NewForm/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                    <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>
                    <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="n">strit_range</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">thisfile</span><span class="p">))</span> <span class="ow">or</span> <span class="n">DefWipe</span><span class="p">:</span>
                        <span class="k">def</span> <span class="nf">This_Apply_Fun</span><span class="p">(</span><span class="n">flow_val</span><span class="p">):</span>
                            <span class="n">flow_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flow_val</span><span class="p">)</span>
                            <span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">irightneg</span><span class="p">,</span><span class="n">itr_deg</span> <span class="o">=</span> <span class="n">GetIndicies</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">its</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">Oplen</span><span class="p">)</span>
                            <span class="n">rightval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iright</span><span class="p">])</span>
                            <span class="n">leftval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">irightneg</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">itr_deg</span><span class="p">:</span> <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rightval</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span> <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">leftval</span><span class="o">+</span><span class="n">rightval</span><span class="p">])</span>
                            <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Oplen</span><span class="p">):</span>
                                <span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">irightneg</span><span class="p">,</span><span class="n">itr_deg</span> <span class="o">=</span> <span class="n">GetIndicies</span><span class="p">(</span><span class="n">itsrc</span><span class="p">,</span><span class="n">its</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">Oplen</span><span class="p">)</span>
                                <span class="n">rightval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">iright</span><span class="p">])</span>
                                <span class="n">leftval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flow_val</span><span class="p">[</span><span class="n">ileft</span><span class="p">]</span><span class="o">*</span><span class="n">flow_val</span><span class="p">[</span><span class="n">irightneg</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">itr_deg</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_fold</span><span class="p">:</span> <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tsrc_data</span><span class="p">,[</span><span class="n">rightval</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span> <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tsrc_data</span><span class="p">,[(</span><span class="n">leftval</span><span class="o">+</span><span class="n">rightval</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">])</span>
                                <span class="c1">#iterates over [flattened itflow, it_range,itsum,itsrc]</span>
                            <span class="k">return</span> <span class="n">tsrc_data</span>
                        <span class="c1">## yielded value [ itsrc ]</span>
                        <span class="n">tsrc_data</span> <span class="o">=</span> <span class="n">flowdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">This_Apply_Fun</span><span class="p">)</span>
                        <span class="k">yield</span> <span class="n">tflow</span><span class="p">,</span> <span class="n">it_range</span><span class="p">,</span> <span class="n">itsum</span><span class="p">,</span> <span class="n">tsrc_data</span><span class="p">,</span><span class="n">thisfile</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">False</span></div>
        <span class="c1">## self.Op2 = [ itflow , it_range , itsum , ito ,  icfg ]</span>
        <span class="c1"># if PostRead: self.Op = np.rollaxis(self.Op,-1)</span>

<div class="viewcode-block" id="FlowOpFullSquared.FlowBootO2"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowBootO2">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootO2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># mkdir_p(self.OpDir+&#39;/Pickle//temp/&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
            <span class="n">this_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SublatMethod</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sum_range</span><span class="p">:</span>
                <span class="n">this_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CreateOpCorrSumR</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CreateOpCorr</span>

        <span class="n">thislambda_Auto</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">ival</span><span class="p">]</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;rlist&#39;</span><span class="p">]])</span>
        <span class="n">thislambda_boot</span> <span class="o">=</span> <span class="p">[(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;rlist&#39;</span><span class="p">][</span><span class="n">icv</span><span class="p">]])</span> <span class="k">for</span> <span class="n">icv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span>   <span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateOpCorrDummy</span><span class="p">())))),</span>
                                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Booting And Autoing Op2 &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">tflows</span><span class="p">,</span> <span class="n">it_range</span><span class="p">,</span> <span class="n">strit_sum</span><span class="p">,</span> <span class="n">tdata_sum</span><span class="p">,</span><span class="n">thisfile</span> <span class="ow">in</span> <span class="n">this_gen</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">thisfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF&#39;</span><span class="p">,</span><span class="n">thisfile</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">strit_range</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_range</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
                <span class="n">it_sum</span> <span class="o">=</span> <span class="n">untstr</span><span class="p">(</span><span class="n">strit_sum</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                    <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp_NewForm/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
                <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>
                <span class="c1"># thisfile = thisdir + &#39;/&#39;+self.flowname+&#39;_&#39;.join([tflows,strit_sum,strit_range])+&#39;.py3p&#39;</span>
                <span class="n">pickledata</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="n">tdata_sum</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span>
                <span class="n">tdata</span><span class="p">[</span><span class="s1">&#39;rlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;random_time_list&#39;</span><span class="p">]</span>
                <span class="n">tdata_Auto</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">thislambda_Auto</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;OpVals&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                    <span class="n">iTr</span><span class="p">,</span><span class="n">iTs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">it_range</span><span class="p">,</span><span class="n">it_sum</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">iTr</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>
                        <span class="n">iTr</span> <span class="o">=</span> <span class="n">iTr</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
                        <span class="n">iTs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
                    <span class="c1"># print &#39;DEBUG&#39;,iTr , iTs, (self.latparams.nt/float(iTr))**self.thispow</span>
                    <span class="c1"># thiscoeff = self.chi_coeff*(self.latparams.nt/np.sqrt(iTr*iTs))**self.thispow</span>
                    <span class="c1"># thiscoeff = self.chi_coeff*(self.latparams.nt/float(iTr))**self.thispow</span>
                    <span class="n">thiscoeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">iTs</span><span class="p">))</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">thispow</span>
                    <span class="c1"># thiscoeff = self.chi_coeff</span>
                    <span class="n">thisfun_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChitFuns</span><span class="p">(</span><span class="n">thiscoeff</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thispow</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisfun_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChitFuns</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
                <span class="n">thisAuto</span> <span class="o">=</span> <span class="n">AutoCorrelate</span><span class="p">(</span>   <span class="n">Fun</span><span class="o">=</span><span class="n">thisfun_input</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">strit_range</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">tflows</span><span class="p">)])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span>
                                            <span class="n">data</span><span class="o">=</span><span class="n">tdata_Auto</span><span class="p">)</span>
                <span class="n">pickledata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                    <span class="c1"># pickledata[0].Power(self.thispow)</span>
                    <span class="c1"># pickledata[0].MultCoeff(thischi)</span>
                    <span class="c1"># pickledata[0].MultCoeff(self.chi_coeff)</span>
                <span class="n">pickledata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">pickledata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">it_src</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">):</span>
                    <span class="c1"># thisfile = self.OpDir+&#39;/Pickle/temp/&#39;+self.flowname+tflows+strit_range+&#39;.py3p&#39;</span>
                    <span class="c1"># if not os.path.isfile(thisfile):</span>
                    <span class="c1"># thisdict,thisdictAvg,thisdictStd = ODNested(),ODNested(),ODNested()</span>
                    <span class="n">boothold</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">strit_src</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_src</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
                    <span class="n">tdata_boot</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">thislambda_boot</span><span class="p">[</span><span class="n">it_src</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span>
                                        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">strit_range</span><span class="p">,</span><span class="n">strit_src</span><span class="p">,</span><span class="n">tflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
                                        <span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata_boot</span><span class="p">,</span><span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">)</span>
                    <span class="n">rlist</span> <span class="o">=</span> <span class="n">thisboot</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                        <span class="n">iTr</span><span class="p">,</span><span class="n">iTs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">it_range</span><span class="p">,</span><span class="n">it_sum</span><span class="o">+</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">iTr</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>
                            <span class="n">iTr</span> <span class="o">=</span> <span class="n">iTr</span> <span class="o">-</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
                            <span class="n">iTs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span>
                        <span class="c1"># thiscoeff = self.chi_coeff*(self.latparams.nt/np.sqrt(iTr*iTs))**self.thispow</span>
                        <span class="c1"># thiscoeff = self.chi_coeff*(self.latparams.nt/float(iTr))**self.thispow</span>
                        <span class="n">thiscoeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">iTs</span><span class="p">))</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">thispow</span>
                        <span class="c1"># thiscoeff = self.chi_coeff</span>
                        <span class="n">thisboot</span> <span class="o">=</span> <span class="n">thiscoeff</span> <span class="o">*</span> <span class="n">thisboot</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">thispow</span>
                        <span class="c1"># boothold[0] = self.chi_coeff * boothold[0] ** self.thispow</span>
                        <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                    <span class="n">boothold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                    <span class="n">boothold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                    <span class="n">boothold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                    <span class="n">pickledata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">boothold</span><span class="p">)</span>
                <span class="n">WritePickle</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,</span><span class="n">pickledata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateOpCorrDummy</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Reading Pickled Op2 &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="n">lOp2</span><span class="p">,</span><span class="n">lOp2Avg</span><span class="p">,</span><span class="n">lOp2Std</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lOp2A</span><span class="p">,</span><span class="n">lOp2AAvg</span><span class="p">,</span><span class="n">lOp2AStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">ilist</span><span class="p">,</span><span class="n">ilist_src</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">tflows</span><span class="p">,</span> <span class="n">it_range</span><span class="p">,</span> <span class="n">strit_sum</span>  <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CreateOpCorrDummy</span><span class="p">():</span>
            <span class="n">strit_range</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_range</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
                <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp_NewForm/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/SplitUp/&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="s1">&#39;trand&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
            <span class="n">mkdir_p</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span>
            <span class="n">thisfile</span> <span class="o">=</span> <span class="n">thisdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="n">strit_range</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">ReadPickleWrap</span><span class="p">(</span><span class="n">thisfile</span><span class="p">,</span><span class="n">thisShowRead</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_range</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">))</span>
            <span class="n">lOp2A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">lOp2AAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">lOp2AStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it_src</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">):</span>
                <span class="n">bootdata</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">strit_src</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">it_src</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
                <span class="n">ilist_src</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit_range</span><span class="p">,</span><span class="n">strit_sum</span><span class="p">,</span><span class="n">strit_src</span><span class="p">))</span>
                <span class="n">lOp2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">lOp2Avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootdata</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">lOp2Std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootdata</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;time_ranges&#39;</span><span class="p">,</span><span class="s1">&#39;sum_time&#39;</span><span class="p">])</span>
        <span class="n">indicies_src</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist_src</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;time_ranges&#39;</span><span class="p">,</span><span class="s1">&#39;sum_time&#39;</span><span class="p">,</span><span class="s1">&#39;it_src&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2A</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2AAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2AStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies_src</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2Avg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies_src</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2Std</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies_src</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.GetChitFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetChitFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetChitFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscoeff</span><span class="p">,</span><span class="n">thispow</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">chit</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">thiscoeff</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thispow</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">chitder</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">thiscoeff</span><span class="o">*</span><span class="n">thispow</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="n">thispow</span><span class="o">-</span><span class="mi">1</span><span class="p">)))]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">chit</span><span class="p">,</span><span class="n">chitder</span><span class="p">)</span></div>



<div class="viewcode-block" id="FlowOpFullSquared.FlowBootChi"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowBootChi">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootChi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Boot And Auto Chi &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="n">lChi</span><span class="p">,</span><span class="n">lChiAvg</span><span class="p">,</span><span class="n">lChiStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lChiA</span><span class="p">,</span><span class="n">lChiAAvg</span><span class="p">,</span><span class="n">lChiAStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">tflows</span><span class="p">,</span><span class="n">tflowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CreateChiTinv</span><span class="p">():</span>
            <span class="n">thisChi</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cfgvals</span><span class="o">=</span><span class="n">tflowdata</span><span class="p">,</span><span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">)</span>
            <span class="c1"># self.Chiboot[tflows] = BootStrap(self.nboot, name=self.flowfilepref+&#39;(&#39;+&#39;,&#39;.join([tflows])+&#39;)&#39;,cfgvals=tflowdata)</span>
            <span class="n">rlist</span> <span class="o">=</span> <span class="n">thisChi</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                <span class="n">thiscoeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi_coeff</span>
                <span class="n">thispow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thispow</span>
                <span class="n">thisChi</span> <span class="o">=</span> <span class="n">thiscoeff</span><span class="o">*</span><span class="n">thisChi</span><span class="o">**</span><span class="n">thispow</span>
                <span class="n">thisChi</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiscoeff</span> <span class="o">=</span> <span class="mf">1.</span>
                <span class="n">thispow</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">thisfun_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChitFuns</span><span class="p">(</span><span class="n">thiscoeff</span><span class="p">,</span><span class="n">thispow</span><span class="p">)</span>
            <span class="n">thisAuto</span> <span class="o">=</span> <span class="n">AutoCorrelate</span><span class="p">(</span><span class="n">Fun</span><span class="o">=</span><span class="n">thisfun_input</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">tflows</span><span class="p">)])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tflowdata</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;OpVals&#39;</span><span class="p">))</span>
            <span class="n">indicies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span>
            <span class="n">lChi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisChi</span><span class="p">)</span>
            <span class="n">lChiAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisChi</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lChiStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisChi</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="n">lChiA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
            <span class="n">lChiAAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lChiAStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">indicies</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChi</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChiAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChiStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChiA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChiAAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lChiAStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowBootstrap"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowBootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">FlowBootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">OnlyQ</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="ow">or</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowRead</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">))],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bootstrapping Op &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="n">lOp</span><span class="p">,</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">lOpStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lOpA</span><span class="p">,</span><span class="n">lOpAAvg</span><span class="p">,</span><span class="n">lOpAStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">thisfun_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetAutoFuns</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">itcf</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">temp_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">itcf</span><span class="p">][</span><span class="n">itsrc</span><span class="p">]</span>
                    <span class="c1"># return x[&#39;Op&#39;][itcf][x[&#39;random_time_list&#39;][itsrc]]</span>
                <span class="n">strit</span> <span class="o">=</span> <span class="n">tstr</span><span class="p">(</span><span class="n">itsrc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
                <span class="n">indicies</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tflows</span><span class="p">,</span><span class="n">strit</span><span class="p">))</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">temp_fun</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;OpVals&#39;</span><span class="p">)</span>
                <span class="n">thisAuto</span> <span class="o">=</span> <span class="n">AutoCorrelate</span><span class="p">(</span>   <span class="n">Fun</span><span class="o">=</span><span class="n">thisfun_input</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">strit</span><span class="p">,</span><span class="n">tflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tdata</span><span class="p">)</span>
                <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">temp_fun</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">thisboot</span> <span class="o">=</span> <span class="n">BootStrap</span><span class="p">(</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowfilepref</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">strit</span><span class="p">,</span><span class="n">tflows</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
                                        <span class="n">cfgvals</span><span class="o">=</span><span class="n">tdata</span><span class="p">,</span><span class="n">rand_list</span><span class="o">=</span><span class="n">rlist</span><span class="p">)</span>
                <span class="n">rlist</span> <span class="o">=</span> <span class="n">thisboot</span><span class="o">.</span><span class="n">Get_Rand_List</span><span class="p">()</span>
                <span class="n">lOp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                <span class="n">lOpAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lOpStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">lOpA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
                <span class="n">lOpAAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lOpAStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indicies</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;it_src&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpA</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpAAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpAStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Autocorrelating Op &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>
        <span class="c1"># thisfun_input = self.GetAvgAutoFuns()</span>
        <span class="n">lOp</span><span class="p">,</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">lOpStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">itcf</span><span class="p">,</span><span class="n">tflows</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">):</span>
            <span class="c1"># tdata = self.Op_cfgs.apply(lambda x : np.mean([x[&#39;Op&#39;][itcf][isrc] for isrc in x[&#39;random_time_list&#39;]]),axis=1).to_frame(&#39;OpVals&#39;)</span>
            <span class="c1"># tdata = self.Op_cfgs.apply(lambda x : np.mean(x[&#39;Op&#39;][itcf]),axis=1).to_frame(&#39;OpVals&#39;)</span>
            <span class="n">tdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">][</span><span class="n">itcf</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;OpVals&#39;</span><span class="p">)</span>
            <span class="n">thisAuto</span> <span class="o">=</span> <span class="n">AutoCorrelate</span><span class="p">(</span>   <span class="n">Fun</span><span class="o">=</span><span class="n">thisfun_input</span><span class="p">,</span><span class="n">Sparam</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span><span class="p">,</span>
                                        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39; $&#39;</span> <span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">tflows</span><span class="p">)])</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tdata</span><span class="p">)</span>
            <span class="n">indicies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tflows</span><span class="p">)</span>
            <span class="n">lOp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="p">)</span>
            <span class="n">lOpAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lOpStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisAuto</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">indicies</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;AutoStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootChi</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">OnlyQ</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowBootO2</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Do_toAvg</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WipeData</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Do_toAvg"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Do_toAvg">[docs]</a>    <span class="k">def</span> <span class="nf">Do_toAvg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Creating Opboot_toavg &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>

        <span class="n">lOp</span><span class="p">,</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">lOpStd</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">flowdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;flow_times&#39;</span><span class="p">):</span>
            <span class="n">indicies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itflow</span><span class="p">)</span>
            <span class="c1"># thisboot = flowdata.mean()</span>
            <span class="n">thisboot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flowdata</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">lOp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
            <span class="n">lOpAvg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">lOpStd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">indicies</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpAvg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOpStd</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">))),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nranget</span><span class="p">))),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span><span class="p">)))],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Creating Op2boot_toavg &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="p">:</span>
            <span class="n">lOp2</span><span class="p">,</span><span class="n">lOp2Avg</span><span class="p">,</span><span class="n">lOp2Std</span> <span class="o">=</span> <span class="p">[],[],[]</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">it_sum</span><span class="p">),</span><span class="n">tsumdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;time_ranges&#39;</span><span class="p">,</span><span class="s1">&#39;sum_time&#39;</span><span class="p">]):</span>
                <span class="n">indicies</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">itflow</span><span class="p">,</span><span class="n">it_range</span><span class="p">,</span><span class="n">it_sum</span><span class="p">))</span>
                <span class="c1"># thisboot = tsumdata.mean()</span>
                <span class="n">thisboot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tsumdata</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="n">thisboot</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
                <span class="n">lOp2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="p">)</span>
                <span class="n">lOp2Avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">lOp2Std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisboot</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indicies</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;time_ranges&#39;</span><span class="p">,</span><span class="s1">&#39;sum_time&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2Avg</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lOp2Std</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span></div>




<div class="viewcode-block" id="FlowOpFullSquared.GetAvgAutoFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetAvgAutoFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetAvgAutoFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">AvgFun</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">AvgFunDer</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">AvgFun</span><span class="p">,</span><span class="n">AvgFunDer</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.GetAutoFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetAutoFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetAutoFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">AvgFun</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">AvgFunDer</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">AvgFun</span><span class="p">,</span><span class="n">AvgFunDer</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.GetAvgChiAutoFuns"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetAvgChiAutoFuns">[docs]</a>    <span class="k">def</span> <span class="nf">GetAvgChiAutoFuns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscoeff</span><span class="p">,</span><span class="n">thispow</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">AvgFun</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">thiscoeff</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="o">**</span><span class="n">thispow</span>
        <span class="k">def</span> <span class="nf">AvgFunDer</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
            <span class="n">thismean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">thiscoeff</span><span class="o">*</span><span class="n">thispow</span><span class="o">*</span><span class="n">thismean</span><span class="o">**</span><span class="p">(</span><span class="n">thispow</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)</span> <span class="o">==</span> <span class="n">jc</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">AvgFun</span><span class="p">,</span><span class="n">AvgFunDer</span></div>






<div class="viewcode-block" id="FlowOpFullSquared.FlowObsToName"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowObsToName">[docs]</a>    <span class="k">def</span> <span class="nf">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;TopChargexTopCharge&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;Q^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span>
        <span class="k">elif</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;WeinbergxWeinberg&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;W^</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="ow">in</span> <span class="n">obs</span> <span class="ow">and</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;WQ&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;TopCharge&#39;</span> <span class="o">==</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;Q&gt;&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;Weinberg&#39;</span> <span class="o">==</span> <span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;W&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obs</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowObsToChi"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowObsToChi">[docs]</a>    <span class="k">def</span> <span class="nf">FlowObsToChi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;TopChargexTopCharge&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;\chi_</span><span class="si">{Q}</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">obs</span> <span class="o">==</span> <span class="s1">&#39;WeinbergxWeinberg&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;\chi_</span><span class="si">{W}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;\chi&#39;</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowSetCustomName"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowSetCustomName">[docs]</a>    <span class="k">def</span> <span class="nf">FlowSetCustomName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;stream_name&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-def-&#39;</span>
        <span class="k">if</span> <span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kud</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ks</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">,</span><span class="s1">&#39;Full&#39;</span><span class="p">])</span>
            <span class="n">cfgfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+=</span><span class="s1">&#39;chit&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+=</span><span class="s1">&#39;_sublat&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sum_range</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+=</span><span class="s1">&#39;_sumrange&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="n">string</span>
            <span class="n">cfgfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>
        <span class="k">if</span> <span class="n">stringLL</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">),</span><span class="s1">&#39;nto=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">),</span><span class="s1">&#39;Full&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_ll</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">),</span><span class="s1">&#39;nto=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">),</span><span class="s1">&#39;Full&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_chi</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowObsToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">FlowObsToChi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">Observ</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_fold</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39;_NoFold&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\ Opfold$&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\ Opfold$&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\ sublat$&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sum_range</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\ sumtr$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># print &#39;setting Legend to &#39;,stringLL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="n">stringLL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowNewForm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps_NewForm/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span> <span class="o">=</span> <span class="n">cfgfmtdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps_NewForm/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps/&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span> <span class="o">=</span> <span class="n">cfgfmtdir</span> <span class="o">+</span><span class="s1">&#39;/FlowOps/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="p">)</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Excel/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.xlsx&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpDir</span><span class="o">+</span><span class="s1">&#39;/Pickle/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowCfgFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpCfgsDir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">cfgfilename</span><span class="o">+</span><span class="s1">&#39;.cfgs&#39;</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.MakeStreamCfgs"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.MakeStreamCfgs">[docs]</a>    <span class="k">def</span> <span class="nf">MakeStreamCfgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;stream_cfgs&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="p">:</span>
            <span class="n">cfglist</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;stream_cfgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;00&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">iccfg</span><span class="p">),</span><span class="n">icfg</span> <span class="ow">in</span> <span class="n">cfglist</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span><span class="n">index</span><span class="o">=</span><span class="n">cfglist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cfglist</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowImportCfgList"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">FlowImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">,</span><span class="n">stream_list</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="c1"># if isinstance(cfglist,(dict,OrderedDict,pa.Series)): cfglist = cfglist.keys()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stream_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="n">stream_list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfglist</span><span class="p">,</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1">## cfglist must be 2-d array, first dimension is stream, second dimension is configuraiton number</span>
            <span class="n">ilist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cfglist</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">icf</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">is_cfg</span><span class="p">):</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="n">is_cfg</span><span class="p">))</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;config_number&#39;</span><span class="p">])</span>
            <span class="n">cfglist</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MakeStreamCfgs</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Update_Stream_List</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">icfg</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">icfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">)]</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Update_Stream_List"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Update_Stream_List">[docs]</a>    <span class="k">def</span> <span class="nf">Update_Stream_List</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nstream</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">)</span>
            <span class="n">old_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">istr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">istr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowname&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowLegLab&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;flowLegLab2&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowStats"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowStats">[docs]</a>    <span class="k">def</span> <span class="nf">FlowStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">itf</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">iOp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
            <span class="n">iOp</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpAvg</span><span class="p">[</span><span class="n">itf</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span><span class="o">.</span><span class="n">Avg</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpStd</span><span class="p">[</span><span class="n">itf</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">iOp</span><span class="o">.</span><span class="n">Std</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowRemoveVals"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowRemoveVals">[docs]</a>    <span class="k">def</span> <span class="nf">FlowRemoveVals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Op&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">:</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowImportPlotParams"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowImportPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">FlowImportPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckCol</span><span class="p">(</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowCheckSym</span><span class="p">(</span><span class="n">thissym</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.GetObsFun"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.GetObsFun">[docs]</a>    <span class="k">def</span> <span class="nf">GetObsFun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">Ident</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">IdentDer</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Ident</span><span class="p">,</span><span class="n">IdentDer</span><span class="p">)</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowCheckCol"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowCheckCol">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCheckCol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thiscol</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thiscol</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in color to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span> <span class="o">=</span> <span class="n">thiscol</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowCheckSym"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowCheckSym">[docs]</a>    <span class="k">def</span> <span class="nf">FlowCheckSym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thissym</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;PreDefine&#39;</span> <span class="o">==</span> <span class="n">thissym</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Not Set&#39;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Pass in symbol to initialize it&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span> <span class="o">=</span> <span class="n">thissym</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowGetShift"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowGetShift">[docs]</a>    <span class="k">def</span> <span class="nf">FlowGetShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xlims</span><span class="p">,</span><span class="n">thisshift</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">xlen</span></div>


    <span class="c1"># def Fit_Propagator(self,t_fit_min,t_fit_max,t_sum,t_flow,fit_fun_info=&#39;PreDef&#39;):</span>
    <span class="c1">#     fitr = &#39;fitr&#39;+str(untstr(t_fit_min))+&#39;-&#39;+str(untstr(t_fit_max))</span>
    <span class="c1">#     if fit_fun_info != &#39;PreDef&#39;: self.prop_fit_fun = fit_fun_info</span>
    <span class="c1">#     if untstr(t_fit_max)-untstr(t_fit_min) &lt; self.prop_fit_fun[1]:</span>
    <span class="c1">#         print &#39;Insufficient degrees of fredom for fit&#39;,fitr, &#39;for fit function&#39;, self.prop_fit_fun</span>
    <span class="c1">#         return None</span>
    <span class="c1">#     prop_fit_name = &#39;_&#39;.join([fitr,t_sum,t_flow])</span>
    <span class="c1">#     fit_data = self.Op2_avg_Stats[&#39;boot&#39;].loc[t_flow,:,t_sum][t_fit_min:t_fit_max]</span>
    <span class="c1">#     parse_data = pa.DataFrame(columns=[&#39;ydata&#39;,&#39;xdata&#39;],index=[0])</span>
    <span class="c1">#     parse_data[&#39;ydata&#39;][0] = fit_data.values</span>
    <span class="c1">#     fitxdata = list(fit_data.index)</span>
    <span class="c1">#     if isinstance(fitxdata[0],tuple):</span>
    <span class="c1">#         fitxdata = [iOp2[1] for iOp2 in fitxdata]</span>
    <span class="c1">#     parse_data[&#39;xdata&#39;][0] = map(untstr,fitxdata)</span>
    <span class="c1">#     fit_class = ff.Fitting(Funs=self.prop_fit_fun,data=parse_data,name=prop_fit_name)</span>
    <span class="c1">#     ikey = fit_class.name.split(&#39;_&#39;)</span>
    <span class="c1">#     ikey = ikey[:-2]+ [ikey[-2]+&#39;_&#39;+ikey[-1]]</span>
    <span class="c1">#     if tuple(ikey) in list(self.Prop_Fit_Stats.index):</span>
    <span class="c1">#         return None</span>
    <span class="c1">#     fit_class.FitBoots()</span>
    <span class="c1">#     return fit_class</span>

    <span class="c1"># def Fit_All_Props(  self,fit_range,sum_list=&#39;All&#39;,tflow_list=&#39;All&#39;,</span>
    <span class="c1">#                     fun_info=&#39;PreDef&#39;,WipeFit=True,show_timer=False):</span>
<div class="viewcode-block" id="FlowOpFullSquared.Fit_All_Props"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Fit_All_Props">[docs]</a>    <span class="k">def</span> <span class="nf">Fit_All_Props</span><span class="p">(</span>  <span class="bp">self</span><span class="p">,</span><span class="n">fit_range</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">tflow_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span>
                        <span class="n">fun_info</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fun_info</span> <span class="o">!=</span> <span class="s1">&#39;PreDef&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span> <span class="o">=</span> <span class="n">fun_info</span>
        <span class="k">if</span> <span class="n">sum_list</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span> <span class="n">sum_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsum_list</span>
        <span class="k">if</span> <span class="n">tflow_list</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span> <span class="n">tflow_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;fitr&#39;</span> <span class="ow">in</span> <span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, new version with implementation of SetsOfFits scans all fit ranges&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no need for list of fit_rangegs in Fit_All_Props&#39;</span><span class="p">)</span>
            <span class="n">fit_range</span> <span class="o">=</span> <span class="n">fit_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># if show_timer: thistimer = Timer(   linklist=[ival[0] for ival in itertools.product(sum_list,tflow_list)],name=&#39;Setting up Fits &#39;)</span>
        <span class="n">flist</span><span class="p">,</span><span class="n">index_list</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">isum</span><span class="p">,</span><span class="n">itflow</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">sum_list</span><span class="p">,</span><span class="n">tflow_list</span><span class="p">):</span>
            <span class="n">ikey</span> <span class="o">=</span> <span class="p">(</span><span class="n">isum</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">WipeFit</span><span class="p">:</span>
                    <span class="c1"># print &#39;DEBUG&#39;</span>
                    <span class="c1"># print ikey</span>
                    <span class="c1"># print self.Prop_Fit_Stats</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ikey</span><span class="p">)],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">fit_out</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">itflow</span><span class="p">,:,</span><span class="n">isum</span><span class="p">],</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ikey</span><span class="p">))</span>
            <span class="n">susc</span> <span class="o">=</span> <span class="n">fit_out</span><span class="o">.</span><span class="n">ScanRange_fitr</span><span class="p">(</span><span class="n">fit_range</span><span class="p">,</span><span class="n">fit_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Funs&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">susc</span><span class="p">:</span>
                <span class="n">flist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_out</span><span class="p">)</span>
                <span class="n">index_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem constructing setoffits for &#39;</span><span class="p">,</span><span class="n">ikey</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Col_Names</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">flist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
                <span class="c1"># this_df.loc[:,&#39;Avg&#39;] = pa.Series(aflist,index=indicies)</span>
                <span class="c1"># this_df.loc[:,&#39;Std&#39;] = pa.Series(sflist,index=indicies)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_df</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">flist</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
                <span class="c1"># self.Prop_Fit_Stats.loc[:,&#39;Avg&#39;] = pa.Series(aflist,index=indicies)</span>
                <span class="c1"># self.Prop_Fit_Stats.loc[:,&#39;Std&#39;] = pa.Series(sflist,index=indicies)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]))),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fitting&#39;</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">DoFit_Fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="n">val</span><span class="o">.</span><span class="n">DoFits</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="n">show_timer</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">DoFit_Fun</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span></div>

<span class="c1">### BLOCK OF PLOTTING FUNCTIONS ################################################</span>


<div class="viewcode-block" id="FlowOpFullSquared.Plot_Prop_Tflow"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Plot_Prop_Tflow">[docs]</a>    <span class="k">def</span> <span class="nf">Plot_Prop_Tflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">tfitr</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">tsum</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">thisparam</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tfitr</span><span class="p">,</span><span class="n">tsum</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> \
                                                        <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Fits found, not plotting any&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="s1">&#39;Not found, attempting to fit all flow times now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">tsum</span><span class="p">],</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">## assuming result is the first fit parameter.</span>
        <span class="c1">## keys are [itsum,itflow,fit_fun,fit_range,parameter]</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries_Wpar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
        <span class="n">avg_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">std_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tsum</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">tsum</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fit_fun</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tfitr</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">tfitr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="s1">&#39;fitr&#39;</span> <span class="ow">in</span> <span class="n">tfitr</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">tfitr</span> <span class="o">=</span> <span class="n">tfitr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thisparam</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thisparam</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisparam</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thisparam</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">thisparam</span><span class="p">]</span>

        <span class="n">updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tflowlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tsum</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="n">updated</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="n">itflow</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit all flow times now&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">tsum</span><span class="p">],</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">tsum</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">tsum</span><span class="p">,</span><span class="n">itflow</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">updated</span><span class="p">:</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries_Wpar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">])</span>
            <span class="n">avg_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">std_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># fit_data = self.Prop_Fit_Stats.loc[(tfitr,tsum),&#39;boot&#39;]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsum</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">fit_fun</span><span class="p">,</span><span class="n">tfitr</span><span class="p">,</span><span class="n">thisparam</span><span class="p">)</span>
        <span class="c1"># tflowplot = list(fit_data.loc[tfitr,tsum,slice(None),fit_parameter_label].index)</span>
        <span class="c1"># if isinstance(tflowplot[0],tuple):</span>
        <span class="c1">#     tflowplot = [iOp[2] for iOp in tflowplot]</span>
        <span class="c1"># tflowphys = np.array(map(untflowstr,tflowplot))</span>
        <span class="c1"># tflowphys = TflowToPhys(np.array(tflowphys),self.latparams.latspace)</span>
        <span class="c1"># plotshift = self.thisshift*np.abs(tflowphys[-1]-tflowphys[0])</span>
        <span class="c1"># print &#39;DEBUG&#39;</span>
        <span class="c1"># print self.tflowlist</span>
        <span class="c1"># print self.Op2_avg_Stats</span>
        <span class="c1"># print self.Prop_Fit_Stats</span>
        <span class="c1"># for ix,iy,iyerr in zip(np.array(tflowphys),plot_data.apply(lambda x : x.Avg),plot_data.apply(lambda x : x.Std)):</span>
        <span class="c1">#     print ix,iy,iyerr</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Prop &#39;</span><span class="c1"># self.flowLegLab # fit_data.name + &#39; &#39; +fit_parameter_label</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum+&#39; Auto&#39;,fmt=self.thissym,color=self.thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Plot_Prop"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Plot_Prop">[docs]</a>    <span class="k">def</span> <span class="nf">Plot_Prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="p">,</span><span class="n">tfitr</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">tsum</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">tflow</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tfitr</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="n">tflow</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Fits found, not plotting any&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plot_class</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">tsum</span><span class="p">],</span><span class="n">tflow_list</span><span class="o">=</span><span class="p">[</span><span class="n">tflow</span><span class="p">])</span>
        <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tfitr</span><span class="p">,</span><span class="n">tsum</span><span class="p">,</span><span class="n">tflow</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Fits found, not plotting any&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot_class</span>
        <span class="k">if</span> <span class="n">tsum</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">tsum</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tflow</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">tflow</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fit_fun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tfitr</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">tfitr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsum</span><span class="p">,</span><span class="n">tflow</span><span class="p">,</span><span class="n">fit_fun</span><span class="p">,</span><span class="n">tfitr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_fit</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span> <span class="p">,</span> <span class="s1">&#39;Not found, attempting to fit now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">tfitr</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">tsum</span><span class="p">],</span><span class="n">tflow_list</span><span class="o">=</span><span class="p">[</span><span class="n">tflow</span><span class="p">])</span>
            <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">fmted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">this_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_fit</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_key</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;error with fitting&#39;</span><span class="p">)</span>
        <span class="c1"># fit_plot = this_fit[&#39;boot&#39;][tfitr,tsum,tflow]</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fit</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
            <span class="n">final_result</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\chi =&#39;</span><span class="o">+</span> <span class="n">MakeValAndErr</span><span class="p">(</span><span class="n">final_result</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">final_result</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">Dec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisshift</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_sublat</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;A&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># fit_plot.PlotFunction(color=thiscol,shift=thisshift,ShowPar=r&#39;A&#39;)</span>


<div class="viewcode-block" id="FlowOpFullSquared.PlotChiLine"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotChiLine">[docs]</a>    <span class="k">def</span> <span class="nf">PlotChiLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flowtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="c1"># mid,err = self.Chi_Stats[&#39;boot&#39;][flowtime].Avg,self.Chi_Stats[&#39;boot&#39;][flowtime].Std</span>
            <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="c1"># linelab = r&#39; $&#39;+r&#39; &#39;.join([r&#39;\chi =&#39;,MakeValAndErr(mid[flowtime],err[flowtime],Dec=3)])+r&#39;$&#39;</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\chi&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Vary</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline&#39;</span>
                <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">mid</span><span class="p">[</span><span class="n">flowtime</span><span class="p">],</span><span class="n">err</span><span class="p">[</span><span class="n">flowtime</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flowtime</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = linelab)</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotChiLineAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotChiLineAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotChiLineAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flowtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="c1"># linelab = r&#39; $&#39;+r&#39; &#39;.join([r&#39;\chi =&#39;,MakeValAndErr(mid[flowtime],err[flowtime],Dec=3)])+r&#39;$&#39;</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\chi&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flowtime</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Vary</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline&#39;</span>
                <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">mid</span><span class="p">[</span><span class="n">flowtime</span><span class="p">],</span><span class="n">err</span><span class="p">[</span><span class="n">flowtime</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flowtime</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = linelab)</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.PlotFOLineAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotFOLineAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFOLineAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flowtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="c1"># linelab = r&#39; $&#39;+r&#39; &#39;.join([r&#39;\chi =&#39;,MakeValAndErr(mid[flowtime],err[flowtime],Dec=3)])+r&#39;$&#39;</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\chi&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Vary</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline&#39;</span>
                <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">mid</span><span class="p">[</span><span class="n">flowtime</span><span class="p">],</span><span class="n">err</span><span class="p">[</span><span class="n">flowtime</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flowtime</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = linelab)</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotFOLine"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotFOLine">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFOLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flowtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
            <span class="c1"># mid,err = self.Op_avg_Stats[&#39;boot&#39;][flowtime].Avg,self.Op_avg_Stats[&#39;boot&#39;][flowtime].Std</span>
            <span class="c1"># up,down = mid+err,mid-err</span>
            <span class="c1"># linelab = r&#39; $&#39;+r&#39; &#39;.join([r&#39;\chi =&#39;,MakeValAndErr(mid[flowtime],err[flowtime],Dec=3)])+r&#39;$&#39;</span>
            <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Vary</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline&#39;</span>
                <span class="n">mid</span><span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">mid</span><span class="p">[</span><span class="n">flowtime</span><span class="p">],</span><span class="n">err</span><span class="p">[</span><span class="n">flowtime</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hline_vary&#39;</span>
                <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flowtime</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ACTUAL_VALUE_\chi&#39;</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thiscol</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
            <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
            <span class="c1"># pl.axhline(mid,color=thiscol,label = linelab)</span>
            <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.PlotChiTflow"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotChiTflow">[docs]</a>    <span class="k">def</span> <span class="nf">PlotChiTflow</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                        <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">plotx</span><span class="p">)))</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="n">TflowToPhys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotx</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ploty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">plotyerr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">linelab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$ \chi_</span><span class="si">{int}</span><span class="s1">$&#39;</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linelab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotx</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.axhline(mid,color=thiscol,label = linelab)</span>
        <span class="c1"># pl.axhspan(up,down, alpha=fillalpha, color=thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


    <span class="c1"># TODO: leave these untill we implement SetsOfFits</span>
<div class="viewcode-block" id="FlowOpFullSquared.PlotVstiFitr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotVstiFitr">[docs]</a>    <span class="k">def</span> <span class="nf">PlotVstiFitr</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">fit_min_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span>
                            <span class="n">thisparam</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">x_is_min</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">fit_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fit_max</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_min_list</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SetsOfFits now does not require lst for fit_min_list, defaulting to minimum value of list&#39;</span><span class="p">)</span>
            <span class="n">fit_min_list</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">fit_min_list</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">fit_min_list</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
            <span class="n">fit_min_list</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_min_list</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fit_min_list</span><span class="p">)</span>
        <span class="n">fitr_range</span> <span class="o">=</span> <span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fit_min_list</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fit_max</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">flowtime</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="s1">&#39;has no fits, fitting now&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">fitr_range</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">thistsum</span><span class="p">],</span><span class="n">tflow_list</span><span class="o">=</span><span class="p">[</span><span class="n">flowtime</span><span class="p">])</span>
            <span class="c1"># raise IOError(&#39;invalid flow/tsum time picked to plot&#39;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">flowtime</span><span class="p">),</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Fit_Stats</span>
            <span class="k">for</span> <span class="n">imin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fit_min_list</span><span class="p">,</span><span class="n">fit_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">imax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">fit_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">imax</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">imin</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="n">fitr_range</span><span class="p">,</span><span class="n">sum_list</span><span class="o">=</span><span class="p">[</span><span class="n">thistsum</span><span class="p">],</span><span class="n">tflow_list</span><span class="o">=</span><span class="p">[</span><span class="n">flowtime</span><span class="p">])</span>
                        <span class="k">break</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">PullSOFSeries_Wpar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">],</span><span class="n">fmted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">avg_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">std_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">thisparam</span> <span class="o">==</span> <span class="s1">&#39;First&#39;</span><span class="p">:</span>
            <span class="n">thisparam</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisparam</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">thisparam</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">thisparam</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x_is_min</span><span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">imax</span><span class="p">),</span><span class="n">thisparam</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_fit_fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">imin</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thisparam</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Fits&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum,</span>
        <span class="c1">#             fmt=self.thissym,color=self.thiscol)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotChiLine</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.PlotVstfFitr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotVstfFitr">[docs]</a>    <span class="k">def</span> <span class="nf">PlotVstfFitr</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">fit_min</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">fit_max_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">thisparam</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotVstiFitr</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">fit_max_list</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span>
                            <span class="n">thissym</span><span class="o">=</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span><span class="n">fit_min_list</span><span class="o">=</span><span class="n">fit_min</span><span class="p">,</span>
                            <span class="n">thisparam</span><span class="o">=</span><span class="n">thisparam</span><span class="p">,</span><span class="n">x_is_min</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotOpT"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOpT">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOpT</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                    <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="n">Opilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Opilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Opilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp</span> <span class="ow">in</span> <span class="n">Opilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Opilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">),</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="c1">#+&#39; $&#39;+str(flowtime)+&#39;$ &#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotFOLine</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum,</span>
        <span class="c1">#             fmt=self.thissym,color=self.thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.PlotOpTAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOpTAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOpTAuto</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                    <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Opilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Opilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Opilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp</span> <span class="ow">in</span> <span class="n">Opilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Opilist</span><span class="p">))</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp.values])</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">),</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotFOLineAuto</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum,</span>
        <span class="c1">#             fmt=self.thissym,color=self.thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.CreateShiftCorr"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.CreateShiftCorr">[docs]</a>    <span class="k">def</span> <span class="nf">CreateShiftCorr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">shift_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Force</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot_shift&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Force</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Op2 shift already computed&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot_shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">itsum</span><span class="p">),</span><span class="n">iseries</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;sum_time&#39;</span><span class="p">)):</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">iseries</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot_shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">itflow</span><span class="p">,:,</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot_shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span></div>
        <span class="c1"># print(&#39;DEBUG&#39;)</span>
        <span class="c1"># print(self.Op2_avg_Stats[&#39;boot_shift&#39;].iloc[0].Avg)</span>
        <span class="c1"># print(self.Op2_avg_Stats[&#39;boot_shift&#39;].iloc[0].Std)</span>

    <span class="c1">## Plots the observable against</span>
<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTsink"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTsink">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTsink</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                            <span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">fitr</span><span class="o">=</span><span class="s1">&#39;First&#39;</span><span class="p">,</span><span class="n">shifted</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">this_col</span> <span class="o">=</span> <span class="s1">&#39;boot&#39;</span>
        <span class="k">if</span> <span class="n">shifted</span><span class="p">:</span>
            <span class="n">this_col</span> <span class="o">=</span> <span class="s1">&#39;boot_shift&#39;</span>
            <span class="k">if</span> <span class="n">this_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CreateShiftCorr</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">this_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="n">this_col</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="n">this_col</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/tsum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="c1"># thisOp2 = self.Op2_avg_Stats.loc[(flowtime,slice(None),thistsum),this_col]</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">this_col</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># hold_series[&#39;label&#39;] = self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum</span>
        <span class="k">if</span> <span class="n">shifted</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span> <span class="o">+</span> <span class="s1">&#39; Csh&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum,</span>
        <span class="c1">#             fmt=self.thissym,color=self.thiscol)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">shifted</span><span class="p">:</span>
            <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotChiLine</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fitr</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Prop</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">plotshift</span><span class="p">,</span><span class="n">tfitr</span><span class="o">=</span><span class="n">fitr</span><span class="p">,</span><span class="n">tsum</span><span class="o">=</span><span class="n">thistsum</span><span class="p">,</span><span class="n">tflow</span><span class="o">=</span><span class="n">flowtime</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTsinkAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTsinkAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTsinkAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/tsum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum+&#39; Auto&#39;,fmt=self.thissym,color=self.thiscol)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotChiLineAuto</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">,</span><span class="n">Vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotTsinkAuto_TauIntWOpt"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotTsinkAuto_TauIntWOpt">[docs]</a>    <span class="k">def</span> <span class="nf">PlotTsinkAuto_TauIntWOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/tsum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># Op2ilist = list(thisOp2.index)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.tau,iOp.tauerr) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="c1">#+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistsum,fmt=self.thissym,color=self.thiscol)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

    <span class="c1">## Plots the observable against</span>
<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTsum"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTsum">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistrange</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/range time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="c1">#+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistrange</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistrange,fmt=self.thissym,color=self.thiscol)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotChiLine</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTsumAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTsumAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTsumAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistrange</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/range time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistrange+&#39; Auto&#39;,fmt=self.thissym,color=self.thiscol)</span>
        <span class="n">plot_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotChiLineAuto</span><span class="p">(</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.PlotTsumAuto_TauIntWOpt"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotTsumAuto_TauIntWOpt">[docs]</a>    <span class="k">def</span> <span class="nf">PlotTsumAuto_TauIntWOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flowtime</span><span class="p">,</span> <span class="n">thistrange</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid flow/range time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.tau,iOp.tauerr) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="c1">#+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistrange</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flowtime</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="c1"># hold_series[&#39;x_data&#39;] = np.array(plotx)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; $&#39;+str(flowtime)+&#39;$ &#39;+thistrange,fmt=self.thissym,color=self.thiscol)</span>

    <span class="c1">## Plots the observable against</span>
<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTflow"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTflow">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">thistrange</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid range/sum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="c1">#+&#39; &#39;+thistrange+ &#39; &#39;+thistsum</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; &#39;+thistrange+ &#39; &#39;+thistsum,fmt=self.thissym,color=self.thiscol)</span>

<div class="viewcode-block" id="FlowOpFullSquared.PlotOp2CorrTflowAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotOp2CorrTflowAuto">[docs]</a>    <span class="k">def</span> <span class="nf">PlotOp2CorrTflowAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">thistrange</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid range/sum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.Avg,iOp.Std) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="s1">&#39; Auto&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; &#39;+thistrange+ &#39; &#39;+thistsum+&#39; Auto&#39;,fmt=self.thissym,color=self.thiscol)</span>

<div class="viewcode-block" id="FlowOpFullSquared.PlotTflowAuto_TauIntWOpt"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.PlotTflowAuto_TauIntWOpt">[docs]</a>    <span class="k">def</span> <span class="nf">PlotTflowAuto_TauIntWOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_class</span><span class="p">,</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span> <span class="ow">and</span> <span class="p">(</span><span class="n">thistsum</span><span class="p">,</span><span class="n">thistrange</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">thistrange</span><span class="p">,</span> <span class="n">thistsum</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;invalid range/sum time picked to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span>
        <span class="n">thisOp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span>
        <span class="n">Op2ilist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Op2ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">Op2ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">iOp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">iOp2</span> <span class="ow">in</span> <span class="n">Op2ilist</span><span class="p">]</span>
        <span class="n">plotx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">Op2ilist</span><span class="p">))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span> <span class="o">=</span> <span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">),</span><span class="n">thisOp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tauerr</span><span class="p">)</span>
        <span class="c1"># ploty,plotyerr = zip(*[(iOp.tau,iOp.tauerr) for iOp in thisOp2.values])</span>
        <span class="n">plotshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisshift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">thistrange</span><span class="p">,</span><span class="n">thistsum</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowLegLab2</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">thistrange</span><span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">thistsum</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thissym</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thiscol</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotshift</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fmt_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeyForamtting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latparams</span><span class="p">)</span>
        <span class="n">plot_class</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_class</span></div>
        <span class="c1"># pl.errorbar(np.array(plotx)+plotshift,ploty,plotyerr,label=self.flowLegLab2+&#39; &#39;+thistrange+ &#39; &#39;+thistsum,fmt=self.thissym,color=self.thiscol)</span>


<span class="c1">### BLOCK OF PLOTTING FUNCTIONS ################################################</span>








    <span class="c1">## Comparisons</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>


    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="FlowOpFullSquared.Flowitems"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowitems">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowitemsAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowitemsAuto">[docs]</a>    <span class="k">def</span> <span class="nf">FlowitemsAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Flowitems2"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowitems2">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Flowitems2Auto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowitems2Auto">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems2Auto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Flowitems_toavg"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowitems_toavg">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems_toavg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.Flowitems2_toavg"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowitems2_toavg">[docs]</a>    <span class="k">def</span> <span class="nf">Flowitems2_toavg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.FlowitemsAvgStd"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowitemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">FlowitemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">Std</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">Std</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outlist</span></div>


<div class="viewcode-block" id="FlowOpFullSquared.Flowvalues"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowvalues">[docs]</a>    <span class="k">def</span> <span class="nf">Flowvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowvaluesAuto"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowvaluesAuto">[docs]</a>    <span class="k">def</span> <span class="nf">FlowvaluesAuto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.FlowvaluesAvgStd"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowvaluesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">FlowvaluesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;Std&#39;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FlowOpFullSquared.Flowkeys"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flowkeys">[docs]</a>    <span class="k">def</span> <span class="nf">Flowkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">iiloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>



<div class="viewcode-block" id="FlowOpFullSquared.Flownext"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.Flownext">[docs]</a>    <span class="k">def</span> <span class="nf">Flownext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">flowcurr</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span></div>

    <span class="c1">## incase next gets overloaded</span>
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flownext</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="FlowOpFullSquared.FlowWrite"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.FlowWrite">[docs]</a>    <span class="k">def</span> <span class="nf">FlowWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">FixDictArray</span><span class="p">(</span><span class="n">thislist</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
            <span class="n">outDict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ilist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thislist</span><span class="p">):</span>
                <span class="n">outDict</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ilist</span>
            <span class="k">return</span> <span class="n">outDict</span>

        <span class="n">outDict</span> <span class="o">=</span> <span class="n">ODNested</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;show_cfgs&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowname</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kud</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nxyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span>

        <span class="k">for</span> <span class="n">istream</span><span class="p">,</span><span class="n">incfg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream_list</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">flowncfg_list</span><span class="p">):</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;ncfg_&#39;</span><span class="o">+</span><span class="n">istream</span><span class="p">]</span> <span class="o">=</span> <span class="n">incfg</span>
        <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;nboot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nboot</span>

        <span class="n">excel_params</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outDict</span><span class="p">))</span>

        <span class="c1">## uncomment this if you want to actually see every time, rather than random sums</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">itsum</span><span class="p">,</span><span class="n">itflow</span><span class="p">),</span><span class="n">idata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Prop_Fit&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetOutputDict</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tdata</span><span class="p">,</span><span class="s1">&#39;Avg&#39;</span><span class="p">):</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Opboot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Opboot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdata</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems_toavg</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Opboot_toavg&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_avg_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;S_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlowitemsAuto</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto_Wopt&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">Wopt</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;OpAuto_tau&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">tau</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">tauerr</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="c1"># if len(self.Op2boot.keys()) &gt; 0:</span>
        <span class="c1">#     for itflow,itrange,itsum,it,tdata in self.Flowitems2():</span>
        <span class="c1">#         outDict[&#39;Op2boot&#39;][itflow][itrange][itsum][it] = AvgStdToFormat(tdata.Avg,tdata.Std,frmtflag=&#39;e&#39;)</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Chi_boot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chi_Stats</span><span class="p">[</span><span class="s1">&#39;Auto&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Chi_Auto&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">itrange</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems2_toavg</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Op2boot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">itrange</span><span class="p">][</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op2_avg_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;S_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sparam</span>
            <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">itrange</span><span class="p">,</span><span class="n">itsum</span><span class="p">,</span><span class="n">tdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowitems2Auto</span><span class="p">():</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Op2Auto&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">itrange</span><span class="p">][</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Op2Auto_Wopt&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">itrange</span><span class="p">][</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">Wopt</span>
                <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;Op2Auto_tau&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">][</span><span class="n">itrange</span><span class="p">][</span><span class="n">itsum</span><span class="p">]</span> <span class="o">=</span> <span class="n">AvgStdToFormat</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">tau</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">tauerr</span><span class="p">,</span><span class="n">frmtflag</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cfgs</span> <span class="ow">and</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">istream</span><span class="p">,</span><span class="n">icfg</span><span class="p">),</span><span class="n">ivals</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">itsrc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrandt</span><span class="p">):</span>
                    <span class="n">thistsrc</span> <span class="o">=</span> <span class="s1">&#39;t_src&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">itsrc</span><span class="p">)</span>
                    <span class="n">thiscfg</span> <span class="o">=</span> <span class="n">ivals</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span>
                    <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;random_sources&#39;</span><span class="p">][</span><span class="n">istream</span><span class="p">][</span><span class="n">thiscfg</span><span class="p">][</span><span class="n">thistsrc</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivals</span><span class="p">[</span><span class="s1">&#39;random_time_list&#39;</span><span class="p">]</span>



        <span class="c1">## Write human readable file with data</span>
        <span class="n">WriteXml</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowHumanFile</span><span class="p">,{</span><span class="s1">&#39;Results&#39;</span><span class="p">:</span><span class="n">outDict</span><span class="p">})</span>

        <span class="n">stats_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">keylist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Op_Stats&#39;</span><span class="p">,</span><span class="s1">&#39;Op2_Stats&#39;</span><span class="p">,</span><span class="s1">&#39;Op_avg_Stats&#39;</span><span class="p">,</span><span class="s1">&#39;Op2_avg_Stats&#39;</span><span class="p">,</span><span class="s1">&#39;Chi_Stats&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
            <span class="n">stats_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ikey</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;configs&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">WriteExcel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowExcelFile</span><span class="p">,</span><span class="n">stats_dict</span><span class="p">,</span><span class="n">flowcfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">excel_params</span><span class="p">)</span>

            <span class="n">outDict</span><span class="p">[</span><span class="s1">&#39;cfglist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series_TO_ODict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Op_cfgs</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>

        <span class="c1">## pickles rest of data for reading</span>
        <span class="c1"># WritePickle(self.flowPickleFile,self.RemoveOp2(deepcopy(self.__dict__)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="n">WritePickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span></div>

    <span class="c1">##################################</span>

<div class="viewcode-block" id="FlowOpFullSquared.RemoveOp2"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.FlowOpFullSquared.RemoveOp2">[docs]</a>    <span class="k">def</span> <span class="nf">RemoveOp2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisdict</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">thisdict</span><span class="p">[</span><span class="s1">&#39;Op2_Stats&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">thisdict</span><span class="p">[</span><span class="s1">&#39;Op2_avg_Stats&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">thisdict</span></div>


    <span class="c1">## Operator overloading</span>

    <span class="c1">#Too Much work, only works for one operator. Please use SetCustomName after doing all algebraic manipulation</span>

    <span class="c1">## this could to with some improving.... or some more generallity somewhere</span>

    <span class="c1"># def FlowUpdateName(self,opp,Op,Op2):</span>
    <span class="c1">#     def GetOppSelf(opp):</span>
    <span class="c1">#         if opp == &#39;+&#39;:</span>
    <span class="c1">#             return &#39;x2&#39;</span>
    <span class="c1">#         elif opp == &#39;-&#39;:</span>
    <span class="c1">#             return &#39;x0&#39;</span>
    <span class="c1">#         elif opp == &#39;x&#39;:</span>
    <span class="c1">#             return &#39;pow2&#39;</span>
    <span class="c1">#         elif opp == &#39;div&#39;:</span>
    <span class="c1">#             return &#39;divself&#39;</span>
    <span class="c1">#         elif opp == &#39;pow&#39;:</span>
    <span class="c1">#             return &#39;powself&#39;</span>
    <span class="c1">#     def GetLegSelf(opp):</span>
    <span class="c1">#         if opp == &#39;+&#39;:</span>
    <span class="c1">#             return &#39;\times 2&#39;</span>
    <span class="c1">#         elif opp == &#39;-&#39;:</span>
    <span class="c1">#             return &#39;\times 0&#39;</span>
    <span class="c1">#         elif opp == &#39;x&#39;:</span>
    <span class="c1">#             return &#39;^{2}&#39;</span>
    <span class="c1">#         elif opp == &#39;div&#39;:</span>
    <span class="c1">#             return &#39;divself&#39;</span>
    <span class="c1">#         elif opp == &#39;pow&#39;:</span>
    <span class="c1">#             return &#39;powself&#39;</span>

    <span class="c1">#     def LLFormatOp(opp):</span>
    <span class="c1">#         oppout = opp.replace(&#39;x&#39;,r&#39;\times &#39;)</span>
    <span class="c1">#         oppout = oppout.replace(&#39;pow&#39;,&#39;^{}&#39;)</span>
    <span class="c1">#         return oppout</span>

    <span class="c1">#     outname = []</span>
    <span class="c1">#     outLL = []</span>
    <span class="c1">#     oppLL = LLFormatOp(opp) ## \times looks better :)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp) and isinstance(Op,FlowOp):</span>
    <span class="c1">#         op1LL = Op.flowLegLab[1:-1] ## removes $ symbols, re adds at end</span>
    <span class="c1">#         op2LL = Op2.flowLegLab[1:-1] ## removes $ symbols, re adds at end</span>
    <span class="c1">#         if Op.flowname == Op2.flowname:</span>
    <span class="c1">#             outname = Op.flowname,GetOppSelf(opp)</span>
    <span class="c1">#             outLL = op1LL,&#39; Comb &#39;,GetLegSelf(oppLL)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             for iname,iname2 in zip(Op.flowname.split(&#39;_&#39;),Op2.flowname.split(&#39;_&#39;)):</span>
    <span class="c1">#                 if iname in iname2:</span>
    <span class="c1">#                     outname.append(iname2)</span>
    <span class="c1">#                 elif iname2 in iname:</span>
    <span class="c1">#                     outname.append(iname)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     outname.append(iname+opp+iname2)</span>
    <span class="c1">#             outname = &#39;_&#39;.join(outname)</span>
    <span class="c1">#             for iflowLegLab,iflowLegLab2 in zip(op1LL.split(&#39;_&#39;),op2LL.split(&#39;\ &#39;)):</span>
    <span class="c1">#                 if iflowLegLab in iflowLegLab2:</span>
    <span class="c1">#                     outLL.append(iflowLegLab2)</span>
    <span class="c1">#                 elif iflowLegLab2 in iflowLegLab:</span>
    <span class="c1">#                     outLL.append(iflowLegLab)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     outLL.append(iflowLegLab+oppLL+iflowLegLab2)</span>
    <span class="c1">#             outLL = &#39;_&#39;.join(outLL)</span>
    <span class="c1">#     elif isinstance(Op,FlowOp):</span>
    <span class="c1">#         op1LL = Op.flowLegLab[1:-1] ## removes $ symbols, re adds at end</span>
    <span class="c1">#         if isinstance(Op2,int):</span>
    <span class="c1">#             outname  =  Op.flowname,opp+str(Op2)</span>
    <span class="c1">#             outLL  =  op1LL,oppLL+str(Op2)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             if Op2 &gt; 0.01:</span>
    <span class="c1">#                 outname = Op.flowname,opp+&#39;{:.2f}&#39;.format(Op2)</span>
    <span class="c1">#                 outLL = op1LL,oppLL+&#39;{:.2f}&#39;.format(Op2)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         op2LL = Op2.flowLegLab[1:-1] ## removes $ symbols, re adds at end</span>
    <span class="c1">#         if isinstance(Op,int):</span>
    <span class="c1">#             outname  =  str(Op) + opp ,Op2.flowname</span>
    <span class="c1">#             outLL  =  str(Op) + oppLL,op2LL</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             if Op &gt; 0.01:</span>
    <span class="c1">#                 outname = &#39;{:.2f}&#39;.format(Op) + opp,Op2.flowname</span>
    <span class="c1">#                 outLL = &#39;{:.2f}&#39;.format(Op) + oppLL,op2LL</span>
    <span class="c1">#     # print r&#39;$&#39;+r&#39;\ &#39;.join(outLL)+&#39;$&#39;</span>
    <span class="c1">#     outLL = list(outLL)</span>
    <span class="c1">#     for ic,iLL in enumerate(outLL):</span>
    <span class="c1">#         if &#39;^{}&#39; in iLL:</span>
    <span class="c1">#             outLL[ic] = iLL.replace(&#39;^{}&#39;,&#39;^{&#39;)+&#39;}&#39;</span>
    <span class="c1">#     self.FlowSetCustomName(&#39;_&#39;.join(outname),r&#39;$&#39;+r&#39;\ &#39;.join(outLL)+&#39;$&#39;)</span>


    <span class="c1"># ## Numerical operatoions</span>

    <span class="c1"># def __add__(self,Op2):</span>
    <span class="c1">#     if any([ipar in str(type(Op2)) for ipar in FlowOp.parentlist]):</span>
    <span class="c1">#         return Op2.__radd__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                               Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#         result.FlowUpdateName(&#39;+&#39;,self,Op2)</span>
    <span class="c1">#         if isinstance(Op2,FlowOp):</span>
    <span class="c1">#             for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#                 result[it] = iOp + Op2[it]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for it,iOp in self.Flowitems():</span>
    <span class="c1">#                     result[it] = iOp + Op2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 print type(Op2)</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#         return result</span>

    <span class="c1"># def __sub__(self,Op2):</span>
    <span class="c1">#     if any([ipar in str(type(Op2)) for ipar in FlowOp.parentlist]):</span>
    <span class="c1">#         return Op2.__rsub__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                               Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#         result.FlowUpdateName(&#39;-&#39;,self,Op2)</span>
    <span class="c1">#         if isinstance(Op2,FlowOp):</span>
    <span class="c1">#             for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#                 result[it] = iOp - Op2[it]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for it,iOp in self.Flowitems():</span>
    <span class="c1">#                     result[it] = iOp - Op2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 print type(Op2)</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#         return result</span>

    <span class="c1"># def __mul__(self,Op2):</span>
    <span class="c1">#     if any([ipar in str(type(Op2)) for ipar in FlowOp.parentlist]):</span>
    <span class="c1">#         return Op2.__rmul__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                               Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#         result.FlowUpdateName(&#39;x&#39;,self,Op2)</span>
    <span class="c1">#         if isinstance(Op2,FlowOp):</span>
    <span class="c1">#             for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#                 result[it] = iOp * Op2[it]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for it,iOp in self.Flowitems():</span>
    <span class="c1">#                     result[it] = iOp * Op2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 print type(Op2)</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#         return result</span>

    <span class="c1"># def __div__(self,Op2):</span>
    <span class="c1">#     if any([ipar in str(type(Op2)) for ipar in FlowOp.parentlist]):</span>
    <span class="c1">#         return Op2.__rdiv__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                               Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#         result.FlowUpdateName(&#39;div&#39;,self,Op2)</span>
    <span class="c1">#         if isinstance(Op2,FlowOp):</span>
    <span class="c1">#             for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#                 try:</span>
    <span class="c1">#                     result[it] = iOp / Op2[it]</span>
    <span class="c1">#                 except Exception as err:</span>
    <span class="c1">#                     if any([ibs == 0 for ibs in Op2[it].bootvals]):</span>
    <span class="c1">#                         raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+Op2.flowname + &#39; &#39;+Op2[it].flowname)</span>

    <span class="c1">#         else:</span>
    <span class="c1">#             if Op2 == 0:</span>
    <span class="c1">#                 raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division&#39;)</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for it,iOp in self.Flowitems():</span>
    <span class="c1">#                     result[it] = iOp / Op2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 print type(Op2)</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># def __pow__(self,Op2):</span>
    <span class="c1">#     if any([ipar in str(type(Op2)) for ipar in FlowOp.parentlist]):</span>
    <span class="c1">#         return Op2.__rpow__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                               Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#         result.FlowUpdateName(&#39;pow&#39;,self,Op2)</span>
    <span class="c1">#         if isinstance(Op2,FlowOp):</span>
    <span class="c1">#             for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#                 result[it] = iOp ** Op2[it]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for it,iOp in self.Flowitems():</span>
    <span class="c1">#                     result[it] = iOp ** Op2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 print type(Op2)</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># ## Right multiplication functions</span>


    <span class="c1"># def __radd__(self,Op2):</span>
    <span class="c1">#     result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                           Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#     result.FlowUpdateName(&#39;+&#39;,Op2,self)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp):</span>
    <span class="c1">#         for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#             result[it] = Op2[it] + iOp</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             for it,iOp in self.Flowitems():</span>
    <span class="c1">#                 result[it] = Op2 + iOp</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             print type(Op2)</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#     return result</span>

    <span class="c1"># def __rsub__(self,Op2):</span>
    <span class="c1">#     result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                           Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#     result.FlowUpdateName(&#39;-&#39;,Op2,self)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp):</span>
    <span class="c1">#         for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#             result[it] =  Op2[it] - iOp</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             for it,iOp in self.Flowitems():</span>
    <span class="c1">#                 result[it] =  Op2 - iOp</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             print type(Op2)</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#     return result</span>

    <span class="c1"># def __rmul__(self,Op2):</span>
    <span class="c1">#     result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                           Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#     result.FlowUpdateName(&#39;x&#39;,Op2,self)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp):</span>
    <span class="c1">#         for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#             result[it] =  Op2[it] * iOp</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             for it,iOp in self.Flowitems():</span>
    <span class="c1">#                 result[it] = Op2 * iOp</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             print type(Op2)</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#     return result</span>

    <span class="c1"># def __rdiv__(self,Op2):</span>
    <span class="c1">#     result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                           Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#     result.FlowUpdateName(&#39;div&#39;,Op2,self)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp):</span>
    <span class="c1">#         for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 result[it] = Op2[it] / iOp</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 if any([ibs == 0 for ibs in iOp.bootvals]):</span>
    <span class="c1">#                     raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+self.flowname + &#39; &#39;+iOp.flowname)</span>

    <span class="c1">#     else:</span>
    <span class="c1">#         for it,iOp in self.Flowitems():</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 result[it] = Op2 / iOp</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 if iOp == 0:</span>
    <span class="c1">#                     raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     print type(Op2)</span>
    <span class="c1">#                     raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#     return result</span>


    <span class="c1"># def __rpow__(self,Op2):</span>
    <span class="c1">#     result = FlowOp(thisnboot=self.nboot, cfglist=self.flowcfglist,</span>
    <span class="c1">#                           Info=self.flowInfo,thissym=self.thissym,thiscol=self.thiscol,thisshift=self.thisshift)</span>
    <span class="c1">#     result.FlowUpdateName(&#39;pow&#39;,Op2,self)</span>
    <span class="c1">#     if isinstance(Op2,FlowOp):</span>
    <span class="c1">#         for (it,iOp) in self.Flowitems():</span>
    <span class="c1">#             result[it] =  Op2[it] ** iOp</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             for it,iOp in self.Flowitems():</span>
    <span class="c1">#                 result[it] = Op2 ** iOp</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             print type(Op2)</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with FlowOp class&#39;)</span>
    <span class="c1">#     return result</span>


    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">itflow</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flowkeys</span><span class="p">():</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">[(</span><span class="n">itflow</span><span class="p">,</span><span class="n">it</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>



<div class="viewcode-block" id="TestFO"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.TestFO">[docs]</a><span class="k">def</span> <span class="nf">TestFO</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># defInfoFlow[&#39;cfg_file_type&#39;] = &#39;html&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/flow_plot_test.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test FlowOps&#39;</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="c1"># data_plot.LoadPickle(DefWipe=False)</span>
    <span class="c1"># data_plot = data.PlotMonteTime(data_plot,&#39;t_f6.01&#39;)</span>
    <span class="c1"># data_plot = data.PlotMonteTimeDeltaEps(data_plot,&#39;t_f6.01&#39;,thiseps=1,thiscol=&#39;Red&#39;)</span>
    <span class="c1"># data_plot = data.PlotTauIntWOpt(data_plot)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">)</span>
    <span class="n">datacomb</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">FlowMakeChit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">datacomb</span><span class="o">.</span><span class="n">FlowPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">datacomb</span><span class="o">.</span><span class="n">FlowFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;fitr4-9&#39;</span><span class="p">)</span>
    <span class="n">datacomb</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span><span class="n">datacomb</span></div>

<div class="viewcode-block" id="ReformatFO"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.ReformatFO">[docs]</a><span class="k">def</span> <span class="nf">ReformatFO</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">out_filename</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;CFGNUMB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_filename</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;CFGNUMB not in out_filename.&#39;</span><span class="p">)</span>
    <span class="n">meta</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span> <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">this_tf_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t_f&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)),</span><span class="n">meta</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;CFGNUMB&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itf</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_tf_list</span><span class="p">,</span><span class="n">idata</span><span class="p">):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{itf:.2f}</span><span class="s1"> </span><span class="si">{ival:.17e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ReformatFO_picktf"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.ReformatFO_picktf">[docs]</a><span class="k">def</span> <span class="nf">ReformatFO_picktf</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="n">out_filename</span><span class="p">,</span><span class="n">pic_ft</span><span class="p">):</span>
    <span class="n">meta</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">ReadWithMeta</span><span class="p">(</span><span class="n">this_file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s1">&#39;Op&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span> <span class="k">for</span> <span class="n">idata</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pic_ft</span><span class="p">)]</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="TestFOFull"><a class="viewcode-back" href="../FlowOpps.html#FlowOpps.TestFOFull">[docs]</a><span class="k">def</span> <span class="nf">TestFOFull</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span>
    <span class="c1"># defInfoFlow[&#39;tflowlist&#39;] = np.array([4.01,5.01,6.01])</span>
    <span class="c1"># defInfoFlow[&#39;tsum_fit_list&#39;] = [&#39;ts28&#39;,&#39;ts30&#39;,&#39;ts32&#39;]</span>
    <span class="c1"># defInfoFlow[&#39;tsum_list&#39;] = [&#39;ts28&#39;,&#39;ts30&#39;,&#39;ts32&#39;]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.01</span><span class="p">])</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tsum_fit_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts32&#39;</span><span class="p">]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;tsum_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ts32&#39;</span><span class="p">]</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;nrandt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">defInfoFlow</span><span class="p">[</span><span class="s1">&#39;FlowNewForm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">dataFull</span> <span class="o">=</span> <span class="n">FlowOpFullSquared</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">defInfoFlow</span><span class="p">)</span>
    <span class="n">dataFull</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
    <span class="c1"># dataFull.ExpFitTime(thistflow=&#39;t_f6.01&#39;,funDebug=True)</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_dir</span><span class="o">+</span><span class="s1">&#39;/TestGraphs/flowfull_plot_test.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Test FlowOpsFull&#39;</span>
    <span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="n">dataFull</span><span class="o">.</span><span class="n">Fit_All_Props</span><span class="p">(</span><span class="s1">&#39;fitr4-15&#39;</span><span class="p">)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">dataFull</span><span class="o">.</span><span class="n">Plot_Prop_Tflow</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="c1"># data_plot = dataFull.PlotOp2CorrTsink(data_plot,&#39;t_f6.01&#39;,&#39;ts32&#39;,thiscol=&#39;Blue&#39;,thissym=&#39;o&#39;,thisshift=0.0)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PrintData</span><span class="p">()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Look at data and datacomb and dataFull&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataFull</span></div>


<span class="c1">## runing this file will do a test run!</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># %matplotlib inline</span>
    <span class="n">data</span><span class="p">,</span><span class="n">datacomb</span> <span class="o">=</span> <span class="n">TestFO</span><span class="p">()</span>
    <span class="n">dataFull</span> <span class="o">=</span> <span class="n">TestFOFull</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data is in data,datacomb,dataFull&#39;</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jack Dragos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
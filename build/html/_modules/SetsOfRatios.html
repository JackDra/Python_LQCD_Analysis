

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SetsOfRatios &mdash; LQCD Analysis Codebase TF Fits documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LQCD Analysis Codebase
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LQCD Analysis Codebase</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>SetsOfRatios</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for SetsOfRatios</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># import matplotlib</span>
<span class="c1"># matplotlib.use(&#39;Agg&#39;) # Must be before importing matplotlib.pyplot or pylab!</span>
<span class="c1"># import matplotlib.pyplot as pl</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="c1"># from MiscFuns import NumbToFileName,mkdir_p,ODNested</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">mkdir_p</span><span class="p">,</span><span class="n">CombineListCfgs</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">graphdir</span><span class="p">,</span><span class="n">defFitDict</span><span class="p">,</span><span class="n">defMcore</span><span class="p">,</span><span class="n">nchi_threshold</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="c1"># from XmlFormatting import rm_tsumfitr</span>

<span class="kn">from</span> <span class="nn">RatioCorrelators</span> <span class="k">import</span> <span class="n">RatioCorr</span><span class="p">,</span><span class="n">RatioFOCorr</span><span class="p">,</span><span class="n">RatioFOFullCorr</span>
<span class="kn">from</span> <span class="nn">TwoPtCorrelators</span> <span class="k">import</span> <span class="n">TwoPointCorr</span>
<span class="kn">from</span> <span class="nn">MultiWrap</span> <span class="k">import</span> <span class="n">DoMulticore</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">FileIO</span> <span class="k">import</span> <span class="n">Construct_Empty</span>
<span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="k">as</span> <span class="nn">op</span>

<div class="viewcode-block" id="Mcore_CombRats"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.Mcore_CombRats">[docs]</a><span class="k">def</span> <span class="nf">Mcore_CombRats</span><span class="p">(</span><span class="n">RatSet</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">RatSet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;None Found&#39;</span>
    <span class="n">this_key</span> <span class="o">=</span> <span class="n">RatSet</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">this_set</span> <span class="o">=</span> <span class="n">RatSet</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">this_name</span> <span class="o">=</span> <span class="n">this_set</span><span class="o">.</span><span class="n">name</span>
    <span class="k">for</span> <span class="n">iset_key</span><span class="p">,</span><span class="n">iset_var</span><span class="p">,</span><span class="n">coeff_scale</span> <span class="ow">in</span> <span class="n">RatSet</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">this_set</span> <span class="o">=</span> <span class="n">this_set</span> <span class="o">+</span> <span class="p">(</span><span class="n">iset_var</span><span class="o">*</span><span class="n">coeff_scale</span><span class="p">)</span>
    <span class="n">this_set</span><span class="o">.</span><span class="n">ReduceIndicies</span><span class="p">()</span>
    <span class="n">this_set</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
    <span class="n">this_set</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">this_name</span>
    <span class="k">return</span> <span class="n">this_set</span><span class="p">,</span><span class="n">this_key</span></div>


<span class="c1">## Move Somewhere?</span>
<span class="c1"># params = {&#39;legend.fontsize&#39;: 7,</span>
<span class="c1">#           &#39;legend.numpoints&#39;: 1,</span>
<span class="c1">#           &#39;axes.labelsize&#39; : 10,</span>
<span class="c1">#           &#39;figure.autolayout&#39;: True,</span>
<span class="c1">#           &#39;axes.grid&#39;: True,</span>
<span class="c1">#           &#39;errorbar.capsize&#39;: 5,</span>
<span class="c1">#           &#39;axes.xmargin&#39;:0.01,</span>
<span class="c1">#           &#39;axes.titlesize&#39; : 20,</span>
<span class="c1">#           &#39;axes.ymargin&#39;:0.01}</span>
<span class="c1"># pl.style.use(plot_style)</span>
<span class="c1"># pl.rcParams.update(params)</span>


<span class="n">colourset8</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;#000080&#39;</span><span class="p">,</span><span class="s1">&#39;#B22222&#39;</span><span class="p">,</span><span class="s1">&#39;#00B800&#39;</span><span class="p">,</span><span class="s1">&#39;#8B008B&#39;</span><span class="p">,</span> <span class="s1">&#39;#0000FF&#39;</span><span class="p">,</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span><span class="s1">&#39;#32CD32&#39;</span><span class="p">,</span><span class="s1">&#39;#FF0066&#39;</span><span class="p">]</span>
<span class="n">markerset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">shiftmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">shiftper</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1">##R function shift</span>
<span class="n">shiftset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ish</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">shiftmax</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">shiftset</span> <span class="o">+=</span> <span class="p">[</span><span class="o">-</span><span class="n">ish</span><span class="o">*</span><span class="n">shiftper</span><span class="p">,</span><span class="n">ish</span><span class="o">*</span><span class="n">shiftper</span><span class="p">]</span>
<span class="k">del</span> <span class="n">ish</span><span class="p">,</span> <span class="n">shiftmax</span><span class="p">,</span><span class="n">shiftper</span>



<div class="viewcode-block" id="SetOfRat"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat">[docs]</a><span class="k">class</span> <span class="nc">SetOfRat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Rat(set) Inherits from RatioCorrelators Class</span>

<span class="sd">    plotting parameters (Move to different file?) ####</span>

<span class="sd">    InfoDict is a list of Info dictionaries to be bassed to RatioCorrelators:</span>
<span class="sd">    Setup to do fits taken from dictionaries within InfoDict (see RatioCorrelators.py)</span>
<span class="sd">    Although Info[&#39;gammas&#39;] can have multiple gamma matricies,</span>
<span class="sd">    This code is only set up to take a list, where each list only has one gamma matrix in Info[&#39;gammas&#39;] ( e.g. = [&#39;g4&#39;])</span>




<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SetOfRat.Construct_Rat_Set"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Construct_Rat_Set">[docs]</a>    <span class="k">def</span> <span class="nf">Construct_Rat_Set</span><span class="p">(</span><span class="n">this_file_list</span><span class="p">,</span><span class="n">fo_list</span><span class="o">=</span><span class="s1">&#39;Def&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fo_list</span> <span class="o">==</span> <span class="s1">&#39;Def&#39;</span><span class="p">:</span>
            <span class="n">fo_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">this_file_list</span><span class="p">]</span>
        <span class="n">set_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ifull</span><span class="p">,</span><span class="n">ifile</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">full_list</span><span class="p">,</span><span class="n">this_file_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;FO&#39;</span> <span class="ow">in</span> <span class="n">ifull</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;Full&#39;</span> <span class="ow">in</span> <span class="n">ifull</span><span class="p">:</span>
                    <span class="n">set_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RatioFOFullCorr</span><span class="o">.</span><span class="n">Construct_RatFOFull_File</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">set_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RatioFOCorr</span><span class="o">.</span><span class="n">Construct_RatFO_File</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">set_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RatioCorr</span><span class="o">.</span><span class="n">Construct_Rat_File</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
        <span class="n">out_class</span> <span class="o">=</span> <span class="n">Construct_Empty</span><span class="p">(</span><span class="n">SetOfRat</span><span class="p">)</span>
        <span class="n">out_class</span><span class="o">.</span><span class="n">cfglist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">out_class</span><span class="o">.</span><span class="n">InfoDict</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">out_class</span><span class="o">.</span><span class="n">Plotdir</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/Rat/&#39;</span>
        <span class="n">out_class</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Set1&#39;</span>
        <span class="n">out_class</span><span class="o">.</span><span class="n">SetRat</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="n">set_list</span><span class="p">:</span>
            <span class="n">out_class</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">iset</span>
        <span class="k">return</span> <span class="n">out_class</span></div>

    <span class="n">instances</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span> <span class="n">InfoDict</span><span class="o">=</span><span class="p">[],</span><span class="n">corr_cfglists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">setnames</span> <span class="o">=</span> <span class="p">[],</span><span class="n">thisFO</span><span class="o">=</span><span class="s1">&#39;FromList&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span> <span class="o">=</span> <span class="n">cfglist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span> <span class="o">=</span> <span class="n">InfoDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/Rat/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Set&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SetOfRat</span><span class="o">.</span><span class="n">instances</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">SetOfRat</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="c1"># SetOfRat.instances.append(self.name)</span>

        <span class="k">if</span> <span class="n">thisFO</span> <span class="o">==</span> <span class="s1">&#39;FromList&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thisFO</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">idict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">thisFO</span> <span class="o">=</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span>
                        <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thisFO</span> <span class="o">=</span> <span class="n">thisFO</span>

        <span class="k">for</span> <span class="n">idict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span><span class="p">:</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;fo_for_cfgs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thisFO</span>

        <span class="c1">## dictionary containing RatioCorrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">setnames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">setnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">InfoDict</span><span class="p">)</span>
        <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="n">setnames</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Ratio Set &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">iname</span><span class="p">,</span><span class="n">idict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">setnames</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span><span class="p">)):</span>
            <span class="n">thiscol</span> <span class="o">=</span> <span class="n">colourset8</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)]</span>
            <span class="n">thissym</span> <span class="o">=</span> <span class="n">markerset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)]</span>
            <span class="n">thisshift</span> <span class="o">=</span> <span class="n">shiftset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)]</span>
            <span class="c1">## each flowed observable dictionary must contain the flow op in Info[&#39;Observable&#39;]</span>
            <span class="k">if</span> <span class="s1">&#39;Observable&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Observable&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">thisRat</span> <span class="o">=</span> <span class="n">RatioCorr</span><span class="p">(</span>    <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">,</span> <span class="n">Info</span><span class="o">=</span><span class="n">idict</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="n">thissym</span><span class="p">,</span>
                                            <span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="n">iname</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">iname</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;Full_Rat&#39;</span> <span class="ow">in</span> <span class="n">idict</span> <span class="ow">and</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Full_Rat&#39;</span><span class="p">]:</span>
                    <span class="n">thisRat</span> <span class="o">=</span> <span class="n">RatioFOFullCorr</span><span class="p">(</span>  <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">,</span> <span class="n">Info</span><span class="o">=</span><span class="n">idict</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="n">thissym</span><span class="p">,</span>
                                                <span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="n">iname</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">iname</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisRat</span> <span class="o">=</span> <span class="n">RatioFOCorr</span><span class="p">(</span>  <span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">,</span> <span class="n">Info</span><span class="o">=</span><span class="n">idict</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="n">thissym</span><span class="p">,</span>
                                            <span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="n">iname</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">iname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisRat</span> <span class="o">=</span> <span class="n">RatioCorr</span><span class="p">(</span><span class="n">cfglist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">,</span> <span class="n">Info</span><span class="o">=</span><span class="n">idict</span><span class="p">,</span><span class="n">thissym</span><span class="o">=</span><span class="n">thissym</span><span class="p">,</span>
                                    <span class="n">thiscol</span><span class="o">=</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thisshift</span><span class="o">=</span><span class="n">thisshift</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="n">iname</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">iname</span><span class="p">)</span>
            <span class="c1"># if isinstance(self.cfglist,dict) and len(self.cfglist.keys()) == 0: self.cfglist = thisRat.cfglist</span>

            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">thisRat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">Ratnext</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">while</span> <span class="nb">str</span><span class="p">(</span><span class="n">thisRat</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ratnext</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">Ratnext</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">thisRat</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ratnext</span><span class="p">)]</span> <span class="o">=</span> <span class="n">thisRat</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">thisRat</span><span class="p">)]</span> <span class="o">=</span> <span class="n">thisRat</span>
            <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
            <span class="c1"># print &#39;Setting up classes for &#39; , thisRat , &#39; complete&#39;</span>
        <span class="c1"># print</span>
            <span class="c1"># print &#39;has color&#39;,thiscol , &#39;symbol &#39; , thissym , &#39;thisshift&#39;,thisshift</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetRatlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">corr_cfglists</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GetUnCorrCfgList</span><span class="p">()</span>

        <span class="c1">##Implement Reading cfglist if len(cfglist) == 0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="SetOfRat.GetUnCorrCfgList"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetUnCorrCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetUnCorrCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">iRat</span><span class="o">.</span><span class="n">GetCfgList</span><span class="p">()</span></div>

<div class="viewcode-block" id="SetOfRat.GetCfgList"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">GetCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetUnCorrCfgList</span><span class="p">()</span>
        <span class="n">cfglist</span> <span class="o">=</span> <span class="n">CombineListCfgs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="s1">&#39;cfglist&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span></div>


<div class="viewcode-block" id="SetOfRat.ImportCfgList"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.ImportCfgList">[docs]</a>    <span class="k">def</span> <span class="nf">ImportCfgList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cfglist</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span> <span class="o">=</span> <span class="n">cfglist</span>
        <span class="k">for</span> <span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">iRat</span><span class="o">.</span><span class="n">ImportCfgList</span><span class="p">(</span><span class="n">cfglist</span><span class="p">)</span></div>


<div class="viewcode-block" id="SetOfRat.CombineWithAlpha"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.CombineWithAlpha">[docs]</a>    <span class="k">def</span> <span class="nf">CombineWithAlpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha_in</span><span class="p">,</span><span class="n">tflow_list</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">iRat</span><span class="p">):</span>
                <span class="n">iRat</span><span class="o">.</span><span class="n">CombineWithAlpha</span><span class="p">(</span><span class="n">alpha_in</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iRat</span><span class="o">.</span><span class="n">CombineWithAlpha</span><span class="p">(</span><span class="n">alpha_in</span><span class="p">,</span><span class="n">tflow_list</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span></div>


<div class="viewcode-block" id="SetOfRat.DoAlphaCombine"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.DoAlphaCombine">[docs]</a>    <span class="k">def</span> <span class="nf">DoAlphaCombine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">truediv</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">iRat</span><span class="p">):</span>
                <span class="n">iRat</span><span class="o">.</span><span class="n">DoAlphaCombine</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span></div>

<div class="viewcode-block" id="SetOfRat.Get_CombRats"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Get_CombRats">[docs]</a>    <span class="k">def</span> <span class="nf">Get_CombRats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_keys</span><span class="p">,</span><span class="n">this_coeffs</span><span class="p">):</span>
        <span class="n">this_len</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">this_coeffs</span><span class="p">))</span>
        <span class="n">set_list</span><span class="p">,</span><span class="n">coeff_list</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_keys</span><span class="p">,</span><span class="n">this_coeffs</span><span class="p">):</span>
            <span class="n">coeff_scale</span> <span class="o">=</span> <span class="n">icoeff</span><span class="o">/</span><span class="n">this_len</span>
            <span class="n">coeff_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff_scale</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iset_key</span><span class="p">,</span><span class="n">iset_var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">iset_key</span><span class="p">:</span>
                    <span class="n">set_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset_key</span><span class="p">,</span><span class="n">iset_var</span><span class="p">,</span><span class="n">coeff_scale</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">set_list</span></div>

<div class="viewcode-block" id="SetOfRat.CombRats"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.CombRats">[docs]</a>    <span class="k">def</span> <span class="nf">CombRats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_keys</span><span class="p">,</span><span class="n">this_coeffs</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">this_name</span><span class="p">,</span><span class="n">this_key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span>
        <span class="n">this_set</span> <span class="o">=</span> <span class="s1">&#39;None Found&#39;</span>
        <span class="n">this_len</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">this_coeffs</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_keys</span><span class="p">,</span><span class="n">this_coeffs</span><span class="p">):</span>
            <span class="n">coeff_scale</span> <span class="o">=</span> <span class="n">icoeff</span><span class="o">/</span><span class="n">this_len</span>
            <span class="k">for</span> <span class="n">iset_key</span><span class="p">,</span><span class="n">iset_var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">iset_key</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                        <span class="n">this_set</span> <span class="o">=</span> <span class="n">iset_var</span><span class="o">*</span><span class="n">coeff_scale</span>
                        <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">this_name</span> <span class="o">=</span> <span class="n">iset_var</span><span class="o">.</span><span class="n">name</span>
                        <span class="n">this_key</span> <span class="o">=</span> <span class="n">iset_key</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">this_set</span> <span class="o">=</span> <span class="n">this_set</span> <span class="o">+</span> <span class="p">(</span><span class="n">iset_var</span><span class="o">*</span><span class="n">coeff_scale</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">show_timer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
                    <span class="c1"># print &#39;DEBUG&#39;</span>
                    <span class="c1"># print iset_var.name</span>
                    <span class="c1"># print type(this_set.Rat_Stats[&#39;boot&#39;].iloc[0])</span>
                    <span class="c1"># print type(this_set.Rat_Stats[&#39;boot&#39;].iloc[0].bootvals[0])</span>
                    <span class="c1"># print this_set.Rat_Stats[&#39;boot&#39;].iloc[0].bootvals[0]</span>
                    <span class="c1"># print</span>
        <span class="k">if</span> <span class="n">this_set</span> <span class="o">!=</span> <span class="s1">&#39;None Found&#39;</span><span class="p">:</span>
            <span class="n">this_set</span><span class="o">.</span><span class="n">ReduceIndicies</span><span class="p">()</span>
            <span class="n">this_set</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">this_set</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">this_name</span>
        <span class="k">return</span> <span class="n">this_set</span><span class="p">,</span><span class="n">this_key</span></div>

<div class="viewcode-block" id="SetOfRat.ReduceRatios"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.ReduceRatios">[docs]</a>    <span class="k">def</span> <span class="nf">ReduceRatios</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key_list</span><span class="p">,</span><span class="n">coeff_list</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">defMcore</span><span class="p">):</span>
        <span class="n">hold_ratios</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">thistimer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">Mcore</span><span class="p">:</span>
            <span class="n">this_key_llist</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">jkey</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">jkey</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="k">for</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">]</span> <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">]</span>
            <span class="n">vallist</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span><span class="p">)</span> <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_key_llist</span><span class="p">,</span><span class="n">coeff_list</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Getting Data for Mcore&#39;</span><span class="p">)</span>
            <span class="n">vallist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Get_CombRats</span><span class="p">(</span><span class="o">*</span><span class="n">ival</span><span class="p">)</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">vallist</span><span class="p">]</span>
            <span class="c1"># for ival in vallist:</span>
            <span class="c1">#     print ival</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span>
                <span class="c1"># print &#39;Reducing Ratios: &#39;</span>
                <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Reducing Ratios Mcore: &#39;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">DoMulticore</span><span class="p">(</span><span class="n">Mcore_CombRats</span><span class="p">,</span><span class="n">vallist</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">this_rat</span><span class="p">,</span><span class="n">this_key</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_rat</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">this_rat</span> <span class="o">==</span> <span class="s1">&#39;None Found&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no ratio in set for:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_key_llist</span><span class="p">[</span><span class="n">ic</span><span class="p">]))</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="n">this_key</span> <span class="o">=</span> <span class="s1">&#39;Error&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hold_ratios</span><span class="p">[</span><span class="n">this_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_rat</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span>
                <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmt_key_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">jkey</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">jkey</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="k">for</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">]</span> <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span>
                <span class="c1"># print &#39;Reducing Ratios: &#39;</span>
                <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="n">fmt_key_list</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Reducing Ratios: &#39;</span><span class="p">,</span><span class="n">prod_or_sum</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">key_list</span><span class="p">,</span><span class="n">coeff_list</span><span class="p">):</span>
                <span class="n">this_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">jkey</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">jkey</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="k">for</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">]</span>
                <span class="n">this_rat</span><span class="p">,</span><span class="n">this_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CombRats</span><span class="p">(</span><span class="n">this_key_list</span><span class="p">,</span><span class="n">icoeff</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="n">thistimer</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_rat</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">this_rat</span> <span class="o">==</span> <span class="s1">&#39;None Found&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, no ratio in set for:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_key_list</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="n">this_key</span> <span class="o">=</span> <span class="s1">&#39;Error&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hold_ratios</span><span class="p">[</span><span class="n">this_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_rat</span>
                <span class="c1"># if show_timer: print &#39;Ratio &#39;,this_key,&#39; complete.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span> <span class="o">=</span> <span class="n">hold_ratios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRatlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">)</span></div>

<div class="viewcode-block" id="SetOfRat.Read"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Importing Ratio of corr: &#39;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">setdata</span><span class="p">))</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span></div>

<div class="viewcode-block" id="SetOfRat.Write"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing Ratio of corr: &#39;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">iRat</span><span class="p">))</span>
            <span class="n">iRat</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span></div>

<div class="viewcode-block" id="SetOfRat.Reformat3pt"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Reformat3pt">[docs]</a>    <span class="k">def</span> <span class="nf">Reformat3pt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisdir</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reformatting 3 point correlation functions into &#39;</span> <span class="p">,</span> <span class="n">thisdir</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iRat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reformatting &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">iRat</span><span class="p">))</span>
            <span class="n">iRat</span><span class="o">.</span><span class="n">C3class</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">show_timer</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">iRat</span><span class="o">.</span><span class="n">C3class</span><span class="o">.</span><span class="n">SetCustomName</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">iRat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;RatioFOFullCorr&#39;</span><span class="p">:</span>
                <span class="n">iRat</span><span class="o">.</span><span class="n">C3class</span><span class="o">.</span><span class="n">WriteCfgsToFile</span><span class="p">(</span><span class="n">thisdir</span><span class="p">)</span></div>

<div class="viewcode-block" id="SetOfRat.LoadPickleCommonC2"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.LoadPickleCommonC2">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickleCommonC2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Mcore</span> <span class="o">=</span> <span class="n">defMcore</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Mcore</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;multicore has loadpicklecommonc2 not implemented yet, running over single thread&#39;</span><span class="p">)</span>
            <span class="c1"># raise NotImplementedError(&#39;multicore has loadpicklecommonc2 not implemented yet&#39;)</span>
        <span class="c1"># else:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">thisiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="n">first_key</span><span class="p">,</span><span class="n">first_Rat</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">thisiter</span><span class="p">)</span>
            <span class="n">first_Rat</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">first_Rat</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_Rat</span><span class="o">.</span><span class="n">C2class</span><span class="p">,</span><span class="n">TwoPointCorr</span><span class="p">):</span>
                <span class="n">common_NN</span> <span class="o">=</span> <span class="n">first_Rat</span><span class="o">.</span><span class="n">C2class</span>
                <span class="n">common_NNQ</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">common_NN</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">common_NNQ</span> <span class="o">=</span> <span class="n">first_Rat</span><span class="o">.</span><span class="n">C2class</span>
            <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iRat</span> <span class="ow">in</span> <span class="n">thisiter</span><span class="p">:</span>
                <span class="n">isFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">iRat</span><span class="p">)</span>
                <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">iRat</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isFO</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isFOFull</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">common_NNQ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">iRat</span><span class="o">.</span><span class="n">C2class</span> <span class="o">=</span> <span class="n">common_NNQ</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">common_NN</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">iRat</span><span class="o">.</span><span class="n">C2class</span> <span class="o">=</span> <span class="n">common_NN</span>
                <span class="n">iRat</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isFO</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isFOFull</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">common_NNQ</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">common_NNQ</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">C2class</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">common_NN</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">common_NN</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">C2class</span>
                <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">iRat</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SetOfRat.LoadPickle"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Mcore</span> <span class="o">=</span> <span class="n">defMcore</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">LPMulti</span><span class="p">(</span><span class="n">thisinput</span><span class="p">):</span>
            <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="o">=</span> <span class="n">thisinput</span>
            <span class="c1"># print &#39;LoadPickle Ratio of corr: &#39; , str(setdata)</span>
            <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">setdata</span><span class="p">))</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">,</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="n">CheckCfgs</span><span class="p">)</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">ImportPlotParams</span><span class="p">(</span><span class="n">colourset8</span><span class="p">[</span><span class="n">iset</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)],</span><span class="n">markerset</span><span class="p">[</span><span class="n">iset</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)],</span>
                                     <span class="n">shiftset</span><span class="p">[</span><span class="n">iset</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)])</span>
            <span class="n">thistimer</span><span class="o">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">newl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1"># print &#39;Ratio of corr: &#39; , str(setdata) , &#39; Complete! &#39;</span>
            <span class="k">return</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span>


        <span class="k">if</span> <span class="n">Mcore</span><span class="p">:</span>
            <span class="c1"># print LPMulti</span>
            <span class="n">vallist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">iset</span><span class="p">,</span><span class="n">setdata</span><span class="p">)</span> <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
            <span class="c1"># for ival in vallist:</span>
            <span class="c1">#     print ival</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">DoMulticore</span><span class="p">(</span><span class="n">LPMulti</span><span class="p">,</span><span class="n">vallist</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">icount</span><span class="p">,</span><span class="n">ikey</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">icout</span><span class="p">,</span><span class="n">iout</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">icout</span> <span class="o">==</span> <span class="n">icount</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">iout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># for iset,setdata in enumerate(self.SetRat.itervalues()):</span>
            <span class="p">[</span> <span class="n">LPMulti</span><span class="p">((</span><span class="n">iset</span><span class="p">,</span><span class="n">setdata</span><span class="p">))</span> <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span></div>
        <span class="c1"># print</span>

<div class="viewcode-block" id="SetOfRat.ReadAndWrite"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.ReadAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Importing and Writing Ratio of corr: &#39;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">setdata</span><span class="p">))</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">ReadAndWrite</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span></div>

<div class="viewcode-block" id="SetOfRat.GetSet"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetSet">[docs]</a>    <span class="k">def</span> <span class="nf">GetSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="n">thisset</span><span class="p">]</span></div>

<div class="viewcode-block" id="SetOfRat.DoFitRanges"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.DoFitRanges">[docs]</a>    <span class="k">def</span> <span class="nf">DoFitRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_min</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fit_max</span><span class="p">))</span>
        <span class="n">fitr</span> <span class="o">=</span> <span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="n">fit_min</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">fit_max</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tsum_fit</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">tsum_fit</span> <span class="o">=</span> <span class="s1">&#39;tsumfitr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tsum_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tsum_fit</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fitting &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isFOFull</span> <span class="ow">and</span> <span class="n">tsum_fit</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;tsum_fit_range must be passed in if using FOFull&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                <span class="n">setdata</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr</span><span class="p">,</span><span class="n">tsum_ranges</span><span class="o">=</span><span class="n">tsum_fit</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="n">min_fitr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">setdata</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="n">fitr</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="n">min_fitr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span></div>
        <span class="c1"># return fit_list</span>

<div class="viewcode-block" id="SetOfRat.GetBestFits"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetBestFits">[docs]</a>    <span class="k">def</span> <span class="nf">GetBestFits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">thisflowlist</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="c1"># print &#39;DEBUG, uncomment for full run&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Undergoing Fits of Ratio Functions&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DoFitRanges</span><span class="p">(</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="n">tsum_fit</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="n">min_fitr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Selecting Best Fits&#39;</span><span class="p">)</span>
        <span class="n">lfout</span><span class="p">,</span><span class="n">lfchi</span><span class="p">,</span><span class="n">iflist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lout</span><span class="p">,</span><span class="n">lchi</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="k">def</span> <span class="nf">Get_Chi</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Chi2DoF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Avg</span>
        <span class="k">def</span> <span class="nf">Get_Res</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">isFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">fit_result</span><span class="p">,</span><span class="n">chi_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetBestChi</span><span class="p">()</span>
                    <span class="n">ifit_key</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetBestChi_key</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                        <span class="n">ifit_key</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ifit_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ifit_key</span> <span class="o">=</span> <span class="n">ifit_key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">iflist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit_key</span><span class="p">,))</span>
                    <span class="n">lfout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_result</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">lfchi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chi_data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">fit_result</span><span class="p">,</span><span class="n">chi_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetBestChi</span><span class="p">()</span>
                    <span class="n">ifit_key</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetBestChi_key</span><span class="p">()</span>
                    <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit_key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>
                    <span class="n">lout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_result</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">lchi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chi_data</span><span class="p">)</span>
        <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span>
                            <span class="n">names</span><span class="o">=</span><span class="p">[</span>  <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;chi2pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lchi</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="c1"># output.loc[:,&#39;Avg&#39;] = pa.Series(lAvg,index=indicies)</span>
            <span class="c1"># output.loc[:,&#39;Std&#39;] = pa.Series(lStd,index=indicies)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING:no Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iflist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">iflist</span><span class="p">,</span>
                        <span class="n">names</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;flow_times&#39;</span><span class="p">,</span><span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">outputflow</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lfout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">outputflow</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;chi2pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lfchi</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="c1"># outputflow.loc[:,&#39;Avg&#39;] = pa.Series(lfAvg,index=indicies)</span>
            <span class="c1"># outputflow.loc[:,&#39;Std&#39;] = pa.Series(lfStd,index=indicies)</span>
        <span class="k">elif</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING:, no flow time Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span></div>


<div class="viewcode-block" id="SetOfRat.GetFitsFromIndex"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetFitsFromIndex">[docs]</a>    <span class="k">def</span> <span class="nf">GetFitsFromIndex</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">input_indicies</span><span class="p">,</span><span class="n">input_flowed_indicies</span><span class="p">,</span>
                            <span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">thisflowlist</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                            <span class="n">chi_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">chi_max</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Undergoing Fits of Ratio Functions&#39;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">Get_Res</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DoFitRanges</span><span class="p">(</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="n">tsum_fit</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="n">min_fitr</span><span class="p">)</span>
        <span class="n">lfout</span><span class="p">,</span><span class="n">iflist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">lout</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">isFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">this_index</span> <span class="o">=</span> <span class="n">input_flowed_indicies</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)]</span>
                    <span class="n">fit_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Fit_Stats_fmt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">this_index</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                            <span class="n">ifit</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ifit</span> <span class="o">=</span> <span class="n">ifit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">iflist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit</span><span class="p">,))</span>
                        <span class="n">lfout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">isFO</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">isFOFull</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">this_index</span> <span class="o">=</span> <span class="n">input_flowed_indicies</span><span class="p">[</span><span class="n">ikey</span><span class="o">+</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)]</span>
                    <span class="n">fit_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Fit_Stats_fmt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">this_index</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>
                        <span class="n">lout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span>
                            <span class="n">names</span><span class="o">=</span><span class="p">[</span>  <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: no Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iflist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">iflist</span><span class="p">,</span>
                        <span class="n">names</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">outputflow</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lfout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING:, no flow time Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span></div>



<div class="viewcode-block" id="SetOfRat.GetChi2PdfFits"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.GetChi2PdfFits">[docs]</a>    <span class="k">def</span> <span class="nf">GetChi2PdfFits</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">thisflowlist</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">ralpha_info</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;boot&#39;</span><span class="p">),</span>
                        <span class="n">chi_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">chi_max</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">nchi_threshold</span><span class="o">=</span><span class="n">nchi_threshold</span><span class="p">,</span><span class="n">imp_list</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">):</span>
        <span class="n">this_col</span> <span class="o">=</span> <span class="n">ralpha_info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">this_col</span> <span class="o">!=</span> <span class="s1">&#39;boot&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Constructing alpha combine&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CombineWithAlpha</span><span class="p">(</span><span class="n">ralpha_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">thisflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">this_fun</span><span class="o">=</span><span class="n">ralpha_info</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Undergoing Fits of Ratio Functions&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DoFitRanges</span><span class="p">(</span><span class="n">fit_min</span><span class="p">,</span><span class="n">fit_max</span><span class="p">,</span><span class="n">tsum_fit</span><span class="o">=</span><span class="n">tsum_fit</span><span class="p">,</span><span class="n">min_fitr</span><span class="o">=</span><span class="n">min_fitr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Selecting Chi2pdf in range&#39;</span><span class="p">,</span> <span class="n">chi_min</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">chi_max</span><span class="p">)</span>
        <span class="n">lfout</span><span class="p">,</span><span class="n">lfchi</span><span class="p">,</span><span class="n">iflist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">lout</span><span class="p">,</span><span class="n">lchi</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">imp_check</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imp_list</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">isFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">setdata</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="n">this_col</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">this_nchi</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">imp_check</span> <span class="ow">or</span> <span class="n">setdata</span><span class="o">.</span><span class="n">C3FOclass</span><span class="o">.</span><span class="n">NJN</span><span class="o">.</span><span class="n">Proj</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">imp_list</span><span class="p">:</span>
                        <span class="n">this_nchi</span> <span class="o">=</span> <span class="n">nchi_threshold</span>
                    <span class="n">fit_data</span><span class="p">,</span><span class="n">chi_test</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetChiRange</span><span class="p">(</span><span class="n">chi_min</span><span class="o">=</span><span class="n">chi_min</span><span class="p">,</span><span class="n">chi_max</span><span class="o">=</span><span class="n">chi_max</span><span class="p">,</span><span class="n">nchi_cutoff</span> <span class="o">=</span> <span class="n">this_nchi</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chi_test</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;Warning, not fit ranges found for &#39;</span><span class="p">,</span><span class="n">iset</span><span class="p">,</span>
                                <span class="s1">&#39;that satisfies chi range, using minimum with chi of &#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi_test</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                            <span class="n">ifit</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ifit</span> <span class="o">=</span> <span class="n">ifit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">iflist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit</span><span class="p">,))</span>
                        <span class="n">lfout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">lfchi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;Chi2pdfAvg&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">isFO</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">isFOFull</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">Rat_Fit_Stats</span><span class="p">[</span><span class="n">this_col</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">this_nchi</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">imp_check</span> <span class="ow">or</span> <span class="n">setdata</span><span class="o">.</span><span class="n">C3FOclass</span><span class="o">.</span><span class="n">NJN</span><span class="o">.</span><span class="n">Proj</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">imp_list</span><span class="p">:</span>
                        <span class="n">this_nchi</span> <span class="o">=</span> <span class="n">nchi_threshold</span>
                    <span class="n">fit_data</span><span class="p">,</span><span class="n">chi_test</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">GetChiRange</span><span class="p">(</span><span class="n">chi_min</span><span class="o">=</span><span class="n">chi_min</span><span class="p">,</span><span class="n">chi_max</span><span class="o">=</span><span class="n">chi_max</span><span class="p">,</span><span class="n">nchi_cutoff</span> <span class="o">=</span> <span class="n">this_nchi</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chi_test</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;Warning, not fit ranges found for &#39;</span><span class="p">,</span><span class="n">iset</span><span class="p">,</span>
                                <span class="s1">&#39;that satisfies chi range, using minimum with chi of &#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi_test</span><span class="p">)]))</span>
                    <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">ival</span> <span class="ow">in</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                        <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ikey</span> <span class="o">+</span> <span class="p">(</span><span class="n">ifit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>
                        <span class="n">lout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">lchi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ival</span><span class="p">[</span><span class="s1">&#39;Chi2pdfAvg&#39;</span><span class="p">])</span>
        <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span><span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ilist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span>  <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span>
                                                                <span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;chi2pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lchi</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: no Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iflist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">iflist</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;Rat_Set&#39;</span><span class="p">,</span><span class="s1">&#39;current_operator&#39;</span><span class="p">,</span><span class="s1">&#39;momentum&#39;</span><span class="p">,</span><span class="s1">&#39;flow_times&#39;</span><span class="p">,</span>
                                                                <span class="s1">&#39;time_fit_range&#39;</span><span class="p">])</span>
            <span class="n">outputflow</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lfout</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">outputflow</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;chi2pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lfchi</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">isFO</span> <span class="ow">or</span> <span class="n">isFOFull</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING:, no flow time Ratio function fits found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span><span class="n">outputflow</span></div>


    <span class="c1">## depreciated</span>
    <span class="c1"># def GetFits(self,fitr = &#39;All&#39;,thisflowlist = &#39;All&#39;):</span>
    <span class="c1">#     lfout,iflist = [],[]</span>
    <span class="c1">#     lout,ilist = [],[]</span>
    <span class="c1">#     ## output { set , igamma , ip  } Fitting class instance</span>
    <span class="c1">#     for iset,setdata in self.SetRat.iteritems():</span>
    <span class="c1">#         isFO = self.CheckFO(setdata)</span>
    <span class="c1">#         isFOFull = self.CheckFOFull(setdata)</span>
    <span class="c1">#         if isFOFull:</span>
    <span class="c1">#             if len(setdata.Rat_Fit_Stats.index) == 0 or fitr \</span>
    <span class="c1">#             not in setdata.Rat_Fit_Stats.index.get_level_values(&#39;tau_tsum_fit_ranges&#39;):</span>
    <span class="c1">#                 fitr_list = fitr.split(&#39;_&#39;)</span>
    <span class="c1">#                 setdata.Fit(fit_ranges=fitr_list[0],tsum_ranges=fitr_list[1])</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             if len(setdata.Rat_Fit_Stats.index) == 0 or fitr \</span>
    <span class="c1">#             not in setdata.Rat_Fit_Stats.index.get_level_values(&#39;time_fit_range&#39;):</span>
    <span class="c1">#                 setdata.Fit(fit_ranges=fitr)</span>
    <span class="c1">#         if isFO or isFOFull:</span>
    <span class="c1">#             for (igamma,ip,itflow,ifitr),idata in setdata.Rat_Fit_Stats[&#39;boot&#39;].iteritems():</span>
    <span class="c1">#                 fit_check = fitr == &#39;All&#39; or ifitr == fitr</span>
    <span class="c1">#                 flow_check = thisflowlist == &#39;All&#39; or itflow in thisflowlist</span>
    <span class="c1">#                 if fit_check and flow_check:</span>
    <span class="c1">#                     fitdata = idata.fit_data[&#39;Params&#39;].iloc[0]</span>
    <span class="c1">#                     iflist.append((iset,igamma,ip,itflow,ifitr))</span>
    <span class="c1">#                     lfout.append(fitdata)</span>
    <span class="c1">#                     lfAvg.append(fitdata.Avg)</span>
    <span class="c1">#                     lfStd.append(fitdata.Std)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             for (igamma,ip,ifitr),idata in setdata.Rat_Fit_Stats[&#39;boot&#39;].iteritems():</span>
    <span class="c1">#                 fit_check = fitr == &#39;All&#39; or ifitr == rm_tsumfitr(fitr)</span>
    <span class="c1">#                 if fit_check:</span>
    <span class="c1">#                     fitdata = idata.fit_data[&#39;Params&#39;].iloc[0]</span>
    <span class="c1">#                     ilist.append((iset,igamma,ip,ifitr))</span>
    <span class="c1">#                     lout.append(fitdata)</span>
    <span class="c1">#                     lAvg.append(fitdata.Avg)</span>
    <span class="c1">#                     lStd.append(fitdata.Std)</span>
    <span class="c1">#     output,outputflow = pa.DataFrame(),pa.DataFrame()</span>
    <span class="c1">#     if len(ilist) &gt; 0:</span>
    <span class="c1">#         indicies = pa.MultiIndex.from_tuples(ilist,names=[  &#39;Rat_Set&#39;,&#39;current_operator&#39;,&#39;momentum&#39;,</span>
    <span class="c1">#                                                             &#39;time_fit_range&#39;])</span>
    <span class="c1">#         output.loc[:,&#39;boot&#39;] = pa.Series(lout,index=indicies)</span>
    <span class="c1">#         output.loc[:,&#39;Avg&#39;] = pa.Series(lAvg,index=indicies)</span>
    <span class="c1">#         output.loc[:,&#39;Std&#39;] = pa.Series(lStd,index=indicies)</span>
    <span class="c1">#     if len(iflist) &gt; 0:</span>
    <span class="c1">#         indicies = pa.MultiIndex.from_tuples(iflist,names=[ &#39;Rat_Set&#39;,&#39;current_operator&#39;,&#39;momentum&#39;,&#39;flow_times&#39;,</span>
    <span class="c1">#                                                             &#39;time_fit_range&#39;])</span>
    <span class="c1">#         outputflow.loc[:,&#39;boot&#39;] = pa.Series(lfout,index=indicies)</span>
    <span class="c1">#         outputflow.loc[:,&#39;Avg&#39;] = pa.Series(lfAvg,index=indicies)</span>
    <span class="c1">#         outputflow.loc[:,&#39;Std&#39;] = pa.Series(lfStd,index=indicies)</span>
    <span class="c1">#     return output,outputflow</span>

    <span class="c1">## fitlist is list of touples { set : (&#39;state#&#39;,&#39;fitr#-#&#39;)}</span>
<div class="viewcode-block" id="SetOfRat.Plot"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Plot">[docs]</a>    <span class="k">def</span> <span class="nf">Plot</span><span class="p">(</span>   <span class="bp">self</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">fitDict</span><span class="o">=</span><span class="n">defFitDict</span><span class="p">,</span><span class="n">fitDictFull</span><span class="o">=</span><span class="n">defFitDict</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">tflowlist</span> <span class="o">=</span> <span class="p">[],</span><span class="n">tsum_list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio Funciton plot&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\tau - t/2$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Ratio Function$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">icount</span><span class="p">,(</span><span class="n">ikey</span><span class="p">,</span><span class="n">iRat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">isFO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFO</span><span class="p">(</span><span class="n">iRat</span><span class="p">)</span>
            <span class="n">isFOFull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">iRat</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting &#39;</span><span class="p">,</span> <span class="n">iRat</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">fit_is_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitDict</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="n">tsum_list</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">isFO</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">fit_is_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit as well &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDictFull</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="n">tsum_list</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">isFO</span><span class="p">:</span>
                    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">fitDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit as well &#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">isFOFull</span><span class="p">:</span>
                        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDictFull</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tsum_list</span><span class="o">=</span><span class="n">tsum_list</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">isFO</span><span class="p">:</span>
                        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>


    <span class="c1">## fitlist is list of touples { set : (&#39;state#&#39;,&#39;fitr#-#&#39;)}</span>
<div class="viewcode-block" id="SetOfRat.PlotTsum"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.PlotTsum">[docs]</a>    <span class="k">def</span> <span class="nf">PlotTsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">fitDict</span><span class="o">=</span><span class="n">defFitDict</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="p">{},</span><span class="n">tflowlist</span> <span class="o">=</span> <span class="p">[],</span><span class="n">tcurr_list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ratio Funciton plot&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$t_</span><span class="si">{s}</span><span class="s1">$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Ratio Function$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_tsum.pdf&#39;</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">icount</span><span class="p">,(</span><span class="n">ikey</span><span class="p">,</span><span class="n">iRat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckFOFull</span><span class="p">(</span><span class="n">iRat</span><span class="p">):</span> <span class="k">continue</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting tsum&#39;</span><span class="p">,</span> <span class="n">iRat</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">fit_is_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitDict</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
            <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">PlotTsum</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tcurr</span><span class="o">=</span><span class="n">tcurr_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fit_is_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit as well &#39;</span><span class="p">)</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitSumPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tcurr</span><span class="o">=</span><span class="n">tcurr_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">fitDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fit as well &#39;</span><span class="p">)</span>
                    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iRat</span><span class="o">.</span><span class="n">FitSumPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">fitDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">gammamomlist</span><span class="o">=</span><span class="n">gammamomlist</span><span class="p">[</span><span class="n">icount</span><span class="p">],</span><span class="n">tflowlist</span><span class="o">=</span><span class="n">tflowlist</span><span class="p">,</span><span class="n">tcurr</span><span class="o">=</span><span class="n">tcurr_list</span><span class="p">)</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="SetOfRat.CheckFO"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.CheckFO">[docs]</a>    <span class="k">def</span> <span class="nf">CheckFO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iRat</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">iRat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;RatioFOCorr&#39;</span></div>

<div class="viewcode-block" id="SetOfRat.CheckFOFull"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.CheckFOFull">[docs]</a>    <span class="k">def</span> <span class="nf">CheckFOFull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iRat</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">iRat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;RatioFOFullCorr&#39;</span></div>


    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>

<div class="viewcode-block" id="SetOfRat.Stats"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.Stats">[docs]</a>    <span class="k">def</span> <span class="nf">Stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">iset</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="SetOfRat.items"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1">#values = igamma,ip,(maybe itflow,) it, data</span>
            <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">setdata</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">outdata</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span><span class="o">+</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outdata</span></div>

<div class="viewcode-block" id="SetOfRat.itemsAvgStd"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.itemsAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">itemsAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">setdata</span><span class="o">.</span><span class="n">itemsAvgStd</span><span class="p">():</span>
                <span class="n">outdata</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span> <span class="o">+</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outdata</span></div>

<div class="viewcode-block" id="SetOfRat.values"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">tdata</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">setdata</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">outdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tdata</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outdata</span></div>



<div class="viewcode-block" id="SetOfRat.valuesAvgStd"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.valuesAvgStd">[docs]</a>    <span class="k">def</span> <span class="nf">valuesAvgStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">tdata</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">setdata</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">outdata</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tdata</span><span class="o">.</span><span class="n">Avg</span><span class="p">,</span><span class="n">tdata</span><span class="o">.</span><span class="n">Std</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">outdata</span></div>

<div class="viewcode-block" id="SetOfRat.keys"><a class="viewcode-back" href="../SetsOfRatios.html#SetsOfRatios.SetOfRat.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iset</span><span class="p">,</span><span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetRat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">setdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">outdata</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="p">,)</span><span class="o">+</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outdata</span></div>

    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thiskey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">thiskey</span><span class="p">]</span>

    <span class="c1">## unitary arithmetic operations</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">## Casting, just casts the bootstrap values, ignore return value (only needed since return has to be same type).</span>


    <span class="k">def</span> <span class="nf">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">complex</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>

    <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">])</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>

    <span class="c1">## Numerical operatoions</span>

    <span class="c1"># def __add__(self,Rat2):</span>
    <span class="c1">#     if type(Rat2) in SetOfRat.parentlist:</span>
    <span class="c1">#         return Rat2.__radd__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = SetOfRat(cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#         if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#             result.name = &#39;+&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat + Rat2[(iset,igamma,ip,it)]</span>
    <span class="c1">#         elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#             result.name = &#39;+&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = iRat + Rat2[(igamma,ip,it)]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 result.name = &#39;+&#39;.join([self.name,NumbToFileName(Rat2)])</span>
    <span class="c1">#                 for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat + Rat2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#         return result</span>

    <span class="c1"># def __sub__(self,Rat2):</span>
    <span class="c1">#     if type(Rat2) in SetOfRat.parentlist:</span>
    <span class="c1">#         return Rat2.__rsub__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#         if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#             result.name = &#39;-&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat - Rat2[(iset,igamma,ip,it)]</span>
    <span class="c1">#         elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 result.name = &#39;-&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = iRat - Rat2[(igamma,ip,it)]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                     result.name = &#39;-&#39;.join([self.name,NumbToFileName(Rat2)])</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat - Rat2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># def __mul__(self,Rat2):</span>
    <span class="c1">#     if type(Rat2) in SetOfRat.parentlist:</span>
    <span class="c1">#         return Rat2.__rmul__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#         if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#             result.name = &#39;x&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat * Rat2[(iset,igamma,ip,it)]</span>
    <span class="c1">#         elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 result.name = &#39;x&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = iRat * Rat2[(igamma,ip,it)]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                     result.name = &#39;x&#39;.join([self.name,NumbToFileName(Rat2)])</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat * Rat2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># def __div__(self,Rat2):</span>
    <span class="c1">#     if type(Rat2) in SetOfRat.parentlist:</span>
    <span class="c1">#         return Rat2.__rdiv__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#         if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#             result.name = &#39;div&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                     try:</span>
    <span class="c1">#                         result[(iset,igamma,ip,it)] = iRat / Rat2[(iset,igamma,ip,it)]</span>
    <span class="c1">#                     except Exception as err:</span>
    <span class="c1">#                         if any([ibs == 0 for ibs in Rat2[(iset,igamma,ip,it)].bootvals]):</span>
    <span class="c1">#                             raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+Rat2.name + &#39; &#39;+Rat2[(iset,igamma,ip,it)].name)</span>
    <span class="c1">#         elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 result.name = &#39;div&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#                 try:</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat / Rat2[(igamma,ip,it)]</span>
    <span class="c1">#                 except Exception as err:</span>
    <span class="c1">#                     if any([ibs == 0 for ibs in Rat2[(igamma,ip,it)].bootvals]):</span>
    <span class="c1">#                         raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+Rat2.name + &#39; &#39;+Rat2[(igamma,ip,it)].name)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             if Rat2 == 0:</span>
    <span class="c1">#                 raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division&#39;)</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                     result.name = &#39;div&#39;.join([self.name,NumbToFileName(Rat2)])</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat / Rat2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># def __pow__(self,Rat2):</span>
    <span class="c1">#     if type(Rat2) in SetOfRat.parentlist:</span>
    <span class="c1">#         return Rat2.__rpow__(self)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#         if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#             result.name = &#39;pow&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat ** Rat2[(iset,igamma,ip,it)]</span>
    <span class="c1">#         elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#             for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#                 result.name = &#39;pow&#39;.join([self.name,Rat2.name])</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = iRat ** Rat2[(igamma,ip,it)]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                     result.name = &#39;pow&#39;.join([self.name,NumbToFileName(Rat2)])</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = iRat ** Rat2</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#         return result</span>


    <span class="c1"># ## Right multiplication functions</span>


    <span class="c1"># def __radd__(self,Rat2):</span>
    <span class="c1">#     result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#     if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#         result.name = &#39;+&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2[(iset,igamma,ip,it)] + iRat</span>
    <span class="c1">#     elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#         result.name = &#39;+&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             result[(iset,igamma,ip,it)] = Rat2[(igamma,ip,it)] + iRat</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             result.name = &#39;+&#39;.join([NumbToFileName(Rat2),self.name])</span>
    <span class="c1">#             for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2 + iRat</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#     return result</span>


    <span class="c1"># def __rsub__(self,Rat2):</span>
    <span class="c1">#     result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#     if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#         result.name = &#39;-&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2[(iset,igamma,ip,it)] - iRat</span>
    <span class="c1">#     elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#         result.name = &#39;-&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             result[(iset,igamma,ip,it)] = Rat2[(igamma,ip,it)] - iRat</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             result.name = &#39;-&#39;.join([NumbToFileName(Rat2),self.name])</span>
    <span class="c1">#             for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2 - iRat</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#     return result</span>

    <span class="c1"># def __rmul__(self,Rat2):</span>
    <span class="c1">#     result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#     if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#         result.name = &#39;x&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2[(iset,igamma,ip,it)] * iRat</span>
    <span class="c1">#     elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#         result.name = &#39;x&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             result[(iset,igamma,ip,it)] = Rat2[(igamma,ip,it)] * iRat</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             result.name = &#39;x&#39;.join([NumbToFileName(Rat2),self.name])</span>
    <span class="c1">#             for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2 * iRat</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#     return result</span>


    <span class="c1"># def __rdiv__(self,Rat2):</span>
    <span class="c1">#     result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#     if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#         result.name = &#39;div&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                 try:</span>
    <span class="c1">#                     result[(iset,igamma,ip,it)] = Rat2[(iset,igamma,ip,it)] / iRat</span>
    <span class="c1">#                 except Exception as err:</span>
    <span class="c1">#                     if any([ibs == 0 for ibs in iRat.bootvals]):</span>
    <span class="c1">#                         raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+self.name + &#39; &#39;+iRat.name)</span>
    <span class="c1">#     elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#         result.name = &#39;div&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             try:</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2[(igamma,ip,it)] / iRat</span>
    <span class="c1">#             except Exception as err:</span>
    <span class="c1">#                 if any([ibs == 0 for ibs in iRat.bootvals]):</span>
    <span class="c1">#                     raise ZeroDivisionError(&#39;Dividing by zero found in bootstrap division for &#39;+Rat2.name + &#39; &#39;+Rat2[(igamma,ip,it)].name)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         result.name = &#39;div&#39;.join([NumbToFileName(Rat2),self.name])</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2 / iRat</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#     return result</span>


    <span class="c1"># def __rpow__(self,Rat2):</span>
    <span class="c1">#     result = SetOfRat( cfglist=self.cfglist, InfoDict=self.InfoDict)</span>
    <span class="c1">#     if isinstance(Rat2,SetOfRat):</span>
    <span class="c1">#         result.name = &#39;pow&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             if iset in Rat2.SetRat.keys():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2[(iset,igamma,ip,it)] ** iRat</span>
    <span class="c1">#     elif isinstance(Rat2,TwoPointCorr):</span>
    <span class="c1">#         result.name = &#39;pow&#39;.join([Rat2.name,self.name])</span>
    <span class="c1">#         for (iset,igamma,ip,it,iRat) in self.items():</span>
    <span class="c1">#             result[(iset,igamma,ip,it)] = Rat2[(igamma,ip,it)] ** iRat</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             result.name = &#39;pow&#39;.join([NumbToFileName(Rat2),self.name])</span>
    <span class="c1">#             for iset,igamma,ip,it,iRat in self.items():</span>
    <span class="c1">#                 result[(iset,igamma,ip,it)] = Rat2 ** iRat</span>
    <span class="c1">#         except Exception as err:</span>
    <span class="c1">#             raise EnvironmentError(&#39;Invalid value to combine with BootStrap class&#39;)</span>
    <span class="c1">#     return result</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jack Dragos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PredefFitFuns &mdash; LQCD Analysis Codebase TF Fits documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LQCD Analysis Codebase
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LQCD Analysis Codebase</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>PredefFitFuns</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for PredefFitFuns</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">## ADD YOUR OWN FUNCTIONS HERE</span>
<span class="c1">## Just remember, function(variable, parameter) where:</span>
<span class="c1">## variable is list (for multiple dimentional fitting) of dependant variables to fit over</span>
<span class="c1">## parameter is list of parameters to extract out of fit.</span>

<span class="c1">## you can also define derivatives of the function w.r.t the paremters to feed into the fitting method.</span>
<span class="c1">## just remember to add 2 lines to DerOfFun (above)</span>

<span class="c1">## you can also add initial conditions for your function in GuessFromFun (above)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">logNA</span>

<span class="n">nM_phys</span> <span class="o">=</span> <span class="mf">939.5653</span>
<div class="viewcode-block" id="makexunit"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.makexunit">[docs]</a><span class="k">def</span> <span class="nf">makexunit</span><span class="p">(</span><span class="n">xin</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xin</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.0</span></div>


<span class="c1"># def ChiDistribution(dof,chi):</span>
<span class="c1">#     return (np.exp(-chi/2.)*(chi**((dof/2.) - 1)))/(gamma(dof/2.)*2**(dof/2.))</span>


<div class="viewcode-block" id="Ratio"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Ratio">[docs]</a><span class="k">def</span> <span class="nf">Ratio</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>
    <span class="c1"># return a[1]</span>

<div class="viewcode-block" id="RatioDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.RatioDer">[docs]</a><span class="k">def</span> <span class="nf">RatioDer</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span></div>

<div class="viewcode-block" id="eyeFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.eyeFun">[docs]</a><span class="k">def</span> <span class="nf">eyeFun</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="eyeFunDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.eyeFunDer">[docs]</a><span class="k">def</span> <span class="nf">eyeFunDer</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span></div>


<span class="c1"># def IntChiDist(dof,alpha,chiList):</span>
<span class="c1">#     # chiList = np.append(chiList,chiList[-1]*10)</span>
<span class="c1">#     # if alpha == 0.5:</span>
<span class="c1">#     #     for ichi,ifun in zip(chiList,ChiDistribution(dof,np.array(chiList))):</span>
<span class="c1">#     #         print ichi/dof, ifun</span>
<span class="c1">#     for ichi,chival in enumerate(chiList):</span>
<span class="c1">#         intval = integrate.simps(ChiDistribution(dof,np.array(chiList[ichi:])),chiList[ichi:])</span>
<span class="c1">#         if intval &lt; alpha:</span>
<span class="c1">#             return chiList[ichi]</span>
<span class="c1">#     return 1000.0</span>

<span class="c1"># def AlphaVsChiDOF(dof):</span>
<span class="c1">#     alphalist = np.arange(0.01,1.01,0.01)</span>
<span class="c1">#     chiList = np.arange(0.01,100.1,0.01)</span>
<span class="c1">#     chinu = []</span>
<span class="c1">#     for ialpha in alphalist:</span>
<span class="c1">#         chinu.append(IntChiDist(dof,ialpha,chiList))</span>
<span class="c1">#     return np.array(chinu)/dof,alphalist</span>

<div class="viewcode-block" id="Chi_Prop_Fit"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Chi_Prop_Fit">[docs]</a><span class="k">def</span> <span class="nf">Chi_Prop_Fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Chi_Prop_Fit_2exp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Chi_Prop_Fit_2exp">[docs]</a><span class="k">def</span> <span class="nf">Chi_Prop_Fit_2exp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="c3FitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">tf</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tf</span></div>

<div class="viewcode-block" id="c3FFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">tf</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">tf</span><span class="p">,</span><span class="n">tf</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3FitFun_log"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun_log">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun_log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>  <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">tf</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tf</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3FFDer_log"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer_log">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer_log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">tf</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">tf</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tf</span><span class="p">)]</span></div>

<div class="viewcode-block" id="c3FitFun_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span></div>

<div class="viewcode-block" id="c3FFDer_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3FitFun_nosqrt_log"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun_nosqrt_log">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun_nosqrt_log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3FFDer_nosqrt_log"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer_nosqrt_log">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer_nosqrt_log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span></div>

<div class="viewcode-block" id="c3FitFun_V2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun_V2">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun_V2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">tf</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tf</span></div>

<div class="viewcode-block" id="c3FFDer_V2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer_V2">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer_V2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">tf</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">tf</span><span class="p">,</span><span class="n">tf</span><span class="p">]</span></div>


<div class="viewcode-block" id="c3PolyFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="c3PFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span></div>

<div class="viewcode-block" id="c3PolyFun2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun2">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3PFDer2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer2">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3PolyFun3"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun3">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span> <span class="n">p2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3PFDer3"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer3">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span></div>


<div class="viewcode-block" id="c3PolyFun_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3PFDer_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3PolyFun2_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun2_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun2_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3PFDer2_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer2_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer2_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3PolyFun3_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PolyFun3_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PolyFun3_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="n">p0</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># return 1+p0*x[0]**2 + p1*x[0]**4+ p2*x[0]**6</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span> <span class="n">p2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3PFDer3_skip1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3PFDer3_skip1">[docs]</a><span class="k">def</span> <span class="nf">c3PFDer3_skip1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># try:</span>
    <span class="c1">#     p0,p1,p2 = np.exp(p[0]),np.exp(p[1]),np.exp(p[2])</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     p0,p1,p2 = p[0].Exp(),p[1].Exp(),p[2].Exp()</span>
    <span class="c1"># return [p0*x[0]**2,p1*x[0]**4,p2*x[0]**6]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span><span class="p">]</span></div>

<span class="n">l8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<div class="viewcode-block" id="c3FitFun_NoA"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FitFun_NoA">[docs]</a><span class="k">def</span> <span class="nf">c3FitFun_NoA</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">l8</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">logx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span><span class="o">-</span><span class="n">l8</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">p0</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">p0</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">+</span> <span class="n">p0</span><span class="o">/</span><span class="p">(</span><span class="n">logx</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span></div>

<div class="viewcode-block" id="c3FFDer_NoA"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3FFDer_NoA">[docs]</a><span class="k">def</span> <span class="nf">c3FFDer_NoA</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">l8</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">logx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span><span class="o">-</span><span class="n">l8</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">logx</span><span class="p">),</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">logx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3ExpFitFun2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ExpFitFun2">[docs]</a><span class="k">def</span> <span class="nf">c3ExpFitFun2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">/</span><span class="mf">2.</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span></div>

<div class="viewcode-block" id="c3EFFDer2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3EFFDer2">[docs]</a><span class="k">def</span> <span class="nf">c3EFFDer2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3ExpFitFun2_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ExpFitFun2_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3ExpFitFun2_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span></div>

<div class="viewcode-block" id="c3EFFDer2_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3EFFDer2_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3EFFDer2_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">,(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span><span class="p">]</span></div>

<div class="viewcode-block" id="c3ExpFitFun3_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ExpFitFun3_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3ExpFitFun3_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span><span class="o">/</span><span class="mf">3.</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span><span class="o">/</span><span class="mf">3.</span></div>

<div class="viewcode-block" id="c3EFFDer3_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3EFFDer3_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3EFFDer3_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span>
                <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span>
                <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">]</span></div>


<div class="viewcode-block" id="c3ExpFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ExpFitFun">[docs]</a><span class="k">def</span> <span class="nf">c3ExpFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span></div>

<div class="viewcode-block" id="c3EFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3EFFDer">[docs]</a><span class="k">def</span> <span class="nf">c3EFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span></div>

<div class="viewcode-block" id="c3ExpFitFun_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ExpFitFun_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3ExpFitFun_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span></div>

<div class="viewcode-block" id="c3EFFDer_nosqrt"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3EFFDer_nosqrt">[docs]</a><span class="k">def</span> <span class="nf">c3EFFDer_nosqrt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">]</span></div>


<div class="viewcode-block" id="Chi_Prop_Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Chi_Prop_Der">[docs]</a><span class="k">def</span> <span class="nf">Chi_Prop_Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>

<div class="viewcode-block" id="Chi_Prop_Der_2exp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Chi_Prop_Der_2exp">[docs]</a><span class="k">def</span> <span class="nf">Chi_Prop_Der_2exp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="p">,(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
                            <span class="p">,(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>


<div class="viewcode-block" id="Alpha_Prop_Fit"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Fit">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>


<div class="viewcode-block" id="Alpha_Prop_Fit_plin"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Fit_plin">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Fit_plin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Tf</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>



<div class="viewcode-block" id="Alpha_Prop_Fit_2exp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Fit_2exp">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Fit_2exp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Tfmint</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># TminTf = x[2]-x[1]</span>
    <span class="c1"># try:</span>
    <span class="c1">#     return p[0] +   p[1]*((-p[2]*TminTf).Exp()-(-p[2]*Tfmint).Exp()) + \</span>
    <span class="c1">#                     p[3]*((-p[4]*TminTf).Exp()-(-p[4]*Tfmint).Exp())</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     return p[0] +   p[1]*(np.exp(-p[2]*TminTf) - np.exp(-p[2]*Tfmint)) + \</span>
    <span class="c1">#                     p[3]*(np.exp(-p[4]*TminTf) - np.exp(-p[4]*Tfmint))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>   <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> \
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>   <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span> <span class="o">+</span> \
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span></div>

<div class="viewcode-block" id="Alpha_Prop_Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Der">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span></div>


<div class="viewcode-block" id="Alpha_Prop_Der_plin"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Der_plin">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Der_plin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Tf</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="o">-</span><span class="n">Tf</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">),</span>
                <span class="o">-</span><span class="n">Tf</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tf</span><span class="p">),</span>
                <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span></div>


<div class="viewcode-block" id="Alpha_Prop_Der_2exp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Alpha_Prop_Der_2exp">[docs]</a><span class="k">def</span> <span class="nf">Alpha_Prop_Der_2exp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Tfmint</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># TminTf = x[2]-x[1]</span>
    <span class="c1"># try:</span>
    <span class="c1">#     return [x[0]/x[0],</span>
    <span class="c1">#             (-p[2]*TminTf).Exp()-(-p[2]*Tfmint).Exp(),</span>
    <span class="c1">#             TminTf*p[1]*(-p[2]*TminTf).Exp()+Tfmint*p[1]*(-p[2]*Tfmint).Exp(),</span>
    <span class="c1">#             (-p[4]*TminTf).Exp()-(-p[4]*Tfmint).Exp(),</span>
    <span class="c1">#             TminTf*p[3]*(-p[4]*TminTf).Exp()+Tfmint*p[3]*(-p[4]*Tfmint).Exp()]</span>
    <span class="c1"># except Exception as err:</span>
    <span class="c1">#     return [x[0]/x[0],</span>
    <span class="c1">#             (np.exp(-p[2]*TminTf) - np.exp(-p[2]*Tfmint)),</span>
    <span class="c1">#             TminTf*p[1]*np.exp(-p[2]*TminTf) +Tfmint*p[1]*np.exp(-p[2]*Tfmint),</span>
    <span class="c1">#             (np.exp(-p[3]*TminTf) - np.exp(-p[3]*Tfmint)),</span>
    <span class="c1">#             TminTf*p[3]*np.exp(-p[4]*TminTf) +Tfmint*p[3]*np.exp(-p[4]*Tfmint)]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="o">-</span><span class="n">Tfmint</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="o">-</span><span class="n">Tfmint</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">),</span>
                <span class="o">-</span><span class="n">Tfmint</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">),</span>
                <span class="o">-</span><span class="n">Tfmint</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Tfmint</span><span class="p">)]</span></div>


<span class="c1">## only difference here is that the current insersion time is included as x[0]</span>
<div class="viewcode-block" id="RF_Prop_Fit"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.RF_Prop_Fit">[docs]</a><span class="k">def</span> <span class="nf">RF_Prop_Fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="RF_Prop_Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.RF_Prop_Der">[docs]</a><span class="k">def</span> <span class="nf">RF_Prop_Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span></div>


<div class="viewcode-block" id="CreateFFO"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.CreateFFO">[docs]</a><span class="k">def</span> <span class="nf">CreateFFO</span><span class="p">(</span><span class="n">thislen</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">FormFactorO</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">ip</span><span class="o">*</span><span class="n">ix</span> <span class="k">for</span> <span class="n">ip</span><span class="p">,</span><span class="n">ix</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">thislen</span><span class="p">],</span><span class="n">x</span><span class="p">[:</span><span class="n">thislen</span><span class="p">])])</span>
    <span class="k">def</span> <span class="nf">FormFactorODer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="n">thislen</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">FormFactorO</span><span class="p">,</span> <span class="n">FormFactorODer</span></div>

<div class="viewcode-block" id="ParmDivX"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ParmDivX">[docs]</a><span class="k">def</span> <span class="nf">ParmDivX</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span></div>

<div class="viewcode-block" id="ParmDivXDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ParmDivXDer">[docs]</a><span class="k">def</span> <span class="nf">ParmDivXDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span></div>

<span class="c1">## Sigma/(1/m_u + 1/m_d + 1/m_s) = Sigma/(2/m_ud + 1/m_s)</span>
<div class="viewcode-block" id="Chipt_Chit"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.Chipt_Chit">[docs]</a><span class="k">def</span> <span class="nf">Chipt_Chit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">sum_part</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sum_part</span><span class="o">**-</span><span class="mi">1</span></div>

<span class="c1">## A e^(-mt) + B(1-e^(-mt))</span>
<div class="viewcode-block" id="RandTFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.RandTFitFun">[docs]</a><span class="k">def</span> <span class="nf">RandTFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">thisexp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">thisexp</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">thisexp</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">thisexp</span><span class="p">)</span></div>


<div class="viewcode-block" id="ChitFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ChitFitFun">[docs]</a><span class="k">def</span> <span class="nf">ChitFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">Denom</span></div>

<div class="viewcode-block" id="ChitFitFunDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ChitFitFunDer">[docs]</a><span class="k">def</span> <span class="nf">ChitFitFunDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Denom</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Denom</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Denom</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span></div>

<span class="c1">## A*x*exp(-m*x)</span>
<div class="viewcode-block" id="A_x_exp_minus_m_x"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.A_x_exp_minus_m_x">[docs]</a><span class="k">def</span> <span class="nf">A_x_exp_minus_m_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span></div>

<span class="c1">## broken for some reason</span>
<div class="viewcode-block" id="ParmDivXP"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ParmDivXP">[docs]</a><span class="k">def</span> <span class="nf">ParmDivXP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="ParmDivXPDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ParmDivXPDer">[docs]</a><span class="k">def</span> <span class="nf">ParmDivXPDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span></div>

<div class="viewcode-block" id="DPfitfun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfun">[docs]</a><span class="k">def</span> <span class="nf">DPfitfun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="DPfitfunDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfunDer">[docs]</a><span class="k">def</span> <span class="nf">DPfitfunDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># return [1/((1+(x[0]/p[1]))**2), (-2*p[0]*p[1]**2)/((x[0]+p[1])**3)]</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">3</span><span class="p">)]</span></div>

<div class="viewcode-block" id="DPfitfunOnePar"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfunOnePar">[docs]</a><span class="k">def</span> <span class="nf">DPfitfunOnePar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="DPfitfunOneParDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfunOneParDer">[docs]</a><span class="k">def</span> <span class="nf">DPfitfunOneParDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1"># return [1/((1+(x[0]/p[1]))**2), (-2*p[0]*p[1]**2)/((x[0]+p[1])**3)]</span>
    <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">3</span><span class="p">)]</span></div>

<div class="viewcode-block" id="DPfitfun2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfun2">[docs]</a><span class="k">def</span> <span class="nf">DPfitfun2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span></div>

<div class="viewcode-block" id="DPfitfun2Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.DPfitfun2Der">[docs]</a><span class="k">def</span> <span class="nf">DPfitfun2Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)]</span></div>

<div class="viewcode-block" id="FormFactorO1"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO1">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO1Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO1Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO1Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO2">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO2Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO2Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO2Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO3"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO3">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO3Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO3Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO3Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO4"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO4">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO4Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO4Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO4Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO5"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO5">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO5</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO5Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO5Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO5Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO6"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO6">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO6</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO6Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO6Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO6Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO7"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO7">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO7</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO7Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO7Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO7Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span></div>

<div class="viewcode-block" id="FormFactorO8"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO8">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO8</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></div>
<div class="viewcode-block" id="FormFactorO8Der"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.FormFactorO8Der">[docs]</a><span class="k">def</span> <span class="nf">FormFactorO8Der</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span><span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span></div>

<span class="n">FormList</span> <span class="o">=</span> <span class="p">[</span><span class="n">FormFactorO8</span><span class="p">,</span>
            <span class="n">FormFactorO7</span><span class="p">,</span>
            <span class="n">FormFactorO6</span><span class="p">,</span>
            <span class="n">FormFactorO5</span><span class="p">,</span>
            <span class="n">FormFactorO4</span><span class="p">,</span>
            <span class="n">FormFactorO3</span><span class="p">,</span>
            <span class="n">FormFactorO2</span><span class="p">,</span>
            <span class="n">FormFactorO1</span><span class="p">]</span>


<div class="viewcode-block" id="ConstantFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ConstantFitFun">[docs]</a><span class="k">def</span> <span class="nf">ConstantFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="ConstFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ConstFFDer">[docs]</a><span class="k">def</span> <span class="nf">ConstFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>



<div class="viewcode-block" id="CreateOORFF"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.CreateOORFF">[docs]</a><span class="k">def</span> <span class="nf">CreateOORFF</span><span class="p">(</span><span class="n">Const</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">OneOnRootNFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Const</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">OneOnRootNFitFun</span></div>

<div class="viewcode-block" id="OORNFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.OORNFFDer">[docs]</a><span class="k">def</span> <span class="nf">OORNFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mf">2.</span><span class="p">))]</span></div>

<span class="c1"># def SchiffFitFun(x,p):</span>
<span class="c1">#     return p[0]*np.array(x[0])**2+p[1] + p[2]*np.array(x[1])</span>
<span class="c1">#</span>
<span class="c1"># def SchiffFFDer(x,p):</span>
<span class="c1">#     return [np.array(x[0])**2,makexunit(x[0]),np.array(x[1])]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># def SchiffFitFun(x,p):</span>
<span class="c1">#     return p[0]*np.array(x[0])**2 + p[1]*np.array(x[1]) + p[2]*np.array(x[1])**2</span>
<span class="c1">#</span>
<span class="c1"># def SchiffFFDer(x,p):</span>
<span class="c1">#     return [np.array(x[0])**2,np.array(x[1]),np.array(x[1])**2]</span>
<span class="c1"># def SchiffFitFun(x,p):</span>
<span class="c1">#     x = np.array(x)</span>
<span class="c1">#     return p[0]*x[0]**2 + p[1]*x[1]**2 + p[2]*np.log(x[1]**2)*x[1]**2</span>
<span class="c1">#</span>
<span class="c1"># def SchiffFFDer(x,p):</span>
<span class="c1">#     x = np.array(x)</span>
<span class="c1">#     return [x[0]**2,x[1]**2,np.log(x[1]**2)*x[1]**2]</span>

<div class="viewcode-block" id="SchiffFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SchiffFitFun">[docs]</a><span class="k">def</span> <span class="nf">SchiffFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="SchiffFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SchiffFFDer">[docs]</a><span class="k">def</span> <span class="nf">SchiffFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span></div>

<div class="viewcode-block" id="SchiffFitFun_noa"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SchiffFitFun_noa">[docs]</a><span class="k">def</span> <span class="nf">SchiffFitFun_noa</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="SchiffFFDer_noa"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SchiffFFDer_noa">[docs]</a><span class="k">def</span> <span class="nf">SchiffFFDer_noa</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span></div>

<div class="viewcode-block" id="c3ContFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ContFitFun">[docs]</a><span class="k">def</span> <span class="nf">c3ContFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="c3ContFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.c3ContFFDer">[docs]</a><span class="k">def</span> <span class="nf">c3ContFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span></div>

<div class="viewcode-block" id="hx_fun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.hx_fun">[docs]</a><span class="k">def</span> <span class="nf">hx_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">out</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">out</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">out</span></div>

<div class="viewcode-block" id="fullq2FitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.fullq2FitFun">[docs]</a><span class="k">def</span> <span class="nf">fullq2FitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="c1">## x[0] is q^2, x[1] is (m_\pi)^2</span>
    <span class="c1">## both must be in same units, I suggest GeV!</span>
    <span class="c1">## equation 7 in notes</span>
    <span class="n">term_2</span> <span class="o">=</span> <span class="n">hx_fun</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">5</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span><span class="n">term_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="fullq2FFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.fullq2FFDer">[docs]</a><span class="k">def</span> <span class="nf">fullq2FFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">term_2</span> <span class="o">=</span> <span class="n">hx_fun</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">5</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span><span class="n">term_2</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>

<div class="viewcode-block" id="LinearFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinearFitFun">[docs]</a><span class="k">def</span> <span class="nf">LinearFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="LinFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinFFDer">[docs]</a><span class="k">def</span> <span class="nf">LinFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>


<div class="viewcode-block" id="LinearFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinearFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">LinearFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="LinFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">LinFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span></div>

<div class="viewcode-block" id="SqPlLogFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SqPlLogFitFun">[docs]</a><span class="k">def</span> <span class="nf">SqPlLogFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span></div>

<div class="viewcode-block" id="SqPlLogFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SqPlLogFFDer">[docs]</a><span class="k">def</span> <span class="nf">SqPlLogFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)]</span></div>


<div class="viewcode-block" id="SqPlLogFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SqPlLogFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">SqPlLogFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span></div>

<div class="viewcode-block" id="SqPlLogFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SqPlLogFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">SqPlLogFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)]</span></div>

<div class="viewcode-block" id="SquaredFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SquaredFitFun">[docs]</a><span class="k">def</span> <span class="nf">SquaredFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="SquaredFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SquaredFFDer">[docs]</a><span class="k">def</span> <span class="nf">SquaredFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>


<div class="viewcode-block" id="SquaredFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SquaredFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">SquaredFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span></div>

<div class="viewcode-block" id="SquaredFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.SquaredFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">SquaredFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContPlLogFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">),</span><span class="n">this_a</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContPlLogFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">),</span><span class="n">this_a</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContPlLogFitFun_x0_dN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_dN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1">## physical neutron mass = 939.5653 MeV</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_dN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_dN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span><span class="n">this_a</span><span class="p">]</span></div>

<span class="c1">## third dim &gt; 0 means neutron, &lt; 0 means proton</span>
<div class="viewcode-block" id="ContPlLogFitFun_NP_nompi3"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_NP_nompi3">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_NP_nompi3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">##neutron case</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_dN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_dN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]]))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_NP_nompi3"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_NP_nompi3">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_NP_nompi3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">out_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span><span class="o">-</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">##neutron case</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_dN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_dN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_list</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_dN</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="ContPlLogFitFun_x0_N"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_N">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1">## physical neutron mass = nM_phys MeV</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nM_phys</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">log_term</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_N"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_N">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nM_phys</span><span class="p">)))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="o">-</span><span class="n">this_x</span><span class="o">*</span><span class="n">log_term</span><span class="p">,</span><span class="n">this_a</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContPlLogFitFun_x0_P"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_P">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1">## physical neutron mass = nM_phys MeV</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">log_term</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_P"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_P">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">nM_phys</span><span class="p">)))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">log_term</span><span class="p">,</span><span class="n">this_a</span><span class="p">]</span></div>



<span class="c1">## third dim &gt; 0 means neutron, &lt; 0 means proton</span>
<div class="viewcode-block" id="ContPlLogFitFun_NP"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_NP">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_NP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_N</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_P</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]]))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_NP"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_NP">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_NP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">out_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span><span class="o">-</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_list</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">output</span></div>

<span class="c1">## third dim &gt; 0 means neutron, &lt; 0 means proton</span>
<div class="viewcode-block" id="ContPlLogFitFun_NP_mC2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_NP_mC2">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_NP_mC2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_N</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_P</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]]))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_NP_mC2"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_NP_mC2">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_NP_mC2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">out_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span><span class="o">-</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_list</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="ContPlLogFitFun_x0_N_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_N_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_N_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1">## mpi / mN</span>
    <span class="n">this_mrat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_mrat</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">log_term</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_N_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_N_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_N_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mrat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_mrat</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="o">-</span><span class="n">this_x</span><span class="o">*</span><span class="n">log_term</span><span class="p">,</span><span class="n">this_a</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContPlLogFitFun_x0_P_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_P_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_P_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1">## physical neutron mass = this_mN MeV</span>
    <span class="n">this_mrat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_mrat</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">log_term</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_P_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_P_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_P_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mrat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_mrat</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">log_term</span><span class="p">,</span><span class="n">this_a</span><span class="p">]</span></div>

<span class="c1">## third dim &gt; 0 means neutron, &lt; 0 means proton</span>
<span class="c1">## forth dim is nucleon mass in same units as pion mass</span>
<div class="viewcode-block" id="ContPlLogFitFun_NP_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_NP_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_NP_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span><span class="p">,</span><span class="n">ix3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_N_latmN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix3</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ContPlLogFitFun_x0_P_latmN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix3</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]]))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_N_latmN</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContPlLogFitFun_x0_P_latmN</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_NP_latmN"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_NP_latmN">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_NP_latmN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span><span class="p">,</span><span class="n">ix3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
            <span class="n">out_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span><span class="o">-</span><span class="n">makexunit</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">ix2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N_latmN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix3</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
            <span class="k">elif</span> <span class="n">ix2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">out_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">out_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P_latmN</span><span class="p">([</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix3</span><span class="p">],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out_list</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ContPlLogFFDer_x0_N_latmN</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">output</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContPlLogFFDer_x0_P_latmN</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="ContFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFitFun">[docs]</a><span class="k">def</span> <span class="nf">ContFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFFDer">[docs]</a><span class="k">def</span> <span class="nf">ContFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">this_a</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">ContFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span></div>

<div class="viewcode-block" id="ContFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">ContFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_a</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContPlLogFitFun_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_mix">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">this_mix</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_mix">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">),</span><span class="n">this_a</span><span class="p">,</span><span class="n">this_mix</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContPlLogFitFun_x0_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFitFun_x0_mix">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFitFun_x0_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">this_mix</span></div>

<div class="viewcode-block" id="ContPlLogFFDer_x0_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContPlLogFFDer_x0_mix">[docs]</a><span class="k">def</span> <span class="nf">ContPlLogFFDer_x0_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this_x</span><span class="p">),</span><span class="n">this_a</span><span class="p">,</span><span class="n">this_mix</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContFitFun_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFitFun_mix">[docs]</a><span class="k">def</span> <span class="nf">ContFitFun_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">this_mix</span></div>

<div class="viewcode-block" id="ContFFDer_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFFDer_mix">[docs]</a><span class="k">def</span> <span class="nf">ContFFDer_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">this_a</span><span class="p">,</span><span class="n">this_mix</span><span class="p">]</span></div>


<div class="viewcode-block" id="ContFitFun_x0_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFitFun_x0_mix">[docs]</a><span class="k">def</span> <span class="nf">ContFitFun_x0_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">this_x</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">this_mix</span></div>

<div class="viewcode-block" id="ContFFDer_x0_mix"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.ContFFDer_x0_mix">[docs]</a><span class="k">def</span> <span class="nf">ContFFDer_x0_mix</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">this_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">this_mix</span> <span class="o">=</span> <span class="n">this_a</span> <span class="o">*</span> <span class="n">this_x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">this_x</span><span class="p">,</span><span class="n">this_a</span><span class="p">,</span><span class="n">this_mix</span><span class="p">]</span></div>




<div class="viewcode-block" id="LogFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LogFitFun">[docs]</a><span class="k">def</span> <span class="nf">LogFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="LogFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LogFFDer">[docs]</a><span class="k">def</span> <span class="nf">LogFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>

<div class="viewcode-block" id="LogFitFun_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LogFitFun_x0">[docs]</a><span class="k">def</span> <span class="nf">LogFitFun_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="LogFFDer_x0"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LogFFDer_x0">[docs]</a><span class="k">def</span> <span class="nf">LogFFDer_x0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">logNA</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>


<div class="viewcode-block" id="LinearFF_2D"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinearFF_2D">[docs]</a><span class="k">def</span> <span class="nf">LinearFF_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="LinFFDer_2D"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.LinFFDer_2D">[docs]</a><span class="k">def</span> <span class="nf">LinFFDer_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">makexunit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>

<div class="viewcode-block" id="TestTwoVarFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.TestTwoVarFitFun">[docs]</a><span class="k">def</span> <span class="nf">TestTwoVarFitFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span></div>

<div class="viewcode-block" id="TestTwoVarFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.TestTwoVarFFDer">[docs]</a><span class="k">def</span> <span class="nf">TestTwoVarFFDer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span></div>

<span class="c1">##ONE STATE FIT FUNCTIONS###</span>

<div class="viewcode-block" id="C2OSFAntiper"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OSFAntiper">[docs]</a><span class="k">def</span> <span class="nf">C2OSFAntiper</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">tsink</span><span class="p">):</span>
    <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Tmint</span> <span class="o">=</span> <span class="n">tsink</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">A0</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span></div>

<div class="viewcode-block" id="C2OSFAntiperDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OSFAntiperDer">[docs]</a><span class="k">def</span> <span class="nf">C2OSFAntiperDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">tsink</span><span class="p">):</span>
    <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Tmint</span> <span class="o">=</span> <span class="n">tsink</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">)),</span><span class="o">-</span><span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">Tmint</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">))]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[((</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()),</span><span class="o">-</span><span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span><span class="n">Tmint</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">Tmint</span><span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">())]</span></div>


<div class="viewcode-block" id="C2OneStateFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OneStateFitFun">[docs]</a><span class="k">def</span> <span class="nf">C2OneStateFitFun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="C2OneStateFitFunNoExp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OneStateFitFunNoExp">[docs]</a><span class="k">def</span> <span class="nf">C2OneStateFitFunNoExp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="C2OSFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OSFFDer">[docs]</a><span class="k">def</span> <span class="nf">C2OSFFDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Ep</span><span class="o">*</span><span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Ep</span><span class="o">*</span><span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="C2OSFFNoExpDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2OSFFNoExpDer">[docs]</a><span class="k">def</span> <span class="nf">C2OSFFNoExpDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">A0</span><span class="p">,</span><span class="n">Ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Ep</span><span class="o">*</span><span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Ep</span><span class="o">*</span><span class="n">A0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Ep</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()]</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="C3OneStateFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3OneStateFitFun">[docs]</a><span class="k">def</span> <span class="nf">C3OneStateFitFun</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">FitEp0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp0</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="C3OneStateFitFunNoExp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3OneStateFitFunNoExp">[docs]</a><span class="k">def</span> <span class="nf">C3OneStateFitFunNoExp</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">FitEp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp0</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="C3OSFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3OSFFDer">[docs]</a><span class="k">def</span> <span class="nf">C3OSFFDer</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">FitEp0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp0</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span></div>


<span class="c1">##Momenta TwoStateFit##</span>

<div class="viewcode-block" id="C2TwoStateFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TwoStateFitFun">[docs]</a><span class="k">def</span> <span class="nf">C2TwoStateFitFun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Am</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
        <span class="n">output</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="C2TwoStateFitFunNoExp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TwoStateFitFunNoExp">[docs]</a><span class="k">def</span> <span class="nf">C2TwoStateFitFunNoExp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Am</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span></div>

<div class="viewcode-block" id="C2TwoStateFitFunCM"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TwoStateFitFunCM">[docs]</a><span class="k">def</span> <span class="nf">C2TwoStateFitFunCM</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Alen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">Alen</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">Alen</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">smpick</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">Am</span><span class="p">[</span><span class="n">smpick</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="p">[</span><span class="n">smpick</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="C2TwoStateFitFunCMNoExp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TwoStateFitFunCMNoExp">[docs]</a><span class="k">def</span> <span class="nf">C2TwoStateFitFunCMNoExp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Alen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">[:</span><span class="n">Alen</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">Alen</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">smpick</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">Am</span><span class="p">[</span><span class="n">smpick</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="p">[</span><span class="n">smpick</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="C2TSFLineFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TSFLineFun">[docs]</a><span class="k">def</span> <span class="nf">C2TSFLineFun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Am</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></div>


<span class="c1"># def C2TSFFCMDer(t,p):</span>
<span class="c1">#     Alen = (len(p)-2)/2</span>
<span class="c1">#     Am,Amp,m,dm = np.array(p[:Alen]),np.array(p[Alen:-2]),np.exp(p[-2]),np.exp(p[-1])</span>
<span class="c1">#     smpick = map(int,t[1])</span>
<span class="c1">#     pder = []</span>
<span class="c1">#     for ism,Ami in enumerate(Am): # Am derivatives</span>
<span class="c1">#         delta = VecDelta(smpick,ism)</span>
<span class="c1">#         pder.append(delta*(np.exp(-m*t[0]) + Amp[smpick]*np.exp(-(m+dm)*t[0])))</span>
<span class="c1">#     for ism,Ampi in enumerate(Amp): # Amp derivatives</span>
<span class="c1">#         delta = VecDelta(smpick,ism)</span>
<span class="c1">#         pder.append(delta*Am[smpick]*np.exp(-(m+dm)*t[0]))</span>
<span class="c1">#     pder.append(-t[0]*m*Am[smpick]*(np.exp(-m*t[0]) + Amp[smpick]*np.exp(-(m+dm)*t[0]))) #mass</span>
<span class="c1">#     pder.append(-t[0]*dm*Am[smpick]*Amp[smpick]*np.exp(-(m+dm)*t[0])) #Dm</span>
<span class="c1">#     return pder</span>

<div class="viewcode-block" id="C2TSFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TSFFDer">[docs]</a><span class="k">def</span> <span class="nf">C2TSFFDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">pder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1">## dC/dAm</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Am</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1">## dC/dAmp</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="c1"># mass</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dm</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># Dm</span>
        <span class="k">return</span> <span class="n">pder</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">(),</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="n">pder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span><span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1">## dC/dAm</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1">## dC/dAmp</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()))</span> <span class="c1"># mass</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dm</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1"># Dm</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">pder</span><span class="p">:</span> <span class="n">ip</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pder</span></div>


<div class="viewcode-block" id="C2TSFFNoExpDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C2TSFFNoExpDer">[docs]</a><span class="k">def</span> <span class="nf">C2TSFFNoExpDer</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Am</span><span class="p">,</span><span class="n">Amp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">dm</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">pder</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span> <span class="c1">## dC/dAm</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1">## dC/dAmp</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="c1"># mass</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="n">Amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># Dm</span>
        <span class="k">return</span> <span class="n">pder</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1">## dC/dAm</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1">## dC/dAmp</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">()))</span> <span class="c1"># mass</span>
        <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Am</span><span class="o">*</span><span class="n">Amp</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="n">dm</span><span class="p">)</span><span class="o">*-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span> <span class="c1"># Dm</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">pder</span><span class="p">:</span> <span class="n">ip</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pder</span></div>


<div class="viewcode-block" id="C3TSFLineFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3TSFLineFun">[docs]</a><span class="k">def</span> <span class="nf">C3TSFLineFun</span><span class="p">(</span><span class="n">Vals</span><span class="p">,</span><span class="n">thistcurr</span><span class="p">,</span><span class="n">thistsink</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># FitA1 = Vals[1]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">FitDm</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">FitB00</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">FitB10</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="c1"># FitB01 = Vals[6]</span>
    <span class="n">FitB11</span> <span class="o">=</span> <span class="n">Vals</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">thistsink</span><span class="p">)</span> <span class="o">*</span>
               <span class="p">(</span><span class="n">FitB00</span> <span class="o">+</span> <span class="n">FitB10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">thistcurr</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">thistsink</span><span class="o">-</span><span class="n">thistcurr</span><span class="p">)))</span> <span class="o">+</span>
                <span class="n">FitB11</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">thistsink</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">output</span></div>



<div class="viewcode-block" id="C3MomTwoStateFitFun"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3MomTwoStateFitFun">[docs]</a><span class="k">def</span> <span class="nf">C3MomTwoStateFitFun</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># FitA1 = tf[3]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="c1"># FitAp1 = tf[7]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">FitDm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">FitEp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
    <span class="n">FitDEp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitEp</span> <span class="o">==</span> <span class="n">Fitm0</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitA0</span> <span class="o">==</span> <span class="n">FitAp0</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>

            <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span>
                      <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">+</span>
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span>
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
    <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="C3MomTwoStateFitFunNoExp"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3MomTwoStateFitFunNoExp">[docs]</a><span class="k">def</span> <span class="nf">C3MomTwoStateFitFunNoExp</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># FitA1 = tf[3]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="c1"># FitAp1 = tf[7]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">FitDm</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">FitEp</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">FitDEp</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitEp</span> <span class="o">==</span> <span class="n">Fitm0</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitA0</span> <span class="o">==</span> <span class="n">FitAp0</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>

            <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span>
                      <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">+</span>
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span>
                       <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span>
                        <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
    <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="C3MomTSFFDer"><a class="viewcode-back" href="../PredefFitFuns.html#PredefFitFuns.C3MomTSFFDer">[docs]</a><span class="k">def</span> <span class="nf">C3MomTSFFDer</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="n">FitA0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># FitA1 = tf[3]</span>
    <span class="n">FitAp0</span> <span class="o">=</span> <span class="n">tf</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="c1"># FitAp1 = tf[7]</span>
    <span class="n">Fitm0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">FitDm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">FitEp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
    <span class="n">FitDEp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
    <span class="n">unitt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitEp</span> <span class="o">==</span> <span class="n">Fitm0</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">FitA0</span> <span class="o">==</span> <span class="n">FitAp0</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">pder</span> <span class="o">=</span> <span class="p">[</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unitt</span><span class="p">)</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unitt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pder</span> <span class="o">=</span> <span class="p">[</span><span class="n">FitA0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unitt</span><span class="p">)</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">itf</span> <span class="k">for</span> <span class="n">itf</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">pder</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unitt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pder</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FitA0</span><span class="o">*</span><span class="n">FitAp0</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Fitm0</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">FitEp</span><span class="o">-</span><span class="n">Fitm0</span><span class="p">)</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="n">pder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pder</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDEp</span><span class="o">*</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">FitDm</span><span class="o">*</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">pder</span></div>



<span class="c1">## bool is whether it vanishes in chiral limit</span>
<span class="c1">## this paper  https://arxiv.org/pdf/0911.3981.pdf sais constant + log + linear</span>
<span class="n">F3ChiralLimFun</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun_x0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">SqPlLogFitFun_x0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">SqPlLogFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_x0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_x0_dN</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_x0_mix</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_mix</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_x0_mix</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_mix</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>


<span class="n">F3LatSpaceFun</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_mix</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_x0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContFitFun_x0_mix</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_mix</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_x0_dN</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F3LatSpaceFun</span><span class="p">[(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ContPlLogFitFun_x0_mix</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># F3ChiralLimFun[True] = (LinearFitFun_x0,1)</span>
<span class="c1"># F3ChiralLimFun[False] = (LinearFitFun,2)</span>
<span class="c1"># F3ChiralLimFun[True] = (LogFitFun_x0,1)</span>
<span class="c1"># F3ChiralLimFun[False] = (LogFitFun,2)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jack Dragos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
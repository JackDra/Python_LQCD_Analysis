
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SetsOfFFs &#8212; LQCD Analysis Codebase TF Fits documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">LQCD Analysis Codebase TF Fits documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for SetsOfFFs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># import matplotlib</span>
<span class="c1"># matplotlib.use(&#39;Agg&#39;) # Must be before importing matplotlib.pyplot or pylab!</span>
<span class="c1"># import matplotlib.pyplot as pl</span>
<span class="kn">import</span> <span class="nn">PlotData</span> <span class="k">as</span> <span class="nn">jpl</span>
<span class="kn">from</span> <span class="nn">NullPlotData</span> <span class="k">import</span> <span class="n">null_series</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span>

<span class="c1"># from collections import OrderedDict</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>

<span class="c1"># from MiscFuns import NumbToFileName,mkdir_p,ODNested</span>
<span class="kn">from</span> <span class="nn">MiscFuns</span> <span class="k">import</span> <span class="n">mkdir_p</span><span class="p">,</span><span class="n">op_dict</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">graphdir</span><span class="p">,</span><span class="n">defMcore</span><span class="p">,</span><span class="n">nboot</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">tflowTOLeg</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">F3ChiralLimFun</span><span class="p">,</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="n">LinearFF_2D</span><span class="p">,</span><span class="n">F3LatSpaceFun</span><span class="p">,</span><span class="n">SchiffFitFun</span>
<span class="kn">import</span> <span class="nn">FitFunctions</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">from</span> <span class="nn">MomParams</span> <span class="k">import</span> <span class="n">physcial_pion_mass</span>

<span class="kn">from</span> <span class="nn">FFSolve</span> <span class="k">import</span> <span class="n">FFEquation</span>

<span class="c1">## Move Somewhere?</span>
<span class="c1"># params = {&#39;legend.fontsize&#39;: 7,</span>
<span class="c1">#           &#39;legend.numpoints&#39;: 1,</span>
<span class="c1">#           &#39;axes.labelsize&#39; : 10,</span>
<span class="c1">#           &#39;figure.autolayout&#39;: True,</span>
<span class="c1">#           &#39;axes.grid&#39;: True,</span>
<span class="c1">#           &#39;errorbar.capsize&#39;: 5,</span>
<span class="c1">#           &#39;axes.xmargin&#39;:0.01,</span>
<span class="c1">#           &#39;axes.titlesize&#39; : 20,</span>
<span class="c1">#           &#39;axes.ymargin&#39;:0.01}</span>
<span class="c1"># pl.style.use(plot_style)</span>
<span class="c1"># pl.rcParams.update(params)</span>


<span class="n">colourset8</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;#000080&#39;</span><span class="p">,</span><span class="s1">&#39;#B22222&#39;</span><span class="p">,</span><span class="s1">&#39;#00B800&#39;</span><span class="p">,</span><span class="s1">&#39;#8B008B&#39;</span><span class="p">,</span> <span class="s1">&#39;#0000FF&#39;</span><span class="p">,</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span><span class="s1">&#39;#32CD32&#39;</span><span class="p">,</span><span class="s1">&#39;#FF0066&#39;</span><span class="p">]</span>
<span class="n">markerset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">shiftmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">shiftper</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1">##R function shift</span>
<span class="n">shiftset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ish</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">shiftmax</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">shiftset</span> <span class="o">+=</span> <span class="p">[</span><span class="o">-</span><span class="n">ish</span><span class="o">*</span><span class="n">shiftper</span><span class="p">,</span><span class="n">ish</span><span class="o">*</span><span class="n">shiftper</span><span class="p">]</span>
<span class="k">del</span> <span class="n">ish</span><span class="p">,</span> <span class="n">shiftmax</span><span class="p">,</span><span class="n">shiftper</span>



<div class="viewcode-block" id="SetOfFF"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF">[docs]</a><span class="k">class</span> <span class="nc">SetOfFF</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    FF(set) Inherits from FFSolve Class</span>

<span class="sd">    plotting parameters (Move to different file?) ####</span>

<span class="sd">    InfoDict is a list of Info dictionaries to be bassed to FFSolve:</span>
<span class="sd">    Setup to do fits taken from dictionaries within InfoDict (see FFSlove.py)</span>
<span class="sd">    Although Info[&#39;gammas&#39;] can have multiple gamma matricies,</span>
<span class="sd">    This code is only set up to take a list, where each list only has one gamma matrix in Info[&#39;gammas&#39;] ( e.g. = [&#39;g4&#39;])</span>




<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">parentlist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfglist</span><span class="o">=</span><span class="p">{},</span> <span class="n">cfglist2pt</span><span class="o">=</span><span class="p">{},</span><span class="n">InfoDict</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">setnames</span> <span class="o">=</span> <span class="p">[]):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span> <span class="o">=</span> <span class="n">cfglist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfglist2pt</span> <span class="o">=</span> <span class="n">cfglist2pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span> <span class="o">=</span> <span class="n">InfoDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/FF/&#39;</span>
        <span class="n">mkdir_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Set&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SetOfFF</span><span class="o">.</span><span class="n">instances</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">SetOfFF</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="c1"># SetOfFF.instances.append(self.name)</span>

        <span class="c1">## dictionary containing FormFactCorrs,capsize=5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">coll</span><span class="p">,</span><span class="n">syml</span><span class="p">,</span><span class="n">shiftl</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">Infol</span><span class="p">,</span><span class="n">q2l</span><span class="p">,</span><span class="n">pp2l</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">fit2ptl</span><span class="p">,</span><span class="n">fitalphal</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="c1"># fitratl = []</span>
        <span class="n">cfgl</span><span class="p">,</span><span class="n">cfgl2pt</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">FFl</span><span class="p">,</span><span class="n">ilist</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="n">fal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">setnames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">setnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">InfoDict</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">iname</span><span class="p">,</span><span class="n">idict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">setnames</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">InfoDict</span><span class="p">)):</span>
            <span class="n">Infol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">)</span>
            <span class="n">coll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colourset8</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)])</span>
            <span class="n">syml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">markerset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)])</span>
            <span class="n">shiftl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shiftset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)])</span>
            <span class="k">if</span> <span class="s1">&#39;CurrType&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;CurrType needs to be in Info Dictionaries&#39;</span><span class="p">)</span>

            <span class="c1"># if &#39;Full_Rat&#39; in idict.keys():</span>
            <span class="c1">#     frat.append(idict[&#39;Full_Rat&#39;])</span>
            <span class="c1">#     if frat[-1]:</span>
            <span class="c1">#         if &#39;FitsRFFull&#39; in idict.keys():</span>
            <span class="c1">#             fitratl.append(idict[&#39;FitsRFFull&#39;][0])</span>
            <span class="c1">#         else:</span>
            <span class="c1">#             fitratl.append(&#39;From Def&#39;)</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         if &#39;FitsRF&#39; in idict.keys():</span>
            <span class="c1">#             fitratl.append(idict[&#39;FitsRF&#39;][0])</span>
            <span class="c1">#         else:</span>
            <span class="c1">#             fitratl.append(&#39;From Def&#39;)</span>
            <span class="c1"># else:</span>
            <span class="c1">#     frat.append(False)</span>
            <span class="c1">#     if &#39;FitsRF&#39; in idict.keys():</span>
            <span class="c1">#         fitratl.append(idict[&#39;FitsRF&#39;][0])</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         fitratl.append(&#39;From Def&#39;)</span>

            <span class="k">if</span> <span class="s1">&#39;Alpha_Full&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">fal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Alpha_Full&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">fal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s1">&#39;FitsAlphaFull&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;FitsAlphaFull&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;From Def&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;FitsAlpha&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;FitsAlpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;From Def&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;FitsAlpha&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;FitsAlpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fitalphal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;From Def&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;q2list&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">q2l</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">q2l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;q2list&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;pp2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">pp2l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pp2l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;pp2&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;Fits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">fit2ptl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;Fits&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fit2ptl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;From Def&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="c1">## kappa up down (in integer form)</span>
                <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="n">thiskud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">thiskud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">this_nxyz</span> <span class="o">=</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">this_nt</span> <span class="o">=</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">this_dim</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_nxyz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_nt</span><span class="p">)</span>
                <span class="c1">## kappa strange (in integer form)</span>
                <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="n">thisks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">thisks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">kappafolder</span> <span class="o">=</span> <span class="n">this_dim</span><span class="o">+</span><span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="n">thiskud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="n">thisks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="s1">&#39;Top&#39;</span> <span class="ow">in</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;CurrType&#39;</span><span class="p">]:</span>
                    <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;_TopCharge&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;Wein&#39;</span> <span class="ow">in</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;CurrType&#39;</span><span class="p">]:</span>
                    <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;_Weinberg&#39;</span>
                <span class="c1"># print &#39;cfglist&#39;,str(idict[&#39;outdir&#39;]+kappafolder+&#39;/cfglist&#39;+fotype+&#39;.py3p&#39;)</span>
                <span class="n">cfgl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/cfglist&#39;</span><span class="o">+</span><span class="n">fotype</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cfgl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist2pt</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="c1">## kappa up down (in integer form)</span>
                <span class="k">if</span> <span class="s1">&#39;kud&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="n">thiskud</span> <span class="o">=</span> <span class="s1">&#39;kud&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">thiskud</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="c1">## kappa strange (in integer form)</span>
                <span class="k">if</span> <span class="s1">&#39;ks&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">idict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="n">thisks</span> <span class="o">=</span> <span class="s1">&#39;ks&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">thisks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">kappafolder</span> <span class="o">=</span> <span class="n">this_dim</span><span class="o">+</span><span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="n">thiskud</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kud&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="n">thisks</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ks&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="s1">&#39;Top&#39;</span> <span class="ow">in</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;CurrType&#39;</span><span class="p">]:</span>
                    <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;_TopCharge&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;Wein&#39;</span> <span class="ow">in</span> <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;CurrType&#39;</span><span class="p">]:</span>
                    <span class="n">fotype</span> <span class="o">=</span> <span class="s1">&#39;_Weinberg&#39;</span>
                <span class="c1"># print &#39;cfglist2pt&#39;,str(idict[&#39;outdir&#39;]+kappafolder+&#39;/cfglist2pt&#39;+fotype+&#39;.py3p&#39;)</span>
                <span class="n">cfgl2pt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idict</span><span class="p">[</span><span class="s1">&#39;outdir&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">kappafolder</span><span class="o">+</span><span class="s1">&#39;/cfglist2pt&#39;</span><span class="o">+</span><span class="n">fotype</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cfgl2pt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfglist2pt</span><span class="p">)</span>

            <span class="n">FFl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FFEquation</span><span class="p">(</span>  <span class="n">idict</span><span class="p">[</span><span class="s1">&#39;CurrType&#39;</span><span class="p">],</span><span class="n">q2list</span><span class="o">=</span><span class="n">q2l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">pp2list</span><span class="o">=</span><span class="p">[</span><span class="n">pp2l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                                    <span class="n">fit2pt</span><span class="o">=</span><span class="n">fit2ptl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fitAlpha</span><span class="o">=</span><span class="n">fitalphal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                    <span class="n">cfglist</span><span class="o">=</span><span class="n">cfgl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">cfglist2pt</span><span class="o">=</span><span class="n">cfgl2pt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Info</span><span class="o">=</span><span class="n">idict</span><span class="p">,</span>
                                    <span class="n">thissym</span><span class="o">=</span><span class="n">syml</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">thiscol</span><span class="o">=</span><span class="n">coll</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">thisshift</span><span class="o">=</span><span class="n">shiftl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># FFl.append(FFEquation(  idict[&#39;CurrType&#39;],q2list=q2l[-1],pp2list=[pp2l[-1]],</span>
            <span class="c1">#                         fit2pt=fit2ptl[-1],fitAlpha=fitalphal[-1],fitratio=fitratl[-1],</span>
            <span class="c1">#                         cfglist=cfgl[-1],cfglist2pt=cfgl2pt[-1], Info=idict,</span>
            <span class="c1">#                         thissym=syml[-1],thiscol=coll[-1],thisshift=shiftl[-1]))</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">FFl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">ilist</span><span class="p">:</span>
                <span class="n">FFnext</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">while</span> <span class="nb">str</span><span class="p">(</span><span class="n">FFl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FFnext</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ilist</span><span class="p">:</span>
                    <span class="n">FFnext</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">FFl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FFnext</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">FFl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># print &#39;Setting up classes for &#39; , thisFF , &#39; complete&#39;</span>
        <span class="c1"># print</span>
            <span class="c1"># print &#39;has color&#39;,thiscol , &#39;symbol &#39; , thissym , &#39;thisshift&#39;,thisshift</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ilist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">FFl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">coll</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">syml</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">shiftl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;info_dictionarie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Infol</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;q2_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">q2l</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;pp2_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pp2l</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;2pt_fit_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit2ptl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;alpha_fit_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fitalphal</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="c1"># self.SetFF.loc[:,&#39;ratio_fit_range&#39;] = pa.Series(fitratl,index=ilist)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;config_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cfgl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;config_list_2pt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cfgl2pt</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">ilist</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetFFlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">)</span>
        <span class="c1">##Implement Reading cfglist if len(cfglist) == 0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>


<div class="viewcode-block" id="SetOfFF.SetPlotParams"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.SetPlotParams">[docs]</a>    <span class="k">def</span> <span class="nf">SetPlotParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,(</span><span class="n">iset</span><span class="p">,</span><span class="n">set_series</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()):</span>
            <span class="n">thiscol</span> <span class="o">=</span> <span class="n">colourset8</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)]</span>
            <span class="n">thissym</span> <span class="o">=</span> <span class="n">markerset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)]</span>
            <span class="n">thisshift</span> <span class="o">=</span> <span class="n">shiftset</span><span class="p">[</span><span class="n">ic</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">thiscol</span> <span class="o">!=</span> <span class="n">set_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Color has changed for &#39;</span><span class="p">,</span><span class="n">iset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thissym</span> <span class="o">!=</span> <span class="n">set_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;symbol has changed for &#39;</span><span class="p">,</span><span class="n">iset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thisshift</span> <span class="o">!=</span> <span class="n">set_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shift has changed for &#39;</span><span class="p">,</span><span class="n">iset</span><span class="p">)</span>
            <span class="n">set_series</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ImportPlotParams</span><span class="p">(</span><span class="n">thiscol</span><span class="p">,</span><span class="n">thissym</span><span class="p">,</span><span class="n">thisshift</span><span class="p">)</span></div>

<div class="viewcode-block" id="SetOfFF.Write"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.Write">[docs]</a>    <span class="k">def</span> <span class="nf">Write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span></div>


<div class="viewcode-block" id="SetOfFF.SetupPickle"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.SetupPickle">[docs]</a>    <span class="k">def</span> <span class="nf">SetupPickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">defMcore</span><span class="p">,</span><span class="n">CommonRatios</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># doubling this should fix some memory issues with the calculation.</span>
        <span class="n">FFtimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Form Factor Read &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">rewrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">RatioFitList</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">Rfit_test</span><span class="p">,</span><span class="n">Rfit_test_flow</span> <span class="o">=</span> <span class="n">setdata</span><span class="o">.</span><span class="n">SetupPickle</span><span class="p">(</span> <span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="n">HardWipe</span><span class="p">,</span>
                                                            <span class="n">Mcore</span><span class="o">=</span><span class="n">Mcore</span><span class="p">,</span><span class="n">RatioFitLists</span><span class="o">=</span><span class="n">RatioFitList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CommonRatios</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Rfit_test</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, rfitindicies not found, must be from old code&#39;</span><span class="p">)</span>
                    <span class="n">setdata</span><span class="o">.</span><span class="n">SetupPickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="n">HardWipe</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">Mcore</span><span class="p">,</span>
                                        <span class="n">RatioFitLists</span><span class="o">=</span><span class="n">RatioFitList</span><span class="p">)</span>
                <span class="n">RatioFitList</span> <span class="o">=</span> <span class="n">Rfit_test</span><span class="p">,</span><span class="n">Rfit_test_flow</span>
            <span class="n">FFtimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span></div>
        <span class="c1"># for setdata in self.SetFF[&#39;FF_class&#39;].values:</span>
        <span class="c1">#     setdata.LoadPickle(DefWipe=False,HardWipe=HardWipe,Mcore=False)</span>
        <span class="c1"># self.SetPlotParams()</span>
        <span class="c1"># self.FitFFs()</span>

<div class="viewcode-block" id="SetOfFF.SolvePickle"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.SolvePickle">[docs]</a>    <span class="k">def</span> <span class="nf">SolvePickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">defMcore</span><span class="p">,</span><span class="n">CommonRatios</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># doubling this should fix some memory issues with the calculation.</span>
        <span class="n">FFtimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Form Factor Solving &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">rewrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">RatioFitList</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">Rfit_test</span><span class="p">,</span><span class="n">Rfit_test_flow</span> <span class="o">=</span> <span class="n">setdata</span><span class="o">.</span><span class="n">SolvePickle</span><span class="p">(</span> <span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="n">HardWipe</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">Mcore</span><span class="p">,</span>
                                                            <span class="n">RatioFitLists</span><span class="o">=</span><span class="n">RatioFitList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CommonRatios</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Rfit_test</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, rfitindicies not found, must be from old code&#39;</span><span class="p">)</span>
                    <span class="n">setdata</span><span class="o">.</span><span class="n">SolvePickle</span><span class="p">(</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="n">HardWipe</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">Mcore</span><span class="p">,</span>
                                        <span class="n">RatioFitLists</span><span class="o">=</span><span class="n">RatioFitList</span><span class="p">)</span>
                <span class="n">RatioFitList</span> <span class="o">=</span> <span class="n">Rfit_test</span><span class="p">,</span><span class="n">Rfit_test_flow</span>
            <span class="n">FFtimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span></div>
        <span class="c1"># for setdata in self.SetFF[&#39;FF_class&#39;].values:</span>
        <span class="c1">#     setdata.LoadPickle(DefWipe=False,HardWipe=HardWipe,Mcore=False)</span>
        <span class="c1"># self.SetPlotParams()</span>
        <span class="c1"># self.FitFFs()</span>

<div class="viewcode-block" id="SetOfFF.WipeAllFits"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.WipeAllFits">[docs]</a>    <span class="k">def</span> <span class="nf">WipeAllFits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">WipeAllFits</span><span class="p">()</span></div>


<div class="viewcode-block" id="SetOfFF.LoadPickle"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.LoadPickle">[docs]</a>    <span class="k">def</span> <span class="nf">LoadPickle</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">defMcore</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">OnlyFits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DoFits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CommonRatios</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># doubling this should fix some memory issues with the calculation.</span>
        <span class="n">FFtimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">linklist</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Form Factor Load &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">rewrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">RatioFitList</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">setdata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">setdata</span><span class="o">.</span><span class="n">LoadPickle</span><span class="p">(</span> <span class="n">DefWipe</span><span class="o">=</span><span class="n">DefWipe</span><span class="p">,</span><span class="n">HardWipe</span><span class="o">=</span><span class="n">HardWipe</span><span class="p">,</span><span class="n">Mcore</span><span class="o">=</span><span class="n">Mcore</span><span class="p">,</span>
                                <span class="n">OnlyFits</span><span class="o">=</span><span class="n">OnlyFits</span><span class="p">,</span><span class="n">DoFits</span><span class="o">=</span><span class="n">DoFits</span><span class="p">,</span><span class="n">RatioFitLists</span><span class="o">=</span><span class="n">RatioFitList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CommonRatios</span><span class="p">:</span>
                <span class="n">RatioFitList</span> <span class="o">=</span> <span class="n">setdata</span><span class="o">.</span><span class="n">RfitIndicies</span><span class="p">,</span><span class="n">setdata</span><span class="o">.</span><span class="n">RfitIndicies_flow</span>
            <span class="n">FFtimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">()</span>
        <span class="c1"># for setdata in self.SetFF[&#39;FF_class&#39;].values:</span>
        <span class="c1">#     setdata.LoadPickle(DefWipe=False,HardWipe=HardWipe,Mcore=False)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetPlotParams</span><span class="p">()</span></div>
        <span class="c1"># self.FitFFs(WipeFit=WipeFit)</span>

<div class="viewcode-block" id="SetOfFF.FitFFs"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.FitFFs">[docs]</a>    <span class="k">def</span> <span class="nf">FitFFs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFList</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">,</span><span class="n">list_of_fits</span><span class="o">=</span><span class="s1">&#39;PreDef&#39;</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">thisFFList</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">list_of_fits</span><span class="o">==</span><span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                    <span class="n">iset</span><span class="o">.</span><span class="n">FitFFs</span><span class="p">(</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_of_fits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                    <span class="n">iset</span><span class="o">.</span><span class="n">FitFFs</span><span class="p">(</span><span class="n">fit_ranges</span><span class="o">=</span><span class="p">[</span><span class="n">ifit</span><span class="p">],</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">iFF</span> <span class="ow">in</span> <span class="n">thisFFList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">list_of_fits</span><span class="o">==</span><span class="s1">&#39;PreDef&#39;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                        <span class="n">iset</span><span class="o">.</span><span class="n">FitFFs</span><span class="p">(</span><span class="n">thisFF</span><span class="o">=</span><span class="n">iFF</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ifit</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_of_fits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                        <span class="n">iset</span><span class="o">.</span><span class="n">FitFFs</span><span class="p">(</span><span class="n">thisFF</span><span class="o">=</span><span class="n">iFF</span><span class="p">,</span><span class="n">WipeFit</span><span class="o">=</span><span class="n">WipeFit</span><span class="p">)</span></div>


<div class="viewcode-block" id="SetOfFF.GetSet"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.GetSet">[docs]</a>    <span class="k">def</span> <span class="nf">GetSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisset</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisset</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">thisset</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s1">&#39;set index for form factor is to large&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">thisset</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">thisset</span><span class="p">,</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="SetOfFF.CombineFFs"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.CombineFFs">[docs]</a>    <span class="k">def</span> <span class="nf">CombineFFs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key_list</span><span class="p">,</span><span class="n">coeff_list</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">fun_str</span> <span class="o">=</span> <span class="n">this_fun</span>
            <span class="n">this_fun</span> <span class="o">=</span> <span class="n">op_dict</span><span class="p">[</span><span class="n">this_fun</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fun_str</span> <span class="o">=</span> <span class="n">this_fun</span><span class="o">.</span><span class="vm">__name__</span>

        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Combining form factors with&#39;</span><span class="p">,</span> <span class="n">fun_str</span><span class="p">)</span>
            <span class="n">thistimer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span>  <span class="n">linklist</span><span class="o">=</span><span class="n">key_list</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FF comb&#39;</span><span class="p">)</span>

        <span class="n">this_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">key_list</span><span class="p">,</span><span class="n">coeff_list</span><span class="p">))</span>
        <span class="n">first_key</span><span class="p">,</span><span class="n">first_coeff</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">this_iter</span><span class="p">)</span>

        <span class="n">this_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSet</span><span class="p">(</span><span class="n">first_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">first_coeff</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">running_set</span> <span class="o">=</span> <span class="n">this_set</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">running_set</span> <span class="o">=</span> <span class="n">this_set</span> <span class="o">*</span> <span class="n">first_coeff</span>
        <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">this_set</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">icoeff</span> <span class="ow">in</span> <span class="n">this_iter</span><span class="p">:</span>
            <span class="n">this_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSet</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">icoeff</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">running_set</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">running_set</span><span class="p">,</span><span class="n">this_set</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">running_set</span> <span class="o">=</span> <span class="n">this_fun</span><span class="p">(</span><span class="n">running_set</span><span class="p">,</span><span class="n">this_set</span> <span class="o">*</span> <span class="n">icoeff</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_timer</span><span class="p">:</span> <span class="n">thistimer</span><span class="o">.</span><span class="n">Lap</span><span class="p">(</span><span class="n">this_set</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">running_set</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="n">set_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;FF_class&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">running_set</span><span class="o">.</span><span class="n">ImportPlotParams</span><span class="p">(</span>   <span class="n">colourset8</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)],</span>
                                        <span class="n">markerset</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)],</span>
                                        <span class="n">shiftset</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)])</span>
        <span class="n">this_row</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span>   <span class="n">colourset8</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)]</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">markerset</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">markerset</span><span class="p">)]</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">shiftset</span><span class="p">[</span><span class="n">set_len</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">shiftset</span><span class="p">)]</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;info_dictionarie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">Info</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;q2_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">q2list</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;pp2_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">pp2list</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2pt_fit_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">fit2ptin</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;alpha_fit_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">fitAlphain</span>
        <span class="c1"># this_row.loc[&#39;ratio_fit_range&#39;] =</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;config_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">cfglistin</span>
        <span class="n">this_row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;config_list_2pt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">running_set</span><span class="o">.</span><span class="n">cfglist2pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">running_set</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_row</span></div>


    <span class="c1">## fitlist is list of touples { set : (&#39;state#&#39;,&#39;fitr#-#&#39;)}</span>
<div class="viewcode-block" id="SetOfFF.Plot"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.Plot">[docs]</a>    <span class="k">def</span> <span class="nf">Plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">chi_list</span><span class="o">=</span><span class="s1">&#39;Chi0-Chi20&#39;</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39; Form Factor plot &#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ Q^</span><span class="si">{2}</span><span class="s1"> [GeV]^</span><span class="si">{2}</span><span class="s1">$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$Form Factor$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlims&#39;</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">chi_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">chi_list</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plottflowlist</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">plottflowlist</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="c1"># for thisFF,itflow,iset in zip(thisFFlist,plottflowlist,self.SetFF[&#39;FF_class&#39;].values):</span>
        <span class="c1">#     data_plot = iset.ValsAndFitPlot(data_plot,thisFF,plottflow=itflow,this_chi_list=chi_list)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ic</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisFFlist</span><span class="p">):</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
            <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">ValsAndFitPlot</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="n">thisFF</span><span class="p">,</span><span class="n">plottflow</span><span class="o">=</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi_list</span><span class="o">=</span><span class="n">chi_list</span><span class="p">)</span>
            <span class="c1"># iset.Plot(thisFF,plottflow=itflow)</span>
            <span class="c1"># if itflow == &#39;PreDefine&#39;:</span>
            <span class="c1">#     iset.FitPlot(thisFF,tflow=&#39;First&#39;)</span>
            <span class="c1"># else:</span>
            <span class="c1">#     iset.FitPlot(thisFF,tflow=itflow)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;tilde&#39;,r&#39;\tilde&#39;)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;frac&#39;,r&#39;\frac&#39;)</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="n">WipeData</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>



    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


<div class="viewcode-block" id="SetOfFF.PlotFitVsUDMass"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotFitVsUDMass">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFitVsUDMass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">chi_list</span><span class="o">=</span><span class="s1">&#39;Chi0&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$F_{Q^</span><span class="si">{2}</span><span class="s1">=0}$ Extrapolation vs Up-Down Mass&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ m^</span><span class="si">{MSbar}</span><span class="s1">_</span><span class="si">{ud}</span><span class="s1"> [MeV]$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$FF(Q^</span><span class="si">{2}</span><span class="s1">=0)$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_F0VsUDmass.pdf&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlims&#39;</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">chi_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">chi_list</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">ichi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chi_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ichi</span><span class="p">:</span>
                <span class="n">chi_list</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span> <span class="o">=</span> <span class="n">ichi</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">plottflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">plotx</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">the_ff</span><span class="p">,</span><span class="n">the_tflow</span><span class="p">,</span><span class="n">the_DS</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">DS</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all UD combinations are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_DS</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">DS</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">thisFFlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iff</span> <span class="k">for</span> <span class="n">iff</span> <span class="ow">in</span> <span class="n">thisFFlist</span><span class="p">]</span> <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all form factors are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_ff</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">firstset</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">plottflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">itflow</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">plottflowlist</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all flow times are the same for mpi plot&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">the_tflow</span> <span class="o">=</span> <span class="n">tflowTOLeg</span><span class="p">(</span><span class="n">plottflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># for thisFF,this_chi,itflow,(ikey,iset) in zip(thisFFlist,chi_list,plottflowlist,self.SetFF[&#39;FF_class&#39;].iteritems()):</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ic</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisFFlist</span><span class="p">):</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">chi_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">chi_list</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
            <span class="c1">## flowed opp</span>
            <span class="c1">## self.FitDict [itflow , iFF , ifitr]</span>
            <span class="c1">## else</span>
            <span class="c1">## self.FitDict [iFF , ifitr]</span>

            <span class="c1">## we just assume the first ifitr is all the data.</span>
            <span class="k">if</span> <span class="n">iset</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># print itflow,this_chi,thisFF ,&#39; fit not in \n&#39;, iset.FF_Fit_Stats[&#39;boot&#39;].keys(), &#39;\n fitting now&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span> <span class="p">,</span><span class="s1">&#39; fit not in &#39;</span><span class="p">,</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39; fitting now&#39;</span><span class="p">)</span>
                    <span class="n">iset</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">thisFF</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">,</span> <span class="s1">&#39;not found, skipping plot&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">this_fit_instance</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">itflow</span><span class="p">,</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1">## assume first parameter is zero intercept</span>
                <span class="n">thisres</span> <span class="o">=</span> <span class="n">this_fit_instance</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisres</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisres</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetUDMass</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1">## in MeV</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># print this_chi,thisFF ,&#39; fit not in \n&#39;, iset.FF_Fit_Stats[&#39;boot&#39;].keys(), &#39;\n fitting now&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span> <span class="p">,</span><span class="s1">&#39; fit not in &#39;</span><span class="p">,</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;fitting now&#39;</span><span class="p">)</span>
                    <span class="n">iset</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">thisFF</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;boot&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span> <span class="ow">or</span> <span class="p">(</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">,</span> <span class="s1">&#39;not found, skipping plot&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
                    <span class="c1"># print this_chi,thisFF ,&#39; fit not in \n&#39;, iset.FF_Fit_Stats[&#39;boot&#39;].keys(), &#39;\n fitting now&#39;</span>
                <span class="n">this_fit_instance</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">FF_Fit_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">][</span><span class="n">this_chi</span><span class="p">,</span><span class="n">thisFF</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1">## assume first parameter is zero intercept</span>
                <span class="n">thisres</span> <span class="o">=</span> <span class="n">this_fit_instance</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Params&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisres</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisres</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetUDMass</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1">## in MeV</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;tilde&#39;,r&#39;\tilde&#39;)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;frac&#39;,r&#39;\frac&#39;)</span>
        <span class="n">thislab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">the_ff</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;\frac&#39;</span><span class="p">),</span><span class="n">the_tflow</span><span class="p">,</span><span class="n">the_DS</span><span class="p">])</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$ &#39;</span><span class="o">+</span><span class="n">this_chi</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotx</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thislab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;Phys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowPar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowEval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="SetOfFF.PlotDist"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotDist">[docs]</a>    <span class="k">def</span> <span class="nf">PlotDist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">chi_colapse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Vanish_Clim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Ord_Two</span><span class="o">=</span><span class="kc">False</span>
                                                                        <span class="p">,</span><span class="n">latspace_fit</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$F_{Q^</span><span class="si">{2}</span><span class="s1">=0}$ Distribution over All Fit Range Bootstraps&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$FF(Q^</span><span class="si">{2}</span><span class="s1">=0)$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$Frequency$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_Distro.pdf&#39;</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plottflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>


        <span class="c1"># for ichi,thisFF,itflow,(ikey,iset) in zip(  chi_colapse,thisFFlist,plottflowlist,</span>
        <span class="c1">#                                             self.SetFF[&#39;FF_class&#39;].iteritems()):</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ic</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisFFlist</span><span class="p">):</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">ichi</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">chi_colapse</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisFF</span><span class="p">,</span><span class="n">ichi</span><span class="p">,</span><span class="n">itflow</span> <span class="o">=</span> <span class="n">thisFFlist</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">chi_colapse</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span><span class="n">plottflowlist</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
            <span class="n">data_plot</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">PlotFitDistribution</span><span class="p">(</span>   <span class="n">data_plot</span><span class="p">,</span><span class="n">thisFF</span><span class="p">,</span><span class="n">tflow</span><span class="o">=</span><span class="n">itflow</span><span class="p">,</span><span class="n">thiscol</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span>
                                                    <span class="n">chi_colapse</span><span class="o">=</span><span class="n">ichi</span><span class="p">)</span>

        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">the_mpi</span><span class="p">,</span><span class="n">the_latspace</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all mpi values are the same for latspace plot&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_mpi</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">latspace</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">latspace</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all lattice spaces are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_latspace</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetLatSpaceLab</span><span class="p">()</span>
        <span class="n">last_col</span> <span class="o">=</span> <span class="n">colourset8</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">colourset8</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">the_latspace</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">the_mpi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotDist_Extrap</span><span class="p">(</span>   <span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;continuum&#39;</span><span class="p">,</span><span class="n">this_color</span><span class="o">=</span><span class="n">last_col</span><span class="p">,</span>
                                                    <span class="n">this_fun</span><span class="o">=</span><span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="n">Vanish_Clim</span><span class="p">,</span><span class="n">Ord_Two</span><span class="p">)</span><span class="o">+</span><span class="n">latspace_fit</span><span class="p">])</span>

                <span class="c1"># last_col2 = colourset8[(len(self.SetFF.keys())+2)%len(colourset8)]</span>
                <span class="c1"># data_plot = self.PlotDist_Extrap(data_plot,&#39;latspace&#39;,this_color=last_col2)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotDist_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;latspace&#39;</span><span class="p">,</span><span class="n">this_color</span><span class="o">=</span><span class="n">last_col</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">the_mpi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PlotDist_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;chiral&#39;</span><span class="p">,</span><span class="n">this_color</span><span class="o">=</span><span class="n">last_col</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="n">Vanish_Clim</span><span class="p">,</span><span class="n">Ord_Two</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)])</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="SetOfFF.PlotFitVsMpi"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotFitVsMpi">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFitVsMpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">Vanish_Clim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Ord_Two</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">latspace_fit</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span><span class="n">fitSchiff</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$F_{Q^</span><span class="si">{2}</span><span class="s1">=0}$ Extrapolation vs Pion Mass&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ m_{\pi} [MeV]$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$FF(Q^</span><span class="si">{2}</span><span class="s1">=0)$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_F0VsMpi.pdf&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlims&#39;</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plottflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">the_DS</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">DS</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all UD combinations are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_DS</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">DS</span>

        <span class="n">the_latspace</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">latspace</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">latspace</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all lattice spaces are the same for mpi plot&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_latspace</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetLatSpaceLab</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">thisFFlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iff</span> <span class="k">for</span> <span class="n">iff</span> <span class="ow">in</span> <span class="n">thisFFlist</span><span class="p">]</span> <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all form factors are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">firstset</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">plottflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">itflow</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">plottflowlist</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all flow times are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">plotx</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">this_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">thisres</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">this_names</span> <span class="o">=</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
            <span class="k">for</span> <span class="n">ireskey</span><span class="p">,</span><span class="n">iresval</span> <span class="ow">in</span> <span class="n">thisres</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">),)</span><span class="o">+</span><span class="n">ireskey</span><span class="p">)</span> <span class="c1">## in MeV</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">this_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">plotx</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$m_</span><span class="si">{pi}</span><span class="s1">$&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">this_names</span><span class="p">)</span>
            <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ploty</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">plotyerr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Sets Found for plotting vs mpi&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data_plot</span>

        <span class="c1"># thisFF = thisFF.replace(&#39;tilde&#39;,r&#39;\tilde&#39;)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;frac&#39;,r&#39;\frac&#39;)</span>
        <span class="n">thislab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">the_DS</span><span class="p">,</span><span class="n">the_latspace</span><span class="p">])</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$ &#39;</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">null_series</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thislab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fitSchiff</span><span class="p">:</span>
            <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;continuum&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">SchiffFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">latspace_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;continuum&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="n">Vanish_Clim</span><span class="p">,</span><span class="n">Ord_Two</span><span class="p">)</span><span class="o">+</span><span class="n">latspace_fit</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;chiral&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">F3ChiralLimFun</span><span class="p">[(</span><span class="n">Vanish_Clim</span><span class="p">,</span><span class="n">Ord_Two</span><span class="p">)</span><span class="o">+</span><span class="n">latspace_fit</span><span class="p">])</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="SetOfFF.PlotFitVsLatSpace"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotFitVsLatSpace">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFitVsLatSpace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">,</span><span class="n">mpi_fit</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span><span class="n">fitSchiff</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$F_{Q^</span><span class="si">{2}</span><span class="s1">=0}$ Extrapolation vs Lattice Spacing&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ a[fm]$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$FF(Q^</span><span class="si">{2}</span><span class="s1">=0)$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_F0VsLatSpace.pdf&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlims&#39;</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plottflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">the_DS</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">DS</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all UD combinations are the same for latspace plots&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_DS</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">DS</span>
        <span class="n">the_mpi</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all mpi values are the same for latspace plot&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">())</span>
                <span class="nb">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_mpi</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">thisFFlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iff</span> <span class="k">for</span> <span class="n">iff</span> <span class="ow">in</span> <span class="n">thisFFlist</span><span class="p">]</span> <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all form factors are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">firstset</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">plottflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">itflow</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">plottflowlist</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all flow times are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">plotx</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">this_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">thisres</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">this_names</span> <span class="o">=</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
            <span class="k">for</span> <span class="n">ireskey</span><span class="p">,</span><span class="n">iresval</span> <span class="ow">in</span> <span class="n">thisres</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetLatSpaceLab</span><span class="p">(),)</span><span class="o">+</span><span class="n">ireskey</span><span class="p">)</span> <span class="c1">## in MeV</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">this_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">plotx</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$a$&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">this_names</span><span class="p">)</span>
            <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ploty</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">plotyerr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Sets Found for plotting vs lat spacing&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data_plot</span>

        <span class="c1"># thisFF = thisFF.replace(&#39;tilde&#39;,r&#39;\tilde&#39;)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;frac&#39;,r&#39;\frac&#39;)</span>
        <span class="n">thislab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">the_DS</span><span class="p">,</span><span class="n">the_mpi</span><span class="p">])</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$ &#39;</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">null_series</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thislab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fitSchiff</span><span class="p">:</span>
            <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;continuum&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">SchiffFitFun</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mpi_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;continuum&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">F3LatSpaceFun</span><span class="p">[</span><span class="n">mpi_fit</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plot_Extrap</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span><span class="s1">&#39;latspace&#39;</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="n">F3LatSpaceFun</span><span class="p">[</span><span class="n">mpi_fit</span><span class="p">])</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>



<div class="viewcode-block" id="SetOfFF.PlotFitVsBoxSize"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotFitVsBoxSize">[docs]</a>    <span class="k">def</span> <span class="nf">PlotFitVsBoxSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisFFlist</span><span class="p">,</span><span class="n">plot_info</span><span class="p">,</span><span class="n">plottflowlist</span><span class="o">=</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">DefPlotInfo</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">this_pi</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$F_{Q^</span><span class="si">{2}</span><span class="s1">=0}$ Extrapolation vs BoxSize&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ La[fm]$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;ylabel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$FF(Q^</span><span class="si">{2}</span><span class="s1">=0)$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;save_file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Plotdir</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_F0VsBox.pdf&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;xlims&#39;</span> <span class="ow">in</span> <span class="n">this_pi</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">this_pi</span><span class="p">[</span><span class="s1">&#39;xlims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">this_pi</span>

        <span class="n">this_plot_info</span> <span class="o">=</span> <span class="n">DefPlotInfo</span><span class="p">(</span><span class="n">plot_info</span><span class="p">)</span>
        <span class="n">data_plot</span> <span class="o">=</span> <span class="n">jpl</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_plot_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plottflowlist</span> <span class="o">==</span> <span class="s1">&#39;PreDefine&#39;</span><span class="p">:</span>
            <span class="n">plottflowlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PreDefine&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">the_DS</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">DS</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all UD combinations are the same for box size plots&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_DS</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">DS</span>
        <span class="n">the_mpi</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">firstset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="o">!=</span> <span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all mpi values are the same for box size plot&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">())</span>
                <span class="nb">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">the_mpi</span> <span class="o">=</span> <span class="n">firstset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMassLab</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">thisFFlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">iff</span> <span class="k">for</span> <span class="n">iff</span> <span class="ow">in</span> <span class="n">thisFFlist</span><span class="p">]</span> <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all form factors are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">firstset</span><span class="o">.</span><span class="n">doflow</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">plottflowlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">itflow</span> <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="n">plottflowlist</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;warning: not all flow times are the same for mpi plot&#39;</span><span class="p">)</span>
        <span class="n">ploty</span><span class="p">,</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">plotx</span> <span class="o">=</span> <span class="p">[],[],[]</span>
        <span class="n">this_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">thisres</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">this_names</span> <span class="o">=</span> <span class="n">thisres</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
            <span class="k">for</span> <span class="n">ireskey</span><span class="p">,</span><span class="n">iresval</span> <span class="ow">in</span> <span class="n">thisres</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ploty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
                <span class="n">plotyerr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iresval</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
                <span class="n">plotx</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetBoxSizeLab</span><span class="p">(),)</span><span class="o">+</span><span class="n">ireskey</span><span class="p">)</span> <span class="c1">## in MeV</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">this_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">this_key</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">plotx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">plotx</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$La$&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">this_names</span><span class="p">)</span>
            <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ploty</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
            <span class="n">plotyerr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">plotyerr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Sets Found for plotting vs box size&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data_plot</span>

        <span class="c1"># thisFF = thisFF.replace(&#39;tilde&#39;,r&#39;\tilde&#39;)</span>
        <span class="c1"># thisFF = thisFF.replace(&#39;frac&#39;,r&#39;\frac&#39;)</span>
        <span class="n">thislab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\ &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">the_DS</span><span class="p">,</span><span class="n">the_mpi</span><span class="p">])</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$ &#39;</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">null_series</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotyerr</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thislab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="c1"># data_plot = self.Plot_BoxSize_Extrap(data_plot)</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_plot</span></div>




<div class="viewcode-block" id="SetOfFF.PlotDist_Extrap"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.PlotDist_Extrap">[docs]</a>    <span class="k">def</span> <span class="nf">PlotDist_Extrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_data</span><span class="p">,</span><span class="n">extrap_type</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="s1">&#39;Default&#39;</span><span class="p">,</span><span class="n">this_color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">extrap_type</span> <span class="o">=</span> <span class="n">extrap_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">this_eval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;latspace&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LatSpace_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">prefix_lab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$a\rightarrow 0 Extrap$&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;boxsize&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoxSize_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">prefix_lab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$La\rightarrow 0 Extrap$&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;mpi&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span> <span class="ow">or</span> <span class="s1">&#39;chiral&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chiral_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">this_eval</span> <span class="o">=</span> <span class="p">[</span><span class="n">physcial_pion_mass</span><span class="p">]</span>
            <span class="n">prefix_lab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$m_{\pi}\rightarrow &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">physcial_pion_mass</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;MeV Extrap$&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFF_2D</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Continuum_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">this_eval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">physcial_pion_mass</span><span class="p">]</span>
            <span class="n">prefix_lab</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$m_{\pi}\rightarrow &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">physcial_pion_mass</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;MeV, a</span><span class="se">\r</span><span class="s1">ightarrow 0 Extrap$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;extrapolation type not recognised &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extrap_type</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot_data</span>
        <span class="k">def</span> <span class="nf">GetEval</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="o">*</span><span class="n">this_eval</span><span class="p">)</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">GetEval</span><span class="p">)</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">null_series</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;histogram_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;boot_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix_lab</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_color</span>
        <span class="n">plot_data</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_data</span></div>


<div class="viewcode-block" id="SetOfFF.Plot_Extrap"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.Plot_Extrap">[docs]</a>    <span class="k">def</span> <span class="nf">Plot_Extrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plot_data</span><span class="p">,</span><span class="n">extrap_type</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="s1">&#39;Default&#39;</span><span class="p">):</span>
        <span class="n">extrap_type</span> <span class="o">=</span> <span class="n">extrap_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">this_eval</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;latspace&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LatSpace_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;boxsize&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoxSize_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;mpi&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span> <span class="ow">or</span> <span class="s1">&#39;chiral&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chiral_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">this_eval</span> <span class="o">=</span> <span class="n">physcial_pion_mass</span>
        <span class="k">elif</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">in</span> <span class="n">extrap_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="n">this_fun</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFF_2D</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Continuum_Extrapolation</span><span class="p">(</span><span class="n">this_fun</span><span class="o">=</span><span class="n">this_fun</span><span class="p">)</span>
            <span class="n">this_eval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">physcial_pion_mass</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;extrapolation type not recognised &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extrap_type</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot_data</span>
        <span class="c1"># if isinstance(fitr_params,pa.Series): fitr_params = fitr_params.iloc[-1]</span>
        <span class="c1">## TODO, plot from zero to data max</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">null_series</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit &#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xdatarange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ToDataMax&#39;</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;ShowEval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_eval</span>
        <span class="n">plot_data</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_data</span></div>


<div class="viewcode-block" id="SetOfFF.Chiral_Extrapolation"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.Chiral_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">Chiral_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">this_fit</span><span class="p">(</span><span class="n">this_series</span><span class="p">):</span>
            <span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[[]],[]</span>
            <span class="k">for</span> <span class="n">icol</span><span class="p">,</span><span class="n">coldata</span> <span class="ow">in</span> <span class="n">this_series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;_mpi&#39;</span> <span class="ow">in</span> <span class="n">icol</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># xdata[0].append(coldata+100)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># coldata2,rand_list = coldata.ResampleBS()</span>
                    <span class="c1"># ydata.append(coldata2)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="n">this_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>

            <span class="c1"># max_nboot = max([ival.nboot for ival in ydata])</span>
            <span class="n">fmt_ydata</span><span class="p">,</span><span class="n">fmt_xdata</span> <span class="o">=</span> <span class="p">[],[[]]</span>
            <span class="k">for</span> <span class="n">icy</span><span class="p">,(</span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ydata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">nboot</span> <span class="o">!=</span> <span class="n">iy</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">,</span><span class="n">rand_list</span> <span class="o">=</span> <span class="n">iy</span><span class="o">.</span><span class="n">ResampleBS</span><span class="p">(</span><span class="n">nboot</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>

            <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="n">this_fun</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_xdata</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_ydata</span><span class="p">)],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chiral_Ext&#39;</span><span class="p">)</span>
            <span class="n">fit_result</span> <span class="o">=</span> <span class="n">thisff</span><span class="o">.</span><span class="n">FitBoots</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fit_result</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">fit_result</span>
            <span class="c1"># print thisff.fit_data[&#39;Params&#39;]</span>
            <span class="k">return</span> <span class="n">thisff</span>

        <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">this_df</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_mpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_fit</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span></div>


<div class="viewcode-block" id="SetOfFF.LatSpace_Extrapolation"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.LatSpace_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">LatSpace_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">this_fit</span><span class="p">(</span><span class="n">this_series</span><span class="p">):</span>
            <span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[[]],[]</span>
            <span class="k">for</span> <span class="n">icol</span><span class="p">,</span><span class="n">coldata</span> <span class="ow">in</span> <span class="n">this_series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;_latspace&#39;</span> <span class="ow">in</span> <span class="n">icol</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># xdata[0].append(coldata+100)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># ydata.append(coldata)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="n">this_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
            <span class="c1"># max_nboot = max([ival.nboot for ival in ydata])</span>
            <span class="n">fmt_ydata</span><span class="p">,</span><span class="n">fmt_xdata</span> <span class="o">=</span> <span class="p">[],[[]]</span>
            <span class="k">for</span> <span class="n">icy</span><span class="p">,(</span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ydata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">nboot</span> <span class="o">!=</span> <span class="n">iy</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">,</span><span class="n">rand_list</span> <span class="o">=</span> <span class="n">iy</span><span class="o">.</span><span class="n">ResampleBS</span><span class="p">(</span><span class="n">nboot</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>

            <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="n">this_fun</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_xdata</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_ydata</span><span class="p">)],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;LatSpace_Ext&#39;</span><span class="p">)</span>
            <span class="n">fit_result</span> <span class="o">=</span> <span class="n">thisff</span><span class="o">.</span><span class="n">FitBoots</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fit_result</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">fit_result</span>
            <span class="k">return</span> <span class="n">thisff</span>

        <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">this_df</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_latspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">latspace</span><span class="p">)</span>
        <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_fit</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span></div>


<div class="viewcode-block" id="SetOfFF.BoxSize_Extrapolation"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.BoxSize_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">BoxSize_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">SquaredFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">this_fit</span><span class="p">(</span><span class="n">this_series</span><span class="p">):</span>
            <span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[[]],[]</span>
            <span class="k">for</span> <span class="n">icol</span><span class="p">,</span><span class="n">coldata</span> <span class="ow">in</span> <span class="n">this_series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;_boxsize&#39;</span> <span class="ow">in</span> <span class="n">icol</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># xdata[0].append(coldata+100)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1"># ##### DEBUGGING ####</span>
                    <span class="c1"># ydata.append(coldata)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="n">this_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
            <span class="c1"># max_nboot = max([ival.nboot for ival in ydata])</span>
            <span class="n">fmt_ydata</span><span class="p">,</span><span class="n">fmt_xdata</span> <span class="o">=</span> <span class="p">[],[[]]</span>
            <span class="k">for</span> <span class="n">icy</span><span class="p">,(</span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ydata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">nboot</span> <span class="o">!=</span> <span class="n">iy</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">,</span><span class="n">rand_list</span> <span class="o">=</span> <span class="n">iy</span><span class="o">.</span><span class="n">ResampleBS</span><span class="p">(</span><span class="n">nboot</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>

            <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="n">this_fun</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_xdata</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_ydata</span><span class="p">)],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;BoxSize_Ext&#39;</span><span class="p">)</span>
            <span class="n">fit_result</span> <span class="o">=</span> <span class="n">thisff</span><span class="o">.</span><span class="n">FitBoots</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fit_result</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">fit_result</span>
            <span class="k">return</span> <span class="n">thisff</span>

        <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">this_df</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_boxsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">Lxyz</span><span class="p">)</span>
        <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_fit</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span></div>




<div class="viewcode-block" id="SetOfFF.Continuum_Extrapolation"><a class="viewcode-back" href="../SetsOfFFs.html#SetsOfFFs.SetOfFF.Continuum_Extrapolation">[docs]</a>    <span class="k">def</span> <span class="nf">Continuum_Extrapolation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_fun</span><span class="o">=</span><span class="p">(</span><span class="n">LinearFF_2D</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">this_fit</span><span class="p">(</span><span class="n">this_series</span><span class="p">):</span>
            <span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[[],[]],[]</span>
            <span class="k">for</span> <span class="n">icol</span><span class="p">,</span><span class="n">coldata</span> <span class="ow">in</span> <span class="n">this_series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;_latspace&#39;</span> <span class="ow">in</span> <span class="n">icol</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1">### DEBUG ###</span>
                    <span class="c1"># xdata[0].append(coldata+0.1)</span>
                    <span class="c1"># xdata[0].append(coldata)</span>
                    <span class="c1"># xdata[0].append(coldata+0.1)</span>
                    <span class="c1"># xdata[0].append(coldata)</span>
                    <span class="c1"># xdata[0].append(coldata+0.1)</span>
                <span class="k">elif</span> <span class="s1">&#39;_mpi&#39;</span> <span class="ow">in</span> <span class="n">icol</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1">### DEBUG ###</span>
                    <span class="c1"># xdata[1].append(coldata)</span>
                    <span class="c1"># xdata[1].append(coldata+100)</span>
                    <span class="c1"># xdata[1].append(coldata+100)</span>
                    <span class="c1"># xdata[1].append(coldata+400)</span>
                    <span class="c1"># xdata[1].append(coldata+400)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coldata</span><span class="p">)</span>
                    <span class="c1">### DEBUG ###</span>
                    <span class="c1"># ydata.append(coldata)</span>
                    <span class="c1"># ydata.append(coldata)</span>
                    <span class="c1"># ydata.append(coldata)</span>
                    <span class="c1"># ydata.append(coldata)</span>
                    <span class="c1"># ydata.append(coldata)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="n">this_fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
            <span class="c1"># max_nboot = max([ival.nboot for ival in ydata])</span>
            <span class="n">fmt_ydata</span><span class="p">,</span><span class="n">fmt_xdata</span> <span class="o">=</span> <span class="p">[],[[],[]]</span>
            <span class="k">for</span> <span class="n">icy</span><span class="p">,(</span><span class="n">ix0</span><span class="p">,</span><span class="n">ix1</span><span class="p">,</span><span class="n">iy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xdata</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ydata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">nboot</span> <span class="o">!=</span> <span class="n">iy</span><span class="o">.</span><span class="n">nboot</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">,</span><span class="n">rand_list</span> <span class="o">=</span> <span class="n">iy</span><span class="o">.</span><span class="n">ResampleBS</span><span class="p">(</span><span class="n">nboot</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix0</span><span class="p">)</span>
                        <span class="n">fmt_xdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
                        <span class="n">fmt_ydata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>
            <span class="n">thisff</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">Fitting</span><span class="p">(</span><span class="n">Funs</span><span class="o">=</span><span class="n">this_fun</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_xdata</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fmt_ydata</span><span class="p">)],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Continuum_Ext&#39;</span><span class="p">)</span>
            <span class="n">fit_result</span> <span class="o">=</span> <span class="n">thisff</span><span class="o">.</span><span class="n">FitBoots</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fit_result</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">fit_result</span>
            <span class="k">return</span> <span class="n">thisff</span>

        <span class="n">this_df</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetFF</span><span class="p">[</span><span class="s1">&#39;FF_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">iset</span><span class="o">.</span><span class="n">Get_Extrapolation</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">this_df</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_latspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">Info</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
                <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_mpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iset</span><span class="o">.</span><span class="n">ppparams</span><span class="o">.</span><span class="n">GetPionMass</span><span class="p">(</span><span class="n">MeV</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">this_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_fit</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this_df</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Jack Dragos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>
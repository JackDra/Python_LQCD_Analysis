
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>GammaMatricies &#8212; LQCD Analysis Codebase TF Fits documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">LQCD Analysis Codebase TF Fits documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GammaMatricies</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span><span class="p">,</span><span class="n">copy</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">myeps</span>


<div class="viewcode-block" id="GammaTOChroma"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaTOChroma">[docs]</a><span class="k">def</span> <span class="nf">GammaTOChroma</span><span class="p">(</span><span class="n">Opp</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Opp</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">Opp</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Opp</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">Opp</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Opp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Opp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">Opp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">Opp</span> <span class="o">=</span> <span class="s1">&#39;g5g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Opp</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;gamma list too long &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Opp</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">Opp</span> <span class="o">==</span> <span class="s1">&#39;Pion&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">15</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Opp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GammaTOChroma</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">Opp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;g5&#39;</span> <span class="ow">in</span> <span class="n">Opp</span> <span class="ow">or</span> <span class="s1">&#39;g5g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">15</span><span class="o">-</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;g5&#39;</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">15</span>
    <span class="k">elif</span> <span class="s1">&#39;I&#39;</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="ChromaTOGamma"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.ChromaTOGamma">[docs]</a><span class="k">def</span> <span class="nf">ChromaTOGamma</span><span class="p">(</span><span class="n">Opp</span><span class="p">):</span>
    <span class="n">Opp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Opp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;I&#39;</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">Opp</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;g1g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">Opp</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;g2g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">Opp</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;g3g4&#39;</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;g5&#39;</span>
    <span class="k">elif</span> <span class="n">Opp</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;g5g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">Opp</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span></div>


<span class="n">mattype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex</span>

<div class="viewcode-block" id="GammaMat"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat">[docs]</a><span class="k">class</span> <span class="nc">GammaMat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class with basic gamma matricies.</span>

<span class="sd">    Initialise with representation.</span>

<span class="sd">    resulting gamma matricies are in np.matrix format</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Rep</span><span class="o">=</span><span class="s1">&#39;Sakurai&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Rep</span> <span class="o">=</span> <span class="n">Rep</span>
        <span class="c1">## sets up gamma matricies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRep</span><span class="p">(</span><span class="n">Rep</span><span class="p">)</span>

<div class="viewcode-block" id="GammaMat.SetRep"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.SetRep">[docs]</a>    <span class="k">def</span> <span class="nf">SetRep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Rep</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;sakura&#39;</span> <span class="ow">in</span> <span class="n">Rep</span> <span class="ow">or</span> <span class="s1">&#39;Sakurai&#39;</span> <span class="ow">in</span> <span class="n">Rep</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                           <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                           <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                           <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">mattype</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">g1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span> <span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]],</span><span class="n">mattype</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">g2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]],</span><span class="n">mattype</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">g3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span>
                                 <span class="p">[</span> <span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]],</span><span class="n">mattype</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">g5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]],</span><span class="n">mattype</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_mu_Tsign</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">## TODO, needs change for whole code tho</span>
        <span class="c1"># elif &#39;dirac&#39; in Rep or &#39;Dirac&#39; in Rep:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">Rep</span><span class="o">+</span><span class="s1">&#39; not a recognised representation for gamma matricies&#39;</span><span class="p">)</span>

        <span class="c1">## include gamma 5 here?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">]</span>
        <span class="c1">## is this right?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_mu_nu</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">)],</span>
                       <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">],</span>
                       <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">],</span>
                       <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">],</span>
                       <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">mattype</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_5_nu</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_nu_5</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g5</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">G_unpol</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">mattype</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">g4</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_pol</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">G_unpol</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">g5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">g3</span>

        <span class="c1">## if you like dictionaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ig</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ig</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jg</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_mu_nu</span><span class="p">[</span><span class="n">ig</span><span class="p">][</span><span class="n">jg</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ig</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[</span><span class="n">ig</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;sig5&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ig</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_5_nu</span><span class="p">[</span><span class="n">ig</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ig</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_nu_5</span><span class="p">[</span><span class="n">ig</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;g5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;P4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G_unpol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;P3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">G_pol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">mattype</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;neg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;cmplx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="n">jkey</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">output</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GammaDict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span>

<div class="viewcode-block" id="GammaMat.SigMult"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.SigMult">[docs]</a>    <span class="k">def</span> <span class="nf">SigMult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">isig</span><span class="p">,</span><span class="n">jsig</span><span class="p">,</span><span class="n">thing</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaMult</span><span class="p">(</span><span class="n">isig</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaMult</span><span class="p">(</span><span class="n">jsig</span><span class="p">,</span><span class="n">thing</span><span class="p">))</span></div>

    <span class="c1">##TODO, go nuts with the predefined functions</span>

<div class="viewcode-block" id="GammaMat.ProjMult"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.ProjMult">[docs]</a>    <span class="k">def</span> <span class="nf">ProjMult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pindex</span><span class="p">,</span><span class="n">thing</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pindex</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">pindex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">thing</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GammaMult</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">thing</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProjMult</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaMult</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GammaMult</span><span class="p">(</span><span class="n">pindex</span><span class="p">,</span><span class="n">thing</span><span class="p">)</span> <span class="p">))</span></div>

    <span class="c1">## either pass in string corresponding to above, or anything else</span>
    <span class="c1">## this is for 1 gamma matrix, multiple gamma matricies to come!</span>
    <span class="c1">## this is an efficiency thing btw, probably not needed but I did it before</span>
    <span class="c1">## Infact, I havn&#39;t bothered to implement these efficiency routines in the rest of the code</span>
    <span class="c1">## I guess TODO if you want...</span>
<div class="viewcode-block" id="GammaMat.MultGamma"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.MultGamma">[docs]</a>    <span class="k">def</span> <span class="nf">MultGamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thing</span><span class="p">,</span><span class="n">rgindex</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">T</span><span class="p">:</span> <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_mu_Tsign</span><span class="p">[</span><span class="n">rgindex</span><span class="p">]</span><span class="o">*</span><span class="n">output</span>
            <span class="k">if</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[:,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">output</span><span class="p">[:,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span>
                <span class="n">output</span><span class="p">[:,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">output</span><span class="p">[:,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
                <span class="n">output</span><span class="p">[:,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">output</span><span class="p">[:,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>
                <span class="n">output</span><span class="p">[:,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">output</span><span class="p">[:,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">rgindex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">T</span><span class="p">:</span> <span class="k">return</span> <span class="n">output</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[</span><span class="n">rgindex</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">output</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[</span><span class="n">rgindex</span><span class="p">]</span></div>


<div class="viewcode-block" id="GammaMat.GammaMult"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.GammaMult">[docs]</a>    <span class="k">def</span> <span class="nf">GammaMult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lgindex</span><span class="p">,</span><span class="n">thing</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MultGamma</span><span class="p">(</span><span class="n">thing</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">lgindex</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[</span><span class="n">lgindex</span><span class="p">]</span><span class="o">*</span><span class="n">thing</span></div>

    <span class="c1">## default is (energy, px, py ,pz)</span>
    <span class="c1">## can use (px,py,pz,energy) as well if Eindex = 4</span>
<div class="viewcode-block" id="GammaMat.Slashed"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.GammaMat.Slashed">[docs]</a>    <span class="k">def</span> <span class="nf">Slashed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">FVecObj</span><span class="p">,</span><span class="n">Eindex</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">FVecObj</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Slashed requires numpy array to do element-wise multiplication&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Eindex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">ig</span> <span class="o">*</span> <span class="n">FVecObj</span> <span class="k">for</span> <span class="n">ig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Eindex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">ig</span> <span class="o">*</span> <span class="n">FVecObj</span> <span class="k">for</span> <span class="n">ig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_mu</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Eindex must be 0 or 4&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CorrSpinTrace"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace">[docs]</a><span class="k">class</span> <span class="nc">CorrSpinTrace</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    has routines which does correlator spin traces, for use in the form factor decomposition</span>

<span class="sd">    something proportional to: trace( Projector * (pp_slashed +m )* Opp *(pp_slashed + m) )</span>
<span class="sd">    Rodgers paper has good definitions for this :D</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Rep</span><span class="o">=</span><span class="s1">&#39;Sakurai&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Rep</span> <span class="o">=</span> <span class="n">Rep</span>
        <span class="c1">## sets up gamma matricies class for use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span> <span class="o">=</span> <span class="n">GammaMat</span><span class="p">(</span><span class="n">Rep</span><span class="o">=</span><span class="n">Rep</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CurrFFs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Scalar&#39;</span>   <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ScalarFF</span><span class="p">,</span>
                        <span class="s1">&#39;Vector&#39;</span>   <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFF</span><span class="p">,</span>
                        <span class="s1">&#39;GeGm&#39;</span>     <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">GeGmFF</span><span class="p">,</span>
                        <span class="s1">&#39;VectorTop&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;VectorTopBNL&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;VectorTopBNL_mal&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;VectorWein&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;VectorWeinBNL&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;VectorTopNoV&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFFTop</span><span class="p">,</span>
                        <span class="s1">&#39;PsScalar&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ScalarFF</span><span class="p">,</span>
                        <span class="s1">&#39;PsVector&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">PsVectorFF</span><span class="p">,</span>
                        <span class="s1">&#39;Tensor&#39;</span>   <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">TensorFF</span><span class="p">}</span>


    <span class="c1">## key of this class is just the form factor function</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ikey</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CurrFFs</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span>

    <span class="c1">## pmu is source 4-momentum</span>
    <span class="c1">## ppmu is sink 4-momentum</span>
    <span class="c1">## the energy component is just the energy, the -j is done in here</span>
    <span class="c1">## Opp can be anyting you can use to __getitem__ from GammaMat (string, or list of string to multiply together etc...)</span>
<div class="viewcode-block" id="CorrSpinTrace.FFunOpp"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.FFunOpp">[docs]</a>    <span class="k">def</span> <span class="nf">FFunOpp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Opp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisOpp</span> <span class="o">=</span> <span class="n">Opp</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">Opp</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">Opp</span><span class="p">]</span>
        <span class="n">Ep</span><span class="p">,</span> <span class="n">Epp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">pmu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">ppmu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pplusm</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g4</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">Ep</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pmu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g1</span> <span class="o">+</span> <span class="n">pmu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g2</span> <span class="o">+</span> <span class="n">pmu</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">mass</span> <span class="o">/</span> <span class="n">Ep</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">pprimeplusm</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g4</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">Epp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ppmu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g1</span> <span class="o">+</span> <span class="n">ppmu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g2</span> <span class="o">+</span> <span class="n">ppmu</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">mass</span> <span class="o">/</span> <span class="n">Epp</span> <span class="p">)</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Rfac</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pplusm</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">pprimeplusm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Epp</span><span class="o">*</span><span class="n">Ep</span><span class="o">/</span><span class="p">((</span><span class="n">Epp</span><span class="o">+</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Ep</span><span class="o">+</span><span class="n">mass</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pplusm</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">pprimeplusm</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span></div>



    <span class="c1">## Form Factor decomposition needs alpha too when using CP voilating operator!!</span>
<div class="viewcode-block" id="CorrSpinTrace.FFunTopOpp"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.FFunTopOpp">[docs]</a>    <span class="k">def</span> <span class="nf">FFunTopOpp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Opp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisOpp</span> <span class="o">=</span> <span class="n">Opp</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">Opp</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">Opp</span><span class="p">]</span>
        <span class="n">p</span><span class="p">,</span><span class="n">pp</span> <span class="o">=</span> <span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">mass</span>
        <span class="n">Ep</span><span class="p">,</span> <span class="n">Epp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">pp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pplusm</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g4</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">Ep</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g1</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g2</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">Ep</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">pprimeplusm</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g4</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">Epp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g1</span> <span class="o">+</span> <span class="n">pp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g2</span> <span class="o">+</span> <span class="n">pp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">Epp</span> <span class="p">)</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">g5facp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">m</span><span class="o">/</span><span class="n">Ep</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g5</span>
        <span class="n">g5facpprime</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">m</span><span class="o">/</span><span class="n">Epp</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="o">.</span><span class="n">g5</span>
        <span class="k">if</span> <span class="n">Rfac</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="n">pplusm</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">g5facpprime</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Epp</span><span class="o">*</span><span class="n">Ep</span><span class="o">/</span><span class="p">((</span><span class="n">Epp</span><span class="o">+</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Ep</span><span class="o">+</span><span class="n">m</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">g5facp</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">pprimeplusm</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Epp</span><span class="o">*</span><span class="n">Ep</span><span class="o">/</span><span class="p">((</span><span class="n">Epp</span><span class="o">+</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Ep</span><span class="o">+</span><span class="n">m</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="n">pplusm</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">g5facpprime</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="p">(</span><span class="n">g5facp</span> <span class="o">*</span> <span class="n">thisOpp</span> <span class="o">*</span> <span class="n">pprimeplusm</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">)</span></div>



    <span class="c1">## traced with projector of FFunOpp</span>
<div class="viewcode-block" id="CorrSpinTrace.TracedFFun"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.TracedFFun">[docs]</a>    <span class="k">def</span> <span class="nf">TracedFFun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Opp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisProj</span><span class="p">,</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetProjGamma</span><span class="p">(</span><span class="o">*</span><span class="n">Opp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">thisProj</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFunOpp</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">))</span></div>

    <span class="c1">## see https://arxiv.org/pdf/1507.02343v2.pdf for definitin of CP odd form factor decomposition.</span>
<div class="viewcode-block" id="CorrSpinTrace.TracedFFunTop"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.TracedFFunTop">[docs]</a>    <span class="k">def</span> <span class="nf">TracedFFunTop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Opp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisProj</span><span class="p">,</span><span class="n">thisOpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetProjGamma</span><span class="p">(</span><span class="o">*</span><span class="n">Opp</span><span class="p">)</span>
        <span class="n">leftval</span><span class="p">,</span><span class="n">rightval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FFunTopOpp</span><span class="p">(</span><span class="n">thisOpp</span><span class="p">,</span><span class="n">pmu</span><span class="p">,</span><span class="n">ppmu</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">thisProj</span> <span class="o">*</span> <span class="n">leftval</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">thisProj</span> <span class="o">*</span> <span class="n">rightval</span><span class="p">)</span></div>



    <span class="c1">## these functions are expecting a list of gamma matricies</span>
<div class="viewcode-block" id="CorrSpinTrace.GetProjGamma"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.GetProjGamma">[docs]</a>    <span class="k">def</span> <span class="nf">GetProjGamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">Opp</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetProj</span><span class="p">(</span><span class="o">*</span><span class="n">Opp</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">GetGamma</span><span class="p">(</span><span class="o">*</span><span class="n">Opp</span><span class="p">)</span></div>

    <span class="c1">## only returns first projector found, if none found, returns identity</span>
<div class="viewcode-block" id="CorrSpinTrace.GetProj"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.GetProj">[docs]</a>    <span class="k">def</span> <span class="nf">GetProj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">thisProj</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iProj</span> <span class="ow">in</span> <span class="n">thisProj</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">in</span> <span class="n">iProj</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">iProj</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CorrSpinTrace.GetGamma"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.GetGamma">[docs]</a>    <span class="k">def</span> <span class="nf">GetGamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">Opp</span><span class="p">):</span>
        <span class="n">outlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iOpp</span> <span class="ow">in</span> <span class="n">Opp</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">iOpp</span><span class="p">:</span>
                <span class="n">outlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iOpp</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="n">outlist</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gammas</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CorrSpinTrace.CreateEs"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.CreateEs">[docs]</a>    <span class="k">def</span> <span class="nf">CreateEs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">momvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">curr</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">momvecsqrd</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">iq</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">iq</span> <span class="ow">in</span> <span class="n">momvec</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">thismass</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">momvecsqrd</span><span class="p">)</span></div>

<div class="viewcode-block" id="CorrSpinTrace.Create4Mom"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.Create4Mom">[docs]</a>    <span class="k">def</span> <span class="nf">Create4Mom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">):</span>
        <span class="n">thispvec</span> <span class="o">=</span> <span class="p">[</span><span class="n">ipp</span><span class="o">-</span><span class="n">iq</span> <span class="k">for</span> <span class="n">ipp</span><span class="p">,</span><span class="n">iq</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="n">thisppvec</span> <span class="o">=</span> <span class="n">thisppvec</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thispvec</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="n">thispvec</span> <span class="o">=</span> <span class="n">thispvec</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">thisp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateEs</span><span class="p">(</span><span class="n">thispvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)]</span> <span class="o">+</span> <span class="n">thispvec</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateEs</span><span class="p">(</span><span class="n">thispvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)]</span>
        <span class="n">thispp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateEs</span><span class="p">(</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)]</span> <span class="o">+</span> <span class="n">thisppvec</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CreateEs</span><span class="p">(</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)]</span>
        <span class="n">thisq</span> <span class="o">=</span> <span class="p">[</span><span class="n">ipp</span><span class="o">-</span><span class="n">ip</span> <span class="k">for</span> <span class="n">ipp</span><span class="p">,</span><span class="n">ip</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">thispp</span><span class="p">,</span><span class="n">thisp</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span></div>


<div class="viewcode-block" id="CorrSpinTrace.ScalarFF"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.ScalarFF">[docs]</a>    <span class="k">def</span> <span class="nf">ScalarFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>
        <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">],</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span> <span class="ow">not</span> <span class="n">ccheck</span></div>

<div class="viewcode-block" id="CorrSpinTrace.VectorFF"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.VectorFF">[docs]</a>    <span class="k">def</span> <span class="nf">VectorFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">PadF3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">thisopp</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FormatOpp</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>
        <span class="c1"># print &#39;calculating form factor coeffs for &#39; ,thisopp</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">j</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisopp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">iscmplx</span><span class="p">:</span>
                    <span class="c1"># print &#39;calculating form factor coeffs for &#39; ,thisopp[:-1]+(&#39;g&#39;+str(i),),&#39;xq&#39;</span>
                    <span class="n">term2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">## sigma_mu_nu * q_mu = -i * g_mu * g_nu * q_nu</span>
                    <span class="c1"># print &#39;calculating form factor coeffs for &#39; ,thisopp+(&#39;g&#39;+str(i),&#39;cmplx&#39;,&#39;neg&#39;),&#39;xq&#39;</span>
                    <span class="n">term2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;cmplx&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">term2</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span>
        <span class="k">if</span> <span class="n">PadF3</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">,</span><span class="n">term2</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span> <span class="ow">not</span> <span class="n">ccheck</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">,</span><span class="n">term2</span><span class="p">],</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span> <span class="ow">not</span> <span class="n">ccheck</span></div>


<div class="viewcode-block" id="CorrSpinTrace.GeGmFF"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.GeGmFF">[docs]</a>    <span class="k">def</span> <span class="nf">GeGmFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">PadF3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">termlist</span><span class="p">,</span><span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFF</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">,</span><span class="n">PadF3</span><span class="o">=</span><span class="n">PadF3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">term1</span><span class="p">,</span><span class="n">term2</span> <span class="o">=</span> <span class="n">termlist</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1">## QM = Q^2/4m^2</span>
        <span class="c1">## Ge = F1 - QM F2</span>
        <span class="c1">## Gm = F1 + F2</span>
        <span class="c1">## reranged</span>
        <span class="c1">## F1 = (QM Gm + Ge) / (QM + 1)</span>
        <span class="c1">## F2 = (Gm - Ge) / (QM + 1)</span>

        <span class="c1">## Ratio = term1 * F1 + term2 * F2</span>
        <span class="c1">## Ratio = [( QM*term1 +term2) Gm + (term1-term2) Ge]/(QM+1)</span>
        <span class="n">QM</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">thisq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">thismass</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">QMP1</span> <span class="o">=</span> <span class="n">QM</span> <span class="o">+</span> <span class="mf">1.</span>
        <span class="n">GeGmterm1</span> <span class="o">=</span> <span class="p">(</span><span class="n">term1</span><span class="o">-</span><span class="n">term2</span><span class="p">)</span><span class="o">/</span><span class="n">QMP1</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">myeps</span><span class="p">:</span>
            <span class="n">GeGmterm2</span> <span class="o">=</span> <span class="n">term2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if opp == (&#39;P4&#39;,&#39;g4&#39;):</span>
            <span class="c1">#     print &#39;debug&#39;</span>
            <span class="c1">#     print opp,QM , term1, term2</span>
            <span class="c1">#     print</span>
            <span class="n">GeGmterm2</span> <span class="o">=</span> <span class="p">(</span><span class="n">QM</span><span class="o">*</span><span class="n">term1</span><span class="o">+</span><span class="n">term2</span><span class="p">)</span><span class="o">/</span><span class="n">QMP1</span>
        <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">GeGmterm1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">GeGmterm2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">GeGmterm1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">GeGmterm2</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span>
        <span class="n">GeGmout</span> <span class="o">=</span> <span class="p">[</span><span class="n">GeGmterm1</span><span class="p">,</span><span class="n">GeGmterm2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">PadF3</span><span class="p">:</span> <span class="n">GeGmout</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">GeGmout</span><span class="p">,</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span><span class="ow">not</span> <span class="n">ccheck</span></div>

    <span class="c1">## helper function used to pull out usefull stuff from opp</span>
<div class="viewcode-block" id="CorrSpinTrace.FormatOpp"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.FormatOpp">[docs]</a>    <span class="k">def</span> <span class="nf">FormatOpp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">combProjGamma</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">thisProj</span><span class="p">,</span><span class="n">thisopp</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span> <span class="o">=</span> <span class="p">(),(),</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span>
        <span class="k">for</span> <span class="n">iopp</span> <span class="ow">in</span> <span class="n">opp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">iopp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Top&#39;</span><span class="p">,</span><span class="s1">&#39;Wein&#39;</span><span class="p">,</span><span class="s1">&#39;cmplx&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="s1">&#39;P&#39;</span> <span class="ow">in</span> <span class="n">iopp</span><span class="p">:</span>
                    <span class="n">thisProj</span> <span class="o">=</span> <span class="p">(</span><span class="n">iopp</span><span class="p">,)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thisopp</span> <span class="o">+=</span> <span class="p">(</span><span class="n">iopp</span><span class="p">,)</span>
            <span class="k">elif</span> <span class="n">iopp</span> <span class="o">==</span> <span class="s1">&#39;cmplx&#39;</span><span class="p">:</span>
                <span class="n">iscmplx</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">iopp</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">:</span>
                <span class="n">isneg</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">combProjGamma</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">thisProj</span><span class="o">+</span><span class="n">thisopp</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">thisProj</span><span class="p">,</span><span class="n">thisopp</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span></div>

<div class="viewcode-block" id="CorrSpinTrace.VectorFFTop"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.VectorFFTop">[docs]</a>    <span class="k">def</span> <span class="nf">VectorFFTop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Top&#39;</span> <span class="ow">in</span> <span class="n">opp</span> <span class="ow">or</span> <span class="s1">&#39;Wein&#39;</span> <span class="ow">in</span> <span class="n">opp</span><span class="p">:</span>
            <span class="n">thisopp</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FormatOpp</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFunTop</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">j</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisopp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">iscmplx</span><span class="p">:</span>
                        <span class="c1"># print &#39;calculating form factor coeffs for &#39; ,thisopp[:-1]+(&#39;g&#39;+str(i),),&#39;xq&#39;</span>
                        <span class="n">term2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFunTop</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">## sigma_mu_nu * q_mu = -i * g_mu * g_nu * q_nu</span>
                        <span class="c1"># print &#39;calculating form factor coeffs for &#39; ,thisopp+(&#39;g&#39;+str(i),&#39;cmplx&#39;,&#39;neg&#39;),&#39;xq&#39;</span>
                        <span class="n">term2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFunTop</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;cmplx&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">term2</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="p">)</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">j</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thisopp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">iscmplx</span><span class="p">:</span>
                        <span class="c1">## sigma_mu_nu * q_mu = -i * g_mu * g_nu * q_nu</span>
                        <span class="n">term3</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;g5&#39;</span><span class="p">),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">term3</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">thisopp</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="s1">&#39;g5&#39;</span><span class="p">,</span><span class="s1">&#39;cmplx&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="n">term3</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="p">)</span>
            <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term3</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span>
                             <span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span>  <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term3</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">,</span><span class="n">term2</span><span class="p">,</span><span class="n">term3</span><span class="p">],</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span> <span class="ow">not</span> <span class="n">ccheck</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VectorFF</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">,</span><span class="n">PadF3</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="CorrSpinTrace.PsVectorFF"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.PsVectorFF">[docs]</a>    <span class="k">def</span> <span class="nf">PsVectorFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>
        <span class="n">oppNoG</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">opp</span><span class="p">))</span>
        <span class="n">oppNoG</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;g5&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iopp</span> <span class="ow">in</span> <span class="n">oppNoG</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;g&#39;</span> <span class="ow">in</span> <span class="n">iopp</span><span class="p">:</span>
                <span class="n">index1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iopp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">oppNoG</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">index1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="p">)</span>
        <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">,</span><span class="n">term2</span><span class="p">],</span><span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span> <span class="ow">not</span> <span class="n">ccheck</span></div>


<div class="viewcode-block" id="CorrSpinTrace.TensorFF"><a class="viewcode-back" href="../GammaMatricies.html#GammaMatricies.CorrSpinTrace.TensorFF">[docs]</a>    <span class="k">def</span> <span class="nf">TensorFF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">opp</span><span class="p">,</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">thisp</span><span class="p">,</span><span class="n">thisq</span><span class="p">,</span><span class="n">thispp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create4Mom</span><span class="p">(</span><span class="n">thisqvec</span><span class="p">,</span><span class="n">thisppvec</span><span class="p">,</span><span class="n">thismass</span><span class="p">)</span>
        <span class="c1">## P = pp + p = 2*pp -q</span>
        <span class="n">thisP</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="n">ipp</span> <span class="k">for</span> <span class="n">ip</span><span class="p">,</span><span class="n">ipp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">)]</span>

        <span class="n">Proj</span><span class="p">,</span><span class="n">gammalist</span><span class="p">,</span><span class="n">iscmplx</span><span class="p">,</span><span class="n">isneg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FormatOpp</span><span class="p">(</span><span class="n">opp</span><span class="p">,</span><span class="n">combProjGamma</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">iscmplx</span><span class="p">:</span> <span class="n">coeff</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">j</span>
        <span class="k">if</span> <span class="n">isneg</span><span class="p">:</span> <span class="n">coeff</span> <span class="o">=</span> <span class="o">-</span><span class="n">coeff</span>
        <span class="n">index1</span><span class="p">,</span><span class="n">index2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gammalist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">gammalist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">## sigma_mu_nu * q_mu = -i * g_mu * g_nu * q_nu</span>
        <span class="c1">## term1 = i sigma_mu_nu H_T(Q^2)</span>
        <span class="c1">## i and -i cancel when sub in sigma_mu_nu</span>
        <span class="c1">## TODO, not sure of the sign of this!!!!</span>
        <span class="c1">## most papers are in Minkowski space me thinks</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">Proj</span><span class="o">+</span><span class="n">gammalist</span><span class="p">,</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span>

        <span class="c1"># print Proj,gammalist</span>
        <span class="c1"># print &#39;&#39;</span>
        <span class="c1"># print &#39;term1&#39;</span>
        <span class="c1"># print self.TracedFFun(Proj+gammalist,thisp,thispp,thismass,Rfac=Rfac)</span>
        <span class="c1"># print &#39;&#39;</span>


        <span class="c1">## term2 = (gamma_mu q_nu - gamma_nu * q_mu ) /2m * E_T(Q^2)</span>
        <span class="c1">## TODO: not sure of the sign of this!!</span>
        <span class="c1">## most papers are in Minkowski space me thinks</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">coeff</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">Proj</span><span class="o">+</span><span class="p">(</span><span class="n">gammalist</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span> <span class="o">-</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">Proj</span><span class="o">+</span><span class="p">(</span><span class="n">gammalist</span><span class="p">[</span><span class="mi">1</span><span class="p">],),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">index1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="p">)</span>
        <span class="c1"># print &#39;&#39;</span>
        <span class="c1"># print &#39;term2&#39;</span>
        <span class="c1"># print self.TracedFFun(Proj+(gammalist[0],),thisp,thispp,thismass,Rfac=Rfac), thisq[index2]</span>
        <span class="c1"># print self.TracedFFun(Proj+(gammalist[0],),thisp,thispp,thismass,Rfac=Rfac)*thisq[index2]</span>
        <span class="c1"># print self.TracedFFun(Proj+(gammalist[1],),thisp,thispp,thismass,Rfac=Rfac) , thisq[index1]</span>
        <span class="c1"># print self.TracedFFun(Proj+(gammalist[1],),thisp,thispp,thismass,Rfac=Rfac)*thisq[index1]</span>
        <span class="c1"># print &#39;&#39;</span>

        <span class="c1">## term3 = (P_mu q_nu - P_nu q_nu)/2m^2 tilde{H}_1</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">TracedFFun</span><span class="p">(</span><span class="n">Proj</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,),</span><span class="n">thisp</span><span class="p">,</span><span class="n">thispp</span><span class="p">,</span><span class="n">thismass</span><span class="p">,</span><span class="n">Rfac</span><span class="o">=</span><span class="n">Rfac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">thisP</span><span class="p">[</span><span class="n">index1</span><span class="p">]</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="n">thisP</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span><span class="o">*</span><span class="n">thisq</span><span class="p">[</span><span class="n">index1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">thismass</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># print &#39;term3&#39;</span>
        <span class="c1"># print self.TracedFFun(Proj+(&#39;I&#39;,),thisp,thispp,thismass,Rfac=Rfac)</span>
        <span class="c1"># print thisP[index1]*thisq[index2]</span>
        <span class="c1"># print thisP[index2]*thisq[index1]</span>
        <span class="c1"># print (thisP[index1]*thisq[index2] - thisP[index2]*thisq[index1] )</span>
        <span class="c1"># print &#39;&#39;</span>
        <span class="c1">##Discrepancy? i think</span>
        <span class="n">rcheck</span><span class="p">,</span><span class="n">ccheck</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term3</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">,</span>
                         <span class="nb">abs</span><span class="p">(</span><span class="n">term1</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term2</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">term3</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">&lt;</span><span class="n">myeps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">term1</span><span class="p">,</span><span class="n">term2</span><span class="p">,</span><span class="n">term3</span><span class="p">],</span> <span class="ow">not</span> <span class="n">rcheck</span><span class="p">,</span><span class="ow">not</span> <span class="n">ccheck</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">gdata</span> <span class="o">=</span> <span class="n">GammaMat</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gdata</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Jack Dragos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>
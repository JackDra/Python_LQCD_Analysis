
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Mat_Alpha_Hack &#8212; LQCD Analysis Codebase TF Fits documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">LQCD Analysis Codebase TF Fits documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Mat_Alpha_Hack</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">FlowOpps</span> <span class="k">import</span> <span class="n">FlowOp</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">defInfoFlow</span><span class="p">,</span><span class="n">defxlimOpMost</span>
<span class="kn">from</span> <span class="nn">Params</span> <span class="k">import</span> <span class="n">outputdir</span><span class="p">,</span><span class="n">graphdir</span><span class="p">,</span><span class="n">scratchdir</span>
<span class="kn">from</span> <span class="nn">XmlFormatting</span> <span class="k">import</span> <span class="n">tflowTOLeg</span><span class="p">,</span><span class="n">untflowstr</span>
<span class="kn">from</span> <span class="nn">TimeStuff</span> <span class="k">import</span> <span class="n">Timer</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">from</span> <span class="nn">NullPlotData</span> <span class="k">import</span> <span class="n">null_series</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">Autocorr</span> <span class="k">import</span> <span class="n">AutoCorrelate</span>
<span class="kn">from</span> <span class="nn">PredefFitFuns</span> <span class="k">import</span> <span class="n">LinearFitFun</span><span class="p">,</span><span class="n">LinFFDer</span><span class="p">,</span><span class="n">c3FitFun_nosqrt</span>
<span class="kn">import</span> <span class="nn">SetsOfFits</span> <span class="k">as</span> <span class="nn">sff</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">PlotData</span> <span class="k">import</span> <span class="n">Plotting</span>
<span class="kn">from</span> <span class="nn">QuantityLists</span> <span class="k">import</span> <span class="n">ens_dict</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pik</span>


<span class="c1"># nx,nt,latspace = 16,32,0.1215</span>
<span class="c1"># kud,ks = 13825,13710</span>
<span class="c1"># beta = 1.83</span>
<span class="c1"># csw = 1761</span>

<span class="c1"># t0=&#39;t_f0.15&#39;</span>
<span class="c1"># t0=&#39;t_f1.37&#39;</span>
<span class="c1"># t0=&#39;t_f3.07&#39;</span>
<span class="c1"># t0=&#39;t_f5.07&#39;</span>
<span class="n">force_t0</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">## try running all lattices at to</span>
<span class="n">mpi_latspace</span> <span class="o">=</span> <span class="mf">0.0907</span> <span class="c1"># fm</span>
<span class="n">ForceWipe</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">WipeBase</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># t0_phys=float(untflowstr(t0))*mpi_latspace**2 ## in fm^2</span>
<span class="c1"># t0_phys=0.1 ## in fm^2</span>
<span class="c1"># t0_phys=0.3 ## in fm^2</span>
<span class="c1"># sqrt8t0_phys = 0.1 ## in fm</span>
<span class="c1"># sqrt8t0_phys = 0.3 ## in fm</span>
<span class="n">my_eps_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;t_f</span><span class="si">{ival:.3}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">ival</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.00</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)]</span>
<span class="n">DoWW</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">DoAuto</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="DoWWAnalysis"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.DoWWAnalysis">[docs]</a><span class="k">def</span> <span class="nf">DoWWAnalysis</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">data_Q</span><span class="p">,</span><span class="n">data_E</span><span class="p">,</span><span class="n">data_W</span><span class="p">,</span><span class="n">data_QW</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">this_a</span><span class="p">):</span>
    <span class="c1">## this functions will have to do the bootstrapping, since it need to interpolate to t0_phys</span>
    <span class="n">t0_phys</span> <span class="o">=</span> <span class="n">t0</span><span class="o">*</span><span class="n">this_a</span><span class="o">**</span><span class="mi">2</span> <span class="c1">## in fm^2</span>
    <span class="n">t0_phys_str</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;t_fp</span><span class="si">{t0_phys:.3}</span><span class="s1">&#39;</span>
    <span class="n">out_name_NoE</span> <span class="o">=</span> <span class="s1">&#39;Test_WWrat_NoE_&#39;</span><span class="o">+</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_phys_str</span>
    <span class="n">out_name</span> <span class="o">=</span> <span class="s1">&#39;Test_WWrat_&#39;</span><span class="o">+</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_phys_str</span>
    <span class="c1"># t0_mpi = &#39;mpi&#39; in ens_name or force_t0</span>
    <span class="n">ens_latspace_2</span> <span class="o">=</span> <span class="n">data_Q</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1"># data_QW_tt = FlowOp(Info=InfoFlow,man_load_cfgs=True)</span>
    <span class="n">data_WW</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># data_QW_tt.FlowSetCustomName(string=ens_name+&#39;_Test_QW_tt_&#39;+t0_phys_str)</span>
    <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_WW_&#39;</span><span class="o">+</span><span class="n">t0_phys_str</span><span class="p">)</span>
    <span class="n">WW_ratio</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">)</span>
    <span class="n">WW_NoE_ratio</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_NoE</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">WW_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found pickled file for Test_WWrat:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">WW_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found pickled file for Test_WWrat_NoE:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
        <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># data_QW.FlowSetCustomName(string=ens_name+&#39;_Test_QW_&#39;+t0_phys_str)</span>
        <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_WW_&#39;</span><span class="o">+</span><span class="n">t0_phys_str</span><span class="p">)</span>
        <span class="c1"># if os.path.isfile(data_QW.flowPickleFile) and not ForceWipe:</span>
        <span class="c1">#     data_QW.FlowLoadPickle(CheckCfgs=False,WipeData=False,DefWipe=False)</span>
        <span class="c1"># if not t0_mpi:</span>
        <span class="c1">#     if os.path.isfile(data_QW_tt.flowPickleFile) and not ForceWipe:</span>
        <span class="c1">#         data_QW_tt.FlowLoadPickle(CheckCfgs=False,WipeData=False,DefWipe=False)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_WW</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if os.path.isfile(data_QW_tt.flowPickleFile) and not ForceWipe:</span>
        <span class="c1">#     data_QW_tt.FlowLoadPickle(CheckCfgs=False,WipeData=False,DefWipe=False)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     data_QW_tt = data_Q.FlowCombinePreBS(data_W,Operation=&#39;x&#39;)</span>
        <span class="c1">#     data_QW_tt.FlowSetCustomName(string=ens_name+&#39;_QW_tt_&#39;+t0_phys_str)</span>
        <span class="c1">#     data_QW_tt.FlowBootstrap(WipeData=False)</span>
        <span class="c1">#     data_QW_tt.FlowWrite()</span>
        <span class="c1"># if t0_mpi:</span>
        <span class="c1">#     data_QW.FlowSetCustomName(string=ens_name+&#39;_Test_QW_&#39;+t0_phys_str)</span>
        <span class="c1">#     data_QW.FlowWrite()</span>
        <span class="c1">#     if os.path.isfile(data_WW.flowPickleFile) and not ForceWipe:</span>
        <span class="c1">#         data_WW.FlowLoadPickle(CheckCfgs=False,WipeData=False,DefWipe=False)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         data_WW_low,data_WW_high,tlow,thigh = data_W.FlowCombinePreBS_FixFT_Interp(data_W,Operation=&#39;x&#39;,flow_time=t0_phys,Phys=True)</span>
        <span class="c1">#         data_WW_low.FlowSetCustomName(string=ens_name+&#39;_Test_WW_low_&#39;+str(tlow))</span>
        <span class="c1">#         data_WW_high.FlowSetCustomName(string=ens_name+&#39;_Test_WW_high_&#39;+str(thigh))</span>
        <span class="c1">#         data_WW_low.FlowBootstrap(WipeData=False)</span>
        <span class="c1">#         data_WW_high.FlowBootstrap(WipeData=False)</span>
        <span class="c1">#         data_WW_low.FlowWrite()</span>
        <span class="c1">#         data_WW_high.FlowWrite()</span>
        <span class="c1">#         fit_info = {}</span>
        <span class="c1">#         fit_info[&#39;Funs&#39;] = (LinearFitFun,2)</span>
        <span class="c1">#         fit_info[&#39;name&#39;] = data_WW_low.flowname + &#39;_&#39;+ data_WW_high.flowname + &#39;_Interp&#39;</span>
        <span class="c1">#         # tlow_index = list(data_WW_low.Op_Stats.index).index(tlow)</span>
        <span class="c1">#         # thigh_index = list(data_WW_high.Op_Stats.index).index(thigh)</span>
        <span class="c1">#         tm = t0_phys / (data_Q.latparams.latspace**2)</span>
        <span class="c1">#         t0_ratio_eval = (tm - untflowstr(tlow))/(untflowstr(thigh)-untflowstr(tlow))</span>
        <span class="c1">#         if 0&gt;t0_ratio_eval &gt;1:</span>
        <span class="c1">#             out_str = &#39;tm must be between the tlow, tight\n&#39;</span>
        <span class="c1">#             out_str += &#39;tlow : &#39;+untflowstr(tlow)+&#39;\n&#39;</span>
        <span class="c1">#             out_str += &#39;tmid : &#39;+str(tm)+&#39;\n&#39;</span>
        <span class="c1">#             out_str += &#39;thigh : &#39;+untflowstr(thigh)+&#39;\n&#39;</span>
        <span class="c1">#             raise EnvironmentError(out_str)</span>
        <span class="c1">#         def Fitt(value):</span>
        <span class="c1">#             data = pa.Series([value[&#39;low&#39;],value[&#39;high&#39;]])</span>
        <span class="c1">#             this_fit = sff.SetOfFitFuns(data=data)</span>
        <span class="c1">#             this_test = this_fit.ScanRange(0,1,fit_info=fit_info,min_fit_len=0)</span>
        <span class="c1">#             if this_test:</span>
        <span class="c1">#                 this_fit.DoFits(show_timer=False)</span>
        <span class="c1">#                 this_fit.SortChi()</span>
        <span class="c1">#                 return this_fit.Fit_Stats.loc[:,&#39;Fit&#39;].iloc[0].Eval_Function(t0_ratio_eval)</span>
        <span class="c1">#             else:</span>
        <span class="c1">#                 return float(&#39;NaN&#39;)</span>
        <span class="c1">#         data_WW_df = data_WW_low.Op_Stats[&#39;boot&#39;].to_frame(&#39;low&#39;)</span>
        <span class="c1">#         data_WW_df[&#39;high&#39;] = data_WW_high.Op_Stats[&#39;boot&#39;]</span>
        <span class="c1">#         data_WW.FlowSetCustomName(string=ens_name+&#39;_Test_WW_&#39;+t0_phys_str)</span>
        <span class="c1">#         data_WW.Op_Stats[&#39;boot&#39;] = data_WW_df.apply(Fitt,axis=1)</span>
        <span class="c1">#         data_WW.FlowWrite()</span>
        <span class="c1">#     QW_denom = data_QW.Op_Stats[&#39;boot&#39;][t0]</span>
        <span class="c1"># else:</span>
        <span class="n">flow_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">data_QW</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
        <span class="k">def</span> <span class="nf">SortFun_pos</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">t0_phys</span><span class="o">-</span><span class="n">val</span><span class="o">*</span><span class="n">ens_latspace_2</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1000</span>
        <span class="k">def</span> <span class="nf">SortFun_neg</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">t0_phys</span><span class="o">-</span><span class="n">val</span><span class="o">*</span><span class="n">ens_latspace_2</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1000</span>
        <span class="n">left_flow</span> <span class="o">=</span> <span class="n">flow_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">flow_list</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">SortFun_pos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">right_flow</span> <span class="o">=</span> <span class="n">flow_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">flow_list</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span><span class="n">SortFun_neg</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">t0_phys</span> <span class="o">/</span> <span class="p">(</span><span class="n">data_Q</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left_flow</span> <span class="o">&gt;</span> <span class="n">right_flow</span><span class="p">:</span>
            <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;problem deturmining closest flow times</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;left: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">left_flow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;t0_phys: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;right: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">right_flow</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">flow_list</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="n">out_str</span><span class="p">)</span>
        <span class="n">flowfitr</span> <span class="o">=</span> <span class="s1">&#39;fitr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">left_flow</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">right_flow</span><span class="p">))</span>
        <span class="n">t0_ratio_eval</span> <span class="o">=</span> <span class="p">(</span><span class="n">tm</span> <span class="o">-</span> <span class="n">untflowstr</span><span class="p">(</span><span class="n">flow_list</span><span class="p">[</span><span class="n">left_flow</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">flow_list</span><span class="p">[</span><span class="n">right_flow</span><span class="p">])</span><span class="o">-</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">flow_list</span><span class="p">[</span><span class="n">left_flow</span><span class="p">]))</span>
        <span class="k">if</span> <span class="mi">0</span><span class="o">&gt;</span><span class="n">t0_ratio_eval</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;tm must be between the tlow, tight</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tlow : &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow_list</span><span class="p">[</span><span class="n">left_flow</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tmid : &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;thigh : &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow_list</span><span class="p">[</span><span class="n">right_flow</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="n">out_str</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetFunction</span><span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowFit</span><span class="p">(</span><span class="n">flowfit_range</span><span class="o">=</span><span class="n">flowfitr</span><span class="p">)</span>
        <span class="n">QW_denom</span> <span class="o">=</span> <span class="n">data_QW</span><span class="o">.</span><span class="n">flowFit_Stats</span><span class="o">.</span><span class="n">Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="n">t0_ratio_eval</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_WW</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_WW_low</span><span class="p">,</span><span class="n">data_WW_high</span><span class="p">,</span><span class="n">tlow</span><span class="p">,</span><span class="n">thigh</span> <span class="o">=</span> <span class="n">data_W</span><span class="o">.</span><span class="n">FlowCombinePreBS_FixFT_Interp</span><span class="p">(</span><span class="n">data_W</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="n">t0_phys</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">data_WW_low</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_WW_low_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tlow</span><span class="p">))</span>
            <span class="n">data_WW_high</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_WW_high_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">thigh</span><span class="p">))</span>
            <span class="n">data_WW_low</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_WW_high</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_WW_low</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
            <span class="n">data_WW_high</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
            <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_WW_low</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="n">data_WW_high</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39;_Interp&#39;</span>
            <span class="c1"># tlow_index = list(data_WW_low.Op_Stats.index).index(tlow)</span>
            <span class="c1"># thigh_index = list(data_WW_high.Op_Stats.index).index(thigh)</span>
            <span class="n">tm</span> <span class="o">=</span> <span class="n">t0_phys</span> <span class="o">/</span> <span class="p">(</span><span class="n">data_Q</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">t0_ratio_eval</span> <span class="o">=</span> <span class="p">(</span><span class="n">tm</span> <span class="o">-</span> <span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">thigh</span><span class="p">)</span><span class="o">-</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">))</span>
            <span class="k">if</span> <span class="mi">0</span><span class="o">&gt;</span><span class="n">t0_ratio_eval</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;tm must be between the tlow, tight</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tlow : &#39;</span><span class="o">+</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tmid : &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;thigh : &#39;</span><span class="o">+</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">thigh</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="n">out_str</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">Fitt</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]])</span>
                <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
                <span class="n">this_test</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
                    <span class="n">this_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">this_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
                    <span class="k">return</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="n">t0_ratio_eval</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
            <span class="n">data_WW_df</span> <span class="o">=</span> <span class="n">data_WW_low</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
            <span class="n">data_WW_df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_WW_high</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_WW_&#39;</span><span class="o">+</span><span class="n">t0_phys_str</span><span class="p">)</span>
            <span class="n">data_WW</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_WW_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Fitt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">data_WW</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;QW_denom is&#39;</span><span class="p">,</span><span class="n">QW_denom</span><span class="o">.</span><span class="n">MakeValAndErr</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;evaulated at&#39;</span><span class="p">,</span><span class="n">t0_phys_str</span><span class="p">,</span><span class="s1">&#39; fm&#39;</span><span class="p">)</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">t0_phys</span> <span class="o">/</span> <span class="p">(</span><span class="n">data_Q</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">latspace</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in lattice units&#39;</span><span class="p">,</span><span class="s1">&#39;t_f&#39;</span><span class="o">+</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{tm:.2}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">WW_NoE_ratio</span> <span class="o">=</span> <span class="n">data_WW</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">QW_denom</span><span class="p">)</span>
        <span class="n">WW_ratio</span> <span class="o">=</span> <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">data_E</span><span class="p">)</span>
        <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">)</span>
        <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_NoE</span><span class="p">)</span>
        <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">WW_ratio</span><span class="o">.</span><span class="n">FlowPlot_mul_tf2</span><span class="p">(</span><span class="n">data_plot</span><span class="p">)</span>
    <span class="n">data_plot_NoE</span> <span class="o">=</span> <span class="n">WW_NoE_ratio</span><span class="o">.</span><span class="n">FlowPlot_mul_tf2</span><span class="p">(</span><span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">mul</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">WW_ratio</span><span class="p">,</span><span class="n">WW_NoE_ratio</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">data_WW</span></div>


<div class="viewcode-block" id="GetCfgQuenched"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.GetCfgQuenched">[docs]</a><span class="k">def</span> <span class="nf">GetCfgQuenched</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">):</span>
    <span class="n">nx</span><span class="p">,</span><span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">beta_float</span> <span class="o">=</span> <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;Beta&#39;</span><span class="p">]</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;b</span><span class="si">{beta_float:.2f}</span><span class="s1">&#39;</span>
    <span class="n">dim_str</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{nx}</span><span class="s1">x</span><span class="si">{nt}</span><span class="s1">&#39;</span>
    <span class="n">cfglist_Q</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cfglist_W</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cfglist_E</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cval_Q</span><span class="p">,</span><span class="n">cval_W</span><span class="p">,</span><span class="n">cval_E</span><span class="p">,</span><span class="n">ival</span> <span class="o">=</span> <span class="p">[],[],[],[]</span>
    <span class="n">master_folder</span> <span class="o">=</span> <span class="s1">&#39;/mnt/research/lqcd/gauge_observables/&#39;</span>
    <span class="n">master_folder</span> <span class="o">+=</span> <span class="n">dim_str</span><span class="o">+</span><span class="n">beta</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">master_folder</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;path not found:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">master_folder</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span>

    <span class="n">printed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">printedQNF</span><span class="p">,</span><span class="n">printedWNF</span><span class="p">,</span><span class="n">printedENF</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span>
    <span class="n">Q_folder</span> <span class="o">=</span> <span class="n">master_folder</span> <span class="o">+</span> <span class="s1">&#39;Q/&#39;</span>
    <span class="n">W_folder</span> <span class="o">=</span> <span class="n">master_folder</span><span class="o">+</span> <span class="s1">&#39;W/&#39;</span>
    <span class="n">E_folder</span> <span class="o">=</span> <span class="n">master_folder</span><span class="o">+</span> <span class="s1">&#39;E/&#39;</span>
    <span class="k">for</span> <span class="n">icfg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1500</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;conf</span><span class="si">{icfg:04}</span><span class="s1">.dat&#39;</span>
        <span class="n">this_file_Q</span> <span class="o">=</span> <span class="n">Q_folder</span> <span class="o">+</span> <span class="n">file_name</span>
        <span class="n">this_file_W</span> <span class="o">=</span> <span class="n">W_folder</span> <span class="o">+</span> <span class="n">file_name</span>
        <span class="n">this_file_E</span> <span class="o">=</span> <span class="n">E_folder</span> <span class="o">+</span> <span class="n">file_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">printedQNF</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
            <span class="n">printedQNF</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">printedWNF</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
            <span class="n">printedWNF</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">printedENF</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
            <span class="n">printedENF</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">printed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;adding files&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="n">printed</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">cval_Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
            <span class="n">cval_W</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
            <span class="n">cval_E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
            <span class="n">ival</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;-q-&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">icfg</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cval_Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No CFGS found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span>
    <span class="n">mi_ival</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
    <span class="n">cfglist_Q</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_Q</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="n">cfglist_W</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_W</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="n">cfglist_E</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_E</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cfglist_Q</span><span class="p">,</span><span class="n">cfglist_W</span><span class="p">,</span><span class="n">cfglist_E</span></div>


<div class="viewcode-block" id="GetCfgEns"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.GetCfgEns">[docs]</a><span class="k">def</span> <span class="nf">GetCfgEns</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">):</span>
    <span class="n">nx</span><span class="p">,</span><span class="n">nt</span> <span class="o">=</span> <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kud</span><span class="p">,</span><span class="n">ks</span> <span class="o">=</span> <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">100</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">100</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;Beta&#39;</span><span class="p">])</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">beta</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1.9&#39;</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">csw</span> <span class="o">=</span> <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;Csw&#39;</span><span class="p">]</span>

    <span class="n">beta_str</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;Beta&#39;</span><span class="p">])</span>
    <span class="n">RC_str</span> <span class="o">=</span> <span class="s1">&#39;RC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
    <span class="n">RC_str2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;X&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
    <span class="n">kud_str</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;00Ks0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;00&#39;</span>
    <span class="k">if</span> <span class="n">nx</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">kud_str2</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;L20kl0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;ks0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">kud_str3</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nx</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
        <span class="n">kud_str2</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;kl0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;ks0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">kud_str3</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;00Ks0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;00&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kud_str3</span> <span class="o">=</span> <span class="s1">&#39;Kud0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Ks0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span>
        <span class="n">kud_str2</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;kl0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kud</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;ks0.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span>


    <span class="n">Csw</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">csw</span><span class="p">)</span>
    <span class="n">cfglist_Q</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cfglist_W</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cfglist_E</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">cval_Q</span><span class="p">,</span><span class="n">cval_W</span><span class="p">,</span><span class="n">cval_E</span><span class="p">,</span><span class="n">ival</span> <span class="o">=</span> <span class="p">[],[],[],[]</span>
    <span class="k">for</span> <span class="n">istream</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;-1-&#39;</span><span class="p">,</span><span class="s1">&#39;-2-&#39;</span><span class="p">,</span><span class="s1">&#39;-3-&#39;</span><span class="p">,</span><span class="s1">&#39;-4-&#39;</span><span class="p">,</span><span class="s1">&#39;-a-&#39;</span><span class="p">,</span><span class="s1">&#39;-b-&#39;</span><span class="p">]:</span>
    <span class="c1"># for istream in [&#39;-1-&#39;,&#39;-2-&#39;,&#39;-a-&#39;,&#39;-b-&#39;]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;/mnt/research/lqcd/CfunAnalysis/FlowNewForm/&#39;</span><span class="o">+</span><span class="n">RC_str</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">kud_str</span><span class="o">+</span><span class="n">istream</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;path not found:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;/mnt/research/lqcd/CfunAnalysis/FlowNewForm/&#39;</span><span class="o">+</span><span class="n">RC_str</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">kud_str</span><span class="o">+</span><span class="n">istream</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="k">continue</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making file list for stream&#39;</span><span class="p">,</span><span class="n">istream</span><span class="p">)</span>
        <span class="n">printed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">printedQNF</span><span class="p">,</span><span class="n">printedWNF</span><span class="p">,</span><span class="n">printedENF</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span>
        <span class="k">for</span> <span class="n">icfg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">700</span><span class="p">):</span>
            <span class="n">icfg_pad</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{icfg:03}</span><span class="s1">&#39;</span>
            <span class="n">this_file_Q</span> <span class="o">=</span> <span class="s1">&#39;/mnt/research/lqcd/CfunAnalysis/FlowNewForm/&#39;</span><span class="o">+</span><span class="n">RC_str</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">kud_str</span><span class="o">+</span><span class="n">istream</span><span class="o">+</span><span class="s1">&#39;/PerGF/q_flow_b1.90_ng@0.out&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="n">icfg_pad</span><span class="p">)</span>

            <span class="n">this_file_W</span> <span class="o">=</span> <span class="s1">&#39;/mnt/research/lqcd/qcEDM/&#39;</span><span class="o">+</span><span class="n">kud_str2</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">RC_str2</span><span class="o">+</span><span class="s1">&#39;/data/weinberg/&#39;</span><span class="o">+</span><span class="n">RC_str</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">beta_str</span><span class="o">+</span><span class="n">kud_str3</span><span class="o">+</span><span class="n">Csw</span><span class="o">+</span><span class="n">istream</span><span class="o">+</span><span class="s1">&#39;00@0/weinberg_T_0.00.dat&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="n">icfg_pad</span><span class="p">)</span>

            <span class="n">this_file_E</span> <span class="o">=</span> <span class="s1">&#39;/mnt/research/lqcd/qcEDM/&#39;</span><span class="o">+</span><span class="n">kud_str2</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">RC_str2</span><span class="o">+</span><span class="s1">&#39;/data/energy/&#39;</span><span class="o">+</span><span class="n">RC_str</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">beta_str</span><span class="o">+</span><span class="n">kud_str3</span><span class="o">+</span><span class="n">Csw</span><span class="o">+</span><span class="n">istream</span><span class="o">+</span><span class="s1">&#39;00@0/energy_T_0.00.dat&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="n">icfg_pad</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">printedQNF</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
                <span class="n">printedQNF</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">printedWNF</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
                <span class="n">printedWNF</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">printedENF</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FNF:&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
                <span class="n">printedENF</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">printed</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;adding files&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">()</span>
                <span class="n">printed</span><span class="o">=</span><span class="kc">True</span>
                <span class="n">cval_Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_Q</span><span class="p">)</span>
                <span class="n">cval_W</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_W</span><span class="p">)</span>
                <span class="n">cval_E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_file_E</span><span class="p">)</span>
                <span class="n">ival</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">istream</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">icfg</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cval_Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No CFGS found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span>
    <span class="n">mi_ival</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
    <span class="n">cfglist_Q</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_Q</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="n">cfglist_W</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_W</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="n">cfglist_E</span><span class="p">[</span><span class="s1">&#39;file_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cval_E</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">mi_ival</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cfglist_Q</span><span class="p">,</span><span class="n">cfglist_W</span><span class="p">,</span><span class="n">cfglist_E</span></div>




<div class="viewcode-block" id="AlphaRatAnalysis"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.AlphaRatAnalysis">[docs]</a><span class="k">def</span> <span class="nf">AlphaRatAnalysis</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">data_plot_NoE</span><span class="p">,</span>
                     <span class="n">data_plot_tauint</span><span class="p">,</span><span class="n">data_plot_covar</span><span class="p">,</span><span class="n">t0_scale</span><span class="p">,</span><span class="n">nblock</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">t0_scale_str</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;t_s</span><span class="si">{t0_scale:.3}</span><span class="s1">&#39;</span>
    <span class="n">leg_lab_ext</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39; \frac{t_</span><span class="si">{s}</span><span class="s1">}{t_</span><span class="si">{0}</span><span class="s1">}=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t_s&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;tflowlist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defxlimOpMost</span>
    <span class="n">InfoFlow</span><span class="p">[</span><span class="s1">&#39;n_block&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nblock</span>

    <span class="n">data_Q</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_W</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_E</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_QW</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_QQ</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_QQ0</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nblock</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nbstr</span> <span class="o">=</span> <span class="s1">&#39;_nb&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nblock</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nbstr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">out_name_NoE</span> <span class="o">=</span> <span class="s1">&#39;Test_alpha_NoE_&#39;</span><span class="o">+</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">out_name_Q0</span><span class="o">=</span> <span class="s1">&#39;Test_alpha_Q0_&#39;</span><span class="o">+</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">out_name</span> <span class="o">=</span> <span class="s1">&#39;Test_alpha_&#39;</span><span class="o">+</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span>



    <span class="n">alpha_ratio</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">)</span>
    <span class="n">alpha_ratio_NoE</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_NoE</span><span class="p">)</span>
    <span class="n">alpha_ratio_Q0</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_Q0</span><span class="p">)</span>
    <span class="n">DoRead</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">alpha_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> \
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> \
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found pickled file for Test_alpha:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">alpha_ratio</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
        <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
            <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found pickled file for Test_alpha_NoE:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
        <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
            <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found pickled file for Test_alpha_Q0:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span>
        <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Auto&#39;</span> <span class="ow">in</span> <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
            <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>

        <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_Q&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_E</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_E&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_W</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_W&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ0&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">data_QW</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_Q</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">):</span>
            <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_E</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">):</span>
            <span class="n">data_E</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>
            <span class="n">data_E</span><span class="o">.</span><span class="n">Compute_t0</span><span class="p">()</span>
            <span class="n">this_t0</span> <span class="o">=</span> <span class="n">data_E</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">t0_scale</span><span class="o">*</span><span class="n">this_t0</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Avg</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_W</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">):</span>
            <span class="n">data_W</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QQ</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QQ0</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QW</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">DoRead</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">DoRead</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;qu_&#39;</span> <span class="ow">in</span> <span class="n">ens_name</span><span class="p">:</span>
            <span class="n">cfglist_Q</span><span class="p">,</span><span class="n">cfglist_W</span><span class="p">,</span><span class="n">cfglist_E</span> <span class="o">=</span> <span class="n">GetCfgQuenched</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cfglist_Q</span><span class="p">,</span><span class="n">cfglist_W</span><span class="p">,</span><span class="n">cfglist_E</span> <span class="o">=</span> <span class="n">GetCfgEns</span><span class="p">(</span><span class="n">ens_name</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cfglist_Q</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;failed to find configurations&#39;</span><span class="p">)</span>
        <span class="n">cfg_list_fileQ</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_cfglist_Q.csv&#39;</span>
        <span class="n">cfg_list_fileW</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_cfglist_W.csv&#39;</span>
        <span class="n">cfg_list_fileE</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_cfglist_E.csv&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;outputting cfglist to files:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cfg_list_fileQ</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cfg_list_fileW</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cfg_list_fileE</span><span class="p">)</span>

        <span class="n">cfglist_Q</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">cfg_list_fileQ</span><span class="p">)</span>
        <span class="n">cfglist_W</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">cfg_list_fileW</span><span class="p">)</span>
        <span class="n">cfglist_E</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">cfg_list_fileE</span><span class="p">)</span>

        <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist_Q</span><span class="p">)</span>
        <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_Q&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>

        <span class="n">data_W</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist_W</span><span class="p">)</span>
        <span class="n">data_W</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_W&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_W</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>

        <span class="n">data_E</span><span class="o">.</span><span class="n">FlowImportCfgList</span><span class="p">(</span><span class="n">cfglist_E</span><span class="p">)</span>
        <span class="n">data_E</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_E&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_E</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="n">WipeBase</span><span class="p">)</span>
        <span class="n">data_E</span><span class="o">.</span><span class="n">Compute_t0</span><span class="p">()</span>
        <span class="n">this_t0</span> <span class="o">=</span> <span class="n">data_E</span><span class="o">.</span><span class="n">t0_values</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">t0_scale</span><span class="o">*</span><span class="n">this_t0</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Avg</span>
        <span class="n">data_QW</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data_QQ</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data_QQ0</span> <span class="o">=</span> <span class="n">FlowOp</span><span class="p">(</span><span class="n">Info</span><span class="o">=</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">man_load_cfgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">data_QW</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
        <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ0&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QW</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_QW_low</span><span class="p">,</span><span class="n">data_QW_high</span><span class="p">,</span><span class="n">tlow</span><span class="p">,</span><span class="n">thigh</span> <span class="o">=</span> <span class="n">data_W</span><span class="o">.</span><span class="n">FlowCombinePreBS_FixFT_Interp</span><span class="p">(</span><span class="n">data_Q</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="n">ts</span><span class="p">,</span><span class="n">Phys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_QW_low</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_low_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tlow</span><span class="p">)</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
            <span class="n">data_QW_high</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_high_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">thigh</span><span class="p">)</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
            <span class="n">data_QW_low</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_QW_high</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_QW_low</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
            <span class="n">data_QW_high</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
            <span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinearFitFun</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QW_low</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="n">data_QW_high</span><span class="o">.</span><span class="n">flowname</span> <span class="o">+</span> <span class="s1">&#39;_Interp&#39;</span>
            <span class="c1"># tlow_index = list(data_QW_low.Op_Stats.index).index(tlow)</span>
            <span class="c1"># thigh_index = list(data_QW_high.Op_Stats.index).index(thigh)</span>
            <span class="n">t0_ratio_eval</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts</span> <span class="o">-</span> <span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">thigh</span><span class="p">)</span><span class="o">-</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">))</span>
            <span class="k">if</span> <span class="mi">0</span><span class="o">&gt;</span><span class="n">t0_ratio_eval</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">out_str</span> <span class="o">=</span> <span class="s1">&#39;tm must be between the tlow, tight</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tlow : &#39;</span><span class="o">+</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">tlow</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;tmid : &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">out_str</span> <span class="o">+=</span> <span class="s1">&#39;thigh : &#39;</span><span class="o">+</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">thigh</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="n">out_str</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">Fitt</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]])</span>
                <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
                <span class="n">this_test</span> <span class="o">=</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fit_info</span><span class="o">=</span><span class="n">fit_info</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">this_test</span><span class="p">:</span>
                    <span class="n">this_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">(</span><span class="n">show_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">this_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
                    <span class="k">return</span> <span class="n">this_fit</span><span class="o">.</span><span class="n">Fit_Stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Eval_Function</span><span class="p">(</span><span class="n">t0_ratio_eval</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
            <span class="n">data_QW_df</span> <span class="o">=</span> <span class="n">data_QW_low</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
            <span class="n">data_QW_df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QW_high</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QW_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="p">,</span>
                                      <span class="n">stringLL</span><span class="o">=</span><span class="n">data_QW</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QW_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Fitt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">data_QW</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QQ</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_QQ</span> <span class="o">=</span> <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowCombinePreBS</span><span class="p">(</span><span class="n">data_Q</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
            <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_QQ</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data_QQ0</span><span class="o">.</span><span class="n">flowPickleFile</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ForceWipe</span><span class="p">:</span>
            <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowLoadPickle</span><span class="p">(</span><span class="n">CheckCfgs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">DefWipe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_QQ0</span> <span class="o">=</span> <span class="n">data_Q</span><span class="o">.</span><span class="n">FlowCombinePreBS_FixFT</span><span class="p">(</span><span class="n">data_Q</span><span class="p">,</span><span class="n">Operation</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">flow_time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">ens_name</span><span class="o">+</span><span class="s1">&#39;_Test_QQ0&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="p">)</span>
            <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowBootstrap</span><span class="p">(</span><span class="n">WipeData</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">data_QQ0</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>

        <span class="c1"># alpha_ratio = data_QW.__div__(data_E)</span>
        <span class="c1"># alpha_ratio.Op_Stats[&#39;boot&#39;] = alpha_ratio.Op_Stats[&#39;boot&#39;] / data_QQ.Op_Stats[&#39;boot&#39;][t0]</span>
        <span class="n">alpha_ratio_Q0</span> <span class="o">=</span> <span class="n">data_QW</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">data_E</span><span class="o">*</span><span class="n">data_QQ0</span><span class="o">.</span><span class="n">GetInterp</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="n">alpha_ratio_NoE</span> <span class="o">=</span> <span class="n">data_QW</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">data_QQ</span><span class="o">.</span><span class="n">GetInterp</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="n">alpha_ratio</span> <span class="o">=</span> <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">data_E</span><span class="p">)</span>
        <span class="c1"># this_df = pa.DataFrame()</span>
        <span class="c1"># this_df[&#39;Op_QQ&#39;] = data_QQ.Op_cfgs[&#39;Op&#39;]</span>
        <span class="c1"># this_df[&#39;Op_QW&#39;] = data_QW.Op_cfgs[&#39;Op&#39;]</span>
        <span class="c1"># this_df[&#39;Op_E&#39;] = data_E.Op_cfgs[&#39;Op&#39;]</span>
        <span class="c1"># box_len_3 = alpha_ratio.latparams.nxyz**3</span>
        <span class="k">if</span> <span class="n">DoAuto</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Auto not implemented since we interpolating&#39;</span><span class="p">)</span>
            <span class="c1"># Alist = []</span>
            <span class="c1"># thistimer = Timer(linklist=alpha_ratio.tflowfloat,name=&#39;Autocorrelating &#39;+ens_name)</span>
            <span class="c1"># for ictflow,strit in enumerate(alpha_ratio.Op_Stats.index):</span>
            <span class="c1">#     itf = float(untflowstr(strit))</span>
            <span class="c1">#     # bl3_div_itf = box_len_3/itf</span>
            <span class="c1">#     bl3_div_itf = itf</span>
            <span class="c1">#     def RatAutoFun(QW,E,QQ):</span>
            <span class="c1">#         return bl3_div_itf * QW/(E*QQ)</span>
            <span class="c1">#     def RatAutFunDer(QW,E,QQ):</span>
            <span class="c1">#         return [bl3_div_itf * np.reciprocal(E*QQ),-bl3_div_itf * QW/(QQ*np.power(E,2)),-bl3_div_itf * QW/(E*np.power(QQ,2))]</span>
            <span class="c1">#     tdata = pa.DataFrame()</span>
            <span class="c1">#     tdata[&#39;Op_QW&#39;] = data_QW.Op_cfgs[&#39;Op&#39;].apply(lambda x: x[ictflow])</span>
            <span class="c1">#     tdata[&#39;Op_E&#39;] = data_E.Op_cfgs[&#39;Op&#39;].apply(lambda x: x[ictflow])</span>
            <span class="c1">#     tdata[&#39;Op_QQ&#39;] = data_QQ.Op_cfgs[&#39;Op&#39;].apply(lambda x: x[list(alpha_ratio.tflowlist).index(ts)])</span>
            <span class="c1">#     Alist.append(AutoCorrelate( Fun=[RatAutoFun,RatAutFunDer],Sparam=alpha_ratio.Sparam,</span>
            <span class="c1">#                                 name=alpha_ratio.flowname + &#39; $&#39; +tflowTOLeg(strit)+&#39;$&#39;,data=tdata,save_covar=True))</span>
            <span class="c1">#     thistimer.Lap(strit)</span>
            <span class="c1"># alpha_ratio.Op_Stats[&#39;Auto&#39;] = pa.Series(Alist,index=alpha_ratio.Op_Stats.index)</span>
        <span class="c1"># alpha_ratio = data_QW.__div__(data_QQ*data_E)</span>
        <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">)</span>
        <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">alpha_ratio</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
        <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_NoE</span><span class="p">)</span>
        <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_NoE</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
        <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
        <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_Q0</span><span class="p">)</span>
        <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name_Q0</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
        <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
        <span class="n">alpha_ratio_Q0</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
    <span class="c1"># data_plot_NoE = alpha_ratio_NoE.FlowPlot_mul_tf2(data_plot_NoE,mul=True)</span>
    <span class="n">data_plot_NoE</span> <span class="o">=</span> <span class="n">alpha_ratio_NoE</span><span class="o">.</span><span class="n">FlowPlot_mul_tf2</span><span class="p">(</span><span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">mul</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">forcet0</span><span class="o">=</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">ens_name</span><span class="p">])</span>
    <span class="c1"># data_plot_NoE = alpha_ratio_NoE.FlowPlot(data_plot_NoE)</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">alpha_ratio</span><span class="o">.</span><span class="n">FlowPlot_mul_tf2</span><span class="p">(</span><span class="n">data_plot</span><span class="p">)</span>
    <span class="c1"># if DoAuto:</span>
    <span class="c1">#     data_plot = alpha_ratio.FlowPlotAuto(data_plot)</span>
    <span class="c1">#     data_plot_tauint =  alpha_ratio.PlotTauIntWOpt(data_plot_tauint)</span>
    <span class="c1">#     data_plot_covar = PlotCovar(alpha_ratio.Op_Stats[&#39;Auto&#39;],data_plot_covar,ens_name)</span>
    <span class="k">return</span> <span class="n">alpha_ratio</span><span class="p">,</span><span class="n">alpha_ratio_Q0</span><span class="p">,</span><span class="n">alpha_ratio_NoE</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">data_plot_tauint</span><span class="p">,</span> \
            <span class="n">data_Q</span><span class="p">,</span><span class="n">data_E</span><span class="p">,</span><span class="n">data_W</span><span class="p">,</span><span class="n">data_QW</span><span class="p">,</span><span class="n">data_QQ</span><span class="p">,</span><span class="n">data_QQ0</span><span class="p">,</span><span class="n">data_plot_covar</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">ts</span></div>


<div class="viewcode-block" id="PlotCovar"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.PlotCovar">[docs]</a><span class="k">def</span> <span class="nf">PlotCovar</span><span class="p">(</span><span class="n">Auto_Series</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">label</span><span class="p">):</span>
    <span class="n">this_key</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="s1">&#39;C11&#39;</span><span class="p">]</span>
    <span class="n">covarl</span><span class="p">,</span><span class="n">indexl</span> <span class="o">=</span> <span class="p">[],[]</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">Auto_Series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">icovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">covar</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jc</span><span class="p">,</span><span class="n">jcovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">icovar</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">jc</span> <span class="o">&gt;=</span> <span class="n">ic</span><span class="p">:</span>
                    <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jc</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
                    <span class="n">covarl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jcovar</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ic</span><span class="p">,</span><span class="n">icovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">covar_NoNorm</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jc</span><span class="p">,</span><span class="n">jcovar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">icovar</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">jc</span> <span class="o">&gt;=</span> <span class="n">ic</span><span class="p">:</span>
                    <span class="n">indexl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_NoNorm&#39;</span><span class="p">))</span>
                    <span class="n">covarl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jcovar</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg_paras</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">*</span><span class="n">idata</span><span class="o">.</span><span class="n">Avg_paras</span><span class="p">[</span><span class="n">jc</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">indicies</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FlowTime&#39;</span><span class="p">,</span><span class="s1">&#39;Covar_matrix&#39;</span><span class="p">])</span>
        <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">covarl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">indicies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ploty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_key</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ploty</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;scatter_vary&#39;</span>
    <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="PlotErrRat"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.PlotErrRat">[docs]</a><span class="k">def</span> <span class="nf">PlotErrRat</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span><span class="n">this_data2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting ratio of relative error WW/WQ&#39;</span><span class="p">)</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_WWdivWQ_errrat.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{\Delta&lt;W(t)W(t_0)&gt;}{\Delta&lt;W(t)Q(t_0)&gt;}$ &#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;$t/a$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="n">idata</span><span class="p">),</span><span class="n">idata2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">this_data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">this_data2</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, &#39;</span><span class="p">,</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39; did not pass properly, skipping&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">this_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">))</span>
        <span class="n">this_data</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">/</span><span class="n">idata2</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">))</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="n">this_data</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">values</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="PlotEt2"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.PlotEt2">[docs]</a><span class="k">def</span> <span class="nf">PlotEt2</span><span class="p">(</span><span class="n">this_data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting ratio of relative error WW/WQ&#39;</span><span class="p">)</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_Et2.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$(\frac</span><span class="si">{6}</span><span class="s1">{N_</span><span class="si">{xyzt}</span><span class="s1">})t^</span><span class="si">{2}</span><span class="s1">&lt;E(t)&gt;$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$(\frac</span><span class="si">{6}</span><span class="s1">{N_</span><span class="si">{xyzt}</span><span class="s1">}t^</span><span class="si">{2}</span><span class="s1">&lt;E(t)&gt;$&#39;</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">this_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, &#39;</span><span class="p">,</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39; did not pass properly, skipping&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">def</span> <span class="nf">this_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nt</span><span class="o">*</span><span class="n">idata</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">nxyz</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">this_data</span> <span class="o">=</span> <span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this_fun</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">this_data</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
        <span class="n">this_s8t0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">idata</span><span class="o">.</span><span class="n">latparams</span><span class="o">.</span><span class="n">Get_t0</span><span class="p">()[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Sqrt</span><span class="p">()</span>
        <span class="n">tflowphys</span><span class="p">,</span><span class="n">tflowphys_err</span> <span class="o">=</span> <span class="p">[],[]</span>
        <span class="k">for</span> <span class="n">itflow</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">itflow</span><span class="p">)</span><span class="o">/</span><span class="n">this_s8t0</span>
            <span class="n">it</span><span class="o">.</span><span class="n">Stats</span><span class="p">()</span>
            <span class="n">tflowphys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
            <span class="n">tflowphys_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">tflowphys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys</span><span class="p">)</span>
        <span class="n">tflowphys_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tflowphys_err</span><span class="p">)</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;xerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tflowphys_err</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;yerr_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="p">)</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error_bar&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="PlotEpsWrap"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.PlotEpsWrap">[docs]</a><span class="k">def</span> <span class="nf">PlotEpsWrap</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span><span class="n">file_name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plotting eps ratio for &#39;</span><span class="o">+</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">op1</span><span class="p">,</span><span class="n">op2</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">file_name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_&#39;</span><span class="o">+</span><span class="n">file_name</span><span class="o">+</span><span class="s1">&#39;_errrat_.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{\Delta&lt;&#39;</span><span class="o">+</span><span class="n">op1</span><span class="o">+</span><span class="s1">&#39;(t+eps)&#39;</span><span class="o">+</span><span class="n">op2</span><span class="o">+</span><span class="s1">&#39;(t_0)&gt;}{\Delta&lt;&#39;</span><span class="o">+</span><span class="n">op1</span><span class="o">+</span><span class="s1">&#39;(t)&#39;</span><span class="o">+</span><span class="n">op2</span><span class="o">+</span><span class="s1">&#39;(t_0)&gt;}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">ErrEpsWrap</span><span class="p">(</span><span class="n">this_data</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, &#39;</span><span class="p">,</span><span class="n">file_name</span><span class="p">,</span><span class="n">ikey</span><span class="p">,</span><span class="s1">&#39; did not pass properly, skipping&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;from_keys&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">idata</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">idata</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plot_vary&#39;</span>
        <span class="n">data_plot</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_plot</span></div>


<div class="viewcode-block" id="ErrEpsWrap"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.ErrEpsWrap">[docs]</a><span class="k">def</span> <span class="nf">ErrEpsWrap</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
    <span class="n">data_out</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">idata</span> <span class="ow">in</span> <span class="n">data_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data_out</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">ErrEpsShift</span><span class="p">(</span><span class="n">idata</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">Std</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">Avg</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">data_out</span></div>


<div class="viewcode-block" id="ErrEpsShift"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.ErrEpsShift">[docs]</a><span class="k">def</span> <span class="nf">ErrEpsShift</span><span class="p">(</span><span class="n">this_data</span><span class="p">):</span>
    <span class="n">vall</span><span class="p">,</span><span class="n">indexl</span> <span class="o">=</span> <span class="p">[],[]</span>
    <span class="k">for</span> <span class="n">ieps</span><span class="p">,</span><span class="n">ikey</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_eps_list</span><span class="p">):</span>
        <span class="n">indexl</span> <span class="o">+=</span> <span class="p">[(</span><span class="s1">&#39;eps&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t_f&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="n">jkey</span><span class="p">)</span> <span class="k">for</span> <span class="n">jkey</span> <span class="ow">in</span> <span class="n">this_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="n">vall</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span><span class="o">-</span><span class="n">ieps</span><span class="p">)</span><span class="o">/</span><span class="n">this_data</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexl</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">index_list</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">indexl</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">,</span><span class="s1">&#39;flow_time&#39;</span><span class="p">])</span>
        <span class="n">out_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vall</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_series</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">out_series</span></div>



<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">master_ens_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mpi411&#39;</span><span class="p">,</span><span class="s1">&#39;mpi570&#39;</span><span class="p">,</span><span class="s1">&#39;mpi701&#39;</span><span class="p">,</span><span class="s1">&#39;L16&#39;</span><span class="p">,</span><span class="s1">&#39;L20&#39;</span><span class="p">,</span><span class="s1">&#39;L28&#39;</span><span class="p">,</span><span class="s1">&#39;qu_L24&#39;</span><span class="p">]</span>
<span class="n">t0_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi411&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.5377162290</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.3999592122</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;mpi701&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">2.2590866059</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">1.3628954894</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">2.2386627909</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>        <span class="mf">4.9885618908</span>
<span class="n">t0_dict</span><span class="p">[</span><span class="s1">&#39;qu_L24&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="mf">3.2060027740</span>


<span class="n">a_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi411&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi570&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;mpi701&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0907</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L16&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.1095</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L20&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0936</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0684</span>
<span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;qu_L24&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.07</span>
<span class="n">fit_info_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fit_info</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fit_info</span><span class="p">[</span><span class="s1">&#39;Funs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c3FitFun_nosqrt</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">fit_info_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_info</span><span class="p">)</span>
<span class="n">tflow_fit_min</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tflow_fit_max</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">min_par_tflow</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">min_hold</span> <span class="o">=</span> <span class="n">tflow_fit_min</span>
<span class="n">max_hold</span> <span class="o">=</span> <span class="n">tflow_fit_max</span>
<span class="n">tflow_fit_min</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tflow_fit_max</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">use_t0rat</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
    <span class="n">sqrt8t_key</span> <span class="o">=</span> <span class="s1">&#39;sqrt8t_t0rat&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">sqrt8t_key</span> <span class="o">=</span> <span class="s1">&#39;sqrt8t_fm&#39;</span>
<span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">min_hold</span><span class="p">,</span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="n">max_hold</span><span class="p">,</span> <span class="s1">&#39; in fm corresponds to&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ikey</span><span class="p">)</span>
        <span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_hold</span><span class="o">/</span><span class="p">(</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
        <span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_hold</span><span class="o">/</span><span class="p">(</span><span class="n">a_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">ikey</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span> <span class="s1">&#39; in units of sqrt(8t_</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ikey</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_hold</span>
        <span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_hold</span>

<span class="n">run_nb</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">ens_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">iarg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="s1">&#39;mpi&#39;</span> <span class="ow">in</span> <span class="n">iarg</span> <span class="ow">and</span> <span class="s1">&#39;ens&#39;</span> <span class="ow">in</span> <span class="n">iarg</span><span class="p">:</span>
            <span class="n">ens_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mpi411&#39;</span><span class="p">,</span><span class="s1">&#39;mpi570&#39;</span><span class="p">,</span><span class="s1">&#39;mpi701&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s1">&#39;latspace&#39;</span> <span class="ow">in</span> <span class="n">iarg</span> <span class="ow">and</span> <span class="s1">&#39;ens&#39;</span> <span class="ow">in</span> <span class="n">iarg</span><span class="p">:</span>
            <span class="n">ens_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;L16&#39;</span><span class="p">,</span><span class="s1">&#39;L20&#39;</span><span class="p">,</span><span class="s1">&#39;L28&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s1">&#39;quenched&#39;</span> <span class="ow">in</span> <span class="n">iarg</span> <span class="ow">and</span> <span class="s1">&#39;ens&#39;</span> <span class="ow">in</span> <span class="n">iarg</span><span class="p">:</span>
            <span class="n">ens_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;qu_L24&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s1">&#39;nblock&#39;</span> <span class="ow">in</span> <span class="n">iarg</span><span class="p">:</span>
            <span class="n">run_nb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iarg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nblock&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">iarg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">master_ens_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, ensemble name not found: &#39;</span><span class="p">,</span><span class="n">iarg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ens_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iarg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ens_list</span> <span class="o">=</span> <span class="n">master_ens_list</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running over ensembles&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ens_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>


<div class="viewcode-block" id="FitRat"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.FitRat">[docs]</a><span class="k">def</span> <span class="nf">FitRat</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span><span class="n">this_key</span><span class="p">,</span><span class="n">nbstr</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="n">fit_data</span> <span class="o">=</span> <span class="n">this_data</span><span class="o">.</span><span class="n">Op_Stats</span><span class="p">[[</span><span class="s1">&#39;boot&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">this_file</span> <span class="o">=</span> <span class="n">scratchdir</span><span class="o">+</span><span class="s1">&#39;/fit_WQ_&#39;</span><span class="o">+</span><span class="n">this_key</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.py3p&#39;</span>
    <span class="n">this_fit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">this_file</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">this_fit</span><span class="p">,</span><span class="n">dummy</span> <span class="o">=</span> <span class="n">pik</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">this_fit</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_fit</span><span class="o">.</span><span class="n">Fit_Stats_fmt</span><span class="p">[</span><span class="s1">&#39;Fit&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_t0rat</span><span class="p">:</span>
            <span class="n">fit_data</span><span class="p">[</span><span class="n">sqrt8t_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">t0_dict</span><span class="p">[</span><span class="n">this_key</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_data</span><span class="p">[</span><span class="n">sqrt8t_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">a_dict</span><span class="p">[</span><span class="n">this_key</span><span class="p">])</span>
        <span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">untflowstr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Flow Times&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Stats</span><span class="p">())</span>
        <span class="n">fit_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">sqrt8t_key</span><span class="p">)[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span>
        <span class="n">fit_less_data</span> <span class="o">=</span> <span class="n">fit_data</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">this_fit</span> <span class="o">=</span> <span class="n">sff</span><span class="o">.</span><span class="n">SetOfFitFuns</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">fit_less_data</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">this_key</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">ScanRange</span><span class="p">(</span><span class="n">tflow_fit_min</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span><span class="n">tflow_fit_max</span><span class="p">[</span><span class="n">ikey</span><span class="p">],</span>
                           <span class="n">fit_info_list</span><span class="p">,</span><span class="n">min_fit_len</span><span class="o">=</span><span class="n">min_par_tflow</span><span class="p">,</span><span class="n">from_xdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">DoFits</span><span class="p">()</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">SortChi</span><span class="p">()</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">Fitr_Len_Sort</span><span class="p">()</span>
        <span class="c1"># this_fit.Cut_min_len(30)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">RemoveFuns</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">this_file</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pik</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">this_fit</span><span class="p">,</span><span class="n">fit_less_data</span><span class="p">),</span><span class="n">f</span><span class="p">)</span>
        <span class="n">this_fit</span><span class="o">.</span><span class="n">GetFuns</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">this_fit</span></div>


<div class="viewcode-block" id="PlotFlowTime"><a class="viewcode-back" href="../Mat_Alpha_Hack.html#Mat_Alpha_Hack.PlotFlowTime">[docs]</a><span class="k">def</span> <span class="nf">PlotFlowTime</span><span class="p">(</span><span class="n">t0_scale</span><span class="p">,</span><span class="n">this_nb</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">this_nb</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nbstr</span> <span class="o">=</span> <span class="s1">&#39;_nb&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">this_nb</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nbstr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">t0_scale_str</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;t_s</span><span class="si">{t0_scale:.3}</span><span class="s1">&#39;</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_NoE_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{t&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)W(t)&gt;}{&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)^</span><span class="si">{2}</span><span class="s1">&gt;}$ $t_</span><span class="si">{s}</span><span class="s1">=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; t_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">data_plot_NoE</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)^</span><span class="si">{2}</span><span class="s1">&gt;}$ $t_</span><span class="si">{s}</span><span class="s1">=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; t_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>


    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_R28_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$\frac{&lt;Q(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})^{2}&gt;_{28}}$ $t_{s}=&#39;+t0_scale_str+ r&#39; t_{0}$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
    <span class="c1"># data_plot_28 = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_Q0_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$\frac{&lt;Q(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})Q(0)&gt;}$ $t_{s}=&#39;+t0_scale_str+ r&#39; t_{0}$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
    <span class="c1"># data_plot_Q0 = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_WWrat_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{&lt;W(t_</span><span class="si">{s}</span><span class="s1">)W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)W(t_</span><span class="si">{s}</span><span class="s1">)&gt;}$ $t_</span><span class="si">{s}</span><span class="s1">=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; t_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">WW_data_plot</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_WWrat_NoE_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\frac{t&lt;W(t_</span><span class="si">{s}</span><span class="s1">)W(t)&gt;}{&lt;Q(t_</span><span class="si">{s}</span><span class="s1">)W(t_</span><span class="si">{s}</span><span class="s1">)&gt;}$ $t_</span><span class="si">{s}</span><span class="s1">=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; t_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ratio&#39;</span>
    <span class="n">WW_data_plot_NoE</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;_tauint.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\tau_</span><span class="si">{int}</span><span class="s1">$ of alpha ratio $t_</span><span class="si">{s}</span><span class="s1">=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; t_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="se">\t</span><span class="s1">au_</span><span class="si">{int}</span><span class="s1">$&#39;</span>
    <span class="n">data_plot_tauint</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>

    <span class="n">this_info</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;save_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphdir</span><span class="o">+</span><span class="s1">&#39;/flowops_test_covar&#39;</span><span class="o">+</span><span class="n">nbstr</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Covariance matrix of alpha ratio &#39;</span><span class="o">+</span><span class="n">nbstr</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\sqrt</span><span class="si">{8t}</span><span class="s1">/\sqrt{8t_</span><span class="si">{0}</span><span class="s1">}$&#39;</span>
    <span class="n">this_info</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;$Covar$&#39;</span>
    <span class="n">data_plot_covar</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">plot_info</span><span class="o">=</span><span class="n">this_info</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_W.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;W(t)&gt;$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = &#39;$W$&#39;</span>
    <span class="c1"># data_plot_W = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_Q.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;Q(t)&gt;$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = &#39;$Q$&#39;</span>
    <span class="c1"># data_plot_Q = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_E.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;\frac{6*t^{2}}{V}*E(t)&gt;$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = &#39;$E$&#39;</span>
    <span class="c1"># data_plot_E = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QQ_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;Q(t)^{2}&gt;$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = r&#39;$&lt;QQ&gt;$&#39;</span>
    <span class="c1"># data_plot_QQ = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QQ0_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;Q(t)Q(0)&gt;$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = r&#39;$&lt;QQ&gt;$&#39;</span>
    <span class="c1"># data_plot_QQ0 = Plotting(plot_info=this_info)</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QW_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;Q(t_{s})W(t)&gt;$ $t_{s}=&#39;+t0_scale_str+ r&#39; t_{0}$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = r&#39;$&lt;QW&gt;$&#39;</span>
    <span class="c1"># data_plot_QW = Plotting(plot_info=this_info)</span>

    <span class="c1"># this_info = pa.Series()</span>
    <span class="c1"># this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_WW_&#39;+t0_scale_str+&#39;.pdf&#39;</span>
    <span class="c1"># this_info[&#39;title&#39;] = r&#39;$&lt;W(t_{s})W(t)&gt;$ $t_{s}=&#39;+t0_scale_str+ r&#39; t_{0}$&#39;</span>
    <span class="c1"># this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
    <span class="c1"># this_info[&#39;ylabel&#39;] = r&#39;$&lt;WW&gt;$&#39;</span>
    <span class="c1"># data_plot_WW = Plotting(plot_info=this_info)</span>

    <span class="n">Rat_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Rat_28_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Rat_Q0_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Rat_NoE_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_Q_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_W_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_E_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_QW_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_QQ_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_QQ0_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_WW_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># data_QW2_list = {}</span>
    <span class="n">WWrat_ens_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ts_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Rat_Fit_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iens</span> <span class="ow">in</span> <span class="n">ens_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ens_list</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ikey</span> <span class="ow">or</span> <span class="s1">&#39;_no2&#39;</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">parse_dict</span> <span class="o">=</span> <span class="n">defInfoFlow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">parse_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">iens</span><span class="p">)</span>
        <span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;nxyzt&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;kud&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parse_dict</span><span class="p">[</span><span class="s1">&#39;ks&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;         ANALYSING CONFIGURATION &#39;</span><span class="p">,</span><span class="n">ikey</span><span class="p">)</span>
        <span class="n">this_alpha</span><span class="p">,</span><span class="n">this_alpha_Q0</span><span class="p">,</span><span class="n">this_alpha_NoE</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span> \
        <span class="n">data_plot_NoE</span><span class="p">,</span><span class="n">data_plot_tauint</span><span class="p">,</span><span class="n">data_Q</span><span class="p">,</span><span class="n">data_E</span><span class="p">,</span><span class="n">data_W</span><span class="p">,</span><span class="n">data_QW</span><span class="p">,</span> \
        <span class="n">data_QQ</span><span class="p">,</span><span class="n">data_QQ0</span><span class="p">,</span><span class="n">data_plot_covar</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">its</span> <span class="o">=</span> <span class="n">AlphaRatAnalysis</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="n">parse_dict</span><span class="p">,</span><span class="n">data_plot</span><span class="p">,</span><span class="n">data_plot_NoE</span><span class="p">,</span>
                                                            <span class="n">data_plot_tauint</span><span class="p">,</span><span class="n">data_plot_covar</span><span class="p">,</span><span class="n">t0_scale</span><span class="p">,</span><span class="n">nblock</span><span class="o">=</span><span class="n">this_nb</span><span class="p">)</span>

        <span class="n">Rat_Fit_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">FitRat</span><span class="p">(</span><span class="n">this_alpha_NoE</span><span class="p">,</span><span class="n">ikey</span><span class="p">,</span><span class="n">nbstr</span><span class="o">=</span><span class="n">nbstr</span><span class="p">)</span>
        <span class="n">ts_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">its</span>
        <span class="n">Rat_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_alpha</span>
        <span class="n">Rat_Q0_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_alpha_Q0</span>
        <span class="n">Rat_NoE_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_alpha_NoE</span>
        <span class="n">data_Q_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_Q</span>
        <span class="n">data_E_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_E</span>
        <span class="n">data_W_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_W</span>
        <span class="n">data_QQ_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QQ</span>
        <span class="n">data_QQ0_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QQ0</span>
        <span class="n">data_QW_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data_QW</span><span class="p">)</span>

        <span class="n">hold_series</span> <span class="o">=</span> <span class="n">null_series</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fit_vary&#39;</span>
        <span class="c1"># plot_fit = A0Fit_data[ikey].ReduceViaChi(nchi_cutoff=15)[0]</span>
        <span class="n">plot_fit</span> <span class="o">=</span> <span class="n">Rat_Fit_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;key_select&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;First&#39;</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;fit_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_fit</span>
        <span class="n">hold_series</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ikey</span><span class="o">+</span><span class="s1">&#39; Fit&#39;</span>
        <span class="c1"># hold_series[&#39;xaxis&#39;] = 0</span>
        <span class="c1"># hold_series[&#39;xdatarange&#39;] = &#39;Data&#39;</span>
        <span class="c1"># hold_series[&#39;otherXvals&#39;] = [1]</span>
        <span class="n">data_plot_NoE</span><span class="o">.</span><span class="n">AppendData</span><span class="p">(</span><span class="n">hold_series</span><span class="p">)</span>

        <span class="c1"># data_plot_Q0 = this_alpha_Q0.FlowPlot_mul_tf2(data_plot_Q0)</span>
        <span class="c1"># data_plot_Q = data_Q.FlowPlot(data_plot_Q)</span>
        <span class="c1"># data_plot_W = data_W.FlowPlot(data_plot_W)</span>
        <span class="c1"># data_plot_E = data_E.FlowPlot_mul_tf2(data_plot_E,just_E=True)</span>
        <span class="c1"># data_plot_QQ = data_QQ.FlowPlot(data_plot_QQ)</span>
        <span class="c1"># data_plot_QQ0 = data_QQ0.FlowPlot(data_plot_QQ0)</span>
        <span class="c1"># data_plot_QW = data_QW.FlowPlot_mul_tf2(data_plot_QW,mul=True)</span>
        <span class="k">if</span> <span class="n">DoWW</span><span class="p">:</span>
            <span class="n">this_WWrat</span><span class="p">,</span><span class="n">this_WWrat_NoE</span><span class="p">,</span><span class="n">WW_data_plot</span><span class="p">,</span><span class="n">WW_data_plot_NoE</span><span class="p">,</span><span class="n">data_WW</span> <span class="o">=</span> <span class="n">DoWWAnalysis</span><span class="p">(</span><span class="n">ikey</span><span class="p">,</span><span class="n">WW_data_plot</span><span class="p">,</span><span class="n">WW_data_plot_NoE</span><span class="p">,</span><span class="n">data_Q</span><span class="p">,</span><span class="n">data_E</span><span class="p">,</span><span class="n">data_W</span><span class="p">,</span><span class="n">data_QW</span><span class="p">,</span><span class="n">InfoFlow</span><span class="p">,</span><span class="n">t0_scale</span><span class="p">)</span>
            <span class="n">data_WW_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_WW</span>
            <span class="c1"># data_QW2_list[ikey] = data_QW2</span>
            <span class="n">WWrat_ens_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_WWrat</span>
            <span class="c1"># data_plot_WW = data_WW.FlowPlot(data_plot_WW)</span>
            <span class="c1"># data_plot_QWcomp = data_QW.FlowPlot(data_plot_QWcomp)</span>
            <span class="c1"># # data_plot_QWcomp = data_QW2.FlowPlot(data_plot_QWcomp)</span>
            <span class="c1"># data_plot_WWvsQW = data_QW.FlowPlot_mul_tf2(data_plot_WWvsQW,mul=True)</span>
            <span class="c1"># data_plot_WWvsQW = data_WW.FlowPlot_mul_tf2(data_plot_WWvsQW,mul=True)</span>
    <span class="k">if</span> <span class="s1">&#39;L28&#39;</span> <span class="ow">in</span> <span class="n">data_QQ_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">QQ_28</span> <span class="o">=</span> <span class="n">data_QQ_list</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">GetInterp</span><span class="p">(</span><span class="n">ts_list</span><span class="p">[</span><span class="s1">&#39;L28&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">QQ_28</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">leg_lab_ext</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39; \frac{t_</span><span class="si">{s}</span><span class="s1">}{t_</span><span class="si">{0}</span><span class="s1">}=&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;t_s&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ikey</span><span class="p">,</span><span class="n">iens</span> <span class="ow">in</span> <span class="n">ens_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">ikey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ens_list</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ikey</span> <span class="ow">or</span> <span class="s1">&#39;_no2&#39;</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;mpi&#39;</span> <span class="ow">in</span> <span class="n">ikey</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="n">QQ_28</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">data_QW_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">data_E_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span><span class="o">*</span><span class="n">QQ_28</span><span class="p">)</span>
            <span class="n">out_name</span> <span class="o">=</span> <span class="s1">&#39;Test_alpha_28_&#39;</span><span class="o">+</span><span class="n">ikey</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">t0_scale_str</span><span class="o">+</span><span class="n">nbstr</span>
            <span class="n">this_data</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">)</span>
            <span class="n">this_data</span><span class="o">.</span><span class="n">FlowSetCustomName</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">out_name</span><span class="p">,</span><span class="n">stringLL</span><span class="o">=</span><span class="n">this_data</span><span class="o">.</span><span class="n">flowLegLab</span><span class="o">+</span><span class="n">leg_lab_ext</span><span class="p">)</span>
            <span class="n">this_data</span><span class="o">.</span><span class="n">FlowStats</span><span class="p">()</span>
            <span class="n">this_data</span><span class="o">.</span><span class="n">FlowWrite</span><span class="p">()</span>
            <span class="c1"># data_plot_28 = this_data.FlowPlot_mul_tf2(data_plot_28)</span>
            <span class="n">Rat_28_list</span><span class="p">[</span><span class="n">ikey</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_data</span>
    <span class="c1"># data_plot_28.PlotAll()</span>
    <span class="n">data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="c1"># data_plot_Q0.PlotAll()</span>
    <span class="n">data_plot_NoE</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="c1"># data_plot_tauint.PlotAll()</span>
    <span class="c1"># data_plot_covar.PlotAll()</span>
    <span class="c1"># data_plot_W.PlotAll()</span>
    <span class="c1"># data_plot_E.PlotAll()</span>
    <span class="c1"># data_plot_Q.PlotAll()</span>
    <span class="c1"># data_plot_QQ.PlotAll()</span>
    <span class="c1"># data_plot_QQ0.PlotAll()</span>
    <span class="c1"># data_plot_QW.PlotAll()</span>
    <span class="c1"># data_plot_WW.PlotAll()</span>
    <span class="c1"># data_plot_QWcomp.PlotAll()</span>

    <span class="k">if</span> <span class="n">DoWW</span><span class="p">:</span>
        <span class="c1"># data_plot_WWvsQW.PlotAll()</span>
        <span class="n">WW_data_plot</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
        <span class="n">WW_data_plot_NoE</span><span class="o">.</span><span class="n">PlotAll</span><span class="p">()</span>
    <span class="c1"># data_plot_QQ_errrat = PlotEpsWrap(data_QQ_list,&#39;QQ&#39;)</span>
    <span class="c1"># data_plot_QW_errrat = PlotEpsWrap(data_QW_list,&#39;QW&#39;)</span>
    <span class="c1"># data_plot_WW_errrat = PlotEpsWrap(data_WW_list,&#39;WW&#39;)</span>
    <span class="c1"># data_plot_QW2_errrat = PlotEpsWrap(data_QW2_list,&#39;QW2&#39;)</span>
    <span class="c1"># data_plot_Et2 = PlotEt2(data_E_list)</span>
    <span class="c1"># data_plot_WWdivQW = PlotErrRat(data_WW_list,data_QW_list)</span>
    <span class="n">out_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Rat_Fit_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rat_Fit_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Rat_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rat_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Rat_28_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rat_28_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Rat_Q0_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rat_Q0_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Rat_NoE_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rat_NoE_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;E_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_E_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;Q_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_Q_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;W_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_W_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;QQ_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QQ_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;QQ0_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QQ0_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;QW_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_QW_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;WW_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_WW_list</span>
    <span class="c1"># out_dict[&#39;QW2_data&#39;] = data_QW2_list</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;data_plot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;data_plot_NoE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot_NoE</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;data_plot_tauint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot_tauint</span>
    <span class="n">out_dict</span><span class="p">[</span><span class="s1">&#39;data_plot_covar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot_covar</span>
    <span class="c1"># out_dict[&#39;data_plot_W&#39;] = data_plot_W</span>
    <span class="c1"># out_dict[&#39;data_plot_E&#39;] = data_plot_E</span>
    <span class="c1"># out_dict[&#39;data_plot_Q&#39;] = data_plot_Q</span>
    <span class="c1"># out_dict[&#39;data_plot_QQ&#39;] = data_plot_QQ</span>
    <span class="c1"># out_dict[&#39;data_plot_QQ0&#39;] = data_plot_QQ0</span>
    <span class="c1"># out_dict[&#39;data_plot_QW&#39;] = data_plot_QW</span>
    <span class="c1"># out_dict[&#39;data_plot_WW&#39;] = data_plot_WW</span>
    <span class="c1"># out_dict[&#39;data_plot_QWcomp&#39;] = data_plot_QWcomp</span>
    <span class="c1"># out_dict[&#39;data_plot_WWvsQW&#39;] = data_plot_WWvsQW</span>
    <span class="c1"># out_dict[&#39;WW_data_plot&#39;] = WW_data_plot</span>
    <span class="c1"># out_dict[&#39;WW_data_plot_NoE&#39;] = WW_data_plot_NoE</span>
    <span class="c1"># out_dict[&#39;data_plot_Et2&#39;] = data_plot_Et2</span>
    <span class="c1"># out_dict[&#39;data_plot_WWdivQW&#39;] = data_plot_WWdivQW</span>
    <span class="k">return</span> <span class="n">out_dict</span></div>

<span class="c1">## sqrt(8t_s) = &quot;sqrt_t0_scale_list&quot; X sqrt(8t_0)</span>
<span class="c1"># sqrt_t0_scale_list = [0.2, 0.4, 0.6, 0.8, 1.0]</span>
<span class="n">sqrt_t0_scale_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">]</span>
<span class="n">t0_scale_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">it0</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">it0</span> <span class="ow">in</span> <span class="n">sqrt_t0_scale_list</span><span class="p">]</span>
<span class="n">pow_list</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span>
<span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">it0s</span> <span class="ow">in</span> <span class="n">t0_scale_list</span><span class="p">:</span>
    <span class="n">t0_scale_str</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;t_s</span><span class="si">{it0s:.3f}</span><span class="s1">&#39;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="n">PlotFlowTime</span><span class="p">(</span><span class="n">it0s</span><span class="p">,</span><span class="n">this_nb</span><span class="o">=</span><span class="n">run_nb</span><span class="p">)</span>
    <span class="n">all_data</span><span class="p">[</span><span class="n">t0_scale_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_list</span>

<span class="c1"># for ikey,iens in ens_dict.items():</span>
<span class="c1">#     if ikey not in ens_list: continue</span>
<span class="c1">#     if &#39;-&#39; in ikey or &#39;_no2&#39; in ikey: continue</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_NoE_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$\frac{t&lt;Q(t_{s})W(t)&gt;}{&lt;Q(t_{s})^{2}&gt;}$ &#39;+ikey</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     data_plot_NoE = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$\frac{&lt;Q(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})^{2}&gt;}$ &#39;+ikey</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     data_plot = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     # this_info = pa.Series()</span>
<span class="c1">#     # this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_R28_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     # this_info[&#39;title&#39;] = r&#39;$\frac{&lt;Q(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})^{2}&gt;_{28}}$ &#39;+ikey</span>
<span class="c1">#     # this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     # this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     # data_plot_28 = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_Q0_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$\frac{&lt;Q(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})Q(0)&gt;}$ &#39;+ikey</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     data_plot_Q0 = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     # this_info = pa.Series()</span>
<span class="c1">#     # this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_WWrat_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     # this_info[&#39;title&#39;] = r&#39;$\frac{&lt;W(t_{s})W(t)&gt;}{t&lt;E(t)&gt;&lt;Q(t_{s})W(t_{s})&gt;}$ &#39;+ikey</span>
<span class="c1">#     # this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     # this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     # WW_data_plot = Plotting(plot_info=this_info)</span>
<span class="c1">#     #</span>
<span class="c1">#     # this_info = pa.Series()</span>
<span class="c1">#     # this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_test_WWrat_NoE_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     # this_info[&#39;title&#39;] = r&#39;$\frac{t&lt;W(t_{s})W(t)&gt;}{&lt;Q(t_{s})W(t_{s})&gt;}$ &#39;+ikey</span>
<span class="c1">#     # this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     # this_info[&#39;ylabel&#39;] = &#39;ratio&#39;</span>
<span class="c1">#     # WW_data_plot_NoE = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QWdiv28_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$&lt;Q(t_{s})W(t)&gt;_{&#39;+ikey+&#39;}/&lt;Q(t_{s})W(t)&gt;_{L28}$ &#39;</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = r&#39;$&lt;QW&gt;/&lt;QW&gt;_{28}$&#39;</span>
<span class="c1">#     data_plot_QW_rat28 = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QWdiv20_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$&lt;Q(t_{s})W(t)&gt;_{&#39;+ikey+&#39;}/&lt;Q(t_{s})W(t)&gt;_{L20}$ &#39;</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = r&#39;$&lt;QW&gt;/&lt;QW&gt;_{20}$&#39;</span>
<span class="c1">#     data_plot_QW_rat20 = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QWdiv16_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$&lt;Q(t_{s})W(t)&gt;_{&#39;+ikey+&#39;}/&lt;Q(t_{s})W(t)&gt;_{L16}$ &#39;</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = r&#39;$&lt;QW&gt;/&lt;QW&gt;_{16}$&#39;</span>
<span class="c1">#     data_plot_QW_rat16 = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#     this_info = pa.Series()</span>
<span class="c1">#     this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_QW_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     this_info[&#39;title&#39;] = r&#39;$&lt;Q(t_{s})W(t)&gt;$ &#39;+ikey</span>
<span class="c1">#     this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     this_info[&#39;ylabel&#39;] = r&#39;$&lt;QW&gt;$&#39;</span>
<span class="c1">#     data_plot_QW = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     # this_info = pa.Series()</span>
<span class="c1">#     # this_info[&#39;save_file&#39;] = graphdir+&#39;/flowops_WW_&#39;+ikey+&#39;.pdf&#39;</span>
<span class="c1">#     # this_info[&#39;title&#39;] = r&#39;$&lt;W(t_{s})W(t)&gt;$ &#39;+ikey</span>
<span class="c1">#     # this_info[&#39;xlabel&#39;] = r&#39;$\sqrt{8t}/\sqrt{8t_{0}}$&#39;</span>
<span class="c1">#     # this_info[&#39;ylabel&#39;] = r&#39;$&lt;WW&gt;$&#39;</span>
<span class="c1">#     # data_plot_WW = Plotting(plot_info=this_info)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     for itc,(its,ts_data) in enumerate(all_data.items()):</span>
<span class="c1">#         # if ikey in ts_data[&#39;Rat_28_data&#39;].keys():</span>
<span class="c1">#         #     this_rat_28 = ts_data[&#39;Rat_28_data&#39;][ikey]</span>
<span class="c1">#         #     data_plot_28 = this_rat_28.FlowPlot_mul_tf2(data_plot_28)</span>
<span class="c1">#</span>
<span class="c1">#         this_QW = ts_data[&#39;QW_data&#39;][ikey]</span>
<span class="c1">#         # this_WW = ts_data[&#39;WW_data&#39;][ikey]</span>
<span class="c1">#         this_rat = ts_data[&#39;Rat_data&#39;][ikey]</span>
<span class="c1">#         this_rat_NoE = ts_data[&#39;Rat_NoE_data&#39;][ikey]</span>
<span class="c1">#         this_rat_Q0 = ts_data[&#39;Rat_Q0_data&#39;][ikey]</span>
<span class="c1">#         if &#39;L28&#39; in ts_data[&#39;QW_data&#39;].keys():</span>
<span class="c1">#             this_QW_rat = this_QW.__div__(ts_data[&#39;QW_data&#39;][&#39;L28&#39;])</span>
<span class="c1">#             this_QW_rat.FlowStats()</span>
<span class="c1">#             data_plot_QW_rat28 = this_QW_rat.FlowPlot(data_plot_QW_rat28,lab_append=its)</span>
<span class="c1">#         if &#39;L20&#39; in ts_data[&#39;QW_data&#39;].keys():</span>
<span class="c1">#             this_QW_rat = this_QW.__div__(ts_data[&#39;QW_data&#39;][&#39;L20&#39;])</span>
<span class="c1">#             this_QW_rat.FlowStats()</span>
<span class="c1">#             data_plot_QW_rat20 = this_QW_rat.FlowPlot(data_plot_QW_rat20,lab_append=its)</span>
<span class="c1">#         if &#39;L16&#39; in ts_data[&#39;QW_data&#39;].keys():</span>
<span class="c1">#             this_QW_rat = this_QW.__div__(ts_data[&#39;QW_data&#39;][&#39;L16&#39;])</span>
<span class="c1">#             this_QW_rat.FlowStats()</span>
<span class="c1">#             data_plot_QW_rat16 = this_QW_rat.FlowPlot(data_plot_QW_rat16,lab_append=its)</span>
<span class="c1">#         data_plot_QW = this_QW.FlowPlot(data_plot_QW)</span>
<span class="c1">#         if &#39;L28&#39; in ikey:</span>
<span class="c1">#             for ipow in pow_list:</span>
<span class="c1">#                 data_plot_QW = this_QW.FlowPlot_mul_tf2(data_plot_QW,mul=True,tpow=ipow,lab_append=&#39;$&lt;QW&gt;^{&#39;+str(ipow)+&#39;}$&#39;)</span>
<span class="c1">#                 data_plot = this_rat.FlowPlot_mul_tf2(data_plot,tpow=ipow,lab_append=&#39;$&lt;QW&gt;^{&#39;+str(ipow)+&#39;}$&#39;)</span>
<span class="c1">#         else:</span>
<span class="c1">#             data_plot_QW = this_QW.FlowPlot_mul_tf2(data_plot_QW,mul=True)</span>
<span class="c1">#             data_plot = this_rat.FlowPlot_mul_tf2(data_plot)</span>
<span class="c1">#         data_plot_NoE = this_rat_NoE.FlowPlot_mul_tf2(data_plot_NoE,mul=True)</span>
<span class="c1">#         data_plot_Q0 = this_rat_Q0.FlowPlot_mul_tf2(data_plot_Q0)</span>
<span class="c1">#     data_plot_QW_rat28.PlotAll()</span>
<span class="c1">#     data_plot_QW_rat20.PlotAll()</span>
<span class="c1">#     data_plot_QW_rat16.PlotAll()</span>
<span class="c1">#     data_plot_QW.PlotAll()</span>
<span class="c1">#     data_plot.PlotAll()</span>
<span class="c1">#     # data_plot_28.PlotAll()</span>
<span class="c1">#     data_plot_NoE.PlotAll()</span>
<span class="c1">#     data_plot_Q0.PlotAll()</span>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Python_Analysis</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Jack Dragos.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>